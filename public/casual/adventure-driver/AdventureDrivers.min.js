var _0x2837=["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=","","charCodeAt","charAt","_keyStr","length","replace","indexOf","fromCharCode","n","dWJnNzcuZ2l0aHViLmlv","dWJnNzcuZ2l0aHViLmlv","NWRkMzAyOTctMDE1Zi0xMWVhLWFkNTYtOWNiNmQwZDk5NWY3dWJnNzcuZ2l0aHViLmlv","dWJnNzcuZ2l0aHViLmlv","decode","href","location","www","//","split","substr","aHR0cDovL3BvLmtpL3NpdGVsb2NrcmVkaXJlY3Q=","top"];!function(){for(var e={_keyStr:_0x2837[0],encode:function(t){var n,i,r,a,s,l,o,_=_0x2837[1],p=0;for(t=e._utf8_encode(t);p<t[_0x2837[5]];)a=(n=t[_0x2837[2]](p++))>>2,s=(3&n)<<4|(i=t[_0x2837[2]](p++))>>4,l=(15&i)<<2|(r=t[_0x2837[2]](p++))>>6,o=63&r,isNaN(i)?l=o=64:isNaN(r)&&(o=64),_=_+this[_0x2837[4]][_0x2837[3]](a)+this[_0x2837[4]][_0x2837[3]](s)+this[_0x2837[4]][_0x2837[3]](l)+this[_0x2837[4]][_0x2837[3]](o);return _},decode:function(t){var n,i,r,a,s,l,o=_0x2837[1],_=0;for(t=t[_0x2837[6]](/[^A-Za-z0-9+/=]/g,_0x2837[1]);_<t[_0x2837[5]];)n=this[_0x2837[4]][_0x2837[7]](t[_0x2837[3]](_++))<<2|(a=this[_0x2837[4]][_0x2837[7]](t[_0x2837[3]](_++)))>>4,i=(15&a)<<4|(s=this[_0x2837[4]][_0x2837[7]](t[_0x2837[3]](_++)))>>2,r=(3&s)<<6|(l=this[_0x2837[4]][_0x2837[7]](t[_0x2837[3]](_++))),o+=String[_0x2837[8]](n),64!=s&&(o+=String[_0x2837[8]](i)),64!=l&&(o+=String[_0x2837[8]](r));return o=e._utf8_decode(o)},_utf8_encode:function(e){e=e[_0x2837[6]](/rn/g,_0x2837[9]);for(var t=_0x2837[1],n=0;n<e[_0x2837[5]];n++){var i=e[_0x2837[2]](n);i<128?t+=String[_0x2837[8]](i):(127<i&&i<2048?t+=String[_0x2837[8]](i>>6|192):(t+=String[_0x2837[8]](i>>12|224),t+=String[_0x2837[8]](i>>6&63|128)),t+=String[_0x2837[8]](63&i|128))}return t},_utf8_decode:function(e){for(var t=_0x2837[1],n=0,i=c1=c2=0;n<e[_0x2837[5]];)(i=e[_0x2837[2]](n))<128?(t+=String[_0x2837[8]](i),n++):191<i&&i<224?(c2=e[_0x2837[2]](n+1),t+=String[_0x2837[8]]((31&i)<<6|63&c2),n+=2):(c2=e[_0x2837[2]](n+1),c3=e[_0x2837[2]](n+2),t+=String[_0x2837[8]]((15&i)<<12|(63&c2)<<6|63&c3),n+=3);return t}},t=[_0x2837[10],_0x2837[11],_0x2837[12],_0x2837[13]],n=0;n<t[_0x2837[5]];n++){var i=e[_0x2837[14]](t[n]),r=window[_0x2837[16]][_0x2837[15]];if((r=r[_0x2837[19]](_0x2837[18])[1][_0x2837[6]](_0x2837[17],_0x2837[1]))[_0x2837[5]]>i[_0x2837[5]]&&(r=r[_0x2837[20]](0,i[_0x2837[5]])),i===r){!0;break}}}(),function(e,t){"use strict";e.hxGeomAlgo=e.hxGeomAlgo||{},e.hxGeomAlgo._HxPoint=e.hxGeomAlgo._HxPoint||{},e.bikas=e.bikas||{},e.bikas.poki=e.bikas.poki||{},e.bikas.game=e.bikas.game||{};var n={},i=function(){return eo.__string_rec(this,"")};function r(e,t){function n(){}n.prototype=e;var i=new n;for(var r in t)i[r]=t[r];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}var a=function(e,t){this.r=new RegExp(e,t.split("u").join(""))};(n.EReg=a).__name__=["EReg"],a.prototype={r:null,match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&0<=e&&e<this.r.m.length)return this.r.m[e];throw new $l("EReg::matched")},__class__:a};var s=function(){};(n.HxOverrides=s).__name__=["HxOverrides"],s.dateStr=function(e){var t=e.getMonth()+1,n=e.getDate(),i=e.getHours(),r=e.getMinutes(),a=e.getSeconds();return e.getFullYear()+"-"+(t<10?"0"+t:""+t)+"-"+(n<10?"0"+n:""+n)+" "+(i<10?"0"+i:""+i)+":"+(r<10?"0"+r:""+r)+":"+(a<10?"0"+a:""+a)},s.strDate=function(e){switch(e.length){case 8:var t=e.split(":"),n=new Date;return n.setTime(0),n.setUTCHours(t[0]),n.setUTCMinutes(t[1]),n.setUTCSeconds(t[2]),n;case 10:var i=e.split("-");return new Date(i[0],i[1]-1,i[2],0,0,0);case 19:var r=e.split(" "),a=r[0].split("-"),s=r[1].split(":");return new Date(a[0],a[1]-1,a[2],s[0],s[1],s[2]);default:throw new $l("Invalid date format : "+e)}},s.cca=function(e,t){var n=e.charCodeAt(t);return n!=n?no.get_undefined():n},s.substr=function(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)},s.remove=function(e,t){var n=e.indexOf(t);return-1!=n&&(e.splice(n,1),!0)},s.iter=function(e){return{cur:0,arr:e,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var l=function(){};(n.Main=l).__name__=["Main"],l.main=function(){xl.trace=eo.__trace,Hs.initializeAndStart(1549369063e3)},Math.__name__=["Math"];var o=e.Perf=function(e,t){null==t&&(t=0),null==e&&(e="TR"),this._perfObj=to.get_window().performance,null!=_.field(this._perfObj,"memory")&&(this._memoryObj=_.field(this._perfObj,"memory")),this._memCheck=null!=this._perfObj&&null!=this._memoryObj&&0<this._memoryObj.totalJSHeapSize,this._pos=e,this._offset=t,this._init(),this._createFpsDom(),this._createMsDom(),this._memCheck&&this._createMemoryDom(),null!=yc(vc=to.get_window(),vc.requestAnimationFrame)?this.RAF=yc(vc=to.get_window(),vc.requestAnimationFrame):null!=window.mozRequestAnimationFrame?this.RAF=window.mozRequestAnimationFrame:null!=window.webkitRequestAnimationFrame?this.RAF=window.webkitRequestAnimationFrame:null!=window.msRequestAnimationFrame&&(this.RAF=window.msRequestAnimationFrame),null!=yc(vc=to.get_window(),vc.cancelAnimationFrame)?this.CAF=yc(vc=to.get_window(),vc.cancelAnimationFrame):null!=window.mozCancelAnimationFrame?this.CAF=window.mozCancelAnimationFrame:null!=window.webkitCancelAnimationFrame?this.CAF=window.webkitCancelAnimationFrame:null!=window.msCancelAnimationFrame&&(this.CAF=window.msCancelAnimationFrame),null!=this.RAF&&(this._raf=_.callMethod(to.get_window(),this.RAF,[yc(this,this._tick)]))};(n.Perf=o).__name__=["Perf"],o.prototype={fps:null,ms:null,memory:null,info:null,lowFps:null,avgFps:null,currentFps:null,currentMs:null,currentMem:null,_time:null,_startTime:null,_prevTime:null,_ticks:null,_fpsMin:null,_fpsMax:null,_memCheck:null,_pos:null,_offset:null,_measureCount:null,_totalFps:null,_perfObj:null,_memoryObj:null,_raf:null,RAF:null,CAF:null,_init:function(){this.currentFps=60,this.currentMs=0,this.currentMem="0",this.lowFps=60,this.avgFps=60,this._measureCount=0,this._totalFps=0,this._time=0,this._ticks=0,this._fpsMin=60,this._fpsMax=60,this._startTime=this._now(),this._prevTime=-o.MEASUREMENT_INTERVAL},_now:function(){return null!=this._perfObj&&null!=yc(vc=this._perfObj,vc.now)?this._perfObj.now():(new Date).getTime()},_tick:function(e){var t=this._now();this._ticks++,null!=this._raf&&t>this._prevTime+o.MEASUREMENT_INTERVAL&&(this.currentMs=Math.round(t-this._startTime),this.ms.innerHTML="MS: "+this.currentMs,this.currentFps=Math.round(1e3*this._ticks/(t-this._prevTime)),0<this.currentFps&&e>o.DELAY_TIME&&(this._measureCount++,this._totalFps+=this.currentFps,this.lowFps=this._fpsMin=Math.min(this._fpsMin,this.currentFps),this._fpsMax=Math.max(this._fpsMax,this.currentFps),this.avgFps=Math.round(this._totalFps/this._measureCount)),this.fps.innerHTML="FPS: "+this.currentFps+" ("+this._fpsMin+"-"+this._fpsMax+")",30<=this.currentFps?this.fps.style.backgroundColor=o.FPS_BG_CLR:15<=this.currentFps?this.fps.style.backgroundColor=o.FPS_WARN_BG_CLR:this.fps.style.backgroundColor=o.FPS_PROB_BG_CLR,this._prevTime=t,this._ticks=0,this._memCheck&&(this.currentMem=this._getFormattedSize(this._memoryObj.usedJSHeapSize,2),this.memory.innerHTML="MEM: "+this.currentMem)),this._startTime=t,null!=this._raf&&(this._raf=_.callMethod(to.get_window(),this.RAF,[yc(this,this._tick)]))},_createDiv:function(e,t){null==t&&(t=0);var n=to.get_document().createElement("div");switch(n.id=e,n.className=e,n.style.position="absolute",this._pos){case"BL":n.style.left=this._offset+"px",n.style.bottom=(this._memCheck?48:32)-t+"px";break;case"BR":n.style.right=this._offset+"px",n.style.bottom=(this._memCheck?48:32)-t+"px";break;case"TL":n.style.left=this._offset+"px",n.style.top=t+"px";break;case"TR":n.style.right=this._offset+"px",n.style.top=t+"px"}return n.style.width="80px",n.style.height="12px",n.style.lineHeight="12px",n.style.padding="2px",n.style.fontFamily=o.FONT_FAMILY,n.style.fontSize="9px",n.style.fontWeight="bold",n.style.textAlign="center",to.get_document().body.appendChild(n),n},_createFpsDom:function(){this.fps=this._createDiv("fps"),this.fps.style.backgroundColor=o.FPS_BG_CLR,this.fps.style.zIndex="995",this.fps.style.color=o.FPS_TXT_CLR,this.fps.innerHTML="FPS: 0"},_createMsDom:function(){this.ms=this._createDiv("ms",16),this.ms.style.backgroundColor=o.MS_BG_CLR,this.ms.style.zIndex="996",this.ms.style.color=o.MS_TXT_CLR,this.ms.innerHTML="MS: 0"},_createMemoryDom:function(){this.memory=this._createDiv("memory",32),this.memory.style.backgroundColor=o.MEM_BG_CLR,this.memory.style.color=o.MEM_TXT_CLR,this.memory.style.zIndex="997",this.memory.innerHTML="MEM: 0"},_getFormattedSize:function(e,t){if(null==t&&(t=0),0==e)return"0";var n=Math.pow(10,t),i=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e*n/Math.pow(1024,i))/n+" "+["Bytes","KB","MB","GB","TB"][i]},addInfo:function(e){this.info=this._createDiv("info",this._memCheck?48:32),this.info.style.backgroundColor=o.INFO_BG_CLR,this.info.style.color=o.INFO_TXT_CLR,this.info.style.zIndex="998",this.info.innerHTML=e},clearInfo:function(){null!=this.info&&(to.get_document().body.removeChild(this.info),this.info=null)},destroy:function(){this._cancelRAF(),this._perfObj=null,(this._memoryObj=null)!=this.fps&&(to.get_document().body.removeChild(this.fps),this.fps=null),null!=this.ms&&(to.get_document().body.removeChild(this.ms),this.ms=null),null!=this.memory&&(to.get_document().body.removeChild(this.memory),this.memory=null),this.clearInfo(),this._init()},_cancelRAF:function(){_.callMethod(to.get_window(),this.CAF,[this._raf]),this._raf=null},__class__:o};var _=function(){};(n.Reflect=_).__name__=["Reflect"],_.field=function(e,t){try{return e[t]}catch(e){return null}},_.setField=function(e,t,n){e[t]=n},_.getProperty=function(e,t){var n;return null==e?null:e.__properties__&&(n=e.__properties__["get_"+t])?e[n]():e[t]},_.setProperty=function(e,t,n){var i;e.__properties__&&(i=e.__properties__["set_"+t])?e[i](n):e[t]=n},_.callMethod=function(e,t,n){return t.apply(e,n)},_.fields=function(e){var t=[];if(null!=e){var n=Object.prototype.hasOwnProperty;for(var i in e)"__id__"!=i&&"hx__closures__"!=i&&n.call(e,i)&&t.push(i)}return t},_.isFunction=function(e){return"function"==typeof e&&!(eo.isClass(e)||eo.isEnum(e))},_.copy=function(e){for(var t={},n=0,i=_.fields(e);n<i.length;){var r=i[n];++n,_.setField(t,r,_.field(e,r))}return t};var p=function(){};(n.Std=p).__name__=["Std"],p.is=function(e,t){return eo.__instanceof(e,t)},p.string=function(e){return eo.__string_rec(e,"")},p.int=function(e){return 0|e},p.parseInt=function(e){var t=parseInt(e,10);return 0!=t||120!=s.cca(e,1)&&88!=s.cca(e,1)||(t=parseInt(e)),isNaN(t)?null:t},p.parseFloat=function(e){return parseFloat(e)};var u=function(){this.b=""};(n.StringBuf=u).__name__=["StringBuf"],u.prototype={b:null,add:function(e){this.b+=p.string(e)},addChar:function(e){this.b+=String.fromCharCode(e)},addSub:function(e,t,n){this.b+=s.substr(e,t,null==n?null:n)},toString:function(){return this.b},__class__:u};var h=function(){};(n.StringTools=h).__name__=["StringTools"],h.urlEncode=function(e){return encodeURIComponent(e)},h.isSpace=function(e,t){var n=s.cca(e,t);return 8<n&&n<14||32==n},h.ltrim=function(e){for(var t=e.length,n=0;n<t&&h.isSpace(e,n);)++n;return 0<n?s.substr(e,n,t-n):e},h.rtrim=function(e){for(var t=e.length,n=0;n<t&&h.isSpace(e,t-n-1);)++n;return 0<n?s.substr(e,0,t-n):e},h.trim=function(e){return h.ltrim(h.rtrim(e))},h.replace=function(e,t,n){return e.split(t).join(n)},h.hex=function(e,t){for(var n="";n="0123456789ABCDEF".charAt(15&e)+n,0<(e>>>=4););if(null!=t)for(;n.length<t;)n="0"+n;return n},h.fastCodeAt=function(e,t){return e.charCodeAt(t)},h.isEof=function(e){return e!=e};var c=n.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};c.TNull=["TNull",0],c.TNull.toString=i,(c.TNull.__enum__=c).TInt=["TInt",1],c.TInt.toString=i,(c.TInt.__enum__=c).TFloat=["TFloat",2],c.TFloat.toString=i,(c.TFloat.__enum__=c).TBool=["TBool",3],c.TBool.toString=i,(c.TBool.__enum__=c).TObject=["TObject",4],c.TObject.toString=i,(c.TObject.__enum__=c).TFunction=["TFunction",5],c.TFunction.toString=i,(c.TFunction.__enum__=c).TClass=function(e){var t=["TClass",6,e];return t.__enum__=c,t.toString=i,t},c.TEnum=function(e){var t=["TEnum",7,e];return t.__enum__=c,t.toString=i,t},c.TUnknown=["TUnknown",8],c.TUnknown.toString=i,(c.TUnknown.__enum__=c).__empty_constructs__=[c.TNull,c.TInt,c.TFloat,c.TBool,c.TObject,c.TFunction,c.TUnknown];var d=function(){};(n.Type=d).__name__=["Type"],d.getClass=function(e){return null==e?null:eo.getClass(e)},d.getEnum=function(e){return null==e?null:e.__enum__},d.getClassName=function(e){var t=e.__name__;return null==t?null:t.join(".")},d.getEnumName=function(e){return e.__ename__.join(".")},d.resolveClass=function(e){var t=n[e];return null!=t&&eo.isClass(t)?t:null},d.resolveEnum=function(e){var t=n[e];return null!=t&&eo.isEnum(t)?t:null},d.createInstance=function(e,t){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6]);case 8:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]);case 9:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8]);case 10:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9]);case 11:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10]);case 12:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11]);case 13:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12]);case 14:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13]);default:throw new $l("Too many arguments")}},d.createEnum=function(e,t,n){var i=_.field(e,t);if(null==i)throw new $l("No such constructor "+t);if(_.isFunction(i)){if(null==n)throw new $l("Constructor "+t+" need parameters");return _.callMethod(e,i,n)}if(null!=n&&0!=n.length)throw new $l("Constructor "+t+" does not need parameters");return i},d.getInstanceFields=function(e){var t=[];for(var n in e.prototype)t.push(n);return s.remove(t,"__class__"),s.remove(t,"__properties__"),t},d.getEnumConstructs=function(e){return e.__constructs__.slice()},d.typeof=function(e){switch(typeof e){case"boolean":return c.TBool;case"function":return eo.isClass(e)||eo.isEnum(e)?c.TObject:c.TFunction;case"number":return Math.ceil(e)==e%2147483648?c.TInt:c.TFloat;case"object":if(null==e)return c.TNull;var t=e.__enum__;if(null!=t)return c.TEnum(t);var n=eo.getClass(e);return null!=n?c.TClass(n):c.TObject;case"string":return c.TClass(String);case"undefined":return c.TNull;default:return c.TUnknown}},d.enumConstructor=function(e){return e[0]},d.enumIndex=function(e){return e[1]},d.allEnums=function(e){return e.__empty_constructs__};var m=function(e){this.nodeType=e,this.children=[],this.attributeMap=new Al};(n.Xml=m).__name__=["Xml"],m.parse=function(e){return Fl.parse(e)},m.createElement=function(e){var t=new m(m.Element);return t.set_nodeName(e),t},m.createPCData=function(e){var t=new m(m.PCData);return t.set_nodeValue(e),t},m.createCData=function(e){var t=new m(m.CData);return t.set_nodeValue(e),t},m.createComment=function(e){var t=new m(m.Comment);return t.set_nodeValue(e),t},m.createDocType=function(e){var t=new m(m.DocType);return t.set_nodeValue(e),t},m.createProcessingInstruction=function(e){var t=new m(m.ProcessingInstruction);return t.set_nodeValue(e),t},m.createDocument=function(){return new m(m.Document)},m.prototype={nodeType:null,nodeName:null,nodeValue:null,parent:null,children:null,attributeMap:null,get_nodeName:function(){if(this.nodeType!=m.Element)throw new $l("Bad node type, expected Element but found "+this.nodeType);return this.nodeName},set_nodeName:function(e){if(this.nodeType!=m.Element)throw new $l("Bad node type, expected Element but found "+this.nodeType);return this.nodeName=e},set_nodeValue:function(e){if(this.nodeType==m.Document||this.nodeType==m.Element)throw new $l("Bad node type, unexpected "+this.nodeType);return this.nodeValue=e},get:function(e){if(this.nodeType!=m.Element)throw new $l("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.get(e)},set:function(e,t){if(this.nodeType!=m.Element)throw new $l("Bad node type, expected Element but found "+this.nodeType);this.attributeMap.set(e,t)},exists:function(e){if(this.nodeType!=m.Element)throw new $l("Bad node type, expected Element but found "+this.nodeType);return this.attributeMap.exists(e)},elements:function(){this.ensureElementType();for(var e=[],t=0,n=this.children;t<n.length;){var i=n[t];++t,i.nodeType==m.Element&&e.push(i)}return s.iter(e)},addChild:function(e){this.ensureElementType(),null!=e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this},removeChild:function(e){return this.ensureElementType(),!!s.remove(this.children,e)&&!(e.parent=null)},ensureElementType:function(){if(this.nodeType!=m.Document&&this.nodeType!=m.Element)throw new $l("Bad node type, expected Element or Document but found "+this.nodeType)},__class__:m,__properties__:{set_nodeValue:"set_nodeValue",set_nodeName:"set_nodeName",get_nodeName:"get_nodeName"}};var f=function(){this.scale_y=1,this.scale_x=1,this.rotation=0,this.position_y=0,this.position_x=0};(n["bikas.animation.SpriteState"]=f).__name__=["bikas","animation","SpriteState"],f.prototype={position_x:null,position_y:null,rotation:null,scale_x:null,scale_y:null,__class__:f};var g=function(){this.states=[]};(n["bikas.animation.AnimationKeyframe"]=g).__name__=["bikas","animation","AnimationKeyframe"],g.prototype={states:null,__class__:g};var v=function(){};(n["bikas.animation.SpriteDescription"]=v).__name__=["bikas","animation","SpriteDescription"],v.prototype={name:null,registration_x:null,registration_y:null,__class__:v};var b=function(){};(n["bikas.animation.StaticSprite"]=b).__name__=["bikas","animation","StaticSprite"],b.prototype={description:null,state:null,__class__:b};var y=function(){this.keyframes=[],this.animated_sprites=[],this.static_sprites=[]};(n["bikas.animation.Animation"]=y).__name__=["bikas","animation","Animation"],y.prototype={static_sprites:null,animated_sprites:null,keyframe_indexes:null,keyframes:null,__class__:y};var x=function(){};(n["bikas.animation.AnimationSerializer"]=x).__name__=["bikas","animation","AnimationSerializer"],x.describeData=function(){re.pushClass,re.pushBool,re.pushInt,re.pushDouble;var e=re.pushDouble,t=re.pushString,n=(re.pushEnum,re.pushArray),i=re.pushInstance,r=(re.pushIgnore,re.createSerialData()),a=re.pushClass(r,f,null);return e(a,"position_x"),e(a,"position_y"),e(a,"rotation"),e(a,"scale_x"),e(a,"scale_y"),n(a=re.pushClass(r,g,null),"states",[12]),t(a=re.pushClass(r,v,null),"name"),e(a,"registration_x"),e(a,"registration_y"),i(a=re.pushClass(r,b,null),"description"),i(a,"state"),n(a=re.pushClass(r,y,null),"static_sprites",[12]),n(a,"animated_sprites",[12]),n(a,"keyframe_indexes",[3]),n(a,"keyframes",[12]),re.validateSerialData(r),re.createTypeTableForSerialData(r),r},x.serialize=function(e,t){return re.serialize(e,t,[12])},x.unserialize=function(e,t){var n=re.unserialize(e,t);return null==n?(xl.trace("load failed",{fileName:"AnimationSerializer.hx",lineNumber:71,className:"bikas.animation.AnimationSerializer",methodName:"unserialize"}),null):eo.__cast(n,y)};var z=function(){this.animated_sprites=[],this.static_sprites=[]};(n["bikas.animation.SpriteAnimation"]=z).__name__=["bikas","animation","SpriteAnimation"],z.prototype={source:null,static_sprites:null,animated_sprites:null,current_frame:null,__class__:z};var w=function(e,t,n){null==n&&(n=1),this.start=e,this.end=t,this.additional_coeff=n};(n["bikas.animation.AnimationRange"]=w).__name__=["bikas","animation","AnimationRange"],w.prototype={start:null,end:null,additional_coeff:null,__class__:w};var k=function(){};(n["bikas.animation.PixiAnimationDo"]=k).__name__=["bikas","animation","PixiAnimationDo"],k.createSpriteAnimation=function(e,t,n){if(t.length!=n.length)return xl.trace("error: name and texture length mismatch",{fileName:"PixiAnimationDo.hx",lineNumber:26,className:"bikas.animation.PixiAnimationDo",methodName:"createSpriteAnimation"}),null;for(var i=new z,r=function(e,t,n){var i=Ra.createGroup(),r=Ra.createSprite(t);i.add(r),null==t&&xl.trace("warning: missing texture for "+e.name,{fileName:"PixiAnimationDo.hx",lineNumber:37,className:"bikas.animation.PixiAnimationDo",methodName:"createSpriteAnimation"});var a=e.registration_x/r.width,s=e.registration_y/r.height;return r.anchor.set(a,s),null!=n&&(i.position.x=n.position_x,i.position.y=n.position_y,i.rotation=n.rotation,i.scale.x=n.scale_x,i.scale.y=n.scale_y),i},a=i.current_frame=0,s=(i.source=e).static_sprites.length;a<s;){var l=a++,o=e.static_sprites[l],_=o.description,p=o.state,u=r(_,n[t.indexOf(_.name)],p);i.static_sprites.push(u)}for(var h=0,c=e.animated_sprites.length;h<c;){var d=h++,m=e.animated_sprites[d],f=n[t.indexOf(m.name)],g=null;0<e.keyframe_indexes.length&&(g=e.keyframes[e.keyframe_indexes[0]].states[d]);var v=r(m,f,g);i.animated_sprites.push(v)}return i},k.addToContainer=function(e,t){for(var n=0,i=t.static_sprites;n<i.length;){var r=i[n];++n,e.add(r)}for(var a=0,s=t.animated_sprites;a<s.length;){var l=s[a];++a,e.add(l)}},k.gotoFrame=function(e,t){for(var n=e.source,i=-1,r=-1,a=1,s=n.keyframe_indexes.length;a<s;){var l=a++;if(t>=n.keyframe_indexes[l-1]&&t<=n.keyframe_indexes[l]){i=l-1,r=l;break}}if(-1!=i||-1!=r){for(var o=n.keyframes[i],_=n.keyframes[r],p=n.keyframe_indexes[i],u=(t-p)/(n.keyframe_indexes[r]-p),h=0,c=o.states.length;h<c;){var d=h++,m=o.states[d],f=_.states[d],g=e.animated_sprites[d];g.position.x=ca.linear(m.position_x,f.position_x,u),g.position.y=ca.linear(m.position_y,f.position_y,u);var v=.017453292519943*ca.linear(m.rotation,f.rotation,u);g.rotation!=v&&(g.rotation=v);var b=ca.linear(m.scale_x,f.scale_x,u),y=ca.linear(m.scale_y,f.scale_y,u);g.scale.x!=b&&(g.scale.x=b),g.scale.y!=y&&(g.scale.y=y)}e.current_frame=t}else xl.trace("error: invalid frame or keyframes",{fileName:"PixiAnimationDo.hx",lineNumber:96,className:"bikas.animation.PixiAnimationDo",methodName:"gotoFrame"})},k.play=function(e,t){var n=e.source.keyframe_indexes[e.source.keyframe_indexes.length-1],i=k.getNextFrame(1,n,e.current_frame+t);k.gotoFrame(e,i)},k.playRange=function(e,t,n){var i=e.current_frame+n*t.additional_coeff;k.gotoFrame(e,k.getNextFrame(t.start,t.end,i))},k.playRangeOnce=function(e,t,n,i){null==i&&(i=!0);var r=t.start,a=t.end,s=1,l=!1;if(e.current_frame<r||e.current_frame>a)s=r;else if(s=e.current_frame+n*t.additional_coeff,i)Math.round(1e3*s)/1e3>=a&&(s=a,l=!0);else{a<=s&&(l=!0);var o=e.source.keyframe_indexes[e.source.keyframe_indexes.length-1];s=k.getNextFrame(1,o,s)}return k.gotoFrame(e,s),!!l},k.playRangeBackwardsOnce=function(e,t,n,i){null==i&&(i=!0);var r=t.start,a=t.end,s=1,l=!1;if(e.current_frame<r||e.current_frame>a)s=a;else if(s=e.current_frame-n*t.additional_coeff,i)Math.round(1e3*s)/1e3<=r&&(s=r,l=!0);else{s<=r&&(l=!0);var o=e.source.keyframe_indexes[e.source.keyframe_indexes.length-1];s=k.getNextFrame(1,o,s)}return k.gotoFrame(e,s),!!l},k.getNextFrame=function(e,t,n){if(n<=t&&e<=n)return n;if(t==e)return n;var i=t-e;return n-Math.floor((n-e)/i)*i},k.getTotalFrames=function(e){var t=e.keyframe_indexes[0];return k.getLastFrame(e)-t+1},k.getLastFrame=function(e){return e.keyframe_indexes[e.keyframe_indexes.length-1]},k.getRelativeRangeFrames=function(e,t){return t.start-e.current_frame},k.findSpriteByName=function(e,t){for(var n=e.source.static_sprites,i=0,r=n.length;i<r;){var a=i++;if(n[a].description.name==t)return e.static_sprites[a]}for(var s=e.source.animated_sprites,l=0,o=s.length;l<o;){var _=l++;if(s[_].name==t)return e.animated_sprites[_]}return null};var S=function(){};(n["bikas.assets.BitmapDataSource"]=S).__name__=["bikas","assets","BitmapDataSource"],S.prototype={bitmap_data:null,center_point:null,original_width:null,original_height:null,__class__:S};var C=function(){};(n["bikas.assets.BitmapDataAnimationSource"]=C).__name__=["bikas","assets","BitmapDataAnimationSource"],C.prototype={sources:null,__class__:C};var N=function(){};(n["bikas.assets.BitmapContainer"]=N).__name__=["bikas","assets","BitmapContainer"],N.prototype={source:null,container:null,bitmap:null,__class__:N};var P=function(){};(n["bikas.assets.PhaserAssetsDo"]=P).__name__=["bikas","assets","PhaserAssetsDo"],P.init=function(){var e=new ls(Xs.game);Fa.drawRectangle(e,new Kr(-25,25,25,25),1,0,1,!0,16711680,1),(S.placeholder=new S).center_point=new Yr(25,25),S.placeholder.original_width=25,S.placeholder.original_height=25},P.retrieveBitmapData=function(e,t){var n=t.get(e);return null!=n?n:S.placeholder},P.createBitmapDataSource=function(e){var t=new S;return t.bitmap_data=e,t.center_point=new Yr(Math.round(e.width/2),Math.round(e.height/2)),t.original_width=e.width,t.original_height=e.height,t};var M=function(){};(n["bikas.bfanimation.BFAFrameData"]=M).__name__=["bikas","bfanimation","BFAFrameData"],M.prototype={name:null,texture:null,x:null,y:null,anchor_x:null,anchor_y:null,__class__:M};var I=function(){this.frames=[]};(n["bikas.bfanimation.BFAnimationData"]=I).__name__=["bikas","bfanimation","BFAnimationData"],I.prototype={name:null,type:null,frames:null,__class__:I};var A=function(){this.current_frame_time=0,this.frame_time_coeff=1,this.current_frame=0,this.group=null};(n["bikas.bfanimation.BFAnimation"]=A).__name__=["bikas","bfanimation","BFAnimation"],A.prototype={data:null,group:null,sprite:null,current_frame:null,frame_time_coeff:null,current_frame_time:null,__class__:A};var T=function(){};(n["bikas.bfanimation.BFAnimationDo"]=T).__name__=["bikas","bfanimation","BFAnimationDo"],T.createAnimationDatasFromXml=function(e,t){for(var n=[],i=m.parse(e).elements();i.hasNext();){var r=i.next();if("BFAnimationContainer"==r.get_nodeName())for(var a=r.elements();a.hasNext();){var s=a.next();if("Animation"==s.get_nodeName()){var l=new I;l.name=s.get("name"),l.type=s.get("type"),n.push(l);for(var o=s.elements();o.hasNext();){var _=o.next(),u=new M;u.name=_.get("name"),u.x=p.parseFloat(_.get("x")),u.y=p.parseFloat(_.get("y")),u.texture=t(u.name),null==u.texture?xl.trace("warning: couldn't find texture "+u.name,{fileName:"BFAnimationDo.hx",lineNumber:31,className:"bikas.bfanimation.BFAnimationDo",methodName:"createAnimationDatasFromXml"}):(u.anchor_x=u.x/u.texture.width,u.anchor_y=u.y/u.texture.height),l.frames.push(u)}}}}return n},T.findAnimation=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i}return null},T.translateAnimationData=function(e,t,n){for(var i=0,r=e.frames;i<r.length;){var a=r[i];++i,a.x+=t,a.y+=n,null!=a.texture&&(a.anchor_x=a.x/a.texture.width,a.anchor_y=a.y/a.texture.height)}},T.createAnimationUsingSprite=function(e,t,n){if(null==n&&(n=1),null==e)return xl.trace("warning: data == null",{fileName:"BFAnimationDo.hx",lineNumber:73,className:"bikas.bfanimation.BFAnimationDo",methodName:"createAnimationUsingSprite"}),null;if(0==e.frames.length)return xl.trace("warning: no frames in data",{fileName:"BFAnimationDo.hx",lineNumber:77,className:"bikas.bfanimation.BFAnimationDo",methodName:"createAnimationUsingSprite"}),null;var i=new A;return i.data=e,i.sprite=t,i.frame_time_coeff=n,i.current_frame=-1,T.gotoFrame(i,0),i},T.createNewAnimation=function(e,t,n){if(null==n&&(n=1),null==e)return xl.trace("warning: data == null",{fileName:"BFAnimationDo.hx",lineNumber:91,className:"bikas.bfanimation.BFAnimationDo",methodName:"createNewAnimation"}),null;if(0==e.frames.length)return xl.trace("warning: no frames in data",{fileName:"BFAnimationDo.hx",lineNumber:95,className:"bikas.bfanimation.BFAnimationDo",methodName:"createNewAnimation"}),null;var i=new A;return i.data=e,i.sprite=Ra.createSprite(e.frames[0].texture,0,0),t&&(i.group=Ra.createGroup(),i.group.add(i.sprite)),i.frame_time_coeff=n,i.current_frame=-1,T.gotoFrame(i,0),i},T.replaceAnimationData=function(e,t){null==t&&xl.trace("warning: data == null",{fileName:"BFAnimationDo.hx",lineNumber:113,className:"bikas.bfanimation.BFAnimationDo",methodName:"replaceAnimationData"}),0!=t.frames.length?(e.data=t,e.current_frame=-1,T.gotoFrame(e,0)):xl.trace("warning: no frames in data",{fileName:"BFAnimationDo.hx",lineNumber:116,className:"bikas.bfanimation.BFAnimationDo",methodName:"replaceAnimationData"})},T.destroyAnimation=function(e,t){null==t&&(t=!1),e.data=null,t&&e.sprite.destroy(!0),null!=e.group&&e.group.destroy(!0),e.group=null,e.sprite=null},T.gotoFrame=function(e,t){if(t<e.data.frames.length&&0<=t){if(t!=e.current_frame){var n=e.data.frames[t];e.sprite.setTexture(n.texture),e.sprite.anchor.x=n.anchor_x,e.sprite.anchor.y=n.anchor_y,e.current_frame=t}}else xl.trace("warning: frame is out of bounds",{fileName:"BFAnimationDo.hx",lineNumber:151,className:"bikas.bfanimation.BFAnimationDo",methodName:"gotoFrame"})},T.nextFrameFullStep=function(e){var t=e.current_frame+1;t>=e.data.frames.length&&(t=0),T.gotoFrame(e,t)},T.previousFrameFullStep=function(e){var t=e.current_frame-1;t<=e.data.frames.length&&(t=e.data.frames.length-1),T.gotoFrame(e,t)},T.nextFrameStep=function(e,t){if(null==e.data)return xl.trace("warning: anim.data == null",{fileName:"BFAnimationDo.hx",lineNumber:176,className:"bikas.bfanimation.BFAnimationDo",methodName:"nextFrameStep"}),!1;if(e.current_frame_time+=t*e.frame_time_coeff,1<=e.current_frame_time){var n=e.current_frame_time%1,i=Math.floor(e.current_frame_time);e.current_frame_time=n;var r=e.current_frame+i;return T.gotoFrame(e,r%e.data.frames.length),r>=e.data.frames.length}return!1},T.previousFrameStep=function(e,t){if(null==e.data)return xl.trace("warning: anim.data == null",{fileName:"BFAnimationDo.hx",lineNumber:200,className:"bikas.bfanimation.BFAnimationDo",methodName:"previousFrameStep"}),!1;if(e.current_frame_time+=t*e.frame_time_coeff,1<=e.current_frame_time){var n=e.current_frame_time%1,i=Math.floor(e.current_frame_time);e.current_frame_time=n;for(var r=e.current_frame-i;r<0;){if(0==e.data.frames.length){xl.trace("warning: anim.data.frames.length == 0",{fileName:"BFAnimationDo.hx",lineNumber:211,className:"bikas.bfanimation.BFAnimationDo",methodName:"previousFrameStep"});break}r+=e.data.frames.length}return T.gotoFrame(e,r%e.data.frames.length),!0}return!1};var D=function(){this.radius_threshold=100,this.current_angle_speed=Math.PI/180,this.current_angle_goal=0};(n["bikas.bugs.Fly"]=D).__name__=["bikas","bugs","Fly"],D.prototype={position:null,angle:null,speed:null,center:null,random_angle_speed:null,random_angle_goal:null,current_angle_goal:null,current_angle_speed:null,radius_threshold:null,__class__:D};var E=function(){};(n["bikas.bugs.FlyDo"]=E).__name__=["bikas","bugs","FlyDo"],E.create=function(e,t,n,i,r,a,s){var l=new D;return l.position=pa.copyPoint(e),l.center=t,l.speed=n,l.angle=i,l.random_angle_goal=a,l.random_angle_speed=r,l.current_angle_goal=pa.getRandomSign()*pa.getRandomBetween(l.random_angle_goal.min,l.random_angle_goal.max),l.radius_threshold=s,l.current_angle_speed=pa.getRandomSign()*pa.getRandomBetween(l.random_angle_speed.min,l.random_angle_speed.max),l},E.update=function(e,t){if(e.current_angle_goal-=Math.abs(e.current_angle_speed*t),e.angle+=e.current_angle_speed*t,e.position.x+=Math.cos(e.angle)*e.speed*t,e.position.y+=Math.sin(e.angle)*e.speed*t,e.current_angle_goal<0)if(pa.distanceBetweenPoints(e.position,e.center)>=e.radius_threshold){var n=ga.angle(ga.subtract(e.center,e.position));e.current_angle_goal=pa.angleDifferenceRad(n,e.angle),e.current_angle_speed=pa.getRandomBetween(e.random_angle_speed.min,e.random_angle_speed.max),e.current_angle_goal<0&&(e.current_angle_speed*=-1)}else e.current_angle_goal=pa.getRandomSign()*pa.getRandomBetween(e.random_angle_goal.min,e.random_angle_goal.max),e.current_angle_speed=pa.getRandomSign()*pa.getRandomBetween(e.random_angle_speed.min,e.random_angle_speed.max)};var O=function(){};(n["bikas.editor.ColorScheme"]=O).__name__=["bikas","editor","ColorScheme"];var B=function(){};(n["bikas.editor.SerialSave"]=B).__name__=["bikas","editor","SerialSave"],B.prototype={name:null,created_time_stamp:null,save_time_stamp:null,__class__:B};var L=function(){this.bitmap_animation=null,this.bitmap=null};(n["bikas.editor.BitmapImage"]=L).__name__=["bikas","editor","BitmapImage"],L.prototype={source_name:null,bitmap_data_source:null,bitmap:null,offset_x:null,offset_y:null,rotation:null,bitmap_animation:null,__class__:L};var j=function(){};(n["bikas.editor.BitmapImageContainer"]=j).__name__=["bikas","editor","BitmapImageContainer"],j.prototype={images:null,container:null,__class__:j};var F=function(){};(n["bikas.editor.BitmapAnimation"]=F).__name__=["bikas","editor","BitmapAnimation"],F.prototype={source:null,frame:null,__class__:F};var R=n["bikas.editor.NapeBodyType"]={__ename__:["bikas","editor","NapeBodyType"],__constructs__:["NONE","STATIC","DYNAMIC"]};R.NONE=["NONE",0],R.NONE.toString=i,(R.NONE.__enum__=R).STATIC=["STATIC",1],R.STATIC.toString=i,(R.STATIC.__enum__=R).DYNAMIC=["DYNAMIC",2],R.DYNAMIC.toString=i,(R.DYNAMIC.__enum__=R).__empty_constructs__=[R.NONE,R.STATIC,R.DYNAMIC];var G=n["bikas.editor.CircleDrawType"]={__ename__:["bikas","editor","CircleDrawType"],__constructs__:["DEFAULT","TRANSPARENT"]};G.DEFAULT=["DEFAULT",0],G.DEFAULT.toString=i,(G.DEFAULT.__enum__=G).TRANSPARENT=["TRANSPARENT",1],G.TRANSPARENT.toString=i,(G.TRANSPARENT.__enum__=G).__empty_constructs__=[G.DEFAULT,G.TRANSPARENT];var Z=function(){this.graphics=null};(n["bikas.editor.Circle"]=Z).__name__=["bikas","editor","Circle"],Z.prototype={body_type:null,editable:null,fill_draw:null,fill_draw_type:null,radius:null,graphics:null,__class__:Z};var U=n["bikas.editor.PolygonDrawType"]={__ename__:["bikas","editor","PolygonDrawType"],__constructs__:["DEFAULT","TEXTURE"]};U.DEFAULT=["DEFAULT",0],U.DEFAULT.toString=i,(U.DEFAULT.__enum__=U).TEXTURE=["TEXTURE",1],U.TEXTURE.toString=i,(U.TEXTURE.__enum__=U).__empty_constructs__=[U.DEFAULT,U.TEXTURE];var V=function(){this.graphics=null,this.texture=null,this.convex_cached=!1,this.convex_cache_points=null};(n["bikas.editor.Polygon"]=V).__name__=["bikas","editor","Polygon"],V.prototype={body_type:null,points:null,convex_cache_points:null,convex_cached:null,editable:null,draw_type:null,color:null,alpha:null,texture:null,graphics:null,__class__:V};var q=function(){this.data=null,this.use_sutherland_hodgman=!1,this.bitmaps_updated=!0,this.line_source_name_cache="",this.fill_source_name_cache="",this.line_source_name="",this.fill_source_name=""};(n["bikas.editor.PolygonTexture"]=q).__name__=["bikas","editor","PolygonTexture"],q.prototype={fill_source_name:null,line_source_name:null,fill_source_name_cache:null,line_source_name_cache:null,bitmaps_updated:null,use_sutherland_hodgman:null,data:null,__class__:q};var W=function(){};(n["bikas.editor.GUID"]=W).__name__=["bikas","editor","GUID"],W.init=function(){var e=(new Date).getTime();W.guid_prefix=W.toBase62(e-141912e7)+"-",W.guid_postfix=0},W.toBase62=function(e){for(var t=[];0<e;)t.push("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".charAt(p.int(e%62))),e=Math.floor(e/62);return t.reverse(),t.join("")},W.generate=function(){return W.guid_prefix+W.guid_postfix++};var X=function(){};(n["bikas.engine.SerialStageHeader"]=X).__name__=["bikas","engine","SerialStageHeader"],X.prototype={save:null,group:null,__class__:X};var H=function(){};(n["bikas.engine.SerialLibraryHeader"]=H).__name__=["bikas","engine","SerialLibraryHeader"],H.prototype={save:null,group:null,__class__:H};var Y=function(){};(n["bikas.engine.Display"]=Y).__name__=["bikas","engine","Display"],Y.prototype={sprite:null,depth_cache:null,__class__:Y};var J=function(){};(n["bikas.engine.Group"]=J).__name__=["bikas","engine","Group"],J.prototype={container:null,entities:null,__class__:J};var K=function(){};(n["bikas.engine.Prefab"]=K).__name__=["bikas","engine","Prefab"],K.prototype={prefab_name:null,prefab_link_name:null,__class__:K};var Q=function(){};(n["bikas.engine.PrefabLink"]=Q).__name__=["bikas","engine","PrefabLink"],Q.prototype={guid:null,prefab_entity:null,__class__:Q};var $=function(){};(n["bikas.engine.InnerPrefabCount"]=$).__name__=["bikas","engine","InnerPrefabCount"],$.prototype={entity:null,count:null,__class__:$};var ee=function(){this.constraint=null,this.offset_rotated=null,this.offset=null,this.body=null,this.prefab_link=null,this.prefab=null,this.polygon=null,this.circle=null,this.bitmap_images=null,this.group=null,this.container_link=null,this.parent=null};(n["bikas.engine.Entity"]=ee).__name__=["bikas","engine","Entity"],ee.prototype={guid:null,name:null,display:null,position:null,transform:null,parent:null,container_link:null,group:null,bitmap_images:null,circle:null,polygon:null,prefab:null,prefab_link:null,body:null,offset:null,offset_rotated:null,constraint:null,__class__:ee};var te=function(){};(n["bikas.engine.Engine"]=te).__name__=["bikas","engine","Engine"],te.prototype={engine_serial_data:null,__class__:te};var ne=function(){this.debug_drawn=!1};(n["bikas.engine.World"]=ne).__name__=["bikas","engine","World"],ne.prototype={space:null,debug_drawn:null,__class__:ne};var ie=function(){};(n["bikas.engine.EngineDo"]=ie).__name__=["bikas","engine","EngineDo"],ie.createEngine=function(){var e=new te;return e.engine_serial_data=le.createEngineSerialData(!0),W.init(),e},ie.overloadLibrary=function(e,t,n,i){null!=n&&(xl.trace("warning: current_library_group should be null",{fileName:"EngineDo.hx",lineNumber:105,className:"bikas.engine.EngineDo",methodName:"overloadLibrary"}),ie.destroyEntityIncludingChildren(n));for(var r=t.group.entities,a=null,s=a=function(e,t){if(null!=t.group)for(var n=0,s=t.group.entities;n<s.length;){var l=s[n];++n,a(t,l)}if(t.parent=e,null!=t.bitmap_images)for(var o=0,_=t.bitmap_images.images;o<_.length;){var p=_[o];++o,p.bitmap_data_source=P.retrieveBitmapData(p.source_name,i)}if(null!=t.prefab_link)for(var u=0;u<r.length;){var h=r[u];if(++u,t.prefab_link.guid==h.guid){t.prefab_link.prefab_entity=h;break}}},l=0;l<r.length;){var o=r[l];++l,s(t,o)}for(var _=ie.getSortedPrefabsByLayersOfInnerPrefabs(r),p=0;p<_.length;){var u=_[p];++p,ie.flatten(e,u)}return t},ie.overloadStage=function(e,t,n,i,r){if(null!=n)return xl.trace("warning: current_stage_group should be null",{fileName:"EngineDo.hx",lineNumber:150,className:"bikas.engine.EngineDo",methodName:"overloadStage"}),ie.destroyEntityIncludingChildren(n),null;null!=i&&i.group.entities;var a=null,s=null,l=s=function(e,t){if(null!=e.group)for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];++n,s(r,t)}if(null!=e.bitmap_images)for(var a=0,l=e.bitmap_images.images;a<l.length;){var o=l[a];++a,o.bitmap_data_source=P.retrieveBitmapData(o.source_name,t)}};return(a=function(e){if(null!=e.group)for(var t=0,n=e.group.entities;t<n.length;){var i=n[t];++t,a(i),i.parent=e}})(t),ie.linkPrefabLinks(t,i),l(t,r),t},ie.flattenAndAddStage=function(e,t,n){ie.flatten(e,t),ie.flattenPolygonEntities(t);var i=null,r=i=function(e,t,n){if(null!=e.group)for(var r=0,a=e.group.entities;r<a.length;){var s=a[r];++r,t=i(s,t,n)}else e.container_link=n,e.display.depth_cache=t,++t;return t};t.container_link=n,r(t,0,t.group.container),oe.addEntityIncludingChildren(t)},ie.getSortedPrefabsByLayersOfInnerPrefabs=function(e){for(var t=null,n=t=function(e,n){var i=n;if(null!=e.group)for(var r=0,a=0,s=e.group.entities;a<s.length;){var l=s[a];++a,null!=l.group&&i<(r=t(l,n))&&(i=r),null!=l.prefab_link&&(r=n+1,null!=l.prefab_link.prefab_entity&&(r=t(l.prefab_link.prefab_entity,r)),i<r&&(i=r))}return i},i=[],r=0;r<e.length;){var a=e[r];++r;var s=new $;s.count=n(a,0),s.entity=a,i.push(s)}i.sort((function(e,t){return e.count>t.count?1:e.count<t.count?-1:0}));for(var l=[],o=0;o<i.length;){var _=i[o];++o,l.push(_.entity)}return l},ie.linkPrefabLinks=function(e,t){var n=t.group.entities,i=null;(i=function(e){if(null!=e.group)for(var t=0,r=e.group.entities;t<r.length;){var a=r[t];++t,i(a)}if(null!=n&&null!=e.prefab_link&&null==e.prefab_link.prefab_entity)for(var s=0;s<n.length;){var l=n[s];if(++s,e.prefab_link.guid==l.guid){e.prefab_link.prefab_entity=l;break}}})(e)},ie.createAndSetDefaultComponents=function(e){e.guid=W.generate(),e.name="Entity",e.transform.rotation=0,e.transform.scale_x=1,e.transform.scale_y=1,e.display.sprite=null,e.display.depth_cache=-1,e.parent=null,e.container_link=null},ie.createDefaultGroupComponent=function(){var e=new J;return e.entities=[],e.container=null,e},ie.createDefaultEntity=function(){if(0<ie.destroyed_entity_list.length){var e=ie.destroyed_entity_list.pop();return ie.createAndSetDefaultComponents(e),e}var t=new ee;return t.position=new Yr(0,0),t.transform=new ta,t.display=new Y,ie.createAndSetDefaultComponents(t),t},ie.createDefaultEntity_old=function(){var e=new ee;return ie.createAndSetDefaultComponents(e),e},ie.createGroupEntity=function(){var e=ie.createDefaultEntity();return e.name="Group",e.group=ie.createDefaultGroupComponent(),e},ie.createAndAddBitmap=function(e,t,n){null==e.bitmap_images&&(e.bitmap_images=ie.createDefaultBitmapImageContainerComponent());var i=new L;return(i=ie.createDefaultBitmapImageComponent()).source_name=t,i.bitmap_data_source=n,e.bitmap_images.images.push(i),i},ie.createDefaultBitmapImageContainerComponent=function(){var e=new j;return e.container=null,e.images=[],e},ie.createDefaultBitmapImageComponent=function(){var e=new L;return e.bitmap=null,e.offset_x=0,e.offset_y=0,e.rotation=0,e.bitmap_animation=null,e},ie.createDefaultCircleComponent=function(){var e=new Z;return e.body_type=R.NONE,e.editable=!0,e.fill_draw=!0,e.fill_draw_type=G.DEFAULT,e.radius=25,e},ie.createDefaultPolygonComponent=function(){var e=new V;return e.body_type=R.NONE,e.convex_cache_points=null,e.convex_cached=!1,e.editable=!0,e.draw_type=U.DEFAULT,e.alpha=1,e.color=9546397,e.texture=null,e.points=null,e},ie.destroyEntityIncludingChildren=function(e){if(""!=e.guid){if(e.guid="",null!=e.parent&&s.remove(e.parent.group.entities,e),null!=e.polygon){if(null!=e.polygon.points){for(var t=0,n=e.polygon.points;t<n.length;){var i=n[t];++t,Yr.destroy(i)}e.polygon.points=null}null!=e.polygon.graphics&&xl.trace("warning: not supported",{fileName:"EngineDo.hx",lineNumber:466,className:"bikas.engine.EngineDo",methodName:"destroyEntityIncludingChildren"})}if(null!=e.circle&&null!=e.circle.graphics&&xl.trace("warning: not supported",{fileName:"EngineDo.hx",lineNumber:474,className:"bikas.engine.EngineDo",methodName:"destroyEntityIncludingChildren"}),e.parent=null,(e.container_link=null)!=e.group)for(;0<e.group.entities.length;)ie.destroyEntityIncludingChildren(e.group.entities[0]);if(null!=e.bitmap_images){for(var r=0,a=e.bitmap_images.images;r<a.length;){var l=a[r];++r,null!=l.bitmap&&l.bitmap.destroy(!0),l.bitmap=null,l.bitmap_animation=null,l.bitmap_data_source=null}null!=e.bitmap_images.container&&e.bitmap_images.container.destroy(!0),e.bitmap_images=null}null!=e.offset&&(e.offset=null),null!=e.offset_rotated&&(e.offset_rotated=null),null!=e.body&&e.body.get_shapes().clear(),e.body=null,e.constraint=null,e.display.depth_cache=-1,null!=e.display.sprite&&(null!=e.display.sprite.parent&&e.display.sprite.parent.removeChild(e.display.sprite),e.display.sprite.destroy(!0),e.display.sprite=null),null!=e.group&&null!=e.group.container&&e.group.container.destroy(!0),e.group=null,e.bitmap_images=null,e.circle=null,e.polygon=null,e.prefab=null,Hr.validate_reusable_objects&&-1!=ie.destroyed_entity_list.indexOf(e)?xl.trace("warning: object is already added to destroyed list",{fileName:"EngineDo.hx",lineNumber:538,className:"bikas.engine.EngineDo",methodName:"destroyEntityIncludingChildren"}):ie.destroyed_entity_list.push(e)}else xl.trace("warning: entity "+e.name+" is already destroyed or guid == ''",{fileName:"EngineDo.hx",lineNumber:443,className:"bikas.engine.EngineDo",methodName:"destroyEntityIncludingChildren"})},ie.flatten=function(e,t){if(null!=t.prefab_link)if(null==t.prefab_link.prefab_entity)xl.trace("warning: prefab_entity is null for "+t.name,{fileName:"EngineDo.hx",lineNumber:555,className:"bikas.engine.EngineDo",methodName:"flatten"});else{var n=t.prefab_link.prefab_entity;t.prefab_link=null;for(var i=[],r=0,a=n.group.entities;r<a.length;){var s=a[r];++r;var l=ie.copyEntity(s,e,!0);l.parent=t,i.push(l)}t.group=new J,t.group.entities=i,t.prefab=new K,t.prefab.prefab_name=n.name,t.prefab.prefab_link_name=t.name}if(null!=t.group){for(var o=0,_=t.group.entities;o<_.length;){var p=_[o];++o,ha.applyTransform(p.position,p.transform,t.position,t.transform),ie.flatten(e,p)}t.position.x=0,t.position.y=0,t.transform.scale_x=1,t.transform.scale_y=1,t.transform.rotation=0}},ie.flattenPolygonEntities=function(e){if(null!=e.polygon){for(var t=new Yr,n=e.transform.rotation,i=e.transform.rotation=0,r=e.polygon.points;i<r.length;){var a=r[i];++i,ha.applyTransformToPoint(a,t,e.transform)}if(null!=e.polygon.convex_cache_points)for(var s=0,l=e.polygon.convex_cache_points;s<l.length;){var o=l[s];++s;for(var _=0;_<o.length;){var p=o[_];++_,ha.applyTransformToPoint(p,t,e.transform)}}e.transform.scale_x=1,e.transform.scale_y=1,e.transform.rotation=n}if(null!=e.group)for(var u=0,h=e.group.entities;u<h.length;){var c=h[u];++u,ie.flattenPolygonEntities(c)}},ie.copyValue=function(e,t,n,i,r){var a=n;if(null!=a)if(11==r[0]){var l=eo.__cast(n,Array),o=null;if(null==i)o=[];else for(o=eo.__cast(i,Array);o.length>l.length;)o.pop();var u=r.slice();u.shift();for(var h=0,c=l.length;h<c;){var m=h++;m>=o.length?(a=ie.copyValue(e,t,l[m],null,u),o.push(a)):(a=ie.copyValue(e,t,l[m],o[m],u),o[m]=a)}a=o}else if(12==r[0]){for(var f=null,g=0,v=e.classes;g<v.length;){var b=v[g];if(++g,p.is(n,b.unserial_type)){f=b;break}}if(null==f)return xl.trace("warning: couldn't find type for "+p.string(n),{fileName:"EngineDo.hx",lineNumber:681,className:"bikas.engine.EngineDo",methodName:"copyValue"}),null;var y=f.unserial_type,x=i;null==x&&(x=null!=f.init_func?f.init_func():d.createInstance(y,[])),y==L?eo.__cast(x,L).bitmap_data_source=eo.__cast(n,L).bitmap_data_source:y==Q?(eo.__cast(x,Q).guid=eo.__cast(n,Q).guid,eo.__cast(x,Q).prefab_entity=eo.__cast(n,Q).prefab_entity):y==K&&(eo.__cast(x,K).prefab_link_name=eo.__cast(n,K).prefab_link_name,eo.__cast(x,K).prefab_name=eo.__cast(n,K).prefab_name);var z,w,k=f.fields.slice();if(t&&y==ee)for(var S=0;S<k.length;){var C=k[S];if(++S,"guid"==C.field_name){s.remove(k,C);break}}for(var N=0;N<k.length;){var P=k[N];++N,z=_.field(n,P.field_name),w=_.field(x,P.field_name),_.setField(x,P.field_name,ie.copyValue(e,t,z,w,P.value_type_flags))}a=x}else if(128==r[0]){var M=eo.__cast(i,Yr);null==M&&(M=new Yr(0,0)),M.x=eo.__cast(n,Yr).x,M.y=eo.__cast(n,Yr).y,a=M}else if(129==r[0]){var I=eo.__cast(i,ta);null==I&&(I=new ta);var A=eo.__cast(n,ta);I.scale_x=A.scale_x,I.scale_y=A.scale_y,I.rotation=A.rotation,a=I}return a},ie.resolveParentReferences=function(e){if(null!=e.group)for(var t=0,n=e.group.entities;t<n.length;){var i=n[t];++t,ie.resolveParentReferences(i),i.parent=e}},ie.copyEntity=function(e,t,n){var i=eo.__cast(ie.copyValue(t,n,e,null,[12]),ee);return ie.resolveParentReferences(i),i.parent=e.parent,i},ie.createBodiesForEntities=function(e,t,n,i){if(null!=e.group)for(var r=0,a=e.group.entities;r<a.length;){var s=a[r];if(++r,!ie.createBodiesForEntities(s,t,n,i))return!1}var l=R.NONE;if(null!=e.polygon&&e.polygon.body_type!=R.NONE&&(l=e.polygon.body_type),null!=e.circle&&e.circle.body_type!=R.NONE){if(l!=R.NONE&&l!=e.circle.body_type)return xl.trace("error: circle and polygon type mismatch",{fileName:"EngineDo.hx",lineNumber:790,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),!1;l=e.circle.body_type}if(l!=R.NONE){var o=new y_;switch(e.body=o,t.push(e),d.enumIndex(l)){case 1:o.set_type(w_.get_STATIC());break;case 2:o.set_type(w_.get_DYNAMIC())}if(null!=e.polygon)if(null==e.polygon.convex_cache_points)xl.trace("warning: convex_cache_points == null (added basic box)",{fileName:"EngineDo.hx",lineNumber:811,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),o.get_shapes().add(new j_(j_.box(10,10),n,i));else if(0==e.polygon.convex_cache_points.length)xl.trace("warning: no cached convexes in polygon (added basic box)",{fileName:"EngineDo.hx",lineNumber:815,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),o.get_shapes().add(new j_(j_.box(10,10),n,i));else for(var _=0,p=e.polygon.convex_cache_points;_<p.length;){var u=p[_];++_,ie.addConvexPolygonToShapeList(o.get_shapes(),u)}if(null!=e.circle){if(e.circle.radius<=0)return xl.trace("error: circle radius is 0 or less",{fileName:"EngineDo.hx",lineNumber:837,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),!1;o.get_shapes().add(new E_(Math.abs(e.circle.radius)))}ie.fixBodyIfEmpty(o);var h=e.transform.scale_x,c=e.transform.scale_y;if(1!=h||1!=c){null!=e.circle&&h!=c&&(xl.trace("warning: circle has different scale x and y",{fileName:"EngineDo.hx",lineNumber:853,className:"bikas.engine.EngineDo",methodName:"createBodiesForEntities"}),c=h);for(var m=o.get_shapes().iterator();m.hasNext();)m.next().scale(h,c)}var f=.017453292519943*e.transform.rotation;o.setShapeFilters(i),o.setShapeMaterials(n),o.get_shapes().empty()||o.align(),e.offset=new Yr(o.get_position().get_x(),o.get_position().get_y()),e.offset_rotated=new Yr(e.offset.x,e.offset.y),va.rotate(e.offset_rotated,f),o.get_position().set_x(e.position.x+e.offset_rotated.x),o.get_position().set_y(e.position.y+e.offset_rotated.y),o.set_rotation(f),o.set_angularVel(0),o.get_velocity().setxy(0,0)}return!0},ie.setSpaceIncludingChildren=function(e,t){if(null!=e.group)for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];++n,ie.setSpaceIncludingChildren(r,t)}null!=e.body&&e.body.get_space()!=t&&e.body.set_space(t)},ie.fixBodyIfEmpty=function(e){0==e.get_shapes().get_length()?(e.set_allowMovement(!1),e.set_allowRotation(!1)):(e.get_allowMovement()||e.set_allowMovement(!0),e.get_allowRotation()||e.set_allowRotation(!0))},ie.decomposePolygonToConvexes=function(e){if(e.length<3)return xl.trace("warning: polygon has less than 3 points",{fileName:"EngineDo.hx",lineNumber:924,className:"bikas.engine.EngineDo",methodName:"decomposePolygonToConvexes"}),null;for(var t=new i_,n=0;n<e.length;){var i=e[n];++n,t.push(d_.get(i.x,i.y))}if(!t.isSimple()){t.clear();for(var r=0,a=e.length;r<a;){for(var s=r++,l=!1,o=s+1,_=e.length;o<_;){var u=o++;if(pa.pointsEqual(e[s],e[u])){xl.trace("warning: found point with same position: "+p.string(e[s]),{fileName:"EngineDo.hx",lineNumber:938,className:"bikas.engine.EngineDo",methodName:"decomposePolygonToConvexes"}),l=!0;break}}l||t.push(d_.get(e[s].x,e[s].y))}if(!t.isSimple())return xl.trace("error: can't have self-intersecting polygon",{fileName:"EngineDo.hx",lineNumber:949,className:"bikas.engine.EngineDo",methodName:"decomposePolygonToConvexes"}),null}for(var h=t.convexDecomposition(),c=(h.get_length(),[]),d=h.iterator();d.hasNext();){var m=d.next();c.push([]);for(var f=m.iterator();f.hasNext();){var g=f.next();c[c.length-1].push(new Yr(g.get_x(),g.get_y()))}}for(;!h.empty();)h.pop().dispose();return t.dispose(),c},ie.addConvexPolygonToShapeList=function(e,t){t.length<3&&xl.trace("warning: polygon has less than 3 points",{fileName:"EngineDo.hx",lineNumber:975,className:"bikas.engine.EngineDo",methodName:"addConvexPolygonToShapeList"});for(var n=[],i=0;i<t.length;){var r=t[i];++i,n.push(d_.get(r.x,r.y))}e.add(new j_(n));for(var a=0;a<n.length;){var s=n[a];++a,s.dispose()}},ie.createWorld=function(e,t,n){var i=new ne;return i.space=new V_(e,U_.get_DYNAMIC_AABB_TREE()),i.space.set_worldLinearDrag(t),i.space.set_worldAngularDrag(n),i};var re=function(){};(n["bikas.serialization.BefDo"]=re).__name__=["bikas","serialization","BefDo"],re.createSerialData=function(){var e=new gs;return e.classes=[],e.enum_cache=[],e},re.pushClass=function(e,t,n){var i=new se;return i.full_class_name=d.getClassName(t),i.serial_type=t,i.unserial_type=t,i.fields=[],i.ignore_fields=[],i.init_func=n,e.classes.push(i),i},re.pushField=function(e,t,n){var i=new ae;i.field_name=t,i.value_type_flags=[],i.value_type_flags.push(n),e.fields.push(i)},re.pushBool=function(e,t){re.pushField(e,t,0)},re.pushInt=function(e,t){re.pushField(e,t,3)},re.pushDouble=function(e,t){re.pushField(e,t,4)},re.pushString=function(e,t){re.pushField(e,t,5)},re.pushEnum=function(e,t){re.pushField(e,t,7)},re.pushArray=function(e,t,n){var i=new ae;i.field_name=t,i.value_type_flags=n.slice(),i.value_type_flags.unshift(11),e.fields.push(i)},re.pushInstance=function(e,t){re.pushField(e,t,12)},re.pushPoint=function(e,t){re.pushField(e,t,128)},re.pushTransform=function(e,t){re.pushField(e,t,129)},re.pushIgnore=function(e,t){e.ignore_fields.push(t)},re.validateSerialData=function(e){for(var t,n=!0,i=0,r=e.classes;i<r.length;){var a=r[i];++i,t=d.getInstanceFields(d.resolveClass(a.full_class_name));for(var s=0;s<t.length;){var l=t[s];++s;for(var o=!1,_=0,p=a.fields;_<p.length;){var u=p[_];if(++_,u.field_name==l){o=!0;break}}-1!=a.ignore_fields.indexOf(l)&&(o=!0),o||(xl.trace("warning: field '"+l+"' in class '"+a.full_class_name+"' is not specified",{fileName:"BefDo.hx",lineNumber:117,className:"bikas.serialization.BefDo",methodName:"validateSerialData"}),n=!1)}for(var h=0;h<a.fields.length;)-1==t.indexOf(a.fields[h].field_name)&&(xl.trace("warning: field '"+a.fields[h].field_name+"' does not exist in class '"+a.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:124,className:"bikas.serialization.BefDo",methodName:"validateSerialData"}),xl.trace("auto-removing serial_field: '"+a.fields[h].field_name+"' from serial_class '"+a.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:125,className:"bikas.serialization.BefDo",methodName:"validateSerialData"}),a.fields.splice(h,1),--h,n=!1),++h;for(h=0;h<a.ignore_fields.length;)-1==t.indexOf(a.ignore_fields[h])&&xl.trace("warning: ignore_field '"+a.ignore_fields[h]+"' does not exist in class '"+a.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:135,className:"bikas.serialization.BefDo",methodName:"validateSerialData"}),++h}return n},re.createTypeTableForSerialData=function(e){var t=re.createByteCursorForSerialization(32768);t.pos=0,re.setUInt16(t,e.classes.length);for(var n=0,i=e.classes;n<i.length;){var r=i[n];++n,re.setString(t,r.full_class_name),re.setUInt16(t,r.fields.length);for(var a=0,s=r.fields;a<s.length;){var l=s[a];++a,re.setString(t,l.field_name),re.setByte(t,l.value_type_flags.length);for(var o=0,_=l.value_type_flags;o<_.length;){var p=_[o];++o,re.setByte(t,p)}}}var u=t.pos,h=kl.alloc(u);h.blit(0,t.bytes,0,u),e.type_table=h},re.createByteCursorForSerialization=function(e){null==e&&(e=1048576);var t=new ds;return t.alloc_size=e,t.bytes=kl.alloc(e),t.pos=0,t},re.allocateMoreIfNeeded=function(e,t){if(e.pos+t>=e.bytes.length){var n=e.bytes.length+e.alloc_size;n<e.pos+t&&(n=e.pos+t);var i=kl.alloc(n);i.blit(0,e.bytes,0,e.bytes.length),e.bytes=i}},re.serialize=function(e,t,n,i){if(null==i&&(i=1048576),null==e.type_table)return xl.trace("warning: type_table is not created for this serial_data",{fileName:"BefDo.hx",lineNumber:202,className:"bikas.serialization.BefDo",methodName:"serialize"}),null;var r=re.createByteCursorForSerialization(i);r.pos=0,re.setString(r,"BEF_v3"),re.setInt32(r,0),re.allocateMoreIfNeeded(r,e.type_table.length),r.bytes.blit(r.pos,e.type_table,0,e.type_table.length),r.pos+=e.type_table.length,e.enum_cache=[],re.setValue(r,e,t,n);var a=r.pos;r.pos=0,"BEF_v3"!=re.getString(r)&&xl.trace("warning: something went wrong in serialization",{fileName:"BefDo.hx",lineNumber:224,className:"bikas.serialization.BefDo",methodName:"serialize"}),re.setInt32(r,a);var s=kl.alloc(a);return s.blit(0,r.bytes,0,a),s},re.unserialize=function(e,t){var n=new ds;n.bytes=t,n.pos=0;var i=re.getString(n);if("BEF_v3"!=i)return xl.trace("error: wrong format name '"+i+"'",{fileName:"BefDo.hx",lineNumber:241,className:"bikas.serialization.BefDo",methodName:"unserialize"}),null;if(re.getInt32(n)!=t.length)return xl.trace("error: invalid byte array",{fileName:"BefDo.hx",lineNumber:247,className:"bikas.serialization.BefDo",methodName:"unserialize"}),null;var r,a=re.getUInt16(n),s=new ys;s.classes=[],s.enum_cache=[];for(var l=0,o=a;l<o;){l++,(r=new bs).fields=[],r.serial_class=null,r.full_class_name=re.getString(n);for(var _=re.getUInt16(n),p=0,u=e.classes;p<u.length;){var h=u[p];if(++p,h.full_class_name==r.full_class_name){r.serial_class=h;break}}null==r.serial_class&&xl.trace("warning: couldn't find match in serial_data for '"+r.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:269,className:"bikas.serialization.BefDo",methodName:"unserialize"});for(var c=0,d=_;c<d;){c++;var m=new vs;m.field_name=re.getString(n),m.value_type_flags=[];for(var f=0,g=re.getByte(n);f<g;)f++,m.value_type_flags.push(re.getByte(n));if((m.serial_field=null)!=r.serial_class){for(var v=0,b=r.serial_class.fields;v<b.length;){var y=b[v];++v,y.field_name==m.field_name&&(m.serial_field=y)}if(null==m.serial_field)xl.trace("warning: couldn't find serial_field for '"+m.field_name+"' in '"+r.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:287,className:"bikas.serialization.BefDo",methodName:"unserialize"});else if(m.value_type_flags.length!=m.serial_field.value_type_flags.length)xl.trace("warning: field value type flag length mismatch of '"+m.field_name+"' in '"+r.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:290,className:"bikas.serialization.BefDo",methodName:"unserialize"}),m.serial_field=null;else for(var x=0,z=m.value_type_flags.length;x<z;){var w=x++;if(m.value_type_flags[w]!=m.serial_field.value_type_flags[w]&&(12!=m.value_type_flags[w]||128!=m.serial_field.value_type_flags[w]&&129!=m.serial_field.value_type_flags[w])){xl.trace("warning: field value flag mismatch of '"+m.field_name+"' in '"+r.full_class_name+"'",{fileName:"BefDo.hx",lineNumber:302,className:"bikas.serialization.BefDo",methodName:"unserialize"}),m.serial_field=null;break}}}r.fields.push(m)}s.classes.push(r)}var k=re.getByte(n);return re.getValue(n,s,k,null)},re.setByte=function(e,t){re.allocateMoreIfNeeded(e,1),e.bytes.set(e.pos,t),e.pos+=1},re.getByte=function(e){var t=e.bytes.get(e.pos);return e.pos+=1,t},re.setUInt16=function(e,t){re.allocateMoreIfNeeded(e,2),e.bytes.setUInt16(e.pos,t),e.pos+=2},re.getUInt16=function(e){var t=e.bytes.getUInt16(e.pos);return e.pos+=2,t},re.setInt32=function(e,t){re.allocateMoreIfNeeded(e,4);var n=e.bytes,i=e.pos;n.set(i,t),n.set(i+1,t>>8),n.set(i+2,t>>16),n.set(i+3,t>>>24),e.pos+=4},re.getInt32=function(e){var t=e.bytes,n=e.pos,i=t.get(n)|t.get(n+1)<<8|t.get(n+2)<<16|t.get(n+3)<<24;return e.pos+=4,i},re.setDouble=function(e,t){re.allocateMoreIfNeeded(e,8),e.bytes.setDouble(e.pos,t),e.pos+=8},re.getDouble=function(e){var t=e.bytes.getDouble(e.pos);return e.pos+=8,t},re.setString=function(e,t){var n=kl.ofString(t);re.setUInt16(e,n.length),re.allocateMoreIfNeeded(e,n.length),e.bytes.blit(e.pos,n,0,n.length),e.pos+=n.length},re.getString=function(e){var t=re.getUInt16(e),n=e.bytes.getString(e.pos,t);return e.pos+=t,n},re.setEnumValue=function(e,t,n){for(var i,r,a=d.getEnum(n),s=0,l=!1,o=0,_=t.enum_cache;o<_.length;){var p=_[o];if(++o,p.type==a){r=!(l=!0);for(var u=i=0,h=p.values;u<h.length;){var c=h[u];if(++u,c.value==n){r=!0;break}++i}if(r)re.setByte(e,8),re.setUInt16(e,s),re.setUInt16(e,i);else{var m=new ms;m.value=n,m.name=d.enumConstructor(n),p.values.push(m),re.setByte(e,9),re.setUInt16(e,s),re.setString(e,m.name)}break}++s}if(null==n)xl.trace("warning: enum value is null",{fileName:"BefDo.hx",lineNumber:438,className:"bikas.serialization.BefDo",methodName:"setEnumValue"}),re.setByte(e,6);else if(!l){var f=new fs;f.type=a,f.name=d.getEnumName(a),f.values=[];var g=new ms;g.value=n,g.name=d.enumConstructor(n),f.values.push(g),re.setByte(e,10),re.setString(e,f.name),re.setString(e,g.name),t.enum_cache.push(f)}},re.getEnum=function(e,t,n){switch(t){case 8:var i=re.getUInt16(e),r=re.getUInt16(e),a=n.enum_cache[i],s=a.values[r];return null!=a.type&&null!=s.value?s.value:null;case 9:var l=re.getUInt16(e),o=re.getString(e),_=n.enum_cache[l],p=_.type,u=new ms;return _.values.push(u),u.name=o,null!=p?(u.value=d.createEnum(p,o),u.value):null;case 10:var h=re.getString(e),c=re.getString(e),m=d.resolveEnum(h),f=new fs;f.name=h,f.type=m,f.values=[];var g=new ms;return g.name=c,f.values.push(g),n.enum_cache.push(f),null!=m?(g.value=d.createEnum(m,c),g.value):null;default:return xl.trace("error: unrecognized enum flag "+t,{fileName:"BefDo.hx",lineNumber:510,className:"bikas.serialization.BefDo",methodName:"getEnum"}),null}},re.setPoint=function(e,t){re.setDouble(e,t.x),re.setDouble(e,t.y)},re.getPoint=function(e,t){var n=re.getDouble(e),i=re.getDouble(e);if(null==t)return new Yr(n,i);var r=eo.__cast(t,Yr);return r.x=n,r.y=i,r},re.setTransform=function(e,t){re.setDouble(e,t.scale_x),re.setDouble(e,t.scale_y),re.setDouble(e,t.rotation)},re.getTransform=function(e,t){var n=re.getDouble(e),i=re.getDouble(e),r=re.getDouble(e);if(null==t){var a=new ta;return a.scale_x=n,a.scale_y=i,a.rotation=r,a}var s=eo.__cast(t,ta);return s.scale_x=n,s.scale_y=i,s.rotation=r,s},re.setValue=function(e,t,n,i){switch(i[0]){case 0:1==eo.__cast(n,kc)?re.setByte(e,1):re.setByte(e,2);break;case 3:re.setByte(e,3),re.setInt32(e,eo.__cast(n,xc));break;case 4:re.setByte(e,4),re.setDouble(e,eo.__cast(n,wc));break;case 5:re.setByte(e,5),re.setString(e,eo.__cast(n,String));break;case 7:re.setEnumValue(e,t,n);break;case 11:if(null==n)re.setByte(e,6);else{re.setByte(e,11);var r=i.slice();r.shift(),re.setArray(e,t,r,eo.__cast(n,Array))}break;case 12:if(null==n)re.setByte(e,6);else{for(var a=null,s=0,l=0,o=t.classes;l<o.length;){var _=o[l];if(++l,p.is(n,_.serial_type)){a=_;break}++s}null==a?(xl.trace("warning: couldn't find SerialClass for '"+p.string(n)+"'",{fileName:"BefDo.hx",lineNumber:600,className:"bikas.serialization.BefDo",methodName:"setValue"}),re.setByte(e,6)):(re.setByte(e,12),re.setInstance(e,t,a,s,n))}break;case 128:null==n?re.setByte(e,6):(re.setByte(e,128),re.setPoint(e,eo.__cast(n,Yr)));break;case 129:null==n?re.setByte(e,6):(re.setByte(e,129),re.setTransform(e,eo.__cast(n,ta)));break;default:xl.trace("error: unrecognized flag '"+i[0]+"'",{fileName:"BefDo.hx",lineNumber:622,className:"bikas.serialization.BefDo",methodName:"setValue"})}},re.getValue=function(e,t,n,i){switch(n){case 1:return!0;case 2:return!1;case 3:return re.getInt32(e);case 4:return re.getDouble(e);case 5:return re.getString(e);case 6:return null;case 8:case 9:case 10:return re.getEnum(e,n,t);case 11:return re.getArray(e,t,i);case 12:return re.getInstance(e,t,i);case 128:return re.getPoint(e,i);case 129:return re.getTransform(e,i);default:return xl.trace("error: unrecognized flag",{fileName:"BefDo.hx",lineNumber:651,className:"bikas.serialization.BefDo",methodName:"getValue"}),null}},re.setArray=function(e,t,n,i){var r=e.pos;re.setInt32(e,0),re.setByte(e,n[0]),re.setInt32(e,i.length);for(var a=0;a<i.length;){var s=i[a];++a,re.setValue(e,t,s,n)}var l=e.pos;e.pos=r,re.setInt32(e,l-e.pos-4),e.pos=l},re.getArray=function(e,t,n){re.getInt32(e),e.pos,re.getByte(e);var i,r,a=re.getInt32(e);if(null==n)n=[];else for(;n.length>a;)n.pop();for(var s=0,l=a;s<l;){var o=s++;i=re.getByte(e),o>=n.length?(r=re.getValue(e,t,i,null),n.push(r)):(r=re.getValue(e,t,i,n[o]),n[o]=r)}return n},re.setInstance=function(e,t,n,i,r){var a,s=n.fields,l=e.pos;re.setInt32(e,0),re.setUInt16(e,i);for(var o=0;o<s.length;){var p=s[o];++o,a=_.field(r,p.field_name),re.setValue(e,t,a,p.value_type_flags)}var u=e.pos;e.pos=l,re.setInt32(e,u-e.pos-4),e.pos=u},re.getInstance=function(e,t,n){var i,r,a,s=re.getInt32(e),l=e.pos,o=re.getUInt16(e),p=t.classes[o],u=p.serial_class;if(null==u)return xl.trace("warning: skipping '"+p.full_class_name+"', because serial_class does not exist anymore",{fileName:"BefDo.hx",lineNumber:733,className:"bikas.serialization.BefDo",methodName:"getInstance"}),e.pos=l+s,null;null==n&&(n=null!=u.init_func?u.init_func():d.createInstance(u.unserial_type,[]));for(var h=0,c=p.fields;h<c.length;){var m=c[h];if(++h,a=re.getByte(e),i=m.field_name,null==m.serial_field)xl.trace("warning: skipping '"+i+"' in '"+u.full_class_name+"', because serial_field does not exist or types don't match",{fileName:"BefDo.hx",lineNumber:752,className:"bikas.serialization.BefDo",methodName:"getInstance"}),re.getValue(e,t,a,null);else{switch(a){case 6:r=null;break;case 11:case 12:case 128:case 129:r=re.getValue(e,t,a,_.field(n,i));break;default:r=re.getValue(e,t,a,null)}_.setField(n,i,r)}}return n};var ae=function(){};(n["bikas.serialization.SerialField"]=ae).__name__=["bikas","serialization","SerialField"],ae.prototype={field_name:null,value_type_flags:null,__class__:ae};var se=function(){this.init_func=null};(n["bikas.serialization.SerialClass"]=se).__name__=["bikas","serialization","SerialClass"],se.prototype={full_class_name:null,serial_type:null,unserial_type:null,fields:null,ignore_fields:null,init_func:null,__class__:se};var le=function(){};(n["bikas.engine.EngineSerializer"]=le).__name__=["bikas","engine","EngineSerializer"],le.createEngineSerialData=function(e){null==e&&(e=!0);var t,n=re.createSerialData();return le.pushGlobalClasses(n),t=le.pushClass(n,ee,ie.createDefaultEntity),le.pushString(t,"guid"),le.pushString(t,"name"),le.pushInstance(t,"position"),le.pushInstance(t,"transform"),le.pushInstance(t,"display"),le.pushIgnore(t,"parent"),le.pushIgnore(t,"container_link"),le.pushInstance(t,"group"),le.pushInstance(t,"bitmap_images"),le.pushInstance(t,"circle"),le.pushInstance(t,"polygon"),le.pushInstance(t,"prefab"),le.pushInstance(t,"prefab_link"),le.pushIgnore(t,"body"),le.pushIgnore(t,"offset"),le.pushIgnore(t,"offset_rotated"),le.pushIgnore(t,"constraint"),t=le.pushClass(n,Y,null),le.pushIgnore(t,"sprite"),le.pushIgnore(t,"depth_cache"),t=le.pushClass(n,J,ie.createDefaultGroupComponent),le.pushArray(t,"entities",[12]),le.pushIgnore(t,"container"),t=le.pushClass(n,j,ie.createDefaultBitmapImageContainerComponent),le.pushArray(t,"images",[12]),le.pushIgnore(t,"container"),t=le.pushClass(n,L,ie.createDefaultBitmapImageComponent),le.pushString(t,"source_name"),le.pushIgnore(t,"bitmap_data_source"),le.pushIgnore(t,"bitmap"),le.pushDouble(t,"offset_x"),le.pushDouble(t,"offset_y"),le.pushDouble(t,"rotation"),le.pushInstance(t,"bitmap_animation"),t=le.pushClass(n,F,null),le.pushIgnore(t,"source"),le.pushInt(t,"frame"),t=le.pushClass(n,Z,ie.createDefaultCircleComponent),le.pushEnum(t,"body_type"),le.pushBool(t,"editable"),le.pushBool(t,"fill_draw"),le.pushEnum(t,"fill_draw_type"),le.pushDouble(t,"radius"),le.pushIgnore(t,"graphics"),t=le.pushClass(n,V,ie.createDefaultPolygonComponent),le.pushEnum(t,"body_type"),le.pushArray(t,"points",[12]),le.pushArray(t,"convex_cache_points",[11,12]),le.pushBool(t,"convex_cached"),le.pushIgnore(t,"editable"),le.pushEnum(t,"draw_type"),le.pushInt(t,"color"),le.pushDouble(t,"alpha"),le.pushInstance(t,"texture"),le.pushIgnore(t,"graphics"),t=le.pushClass(n,q,null),le.pushString(t,"fill_source_name"),le.pushString(t,"line_source_name"),le.pushIgnore(t,"fill_source_name_cache"),le.pushIgnore(t,"line_source_name_cache"),le.pushIgnore(t,"bitmaps_updated"),le.pushBool(t,"use_sutherland_hodgman"),le.pushIgnore(t,"data"),t=le.pushClass(n,K,null),le.pushIgnore(t,"prefab_name"),le.pushIgnore(t,"prefab_link_name"),t=le.pushClass(n,Q,null),le.pushString(t,"guid"),le.pushIgnore(t,"prefab_entity"),t=le.pushClass(n,B,null),le.pushString(t,"name"),le.pushDouble(t,"created_time_stamp"),le.pushDouble(t,"save_time_stamp"),t=le.pushClass(n,X,null),le.pushInstance(t,"save"),le.pushInstance(t,"group"),t=le.pushClass(n,H,null),le.pushInstance(t,"save"),le.pushInstance(t,"group"),e&&re.validateSerialData(n),re.createTypeTableForSerialData(n),n},le.pushGlobalClasses=function(e){var t=le.pushClass(e,Yr,Yr.createDefault);le.pushDouble(t,"x"),le.pushDouble(t,"y"),le.pushIgnore(t,"toString"),t=le.pushClass(e,ta),le.pushDouble(t,"scale_x"),le.pushDouble(t,"scale_y"),le.pushDouble(t,"rotation"),le.pushIgnore(t,"toString"),t=le.pushClass(e,Kr),le.pushDouble(t,"x"),le.pushDouble(t,"y"),le.pushDouble(t,"width"),le.pushDouble(t,"height"),le.pushIgnore(t,"toString")},le.unserializeStageEngine=function(e,t){var n=ql.run(t);return le.unserializeStageEngineUncompressed(e,n)},le.unserializeLibraryEngine=function(e,t){var n=ql.run(t);return le.unserializeLibraryEngineUncompressed(e,n)},le.unserializeStageEngineUncompressed=function(e,t){var n=re.unserialize(e,t);if(!p.is(n,X))return xl.trace("error: wrong type, expected: "+p.string(X)+", got: "+p.string(n),{fileName:"EngineSerializer.hx",lineNumber:222,className:"bikas.engine.EngineSerializer",methodName:"unserializeStageEngineUncompressed"}),null;var i=eo.__cast(n,X);return null==i.group?(xl.trace("error: no stage group",{fileName:"EngineSerializer.hx",lineNumber:227,className:"bikas.engine.EngineSerializer",methodName:"unserializeStageEngineUncompressed"}),null):i},le.unserializeLibraryEngineUncompressed=function(e,t){var n=re.unserialize(e,t);if(!p.is(n,H))return xl.trace("error: wrong type, expected: "+p.string(H)+", got: "+p.string(n),{fileName:"EngineSerializer.hx",lineNumber:236,className:"bikas.engine.EngineSerializer",methodName:"unserializeLibraryEngineUncompressed"}),null;var i=eo.__cast(n,H);return null==i.group?(xl.trace("error: no stage group",{fileName:"EngineSerializer.hx",lineNumber:241,className:"bikas.engine.EngineSerializer",methodName:"unserializeLibraryEngineUncompressed"}),null):i};var oe=function(){};(n["bikas.engine.EngineSystems"]=oe).__name__=["bikas","engine","EngineSystems"],oe.addEntity=function(e){null!=e.polygon&&de.refresh(e),null!=e.circle&&pe.refresh(e),null!=e.bitmap_images&&_e.add(e),ue.add(e),he.refresh(e),me.refresh(e)},oe.removeEntity=function(e){me.remove(e),ue.remove(e),null!=e.bitmap_images&&_e.remove(e),null!=e.circle&&pe.remove(e),null!=e.polygon&&de.remove(e)},oe.addEntityIncludingChildren=function(e){if(null!=e.group)for(var t=0,n=e.group.entities;t<n.length;){var i=n[t];++t,oe.addEntityIncludingChildren(i)}oe.addEntity(e)},oe.removeEntityIncludingChildren=function(e){if(oe.removeEntity(e),null!=e.group)for(var t=0,n=e.group.entities;t<n.length;){var i=n[t];++t,oe.removeEntityIncludingChildren(i)}},oe.refreshEntityIncludingChildren=function(e){xl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:76,className:"bikas.engine.EngineSystems",methodName:"refreshEntityIncludingChildren"})};var _e=function(){};(n["bikas.engine.BitmapImagesSystem"]=_e).__name__=["bikas","engine","BitmapImagesSystem"],_e.add=function(e){var t;2<=e.bitmap_images.images.length&&xl.trace("warning: entity "+e.name+" has "+e.bitmap_images.images.length+" bitmap images, more than 1 sprite per entity is no longer supported!",{fileName:"EngineSystems.hx",lineNumber:116,className:"bikas.engine.BitmapImagesSystem",methodName:"add"});for(var n=0,i=e.bitmap_images.images;n<i.length;){var r=i[n];++n,t=r.bitmap_data_source,null==e.display.sprite&&(e.display.sprite=Ra.createEmptySprite());var a=e.display.sprite;null==t.bitmap_data?xl.trace("warning: source.bitmap_data == null (entity: "+e.name+", bitmap: "+r.source_name+")",{fileName:"EngineSystems.hx",lineNumber:134,className:"bikas.engine.BitmapImagesSystem",methodName:"add"}):(null==a.texture?a.texture=t.bitmap_data:a.setTexture(t.bitmap_data),a.anchor.x=(t.center_point.x-r.offset_x)/t.bitmap_data.width,a.anchor.y=(t.center_point.y-r.offset_y)/t.bitmap_data.height),0!=r.rotation&&xl.trace("warning: image.rotation is not supported! (entity: "+e.name+", bitmap: "+r.source_name+", image.rotation: "+r.rotation+")",{fileName:"EngineSystems.hx",lineNumber:153,className:"bikas.engine.BitmapImagesSystem",methodName:"add"}),a.rotation=0;break}},_e.remove=function(e){};var pe=function(){};(n["bikas.engine.CircleFillDrawSystem"]=pe).__name__=["bikas","engine","CircleFillDrawSystem"],pe.remove=function(e){null!=e.circle&&null!=e.circle.graphics&&(e.circle.graphics.clear(),xl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:175,className:"bikas.engine.CircleFillDrawSystem",methodName:"remove"}))},pe.refresh=function(e){if(oe.debug_draw_polygons_and_circles){var t=1,n=e.circle.fill_draw_type;switch(d.enumIndex(n)){case 0:t=1;break;case 1:t=.5}var i=e.circle,r=null;null==i.graphics&&(r=i.graphics=Ra.createGraphics(),xl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:194,className:"bikas.engine.CircleFillDrawSystem",methodName:"refresh"})),r.clear(),r.beginFill(9546397,t),r.lineStyle(1,1651777,t),r.drawCircle(0,0,2*i.radius),r.endFill()}};var ue=function(){};(n["bikas.engine.DisplayContainerSystem"]=ue).__name__=["bikas","engine","DisplayContainerSystem"],ue.add=function(e){e.display;var t=null;if(null!=(t=null!=e.group?e.group.container:e.display.sprite)){t.name="entity:"+e.name;var n=e.container_link;null!=n&&-1==n.children.indexOf(t)&&n.add(t)}},ue.remove=function(e){var t=e.container_link;null!=t&&(null!=e.group&&null!=e.group.container&&-1!=t.children.indexOf(e.group.container)&&t.remove(e.group.container),null!=e.display.sprite&&-1!=t.children.indexOf(e.display.sprite)&&t.remove(e.display.sprite))},ue.refresh=function(e){xl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:282,className:"bikas.engine.DisplayContainerSystem",methodName:"refresh"})};var he=function(){};(n["bikas.engine.DisplayPositionSystem"]=he).__name__=["bikas","engine","DisplayPositionSystem"],he.refresh=function(e){null!=e.group&&null!=e.group.container&&(e.group.container.x=e.position.x,e.group.container.y=e.position.y),null!=e.display.sprite&&(e.display.sprite.x=e.position.x,e.display.sprite.y=e.position.y)};var ce=function(){};(n["bikas.engine.NapeSystem"]=ce).__name__=["bikas","engine","NapeSystem"],ce.refresh=function(e){if(null==e.body.zpp_inner.component||!e.body.zpp_inner.component.sleeping){var t=e.offset,n=e.offset_rotated;n.x=t.x,n.y=t.y;var i=e.body.get_rotation(),r=Math.cos(i),a=Math.sin(i),s=r*n.x-a*n.y,l=a*n.x+r*n.y;n.x=s,n.y=l;var o=e.body.get_position().get_x();e.position.x=o-n.x;var _=e.body.get_position().get_y();if(e.position.y=_-n.y,null!=e.display.sprite){e.display.sprite.x=e.position.x,e.display.sprite.y=e.position.y;var p=e.body.get_rotation();e.display.sprite.rotation=ce.normalizeAngle(p)}}},ce.normalizeAngle=function(e){return(e=(e%Xr.PI2+Xr.PI2)%Xr.PI2)>Xr.PI&&(e-=Xr.PI2),e};var de=function(){};(n["bikas.engine.PolygonSystem"]=de).__name__=["bikas","engine","PolygonSystem"],de.remove=function(e){null!=e.polygon&&null!=e.polygon.graphics&&(e.polygon.graphics.clear(),xl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:359,className:"bikas.engine.PolygonSystem",methodName:"remove"}))},de.refresh=function(e){if(oe.debug_draw_polygons_and_circles){var t=e.polygon,n=t.draw_type;switch(d.enumIndex(n)){case 0:var i=null;null==t.graphics&&(i=t.graphics=Ra.createGraphics(),xl.trace("warning: not supported",{fileName:"EngineSystems.hx",lineNumber:396,className:"bikas.engine.PolygonSystem",methodName:"refresh"})),i.clear(),i.beginFill(9546397),i.lineStyle(1,1651777,1),i.moveTo(t.points[0].x,t.points[0].y);for(var r=1,a=t.points.length;r<a;){var s=r++;i.lineTo(t.points[s].x,t.points[s].y)}i.endFill()}}};var me=function(){};(n["bikas.engine.TransformSystem"]=me).__name__=["bikas","engine","TransformSystem"],me.refresh=function(e){var t=e.transform;if(null!=e.group&&null!=e.group.container){var n=e.group.container;n.scale.x=t.scale_x,n.scale.y=t.scale_y,n.rotation=.017453292519943*t.rotation}if(null!=e.display.sprite){var i=e.display.sprite;i.scale.x=t.scale_x,i.scale.y=t.scale_y,i.rotation=.017453292519943*t.rotation}},me.remove=function(e){if(null!=e.group){var t=e.group.container;null!=t&&(t.scale.x=1,t.scale.y=1,t.rotation=0)}if(null!=e.display.sprite){var n=e.display.sprite;n.scale.x=1,n.scale.y=1,n.rotation=0}};var fe=n["bikas.game.AbilityAnimationState"]={__ename__:["bikas","game","AbilityAnimationState"],__constructs__:["None","JuctPicked","TransitioningToUI","RollingDice","ButtonMode"]};fe.None=["None",0],fe.None.toString=i,(fe.None.__enum__=fe).JuctPicked=["JuctPicked",1],fe.JuctPicked.toString=i,(fe.JuctPicked.__enum__=fe).TransitioningToUI=["TransitioningToUI",2],fe.TransitioningToUI.toString=i,(fe.TransitioningToUI.__enum__=fe).RollingDice=["RollingDice",3],fe.RollingDice.toString=i,(fe.RollingDice.__enum__=fe).ButtonMode=["ButtonMode",4],fe.ButtonMode.toString=i,(fe.ButtonMode.__enum__=fe).__empty_constructs__=[fe.None,fe.JuctPicked,fe.TransitioningToUI,fe.RollingDice,fe.ButtonMode];var ge=n["bikas.game.AbilityType"]={__ename__:["bikas","game","AbilityType"],__constructs__:["None","Bomb","Dynamite","Armor","Nitro","Magnet"]};ge.None=["None",0],ge.None.toString=i,(ge.None.__enum__=ge).Bomb=["Bomb",1],ge.Bomb.toString=i,(ge.Bomb.__enum__=ge).Dynamite=["Dynamite",2],ge.Dynamite.toString=i,(ge.Dynamite.__enum__=ge).Armor=["Armor",3],ge.Armor.toString=i,(ge.Armor.__enum__=ge).Nitro=["Nitro",4],ge.Nitro.toString=i,(ge.Nitro.__enum__=ge).Magnet=["Magnet",5],ge.Magnet.toString=i,(ge.Magnet.__enum__=ge).__empty_constructs__=[ge.None,ge.Bomb,ge.Dynamite,ge.Armor,ge.Nitro,ge.Magnet];var ve=function(){this.use_ability_click=!1,this.instantly_receive_ability=!1,this.dice_roll_scaled_up=!1,this.current_shuffle_time=0,this.current_transition_time=0,this.menu_position=new Yr,this.start_position=new Yr,this.old_clicked_container=null,this.old_containers=[],this.old_icons=[],this.icon=null,this.container=null,this.state=fe.None,this.type=ge.None};(n["bikas.game.AbilityButton"]=ve).__name__=["bikas","game","AbilityButton"],ve.prototype={type:null,state:null,container:null,icon:null,old_icons:null,old_containers:null,old_clicked_container:null,keyboard_shortcut_display:null,start_position:null,menu_position:null,start_scale:null,menu_scale:null,radius:null,current_transition_time:null,current_shuffle_time:null,dice_roll_scaled_up:null,dice_roll_frames:null,dice_roll_frame_count:null,dice_roll_start_frame:null,dice_roll_final_index:null,parent_cache_x:null,parent_cache_y:null,instantly_receive_ability:null,use_ability_click:null,__class__:ve};var be=function(){};(n["bikas.game.AbilityButtonDo"]=be).__name__=["bikas","game","AbilityButtonDo"],be.pickItem=function(e,t,n,i,r){e.type=ge.None,e.state=fe.TransitioningToUI,e.instantly_receive_ability=r,null!=e.icon&&(e.old_icons.push(e.icon),e.old_containers.push(e.container),e.icon=null,e.container=null),e.icon=T.createNewAnimation(Os.animation_power_icons,!1),e.container=Ra.createGroup(),i.add(e.container),e.radius=e.icon.sprite.width/2*1.2,e.start_position.x=t.x,e.start_position.y=t.y,e.start_scale=n.x/2,e.container.position.x=e.start_position.x,e.container.position.y=e.start_position.y,e.container.scale.x=e.start_scale,e.container.scale.y=e.start_scale,e.menu_position.x=0,e.menu_position.y=0,e.menu_scale=1,e.current_transition_time=0,e.current_shuffle_time=0,e.keyboard_shortcut_display=lr.createKeyboardShortcutDisplay("(ENTER)",2,24)},be.destroy=function(e){null!=e.icon&&(e.old_icons.push(e.icon),e.icon=null),null!=e.container&&(e.old_containers.push(e.container),e.container=null);for(var t=0,n=e.old_icons;t<n.length;){var i=n[t];++t,i.sprite.destroy(!0),T.destroyAnimation(i)}for(var r=0,a=e.old_containers;r<a.length;){var s=a[r];++r,s.destroy(!0)}e.old_icons=null,e.old_containers=null,e.start_position=null,e.start_scale=null,e.menu_position=null,e.menu_scale=null},be.useAbility=function(e,t,n,i,r,a){var s=e.ability_button;Me.useCurrentAbility(e.car,e,e.abilities,t,n,i,r,a),s.state=fe.None,s.old_clicked_container=s.container,be.pushToOld(s)},be.pushToOld=function(e){e.old_containers.push(e.container),e.old_icons.push(e.icon),e.icon=null,e.container=null},be.updateAbilityItem=function(e,t,n,i,r,a,s,l,o){var _=e.ability_button,p=e.abilities;if(_.state==fe.TransitioningToUI){null==_.icon.sprite.parent&&(_.container.add(_.icon.sprite),_.container.add(_.keyboard_shortcut_display.container)),_.current_transition_time+=l;var u=_.current_transition_time/Pe.transition_time;1<u&&(u=1),_.instantly_receive_ability&&(u=1),_.container.x=ca.smoothEnd(_.start_position.x,_.menu_position.x,u),_.container.y=ca.smoothEnd(_.start_position.y,_.menu_position.y,u);var h=ca.smoothToABCWithSmoothB(_.start_scale,1.3,_.menu_scale,.6,u);if(_.container.scale.x=h,_.container.scale.y=h,1==u){_.state=fe.RollingDice,_.dice_roll_frames=[];for(var c=1,d=_.icon.data.frames.length;c<d;){var m=c++;_.dice_roll_frames.push(m)}ha.shuffleArray(_.dice_roll_frames),_.dice_roll_final_index=Me.getIndexByAbility(e.abilities.received_ability),_.dice_roll_frame_count=2*ve.dice_roll_available_abilities.length+_.dice_roll_final_index}}if(_.state==fe.RollingDice){_.current_shuffle_time+=l;var f=_.current_shuffle_time/Pe.shuffle_time,g=ca.smoothEnd(0,1,f),v=0;_.instantly_receive_ability&&(f=1.1),1<f?(g=f=1,v=_.dice_roll_final_index):v=Math.floor(_.dice_roll_frame_count*g)%ve.dice_roll_available_abilities.length,_.icon.current_frame!=v+1&&(ks.playSound(Os.sound_power_roll,o,.5),1==f&&ks.playSound(Os.sound_power_roll_end,o,.5)),T.gotoFrame(_.icon,v+1),1==f&&(_.container.scale.x=1,_.container.scale.y=1,_.state=fe.ButtonMode,p.current_ability=Me.getAbilityByIndex(v),p.received_ability=null)}_.state==fe.ButtonMode&&(_.container.parent.x==_.parent_cache_x&&_.container.parent.y==_.parent_cache_y||(_.parent_cache_x=_.container.parent.x,_.parent_cache_y=_.container.parent.y),_.use_ability_click?(_.use_ability_click=!1,be.useAbility(e,i,r,a,s,o)):Ha.isDowned(_.parent_cache_x,_.parent_cache_y,t,_.radius)&&be.useAbility(e,i,r,a,s,o),n.desktop&&(Ha.isOver(_.parent_cache_x,_.parent_cache_y,t,_.radius)?_.keyboard_shortcut_display.container.visible=!0:_.keyboard_shortcut_display.container.visible=!1)),null==p.received_ability&&(null==p.current_ability?_.state!=fe.None&&(_.state=fe.None,_.old_clicked_container=_.container,be.pushToOld(_)):p.current_ability==ge.None&&_.state!=fe.None&&(_.state=fe.None,_.old_clicked_container=_.container,be.pushToOld(_)));for(var b=0;b<_.old_icons.length;){var y=_.old_icons[b],x=_.old_containers[b];x.alpha-=.1*l,x==_.old_clicked_container&&(x.scale.x+=.05*l,x.scale.y+=.05*l),x.alpha<=0&&(y.sprite.destroy(!0),T.destroyAnimation(y),_.old_icons.splice(b,1),_.old_containers[b].destroy(!0),_.old_containers.splice(b,1),--b),++b}};var ye=function(){this.cooldown_time_stamp=0,this.cooldown_time=1};(n["bikas.game.JumpPower"]=ye).__name__=["bikas","game","JumpPower"],ye.prototype={cooldown_time:null,cooldown_time_stamp:null,__class__:ye};var xe=n["bikas.game.ConstantPowerType"]={__ename__:["bikas","game","ConstantPowerType"],__constructs__:["Nitro","Shield","Magnet"]};xe.Nitro=["Nitro",0],xe.Nitro.toString=i,(xe.Nitro.__enum__=xe).Shield=["Shield",1],xe.Shield.toString=i,(xe.Shield.__enum__=xe).Magnet=["Magnet",2],xe.Magnet.toString=i,(xe.Magnet.__enum__=xe).__empty_constructs__=[xe.Nitro,xe.Shield,xe.Magnet];var ze=function(e){this.additional=[],this.animation=null,this.added_to_partition=!1,this.above_car=!1,this.additional_offset=null,this.phase_time=5,this.max_alpha=1,this.max_time=0,this.current_time=0,this.activated=!1,this.type=e};(n["bikas.game.ConstantPower"]=ze).__name__=["bikas","game","ConstantPower"],ze.prototype={type:null,activated:null,current_time:null,max_time:null,max_alpha:null,phase_time:null,additional_offset:null,above_car:null,added_to_partition:null,sprite:null,animation:null,additional:null,__class__:ze};var we=function(){this.power_add_coeff=0};(n["bikas.game.ExplosionEvent"]=we).__name__=["bikas","game","ExplosionEvent"],we.prototype={type:null,source_car:null,space:null,explosion_center:null,explosion_radius:null,body_containment:null,min_impulse:null,max_impulse:null,power_add_coeff:null,one_time_velocity_friction:null,__class__:we};var ke=n["bikas.game.ExplosiveType"]={__ename__:["bikas","game","ExplosiveType"],__constructs__:["Bomb","Dynamite","Barrel"]};ke.Bomb=["Bomb",0],ke.Bomb.toString=i,(ke.Bomb.__enum__=ke).Dynamite=["Dynamite",1],ke.Dynamite.toString=i,(ke.Dynamite.__enum__=ke).Barrel=["Barrel",2],ke.Barrel.toString=i,(ke.Barrel.__enum__=ke).__empty_constructs__=[ke.Bomb,ke.Dynamite,ke.Barrel];var Se=n["bikas.game.ExplosiveState"]={__ename__:["bikas","game","ExplosiveState"],__constructs__:["Normal","ExplosionExploded","ExplosionAnimation","Done"]};Se.Normal=["Normal",0],Se.Normal.toString=i,(Se.Normal.__enum__=Se).ExplosionExploded=["ExplosionExploded",1],Se.ExplosionExploded.toString=i,(Se.ExplosionExploded.__enum__=Se).ExplosionAnimation=["ExplosionAnimation",2],Se.ExplosionAnimation.toString=i,(Se.ExplosionAnimation.__enum__=Se).Done=["Done",3],Se.Done.toString=i,(Se.Done.__enum__=Se).__empty_constructs__=[Se.Normal,Se.ExplosionExploded,Se.ExplosionAnimation,Se.Done];var Ce=function(){this.explosion_events_buffer=[],this.explosion_max_impulse=1e3,this.explosion_min_impulse=350,this.explosion_radius=300,this.explosion_velocity_friction=.6,this.power_add_coeff=0,this.current_bomb_existance_time=0,this.bomb_throw_angular_impulse=2e3,this.dynamite_time=14,this.dynamite_time_current=-1,this.hide_sprite=null,this.source_car=null};(n["bikas.game.Explosive"]=Ce).__name__=["bikas","game","Explosive"],Ce.prototype={type:null,state:null,cbody:null,source_car:null,container:null,animation:null,hide_sprite:null,init_pos:null,dynamite_time_current:null,dynamite_time:null,bomb_throw_angular_impulse:null,current_bomb_existance_time:null,power_add_coeff:null,explosion_velocity_friction:null,explosion_radius:null,explosion_min_impulse:null,explosion_max_impulse:null,current_explosion_time:null,explosion_events_buffer:null,__class__:Ce};var Ne=function(){this.last_car_multiplier=1,this.first_car_multiplier=1};(n["bikas.game.AbilityProbability"]=Ne).__name__=["bikas","game","AbilityProbability"],Ne.prototype={type:null,first_car_multiplier:null,last_car_multiplier:null,__class__:Ne};var Pe=function(){this.nitro_power_charge=0,this.bot_ability_receive_time_stamp=0,this.received_ability=null,this.current_ability_power_add_coeff=0,this.current_ability=ge.None};(n["bikas.game.AbilityInventory"]=Pe).__name__=["bikas","game","AbilityInventory"],Pe.prototype={jump_power:null,nitro_power:null,shield_power:null,magnet_power:null,current_ability:null,current_ability_power_add_coeff:null,received_ability:null,bot_ability_receive_time_stamp:null,nitro_power_charge:null,__class__:Pe};var Me=function(){};(n["bikas.game.AbilityDo"]=Me).__name__=["bikas","game","AbilityDo"],Me.createAbilities=function(){var e=new Pe;return e.jump_power=Me.createJumpPower(),e.nitro_power=Me.createNitroPower(),e.shield_power=Me.createShieldPower(),e.magnet_power=Me.createMagnetPower(),e},Me.destroyAbilities=function(e){Me.destroyConstantPower(e.nitro_power),Me.destroyConstantPower(e.shield_power),Me.destroyConstantPower(e.magnet_power),e.jump_power=null,e.nitro_power=null,e.shield_power=null,e.magnet_power=null},Me.destroyConstantPower=function(e){null!=e.animation&&T.destroyAnimation(e.animation,!1),null!=e.sprite&&e.sprite.destroy(!0);for(var t=0,n=e.additional;t<n.length;){var i=n[t];++t,i.destroy(!0)}null!=e.additional_offset&&(Yr.destroy(e.additional_offset),e.additional_offset=null)},Me.deactivateAbilities=function(e){Me.deactivateConstantPower(e.nitro_power),Me.deactivateConstantPower(e.shield_power),Me.deactivateConstantPower(e.magnet_power),e.nitro_power_charge=0,e.current_ability=ge.None,e.received_ability=null},Me.deactivateConstantPower=function(e){e.current_time=0,e.activated=!1,null!=e.sprite&&e.sprite.visible&&(e.sprite.visible=!1)},Me.createJumpPower=function(){return new ye},Me.createNitroPower=function(){var e=new ze(xe.Nitro);return e.additional_offset=Yr.create(0,0),e.animation=T.createNewAnimation(Os.animation_nitro_flames,!1),e.sprite=e.animation.sprite,e.max_alpha=.8,e.phase_time=3,e},Me.createShieldPower=function(){var e=new ze(xe.Shield);return e.animation=T.createNewAnimation(Os.animation_power_shield,!1),e.sprite=e.animation.sprite,e.sprite.alpha=1,e},Me.createMagnetPower=function(){var e=new ze(xe.Magnet);return e.animation=T.createNewAnimation(Os.animation_power_magnet,!1),e.sprite=e.animation.sprite,e.sprite.alpha=1,e},Me.updateConstantPowerAbilities=function(e,t,n,i,r,a,s,l){n.nitro_power.activated&&Me.updateConstantPower(e,t,n.nitro_power,i,r,a,s,l),n.shield_power.activated&&Me.updateConstantPower(e,t,n.shield_power,i,r,a,s,l),n.magnet_power.activated&&Me.updateConstantPower(e,t,n.magnet_power,i,r,a,s,l)},Me.updateConstantPower=function(e,t,n,i,r,a,s,l){if(n.activated){if(null!=n.sprite){if(n.sprite.visible||(n.sprite.visible=!0),n.type==xe.Nitro)if(null!=i.exhaust_position){var o=i.exhaust_position.get_x();n.additional_offset.x=o-n.animation.data.frames[0].texture.width/2+20,n.additional_offset.y=i.exhaust_position.get_y()}else n.additional_offset.x=i.bounds.min_x-60,n.additional_offset.y=i.bounds.max_y-.5*i.back_wheel_diameter;var _=i.main_body.get_rotation();if(n.sprite.rotation=ce.normalizeAngle(_),null!=n.additional_offset?(va.rotate(n.additional_offset,n.sprite.rotation),n.sprite.position.x=i.main_body_position_x+n.additional_offset.x,n.sprite.position.y=i.main_body_position_y+n.additional_offset.y):(n.sprite.position.x=i.main_body_position_x,n.sprite.position.y=i.main_body_position_y),!n.added_to_partition){var p;p=n.above_car?1:-1,null!=bi.tryToAddSpriteAfterThisDisplayObject(e,t,i.main_body_entity.display.sprite,p,n.sprite,!0)&&(n.added_to_partition=!0)}}if(n.current_time-=l.dc,n.type!=xe.Nitro&&n.type!=xe.Shield&&n.type!=xe.Magnet||(null==n.animation?xl.trace("warning: power.animation == null",{fileName:"AbilityDo.hx",lineNumber:215,className:"bikas.game.AbilityDo",methodName:"updateConstantPower"}):T.nextFrameStep(n.animation,l.dc)),n.type==xe.Nitro)Ct.nitro(i,r,a,l.dc);else if(n.type==xe.Magnet)for(var u=i.main_body.get_position(),h=0;h<s.length;){var c=s[h];if(++h,c!=i){var d=u.sub(c.main_body.get_position());d.get_length()<ze.magnet_distance&&(d.muleq(5*l.dc),c.main_body.applyImpulse(d),c.main_body.get_velocity().muleq(Math.pow(.93,l.dc))),d.dispose()}}return n.current_time<0&&Me.deactivateConstantPower(n),!0}return Me.deactivateConstantPower(n),!1},Me.useCurrentAbility=function(e,t,n,i,r,a,s,l){n.current_ability==ge.Bomb?(Me.throwBombFromCar(e,n.current_ability_power_add_coeff,i,r,a,s),Un.playSoundInGameLevel(Os.sound_throw,l,e.main_body.get_position(),t.car,1e3,1)):n.current_ability==ge.Dynamite?(Me.dropDynamiteFromCar(e,n.current_ability_power_add_coeff,i,r,a,s),Un.playSoundInGameLevel(Os.sound_throw,l,e.main_body.get_position(),t.car,1e3,1)):n.current_ability==ge.Armor?(Me.activateOrExtendConstantPower(n.shield_power,e,Pe.shield_time),Un.playSoundInGameLevel(Os.sound_armor,l,e.main_body.get_position(),t.car,1e3,1)):n.current_ability==ge.Nitro?Me.activateOrExtendConstantPower(n.nitro_power,e,Pe.nitro_time):n.current_ability==ge.Magnet?Me.activateOrExtendConstantPower(n.magnet_power,e,Pe.magnet_time):xl.trace("warning: unhandled ability "+p.string(n.current_ability),{fileName:"AbilityDo.hx",lineNumber:301,className:"bikas.game.AbilityDo",methodName:"useCurrentAbility"}),n.current_ability=ge.None},Me.activateOrExtendConstantPower=function(e,t,n){e.activated=!0,e.max_time=n,e.current_time=e.max_time,e.above_car=!0,e.type==xe.Nitro?e.above_car=!1:(e.type==xe.Shield||e.type==xe.Magnet)&&(e.above_car=!0)},Me.getAbilityByIndex=function(e){return 0==e?ge.Bomb:1==e?ge.Dynamite:2==e?ge.Armor:3==e?ge.Nitro:4==e?ge.Magnet:(xl.trace("warning: ability does not exist",{fileName:"AbilityDo.hx",lineNumber:339,className:"bikas.game.AbilityDo",methodName:"getAbilityByIndex"}),ge.None)},Me.getIndexByAbility=function(e){return e==ge.Bomb?0:e==ge.Dynamite?1:e==ge.Armor?2:e==ge.Nitro?3:e==ge.Magnet?4:(xl.trace("warning: unhandled ability",{fileName:"AbilityDo.hx",lineNumber:360,className:"bikas.game.AbilityDo",methodName:"getIndexByAbility"}),-1)},Me.isAllowedToJump=function(e,t){return t>=e.cooldown_time_stamp},Me.isAbleToJump=function(e){return e.updates_since_any_wheel_collided<=6},Me.tryJump=function(e,t,n,i,r){return!(!Me.isAllowedToJump(e,r)||!Me.isAbleToJump(i)||(e.cooldown_time_stamp=r+e.cooldown_time,Ct.jump(t,n,i),0))},Me.throwBombFromCar=function(e,t,n,i,r,a){var s=d_.get(e.bounds.max_x+25,e.bounds.min_y-25);s.rotate(e.main_body.get_rotation()),s.addeq(e.main_body.get_position());var l=d_.get(1200,0);l.rotate(e.main_body.get_rotation()-.1111111111111111*Math.PI);var o=Me.throwBomb(s.get_x(),s.get_y(),e.main_body.get_velocity().get_x(),l,t,n,i,r,a,e);return s.dispose(),l.dispose(),o},Me.throwBomb=function(e,t,n,i,r,a,s,l,o,_){var p=Me.createExplosive(a,s,Ce.bomb_explosion_radius,e,t,ke.Bomb,r);return p.source_car=_,Xt.setSpace(p.cbody,l),p.cbody.body.get_velocity().setxy(n,0),p.cbody.body.applyImpulse(i),p.cbody.body.applyAngularImpulse(p.bomb_throw_angular_impulse),p.current_bomb_existance_time=0,o.push(p),Xt.updateContainerBody(p.cbody),p},Me.dropDynamiteFromCar=function(e,t,n,i,r,a){var s=e.main_body.get_position();return Me.dropDynamite(s.get_x(),s.get_y(),t,n,i,r,a,e)},Me.dropDynamite=function(e,t,n,i,r,a,s,l){var o=Me.createExplosive(i,r,Ce.dynamite_explosion_radius,e,t,ke.Dynamite,n);return o.source_car=l,Xt.setSpace(o.cbody,a),s.push(o),Xt.updateContainerBody(o.cbody),o},Me.applyExplosionImpulseToBodies=function(e,t,n,i,r,a,s,l,o,_){null==_&&(_=.6),null==o&&(o=10),null==l&&(l=2),null==s&&(s=1e3),null==a&&(a=350),null==r&&(r=!1),null==i&&(i=300);for(var p=e.bodiesInCircle(n,i,r).iterator();p.hasNext();){var u=p.next();if(-1==t.indexOf(u)){var h=u.get_position().sub(n),c=h.get_length();h.dispose();var d=pa.clamp(1-c/(2*i),0,1),m=ca.linear(1,_,d);u.get_velocity().muleq(m);var f=ca.linear(a,s,d),g=d_.get(0,-f*u.get_mass());u.applyImpulse(g);var v=ca.linear(l,o,d)*u.get_inertia(),b=pa.getRandomSign();u.applyAngularImpulse(v*b),u.isStatic()&&(u.get_userData().just_applied_impulse_length=g.get_length()),u.get_userData().just_exploded=!0,g.dispose()}}},Me.createExplosionEvent=function(e,t){var n=new we;return n.type=t.type,n.source_car=t.source_car,n.space=e.get_space(),n.explosion_center=e.get_position(),n.explosion_radius=t.explosion_radius,n.body_containment=!1,n.min_impulse=t.explosion_min_impulse,n.max_impulse=t.explosion_max_impulse,n.power_add_coeff=t.power_add_coeff,n.one_time_velocity_friction=t.explosion_velocity_friction,n},Me.updateExplosive=function(e,t,n){Xt.updateContainerBody(e.cbody);var i=e.cbody.body;if(e.state==Se.Normal)e.type==ke.Dynamite?(e.dynamite_time_current-=n.dc,e.dynamite_time_current>2*e.dynamite_time?T.gotoFrame(e.animation,0):e.dynamite_time_current>e.dynamite_time?T.gotoFrame(e.animation,1):e.dynamite_time_current>.2*e.dynamite_time?T.gotoFrame(e.animation,2):e.dynamite_time_current<=0&&(e.state=Se.ExplosionExploded,T.replaceAnimationData(e.animation,Os.animation_explosion),e.explosion_events_buffer.push(Me.createExplosionEvent(i,e)),e.current_explosion_time=Ce.total_explosion_time,Xt.setSpace(e.cbody,null))):e.type==ke.Bomb?(e.current_bomb_existance_time+=n.dc,e.current_bomb_existance_time>=Ce.bomb_min_existance_time&&Na.hasCollisionArbiterDynamicBody(i)?(T.replaceAnimationData(e.animation,Os.animation_explosion),i.set_allowMovement(!1),i.set_allowRotation(!1),i.get_velocity().set_x(0),i.get_velocity().set_y(0),i.set_angularVel(0),i.setShapeFilters(zi.no_interaction),e.state=Se.ExplosionExploded,e.explosion_events_buffer.push(Me.createExplosionEvent(i,e)),e.current_explosion_time=Ce.total_explosion_time,Xt.setSpace(e.cbody,null)):T.nextFrameStep(e.animation,n.dc)):e.type==ke.Barrel&&(e.animation=T.createNewAnimation(Os.animation_explosion,!1),e.container.add(e.animation.sprite),T.gotoFrame(e.animation,0),e.state=Se.ExplosionExploded,e.explosion_events_buffer.push(Me.createExplosionEvent(i,e)),e.current_explosion_time=Ce.total_explosion_time,Xt.setSpace(e.cbody,null));else if(e.state==Se.ExplosionExploded)e.state=Se.ExplosionAnimation;else if(e.state==Se.ExplosionAnimation){var r=n.dc;if(2<r&&(r=2),e.current_explosion_time-=r,e.current_explosion_time<=0)return void(e.state=Se.Done);var a=1-e.current_explosion_time/Ce.total_explosion_time,s=Math.floor(ca.linear(0,Os.animation_explosion.frames.length,a));3<=s&&null!=e.hide_sprite&&e.hide_sprite.visible&&(e.hide_sprite.visible=!1),s>=e.animation.data.frames.length&&(s=e.animation.data.frames.length-1),e.animation.sprite.parent.scale.x=2,e.animation.sprite.parent.scale.y=2,T.gotoFrame(e.animation,s)}},Me.createExplosive=function(e,t,n,i,r,a,s,l,o){var _=new Ce;if(_.state=Se.Normal,_.cbody=Xt.createContainerBody(w_.get_DYNAMIC(),l),a!=ke.Bomb&&a!=ke.Dynamite||(_.cbody.body.get_position().set_x(i),_.cbody.body.get_position().set_y(r)),_.init_pos=_.cbody.body.get_position().copy(),(_.type=a)==ke.Bomb){var u=new E_(21);_.cbody.body.get_shapes().add(u),_.animation=T.createNewAnimation(Os.animation_power_bomb_burning,!1)}else if(a==ke.Dynamite){_.dynamite_time_current=3*_.dynamite_time;var h=new j_(j_.box(93.75,52.5));_.cbody.body.get_shapes().add(h),_.cbody.body.setShapeFilters(zi.only_to_ground),_.animation=T.createNewAnimation(Os.animation_power_dynamite,!1)}else a==ke.Barrel?_.hide_sprite=o:xl.trace("warning: unhandled type "+p.string(a),{fileName:"AbilityDo.hx",lineNumber:658,className:"bikas.game.AbilityDo",methodName:"createExplosive"});_.explosion_radius=n,_.explosion_min_impulse=350,_.explosion_max_impulse=1e3,_.power_add_coeff=s,_.container=Ra.createGroup(),null!=_.animation&&_.container.add(_.animation.sprite);var c=new PIXI.Rectangle(-750,-750,1500,1500);return Xt.addDisplayObject(_.cbody,e,t,_.container,c,-1),_},Me.destroyExplosive=function(e,t){null!=e.cbody&&Xt.destroyContainerBody(e.cbody,t,!0),null!=e.animation&&T.destroyAnimation(e.animation),e.animation=null,(e.cbody=null)!=e.init_pos&&(e.init_pos.dispose(),e.init_pos=null)};var Ie=function(){};(n["bikas.game.AdjustTop"]=Ie).__name__=["bikas","game","AdjustTop"],Ie.update=function(e){for(var t=e.level_seconds,n=e.step_size,i=(Ie.adjusts.length,0),r=Ie.adjusts;i<r.length;){var a=r[i];++i,a.update()}for(var s=0,l=Ie.updates.length;s<l;)Ie.updates[s](t,n)||(Ie.updates.splice(s,1),--s,--l),++s},Ie.cancelAll=function(){for(var e=0,t=Ie.adjusts;e<t.length;){var n=t[e];++e,null!=n.onEnd&&n.onEnd()}Ie.adjusts=[],Ie.updates=[]},Ie.prototype={__class__:Ie};var Ae=function(e){this.save={},this.start_time_stamp=0,this.current_wait=0,this.wait_frames_after_start_call=60,this.update_in_progress=!1,this.iteration=0,this.name="",this.onEnd=null,this.name=e};(n["bikas.game.AdjustTimed"]=Ae).__name__=["bikas","game","AdjustTimed"],Ae.prototype={update_start_call:null,update_begin_call:null,update_call:null,update_end_call:null,adjust_var:null,adjust_finish_call:null,onEnd:null,name:null,iteration:null,update_in_progress:null,wait_frames_after_start_call:null,current_wait:null,start_time_stamp:null,save:null,startAdjust:function(){xl.trace("start adjust: "+this.name,{fileName:"AdjustTop.hx",lineNumber:71,className:"bikas.game.AdjustTimed",methodName:"startAdjust"}),-1==Ie.adjusts.indexOf(this)&&Ie.adjusts.push(this),this.iteration=0,this.startUpdate()},startUpdate:function(){this.start_time_stamp=hn.step.level_seconds,this.iteration++,xl.trace("start adjust update: "+this.name+", iteration: "+this.iteration,{fileName:"AdjustTop.hx",lineNumber:81,className:"bikas.game.AdjustTimed",methodName:"startUpdate"}),null!=this.update_start_call&&this.update_start_call(),null!=this.update_call?(this.update_in_progress=!0,this.current_wait=this.wait_frames_after_start_call):this.finishUpdate()},finishUpdate:function(){this.update_in_progress=!1,null!=this.update_end_call&&this.update_end_call(),xl.trace("end adjust update: "+this.name+", iteration: "+this.iteration,{fileName:"AdjustTop.hx",lineNumber:97,className:"bikas.game.AdjustTimed",methodName:"finishUpdate"}),null==this.adjust_var||this.adjust_var()?this.end():this.startUpdate()},end:function(){xl.trace("finish adjust: "+this.name,{fileName:"AdjustTop.hx",lineNumber:109,className:"bikas.game.AdjustTimed",methodName:"end"}),-1!=Ie.adjusts.indexOf(this)&&s.remove(Ie.adjusts,this),null!=this.adjust_finish_call&&this.adjust_finish_call(),null!=this.onEnd&&this.onEnd()},update:function(){if(this.update_in_progress){if(0<this.current_wait){if(this.current_wait--,0!=this.current_wait)return;this.start_time_stamp=hn.step.level_seconds,null!=this.update_begin_call&&this.update_begin_call()}null!=this.update_call&&this.update_call()&&this.finishUpdate()}},__class__:Ae};var Te=function(){};(n["bikas.game.AdjustDo"]=Te).__name__=["bikas","game","AdjustDo"],Te.initRace=function(e,t,n,i){for(var r=0,a=t.baggages;r<a.length;){var s=a[r];++r,s.body.setShapeFilters(zi.only_to_ground)}Gn.initRace(hn.game,hn.step)},Te.all=function(e,t,n){var i=Te.zeroToMaxDrive(e,t,n),r=Te.zeroToMaxNitro(e,t,n),a=Te.jump(e,t,n);return i.adjust_finish_call=function(){r.startAdjust()},r.adjust_finish_call=function(){a.startAdjust()},i.startAdjust(),null},Te.zeroToMaxDrive=function(e,t,n){var i=new Ae("zero to max drive (for time: 0.9s)");return i.update_start_call=function(){Te.initRace(hn.game,e,t,n)},i.update_call=function(){return Ct.drive(e,t,n,1),e.main_body.get_velocity().get_length()>=t.drive_velocity_max},i.update_end_call=function(){xl.trace("impulse: "+t.drive_impulse,{fileName:"AdjustTop.hx",lineNumber:182,className:"bikas.game.AdjustDo",methodName:"zeroToMaxDrive"}),xl.trace("time: "+(hn.step.level_seconds-i.start_time_stamp),{fileName:"AdjustTop.hx",lineNumber:183,className:"bikas.game.AdjustDo",methodName:"zeroToMaxDrive"})},i.adjust_var=function(){if(Math.abs(.9-(hn.step.level_seconds-i.start_time_stamp))<.008333333333333333)return t.info_zero_to_max_drive=hn.step.level_seconds-i.start_time_stamp,St.roundConfigFloats(t),xl.trace(St.getMinimalConfigText(t),{fileName:"AdjustTop.hx",lineNumber:189,className:"bikas.game.AdjustDo",methodName:"zeroToMaxDrive"}),!0;var e=(hn.step.level_seconds-i.start_time_stamp)/.9;return t.drive_impulse*=e,xl.trace("impulse: "+t.drive_impulse,{fileName:"AdjustTop.hx",lineNumber:194,className:"bikas.game.AdjustDo",methodName:"zeroToMaxDrive"}),!1},i},Te.zeroToMaxNitro=function(e,t,n){var i=new Ae("zero to max nitro (for time: 0.5s)");return i.update_start_call=function(){Te.initRace(hn.game,e,t,n)},i.update_call=function(){return Ct.nitro(e,t,n,hn.step.dc),e.main_body.get_velocity().get_length()>=t.nitro_velocity_to_drive_velocity_max_coeff*t.drive_velocity_max},i.update_end_call=function(){xl.trace("impulse: "+t.nitro_impulse,{fileName:"AdjustTop.hx",lineNumber:213,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"}),xl.trace("time: "+(hn.step.level_seconds-i.start_time_stamp),{fileName:"AdjustTop.hx",lineNumber:214,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"})},i.adjust_var=function(){if(Math.abs(.5-(hn.step.level_seconds-i.start_time_stamp))<.008333333333333333)return t.info_zero_to_max_nitro=hn.step.level_seconds-i.start_time_stamp,St.roundConfigFloats(t),xl.trace(St.getMinimalConfigText(t),{fileName:"AdjustTop.hx",lineNumber:220,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"}),!0;var e=(hn.step.level_seconds-i.start_time_stamp)/.5;return t.nitro_impulse*=e,xl.trace("coeff: "+e,{fileName:"AdjustTop.hx",lineNumber:225,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"}),xl.trace("impulse: "+t.nitro_impulse,{fileName:"AdjustTop.hx",lineNumber:226,className:"bikas.game.AdjustDo",methodName:"zeroToMaxNitro"}),!1},i},Te.jump=function(e,t,n){var i=new Ae("jump test (for height = -200)");return i.update_start_call=function(){Gn.initRace(hn.game,hn.step)},i.update_begin_call=function(){var r=e.back_wheel_body.get_position().get_y();i.save.jumpPreviousHeight=r+1,i.save.jumpInitHeight=e.main_body.get_position().get_y(),Ct.jump(e,t,n)},i.update_call=function(){var t=e.main_body.get_position().get_y();return i.save.jumpPreviousHeight<(i.save.jumpPreviousHeight=t)},i.update_end_call=function(){xl.trace("impulse: "+t.jump_impulse,{fileName:"AdjustTop.hx",lineNumber:260,className:"bikas.game.AdjustDo",methodName:"jump"}),xl.trace("time: "+(hn.step.level_seconds-i.start_time_stamp),{fileName:"AdjustTop.hx",lineNumber:261,className:"bikas.game.AdjustDo",methodName:"jump"})},i.adjust_var=function(){var n=e.main_body.get_position().get_y()-i.save.jumpInitHeight;if(-200==Math.round(n))return t.info_max_height_jump_time=hn.step.level_seconds-i.start_time_stamp,t.info_max_height_jump_distance=n,St.roundConfigFloats(t),xl.trace(St.getMinimalConfigText(t),{fileName:"AdjustTop.hx",lineNumber:271,className:"bikas.game.AdjustDo",methodName:"jump"}),!0;var r=-200/n;return 1<r?r*=1-(r-1)/10:r<1&&(r*=1+(1-r)/10),t.jump_impulse*=r,xl.trace("height: "+n,{fileName:"AdjustTop.hx",lineNumber:282,className:"bikas.game.AdjustDo",methodName:"jump"}),xl.trace("coeff: "+r,{fileName:"AdjustTop.hx",lineNumber:283,className:"bikas.game.AdjustDo",methodName:"jump"}),xl.trace("impulse: "+t.jump_impulse,{fileName:"AdjustTop.hx",lineNumber:284,className:"bikas.game.AdjustDo",methodName:"jump"}),!1},i},Te.testZeroToMaxNitroToMaxDrive=function(e,t,n){var i=new Ae("zero to max nitro to max drive");return i.update_start_call=function(){Te.initRace(hn.game,e,t,n),i.save.stage=0},i.update_begin_call=function(){},i.update_call=function(){if(0==i.save.stage)Ct.nitro(e,t,n,hn.step.dc),e.main_body.get_velocity().get_length()>=t.nitro_velocity_to_drive_velocity_max_coeff*t.drive_velocity_max&&(i.save.stage=1,i.save.slowDownTimeStamp=hn.step.level_seconds);else if(1==i.save.stage&&(Ct.drive(e,t,n,1),e.main_body.get_velocity().get_length()<=t.drive_velocity_max+1))return xl.trace("slowed down from max nitro in "+(hn.step.level_seconds-i.save.slowDownTimeStamp),{fileName:"AdjustTop.hx",lineNumber:311,className:"bikas.game.AdjustDo",methodName:"testZeroToMaxNitroToMaxDrive"}),!0;return!1},i.adjust_var=function(){return!0},i},Te.testRotate=function(e,t,n){var i=new Ae("test rotate(1): "+e.name);return i.update_start_call=function(){i.save.gravity=hn.game.world.space.get_gravity().get_y(),i.save.previousRotation=0,i.save.rotationAccumulated=0,i.save.appliedTimes=0,i.save.appliedPI=0,i.save.angularMaxTraced=!1,hn.game.world.space.get_gravity().set_y(0),i.save.piRotationTime=-1,Tt.setDeltaPosition(e,0,-500),Tt.setVelocity(e,0,0),Tt.setRotation(e,0)},i.update_begin_call=function(){i.save.totalTime=hn.step.level_seconds},i.update_call=function(){return i.save.rotationAccumulated+=e.main_body.get_rotation()-i.save.previousRotation,i.save.previousRotation=e.main_body.get_rotation(),i.save.angularMaxTraced||e.main_body.get_angularVel()>=t.rotation_angular_velocity_max-.1&&(i.save.angularMaxTraced=!0,xl.trace("reached max angular velocity time: "+(hn.step.level_seconds-i.save.totalTime),{fileName:"AdjustTop.hx",lineNumber:348,className:"bikas.game.AdjustDo",methodName:"testRotate"}),xl.trace("reached max angular velocity rotation: "+Math.round(i.save.rotationAccumulated/Math.PI*180*10)/10,{fileName:"AdjustTop.hx",lineNumber:349,className:"bikas.game.AdjustDo",methodName:"testRotate"}),xl.trace("reached max angular velocity rotate(1) count: "+p.string(i.save.appliedTimes),{fileName:"AdjustTop.hx",lineNumber:350,className:"bikas.game.AdjustDo",methodName:"testRotate"})),i.save.rotationAccumulated>=2*Math.PI||(i.save.rotationAccumulated>Math.PI/2&&-1==i.save.piRotationTime?(i.save.piRotationTime=hn.step.level_seconds,i.save.appliedPI=i.save.appliedTimes):i.save.rotationAccumulated>3*Math.PI/2&&0!=i.save.piRotationTime&&(xl.trace("Math.PI/2 -> Math.PI*3/2, rotation time: "+(hn.step.level_seconds-i.save.piRotationTime),{fileName:"AdjustTop.hx",lineNumber:361,className:"bikas.game.AdjustDo",methodName:"testRotate"}),xl.trace("Math.PI/2 -> Math.PI*3/2, angularVel: "+e.main_body.get_angularVel(),{fileName:"AdjustTop.hx",lineNumber:362,className:"bikas.game.AdjustDo",methodName:"testRotate"}),xl.trace("Math.PI/2 -> Math.PI*3/2, rotate(1) count: "+(i.save.appliedTimes-i.save.appliedPI),{fileName:"AdjustTop.hx",lineNumber:363,className:"bikas.game.AdjustDo",methodName:"testRotate"}),i.save.piRotationTime=0),Ct.rotate(e,t,1),i.save.appliedTimes++,!1)},i.update_end_call=function(){xl.trace("0 -> Math.PI*2, rotation time: "+(hn.step.level_seconds-i.save.totalTime),{fileName:"AdjustTop.hx",lineNumber:372,className:"bikas.game.AdjustDo",methodName:"testRotate"}),xl.trace("0 -> Math.PI*2, angularVel: "+e.main_body.get_angularVel(),{fileName:"AdjustTop.hx",lineNumber:373,className:"bikas.game.AdjustDo",methodName:"testRotate"}),xl.trace("0 -> Math.PI*2, rotate(1) count: "+p.string(i.save.appliedTimes),{fileName:"AdjustTop.hx",lineNumber:374,className:"bikas.game.AdjustDo",methodName:"testRotate"})},i.adjust_var=function(){return hn.game.world.space.get_gravity().set_y(i.save.gravity),!0},i};var De=n["bikas.game.AttachmentType"]={__ename__:["bikas","game","AttachmentType"],__constructs__:["AttachmentBalloon","AttachmentAnchor"]};De.AttachmentBalloon=["AttachmentBalloon",0],De.AttachmentBalloon.toString=i,(De.AttachmentBalloon.__enum__=De).AttachmentAnchor=["AttachmentAnchor",1],De.AttachmentAnchor.toString=i,(De.AttachmentAnchor.__enum__=De).__empty_constructs__=[De.AttachmentBalloon,De.AttachmentAnchor];var Ee=function(){this.baggages=[],this.anti_gravity_bodies=[],this.anti_gravity_current=d_.get(0,0),this.anti_gravity=d_.get(0,0),this.pivot_joints_to_main_body=[],this.all_pivot_joints=[],this.disconnect_in_seconds=-1};(n["bikas.game.Attachment"]=Ee).__name__=["bikas","game","Attachment"],Ee.prototype={type:null,prefab:null,disconnect_in_seconds:null,all_pivot_joints:null,pivot_joints_to_main_body:null,anti_gravity:null,anti_gravity_current:null,anti_gravity_bodies:null,baggages:null,__class__:Ee};var Oe=function(){};(n["bikas.game.AttachmentDo"]=Oe).__name__=["bikas","game","AttachmentDo"],Oe.createBalloons=function(e,t,n){null==n&&(n=-1);var i=new Ee;i.type=De.AttachmentBalloon,i.prefab=e,i.disconnect_in_seconds=n;var r=i.prefab.group.entities,a=Oe.findEntity(r,"connection_pivot_joint");i.anti_gravity.set_y(-200);for(var s=1;s<4;){var l=s++,o=Oe.findEntity(r,"balloon"+l),_=Oe.findEntity(r,"balloon_line"+l),p=Oe.findEntity(r,"pivot_joint"+l);o.body.setShapeMaterials($i.balloons),_.body.setShapeMaterials($i.balloons_line),o.body.setShapeFilters(zi.car_baggage_self),null!=t.get_group()&&o.body.set_group(t.get_group()),i.baggages.push(o.body),_.body.setShapeFilters(zi.no_interaction);var u=Oe.connectBodies(_.body,o.body,p.position),h=Oe.connectBodies(_.body,t,a.position);i.all_pivot_joints.push(u),i.all_pivot_joints.push(h),i.pivot_joints_to_main_body.push(h),i.anti_gravity_bodies.push(o.body)}return i},Oe.createAnchor=function(e,t,n){null==n&&(n=-1);var i=new Ee;i.type=De.AttachmentAnchor,i.prefab=e,i.disconnect_in_seconds=n;var r=i.prefab.group.entities,a=Oe.findEntity(r,"anchor"),s=Oe.findEntity(r,"anchor_rope1"),l=Oe.findEntity(r,"anchor_rope2"),o=Oe.findEntity(r,"anchor_rope3");a.body.setShapeMaterials($i.anchor),s.body.setShapeMaterials($i.anchor_line),l.body.setShapeMaterials($i.anchor_line),o.body.setShapeMaterials($i.anchor_line),a.body.setShapeFilters(zi.only_to_ground),s.body.setShapeFilters(zi.only_to_ground),l.body.setShapeFilters(zi.only_to_ground),o.body.setShapeFilters(zi.only_to_ground);var _=Oe.findEntity(r,"pivot1"),p=Oe.findEntity(r,"pivot2"),u=Oe.findEntity(r,"pivot3"),h=Oe.findEntity(r,"connection"),c=Oe.connectBodies(s.body,l.body,_.position),d=Oe.connectBodies(l.body,o.body,p.position),m=Oe.connectBodies(o.body,a.body,u.position),f=Oe.connectBodies(s.body,t,h.position);return i.all_pivot_joints.push(c),i.all_pivot_joints.push(d),i.all_pivot_joints.push(m),i.all_pivot_joints.push(f),i.pivot_joints_to_main_body.push(f),i},Oe.findEntity=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i}return xl.trace("warning: couldn't find "+t,{fileName:"AttachmentDo.hx",lineNumber:113,className:"bikas.game.AttachmentDo",methodName:"findEntity"}),null},Oe.connectBodies=function(e,t,n){var i=d_.get(n.x,n.y),r=e.worldPointToLocal(i),a=t.worldPointToLocal(i),s=new Bo(e,t,r,a);return s.set_frequency(10),s.set_damping(1),i.dispose(),s},Oe.disconnectAttachment=function(e){for(var t=0,n=e.baggages;t<n.length;){var i=n[t];++t,i.set_group(null),i.setShapeFilters(zi.only_to_ground)}for(var r=0,a=e.pivot_joints_to_main_body;r<a.length;){var s=a[r];++r,null!=s.get_space()&&s.set_space(null)}},Oe.destroy=function(e){e.prefab=null,e.all_pivot_joints=null,(e.pivot_joints_to_main_body=null)!=e.anti_gravity&&(e.anti_gravity.dispose(),e.anti_gravity=null),null!=e.anti_gravity_current&&(e.anti_gravity_current.dispose(),e.anti_gravity_current=null),e.anti_gravity_bodies=null},Oe.setSpace=function(e,t){for(var n=0,i=e.all_pivot_joints;n<i.length;){var r=i[n];++n,r.get_space()!=t&&r.set_space(t)}},Oe.update=function(e,t,n){for(var i=0,r=e.anti_gravity_bodies;i<r.length;){var a=r[i];++i,e.anti_gravity_current.set_x(e.anti_gravity.get_x()*n),e.anti_gravity_current.set_y(e.anti_gravity.get_y()*n),a.applyImpulse(e.anti_gravity_current)}-1!=e.disconnect_in_seconds&&(e.disconnect_in_seconds-=t,e.disconnect_in_seconds<=0&&(e.disconnect_in_seconds=-1,Oe.disconnectAttachment(e)))};var Be=function(){this.all_sprites=[],this.horizontal_waves=[],this.background_sprites=[],this.plane=new Le,this.camera=new ji,this.eye=new ji,this.sprite_and_position_map=new Ml,this.sprite_and_description_map=new Ml};(n["bikas.game.Background"]=Be).__name__=["bikas","game","Background"],Be.prototype={level:null,background_objects:null,sprite_and_description_map:null,sprite_and_position_map:null,plane_container:null,background_container:null,foreground_container:null,eye:null,camera:null,plane:null,default_fov_z:null,current_fov_z:null,y:null,background_sprites:null,horizontal_waves:null,all_sprites:null,__class__:Be};var Le=function(){this.points=[]};(n["bikas.game.BackgroundPlane"]=Le).__name__=["bikas","game","BackgroundPlane"],Le.prototype={flat:null,sky:null,sky_min_height:null,points:null,__class__:Le};var je=function(){this.invisible_waves=[],this.visible_waves=[],this.additional_scale=1};(n["bikas.game.BackgroundHorizontalSeaWaves"]=je).__name__=["bikas","game","BackgroundHorizontalSeaWaves"],je.prototype={texture:null,z:null,z_max:null,additional_scale:null,visible_waves:null,invisible_waves:null,__class__:je};var Fe=function(){this.additional_scale=1,this.current_wave_time=0,this.max_wave_time=60,this.z_max=0,this.z_min=0};(n["bikas.game.BackgroundSeaWave"]=Fe).__name__=["bikas","game","BackgroundSeaWave"],Fe.prototype={sprite:null,z_min:null,z_max:null,max_wave_time:null,current_wave_time:null,additional_scale:null,__class__:Fe};var Re=function(){this.offset_y=0,this.offset_x=0,this.scale_z=800};(n["bikas.game.BackgroundObjectDescription"]=Re).__name__=["bikas","game","BackgroundObjectDescription"],Re.prototype={name:null,scale_z:null,offset_x:null,offset_y:null,__class__:Re};var Ge=function(){};(n["bikas.game.BackgroundObjectPosition"]=Ge).__name__=["bikas","game","BackgroundObjectPosition"],Ge.prototype={name:null,z:null,x:null,y:null,__class__:Ge};var Ze=function(){this.positions=[]};(n["bikas.game.BackgroundLevelObjects"]=Ze).__name__=["bikas","game","BackgroundLevelObjects"],Ze.prototype={level_name:null,positions:null,__class__:Ze};var Ue=function(){this.levels=[],this.descriptions=[]};(n["bikas.game.BackgroundObjects"]=Ue).__name__=["bikas","game","BackgroundObjects"],Ue.prototype={descriptions:null,levels:null,__class__:Ue};var Ve=function(){};(n["bikas.game.BackgroundDo"]=Ve).__name__=["bikas","game","BackgroundDo"],Ve.createBackground=function(e,t,n,i,r){null==e&&(e=800);var a=new Be;return a.plane_container=Ra.createGroup(),a.background_container=Ra.createGroup(),a.foreground_container=Ra.createGroup(),a.default_fov_z=e,a.current_fov_z=e,a.eye.z=a.current_fov_z,a.plane.flat=t,a.plane.sky=n,a.plane.sky_min_height=r,Ve.setBackgroundY(a,i),-1==a.plane_container.children.indexOf(n)&&a.plane_container.add(n),-1==a.plane_container.children.indexOf(t)&&a.plane_container.add(t),a},Ve.destroyBackground=function(e){e.background_container.parent.removeChild(e.background_container),e.plane_container.parent.removeChild(e.plane_container),e.foreground_container.parent.removeChild(e.foreground_container),e.plane.flat.parent.removeChild(e.plane.flat),e.plane.sky.parent.removeChild(e.plane.sky);for(var t=0,n=e.all_sprites;t<n.length;){var i=n[t];++t,i.sprite.parent.removeChild(i.sprite),(p.is(i.sprite,hs)||p.is(i.sprite,us)||p.is(i.sprite,ls))&&i.sprite.destroy(!0)}for(var r=0,a=e.horizontal_waves;r<a.length;){var s=a[r];++r;for(var l=0,o=s.visible_waves;l<o.length;){var _=o[l];++l,_.sprite=null}for(var u=0,h=s.invisible_waves;u<h.length;){var c=h[u];++u,c.sprite=null}s.visible_waves=null,s.invisible_waves=null}for(var d=0,m=e.all_sprites;d<m.length;){var f=m[d];++d,f.init_position=null,f.anchor=null,f.points=null,f.position=null,f.sprite=null}e.plane.flat.destroy(!0),e.plane.sky.destroy(!0),e.background_container.destroy(!0),e.plane_container.destroy(!0),e.foreground_container.destroy(!0),e.eye=null,e.camera=null,e.plane.flat=null,e.plane.sky=null,e.plane=null,e.background_container=null,e.plane_container=null,e.foreground_container=null,e.background_sprites=null,e.horizontal_waves=null,e.sprite_and_description_map=null,e.sprite_and_position_map=null,e.all_sprites=null},Ve.setBackgroundY=function(e,t){e.y=t;var n=rs.createPosition3D(new ji(300,e.y,800)),i=rs.createPosition3D(new ji(700,e.y,800)),r=rs.createPosition3D(new ji(500,e.y,1/0));e.plane.points=[n,i,r];for(var a=0,s=e.all_sprites;a<s.length;){var l=s[a];++a;var o=e.sprite_and_description_map.get(l);l.position.y=n.global.y+o.offset_y,rs.updateSpritePoints(l)}},Ve.serializeBackgroundObjects=function(e){var t="[descriptions]\n";t+="\n";for(var n=0,i=e.descriptions;n<i.length;){var r=i[n];++n,t+=r.name+":"+r.scale_z+","+r.offset_x+","+r.offset_y+";\n"}for(var a=0,s=e.levels;a<s.length;){var l=s[a];++a,t+="\n",t+="[level:"+l.level_name+"]\n",t+="\n";for(var o=0,_=l.positions;o<_.length;){var p=_[o];++o,t+=p.name+":"+p.z+","+p.x+","+p.y+";\n"}}return t},Ve.getBackgroundObjectDefaultZ=function(e,t,n){return e*t/n-e},Ve.getZSpreadOverBackgroundArea=function(e,t,n){for(var i=new ji(0,0,0),r=(new Yr(0,0),[]),a=0,s=e.plane.points;a<s.length;){var l=s[a];++a;var o=ma.copy(l.global);r.push(ma.getProjectionWithCamera(t,i,o))}for(var _=Ve.getPlaneY(e),p=r[0],u=r[2],h=[],c=0,d=n;c<d;){var m=c++,f=new Yr(0,0);f.y=ca.linear(p.y,u.y,(m+1)/(n+1));var g=ma.getPointZUsingY(f,t,i,_);h.push(g)}return h},Ve.getPlaneY=function(e){return e.plane.points[0].global.y},Ve.getPlaneYMax=function(e){return e.plane.points[1].global.y},Ve.getObjectDescription=function(e,t){for(var n=0,i=e.descriptions;n<i.length;){var r=i[n];if(++n,t==r.name)return r}return xl.trace("warning: couldn't find "+t,{fileName:"BackgroundDo.hx",lineNumber:201,className:"bikas.game.BackgroundDo",methodName:"getObjectDescription"}),null},Ve.getLevelByName=function(e,t){for(var n=0,i=e.levels;n<i.length;){var r=i[n];if(++n,r.level_name==t)return r}return xl.trace("warning: couldn't find "+t+" background level",{fileName:"BackgroundDo.hx",lineNumber:211,className:"bikas.game.BackgroundDo",methodName:"getLevelByName"}),null},Ve.overloadBackground=function(e,t,n,i,r){if(e.background_objects=t,e.level=Ve.getLevelByName(e.background_objects,i),null==e.level&&(e.level=Ve.getLevelByName(e.background_objects,n),xl.trace("using 'default' level for background",{fileName:"BackgroundDo.hx",lineNumber:220,className:"bikas.game.BackgroundDo",methodName:"overloadBackground"})),e.sprite_and_description_map=new Ml,e.sprite_and_position_map=new Ml,null!=e.level){var a=e.level.positions;Ve.removeAllSpritesFromContainer(e);for(var l=0,o=e.background_sprites;l<o.length;){var _=o[l];++l,s.remove(e.all_sprites,_),_.sprite.destroy(!0)}e.background_sprites=[];for(var p=0;p<a.length;){var u=a[p];++p;var h=Ve.getObjectDescription(e.background_objects,u.name);null==h&&((h=new Re).scale_z=e.default_fov_z,h.offset_y=0);var c=Ve.pushSprite3D(e,r(u.name),u.x,u.y,u.z,h.scale_z,h.offset_x,h.offset_y);e.background_sprites.push(c),e.sprite_and_description_map.set(c,h),e.sprite_and_position_map.set(c,u)}Ve.addAndSortAllSpritesToContainer(e)}},Ve.parseBackgroundObjects=function(e){for(var t=new Ue,n=da.splitByLines(e),i=0,r=!1,a=0;a<n.length;){var s=n[a];if(++a,r=!1,s=h.replace(s,"\t",""),"[descriptions]"==(s=da.removeSpacesAtStartAndEnd(s)))i=1,r=!0;else if((1==i||2==i)&&-1!=s.indexOf("[level")){var l=h.replace(s,"[level","");l=h.replace(l,":",""),l=h.replace(l,"]","");var o=new Ze;o.level_name=l,t.levels.push(o),i=2,r=!0}if(!r)if(s=h.replace(s," ",""),1==i)for(var _=s.split(";"),u=0;u<_.length;){var c=_[u];if(++u,0<c.length){var d=c.split(":");if(2==d.length){var m=d[0],f=d[1].split(",");if(3==f.length){var g=f[0],v=f[1],b=f[2],y=new Re;y.name=m,y.scale_z=p.parseFloat(g),y.offset_x=p.parseFloat(v),y.offset_y=p.parseFloat(b),t.descriptions.push(y)}}}}else if(2==i)for(var x=s.split(";"),z=0;z<x.length;){var w=x[z];if(++z,0<w.length){var k=w.split(":");if(2==k.length){var S=k[0],C=k[1].split(",");if(3==C.length){var N=C[0],P=C[1],M=C[2],I=new Ge;I.name=S,I.z=p.parseFloat(N),I.x=p.parseFloat(P),I.y=p.parseFloat(M),t.levels[t.levels.length-1].positions.push(I)}}}}}return t},Ve.addWaves=function(e,t,n,i,r){if(t.length==n.length){for(var a=-1/0,s=0;s<n.length;){var l=n[s];++s,a<l&&(a=l)}for(var o=0,_=t.length;o<_;){var p=o++,u=new je;u.z=n[p],u.z_max=a,u.additional_scale=i,u.texture=r(t[p]),e.horizontal_waves.push(u)}}else xl.trace("warning: lengths do not match",{fileName:"BackgroundDo.hx",lineNumber:354,className:"bikas.game.BackgroundDo",methodName:"addWaves"})},Ve.pushWave=function(e,t,n){var i,r=null,a=t.z,s=t.z_max,l=-1300;if(i=0<t.invisible_waves.length?!((r=t.invisible_waves.pop()).sprite.sprite.visible=!0):(r=new Fe,!0),0<t.visible_waves.length)if(n){var o=t.visible_waves[t.visible_waves.length-1].sprite;l=o.points[1].global.x+rs.getSprite3DWidth(o)/2,t.visible_waves.push(r)}else{var _=t.visible_waves[0].sprite;l=_.points[0].global.x-rs.getSprite3DWidth(_)/2,t.visible_waves.unshift(r)}else t.visible_waves.push(r);if(i){var p=Ve.pushSprite3D(e,t.texture,l,0,a,a,0,0);r.sprite=p,r.z_min=a+150,r.z_max=a-150,r.max_wave_time=ca.linear(180,300,a/s),r.current_wave_time=Math.round(Math.random()*r.max_wave_time),r.additional_scale=t.additional_scale}else r.sprite.position.x=l,rs.updateSpritePoints(r.sprite);return rs.applyProjectionAndUpdateSprite3DPosition(r.sprite,e.eye,e.camera),r},Ve.pushSprite3D=function(e,t,n,i,r,a,s,l){null==l&&(l=0),null==s&&(s=0),null==a&&(a=0);var o=s+n,_=Ve.getPlaneY(e)+l+i,p=r,u=a,h=e.default_fov_z,c=Ra.createSprite(t,.5,1),d=rs.createSprite3D(c,new ji(o,_,p),u,h);return Ve.insertSpriteToList(e,d),d},Ve.insertSpriteToList=function(e,t){for(var n=0,i=0,r=e.all_sprites.length;i<r;){var a=i++,s=e.all_sprites[a].init_position.z;if(!(t.init_position.z<=s))break;n=a+1}e.all_sprites.splice(n,0,t)},Ve.insertSpriteToContainer=function(e,t){var n=e.all_sprites.indexOf(t);if(-1!=n)if(0==n)0<t.position.z?e.background_container.addAt(t.sprite,0):e.foreground_container.addAt(t.sprite,0);else{var i=e.all_sprites[n-1];if(0<t.position.z){var r=e.background_container.children.indexOf(i.sprite);-1==r?e.background_container.addAt(t.sprite,0):e.background_container.addAt(t.sprite,r+1)}else{var a=e.foreground_container.children.indexOf(i.sprite);-1==a?e.foreground_container.addAt(t.sprite,0):e.foreground_container.addAt(t.sprite,a+1)}}else xl.trace("error: sprite is not added to all_sprites",{fileName:"BackgroundDo.hx",lineNumber:457,className:"bikas.game.BackgroundDo",methodName:"insertSpriteToContainer"})},Ve.updateSpriteOrderAfterZChanged=function(e,t){var n=e.all_sprites.indexOf(t),i=!1;if(0<n){var r=e.all_sprites[n-1];t.init_position.z>r.init_position.z&&(i=!0)}if(n<e.all_sprites.length-1){var a=e.all_sprites[n+1];t.init_position.z<a.init_position.z&&(i=!0)}0<t.init_position.z?-1==e.background_container.children.indexOf(t.sprite)&&(i=!0):-1==e.foreground_container.children.indexOf(t.sprite)&&(i=!0),i&&(s.remove(e.all_sprites,t),t.sprite.parent.removeChild(t.sprite),Ve.insertSpriteToList(e,t),Ve.insertSpriteToContainer(e,t))},Ve.addAndSortAllSpritesToContainer=function(e){e.all_sprites.sort(rs.sortSpritesByZ);for(var t=0,n=e.all_sprites;t<n.length;){var i=n[t];++t,0<i.position.z?e.background_container.add(i.sprite):e.foreground_container.add(i.sprite)}},Ve.removeAllSpritesFromContainer=function(e){for(var t=0,n=e.all_sprites;t<n.length;){var i=n[t];++t,null!=i.sprite.parent&&i.sprite.parent.removeChild(i.sprite)}},Ve.updateBackground=function(e,t,n,i,r,a){e.eye.x=i,e.eye.y=r,e.eye.z=e.current_fov_z,null!=e.plane&&rs.updatePositions(e.eye,e.camera,e.plane.points);var s=e.plane.points[2];e.plane.flat.y=Math.round(s.projection.y),e.plane.sky.y=e.plane.flat.y,e.plane.flat.width!=t&&(e.plane.flat.width=t,e.plane.sky.width=t);var l=n-e.plane.flat.y;e.plane.flat.height!=l&&(e.plane.flat.height=l);var o=e.plane.flat.y;o<e.plane.sky_min_height&&(o=e.plane.sky_min_height),e.plane.sky.height!=o&&(e.plane.sky.height=o),rs.updateSprites(e.eye,e.camera,e.all_sprites);for(var _=0,p=e.background_sprites;_<p.length;){var u=p[_];++_;var h=u.points[0].projection.x,c=u.points[1].projection.x;u.sprite.visible=!(c<-10||t+10<h)}for(var d=0,m=e.horizontal_waves;d<m.length;){var f=m[d];if(++d,0==f.visible_waves.length){var g=Ve.pushWave(e,f,!0);Ve.insertSpriteToContainer(e,g.sprite)}var v=0,b=f.visible_waves[0].sprite.points[1].projection.x;for(v=0;b<-300;){if(100<v++){xl.trace("warning: loop broke",{fileName:"BackgroundDo.hx",lineNumber:630,className:"bikas.game.BackgroundDo",methodName:"updateBackground"});break}var y=f.visible_waves.shift();if(y.sprite.sprite.visible=!1,f.invisible_waves.push(y),!(0<f.visible_waves.length))break;b=f.visible_waves[0].sprite.points[1].projection.x}if(0==f.visible_waves.length){var x=Ve.pushWave(e,f,!0);Ve.insertSpriteToContainer(e,x.sprite)}var z=f.visible_waves[f.visible_waves.length-1].sprite.points[0].projection.x;for(v=0;t+300<z;){if(100<v++){xl.trace("warning: loop broke",{fileName:"BackgroundDo.hx",lineNumber:654,className:"bikas.game.BackgroundDo",methodName:"updateBackground"});break}var w=f.visible_waves.pop();if(w.sprite.sprite.visible=!1,f.invisible_waves.push(w),!(0<f.visible_waves.length))break;z=f.visible_waves[f.visible_waves.length-1].sprite.points[0].projection.x}if(0==f.visible_waves.length){var k=Ve.pushWave(e,f,!0);Ve.insertSpriteToContainer(e,k.sprite)}var S=f.visible_waves[0].sprite.points[0].projection.x;for(v=0;-100<S;){if(100<v++){xl.trace("warning: loop broke",{fileName:"BackgroundDo.hx",lineNumber:679,className:"bikas.game.BackgroundDo",methodName:"updateBackground"});break}var C=Ve.pushWave(e,f,!1);if(Ve.insertSpriteToContainer(e,C.sprite),!(0<f.visible_waves.length))break;S=f.visible_waves[0].sprite.points[0].projection.x}var N=f.visible_waves[f.visible_waves.length-1].sprite.points[1].projection.x;for(v=0;N<t+100;){if(100<v++){xl.trace("warning: loop broke",{fileName:"BackgroundDo.hx",lineNumber:695,className:"bikas.game.BackgroundDo",methodName:"updateBackground"});break}var P=Ve.pushWave(e,f,!0);if(Ve.insertSpriteToContainer(e,P.sprite),!(0<f.visible_waves.length))break;N=f.visible_waves[f.visible_waves.length-1].sprite.points[1].projection.x}for(var M=0,I=f.visible_waves;M<I.length;){var A=I[M];++M,A.sprite.sprite.visible&&Ve.updateWave(A,a)}}},Ve.updateWave=function(e,t){e.current_wave_time+=t,e.current_wave_time>e.max_wave_time&&(e.current_wave_time=0);var n=e.current_wave_time/e.max_wave_time,i=ca.linear(e.z_min,e.z_max,n);e.sprite.position.z=i;for(var r=0,a=e.sprite.points;r<a.length;){var s=a[r];++r,s.global.z=s.local.z+e.sprite.position.z}e.sprite.sprite.alpha=ca.linearForwardAndBackward(0,1,n);var l=e.sprite.sprite.scale.y;e.sprite.sprite.scale.y=ca.linearForwardAndBackward(.8*l*e.additional_scale,l*e.additional_scale,n)};var qe=function(){};(n["bikas.game.BackgroundSpriteDrop"]=qe).__name__=["bikas","game","BackgroundSpriteDrop"],qe.prototype={description:null,sprite:null,__class__:qe};var We=n["bikas.game.BackgroundUndoType"]={__ename__:["bikas","game","BackgroundUndoType"],__constructs__:["PositionChanged","PositionAdded","PositionRemoved"]};We.PositionChanged=["PositionChanged",0],We.PositionChanged.toString=i,(We.PositionChanged.__enum__=We).PositionAdded=["PositionAdded",1],We.PositionAdded.toString=i,(We.PositionAdded.__enum__=We).PositionRemoved=["PositionRemoved",2],We.PositionRemoved.toString=i,(We.PositionRemoved.__enum__=We).__empty_constructs__=[We.PositionChanged,We.PositionAdded,We.PositionRemoved];var Xe=function(){};(n["bikas.game.BackgroundUndo"]=Xe).__name__=["bikas","game","BackgroundUndo"],Xe.prototype={type:null,original_position:null,position:null,description:null,__class__:Xe};var He=function(){};(n["bikas.game.BackgroundEditTypeButton"]=He).__name__=["bikas","game","BackgroundEditTypeButton"],He.prototype={type:null,name:null,button:null,__class__:He};var Ye=function(e){this.init=new Yr,this.offset=new Yr,this.lods=[],this.sprite=e};(n["bikas.game.Sprite3DDrag"]=Ye).__name__=["bikas","game","Sprite3DDrag"],Ye.prototype={sprite:null,lods:null,offset:null,init:null,object_position:null,object_description:null,text_pos:null,text_len:null,__class__:Ye};var Je=n["bikas.game.BackgroundEditType"]={__ename__:["bikas","game","BackgroundEditType"],__constructs__:["EditZX","EditZ","EditX","EditXY","EditY","EditZXVertical","EditSelect","EditSetOriginalZ"]};Je.EditZX=["EditZX",0],Je.EditZX.toString=i,(Je.EditZX.__enum__=Je).EditZ=["EditZ",1],Je.EditZ.toString=i,(Je.EditZ.__enum__=Je).EditX=["EditX",2],Je.EditX.toString=i,(Je.EditX.__enum__=Je).EditXY=["EditXY",3],Je.EditXY.toString=i,(Je.EditXY.__enum__=Je).EditY=["EditY",4],Je.EditY.toString=i,(Je.EditY.__enum__=Je).EditZXVertical=["EditZXVertical",5],Je.EditZXVertical.toString=i,(Je.EditZXVertical.__enum__=Je).EditSelect=["EditSelect",6],Je.EditSelect.toString=i,(Je.EditSelect.__enum__=Je).EditSetOriginalZ=["EditSetOriginalZ",7],Je.EditSetOriginalZ.toString=i,(Je.EditSetOriginalZ.__enum__=Je).__empty_constructs__=[Je.EditZX,Je.EditZ,Je.EditX,Je.EditXY,Je.EditY,Je.EditZXVertical,Je.EditSelect,Je.EditSetOriginalZ];var Ke=function(){this.drops=[],this.drop_container_original_height=1,this.drop_container_original_width=1,this.js_info_last_height=0,this.js_info_last_width=0,this.positions_elements=[],this.descriptions_elements=[],this.general_elements=[],this.background_edit_type_buttons=[],this.redo_list=[],this.undo_list=[],this.right_mouse_down_point=null,this.last_drag=null,this.current_drag=null,this.drags=[],this.pointer=null,this.basic=null,this.move_to_sides=0,this.pressed=!1,this.camera_pos=new ji,this.camera_drag=new Yr(0,0),this.editing_enabled=!0,this.type=Je.EditZX};(n["bikas.game.BackgroundEdit"]=Ke).__name__=["bikas","game","BackgroundEdit"],Ke.prototype={type:null,editing_enabled:null,element:null,camera_drag:null,camera_pos:null,pressed:null,move_to_sides:null,basic:null,pointer:null,drags:null,current_drag:null,last_drag:null,current_level:null,last_saved:null,right_mouse_down_point:null,undo_list:null,redo_list:null,background_edit_type_buttons:null,general_elements:null,descriptions_elements:null,positions_elements:null,js_info_last_width:null,js_info_last_height:null,drop_background:null,drop_container:null,drop_container_original_width:null,drop_container_original_height:null,drops:null,__class__:Ke};var Qe=function(){};(n["bikas.game.BackgroundEditDo"]=Qe).__name__=["bikas","game","BackgroundEditDo"],Qe.create=function(e,t,n){t.js_info,wa.addText(e,"2.5D Backgrounds",!1,!0),wa.addButton(e,"foreground visibility",(function(){var e=!t.entity_container.visible;t.ground_container.visible=e,t.entity_container.visible=e,t.ingame_container.visible=e,t.ability_item_container.visible=e,t.ongoing_powers_container.visible=e})),wa.addButton(e,"background visibility",(function(){var e=!t.background.background_container.visible;t.background.background_container.visible=e,t.background.foreground_container.visible=e,t.background.plane_container.visible=e})),wa.addButton(e,"print background objects default z",(function(){var e=function(e,n,i,r,a){var s=Ve.getBackgroundObjectDefaultZ(t.background.eye.z,n,i);xl.trace(e+":"+Math.round(s)+","+r+","+a+";",{fileName:"BackgroundEditDo.hx",lineNumber:91,className:"bikas.game.BackgroundEditDo",methodName:"create"})};e("clouds",14800,209,0,-3e3),e("big_volcano",2e4,280,0,1200),e("big_volcano_scale_2",2e4,560,0,1200),e("narrow_volcano",14800,209,0,600),e("long_sand_island",1599.15,76,0,0),e("long_sand_island_scale_3",1599.15,228,0,0),e("long_green_island",1456.35,69,0,0),e("long_green_island_scale_3",1456.35,207,0,0),e("green_island",2009.7,96,0,0),e("green_island_scale_3",2009.7,288,0,0),e("big_sand_island",3200.4,152,0,0),e("big_sand_island_scale_3",3200.4,456,0,0),e("high_sand_island",2733.15,130,0,0),e("high_sand_island_scale_3",2733.15,390,0,0),e("very_big_sand_island",3200.4,152,0,120),e("very_big_sand_island_scale_3",3200.4,456,0,120),e("big_green_island",2009.7,96,0,0),e("big_green_island_scale_3",2009.7,288,0,0),e("sinking_titanic",3664,115,0,1e3),e("sinking_titanic_scale_3",3664,345,0,1e3),e("big_ship",1624.4,69,0,0),e("big_ship_scale_3",1624.4,207,0,0),e("pirate_ship",1600,148,0,0),e("pirate_ship_scale_3",1600,444,0,0),e("sailing_yacht",952.2,96,0,0),e("sailing_yacht_scale_3",952.2,288,0,0),e("fast_yacht",354.7,34,0,0),e("fast_yacht_scale_3",354.7,102,0,0),e("house1",776,388,0,0),e("house1_scale_03",776,116,0,0),e("house1_scale_01",776,39,0,0),e("house2",868,434,0,0),e("house2_scale_03",868,130,0,0),e("house2_scale_01",868,43,0,0),e("house3",838,419,0,0),e("house3_scale_03",838,126,0,0),e("house3_scale_01",838,42,0,0),e("palm_tree1",827,827,0,0),e("palm_tree2",795,795,0,0),e("palm_tree3",849,849,0,0),e("palm_tree4",797,797,0,0)})),wa.addButton(e,"print z spread over background",(function(){for(var e=Ve.getZSpreadOverBackgroundArea(t.background,t.background.eye,13),n=0;n<e.length;){var i=e[n];++n,xl.trace(Math.round(i),{fileName:"BackgroundEditDo.hx",lineNumber:167,className:"bikas.game.BackgroundEditDo",methodName:"create"})}})),wa.addButton(e,"undo",(function(){null!=t.background_edit&&Qe.applyUndoOrRedoAction(t.background_edit,t.background,t.background_edit.undo_list,t.background_edit.redo_list)})),wa.addButton(e,"redo",(function(){null!=t.background_edit&&Qe.applyUndoOrRedoAction(t.background_edit,t.background,t.background_edit.redo_list,t.background_edit.undo_list)}));var i=function(){null!=t.background_edit&&Qe.destroy(t.background_edit),t.background_edit=Qe.createBackgroundEdit(t,e),Qe.addDragAndDropBackgroundEdit(t,t.background_edit)};(t.background_edit=null)!=t.background&&i(),t.temp.levelloads.push(i),t.temp.updates.push((function(){Qe.updateBackgroundEdit(t,t.background_edit)}))},Qe.createBackgroundEdit=function(e,t){var n=new Ke;n.element=t,n.pointer=e.pointer.main_pointer_object,n.last_saved=Os.background_objects_source,n.general_elements.push(wa.addText(t,"Background Edit",!1,!0)),n.general_elements.push(wa.addBoolEdit(t,n,"editing_enabled")),n.general_elements.push(wa.addText(t,"Edit Type (X - Horizontal, Y - Vertical, Z - Distance):",!1,!1)),n.general_elements.push(Qe.createAndAddBackgroundEditTypeButton(n,Je.EditZX,"ZX").button),n.general_elements.push(Qe.createAndAddBackgroundEditTypeButton(n,Je.EditZ,"Z").button),n.general_elements.push(Qe.createAndAddBackgroundEditTypeButton(n,Je.EditX,"X").button),n.general_elements.push(Qe.createAndAddBackgroundEditTypeButton(n,Je.EditXY,"XY").button),n.general_elements.push(Qe.createAndAddBackgroundEditTypeButton(n,Je.EditY,"Y").button),n.general_elements.push(Qe.createAndAddBackgroundEditTypeButton(n,Je.EditZXVertical,"ZXVertical").button),n.general_elements.push(Qe.createAndAddBackgroundEditTypeButton(n,Je.EditSelect,"Select").button),n.general_elements.push(Qe.createAndAddBackgroundEditTypeButton(n,Je.EditSetOriginalZ,"SetOriginalZ").button),n.general_elements.push(wa.addButtonCustom(t,"Move to Left",(function(i){null!=e.background&&(n.move_to_sides=Ke.move_to_sides_speed,t.onmouseup=function(e){n.move_to_sides=0,t.onmouseup=null})}))),n.general_elements.push(wa.addButtonCustom(t,"Move Camera",(function(i){null!=e.background&&(n.camera_drag.x=i.clientX,n.camera_drag.y=i.clientY,n.camera_pos=ma.copy(e.background.camera),n.pressed=!0,t.onmousemove=function(t){n.pressed&&(e.background.camera.x=100*(t.clientX-n.camera_drag.x)+n.camera_pos.x,e.background.camera.y=100*(t.clientY-n.camera_drag.y)+n.camera_pos.y)},t.onmouseup=function(e){n.pressed=!1,t.onmousemove=null,t.onmouseup=null})}),null,100,100)),n.general_elements.push(wa.addButtonCustom(t,"Move to Right",(function(i){null!=e.background&&(n.move_to_sides=-Ke.move_to_sides_speed,t.onmouseup=function(e){n.move_to_sides=0,t.onmouseup=null})}))),Qe.refreshDrags(n.drags,e.background),n.general_elements.push(wa.addButton(t,"Update Background",(function(){for(var t=0,i=n.descriptions_elements;t<i.length;){var r=i[t];++t,r.remove()}n.descriptions_elements=[];for(var a=0,s=n.positions_elements;a<s.length;){var l=s[a];++a,l.remove()}n.positions_elements=[],Os.background_objects_source=Ve.serializeBackgroundObjects(e.background.background_objects),Os.background_objects_obj=Ve.parseBackgroundObjects(Os.background_objects_source),Ve.overloadBackground(e.background,Os.background_objects_obj,"default",e.current_level_save.description.name,(function(e){return _.field(Os,e)})),Qe.refreshDrags(n.drags,e.background)}))),n.general_elements.push(wa.addButton(t,"Save To File",(function(){var t=Ve.serializeBackgroundObjects(e.background.background_objects);Os.background_objects_source=t,n.last_saved=t;var i="assets/saves/background_objects.txt",r=Gn.createPostRequest("http://localhost:8000",i,"String",Os.background_objects_source);r.xhr.send(r.json),xl.trace("sent file to save: "+i,{fileName:"BackgroundEditDo.hx",lineNumber:397,className:"bikas.game.BackgroundEditDo",methodName:"createBackgroundEdit"})}))),n.general_elements.push(wa.addButton(t,"Reload Last Saved",(function(){Os.background_objects_source=n.last_saved,Os.background_objects_obj=Ve.parseBackgroundObjects(Os.background_objects_source);for(var t=0,i=n.descriptions_elements;t<i.length;){var r=i[t];++t,r.remove()}n.descriptions_elements=[];for(var a=0,s=n.positions_elements;a<s.length;){var l=s[a];++a,l.remove()}n.positions_elements=[],Ve.overloadBackground(e.background,Os.background_objects_obj,"default",e.current_level_save.description.name,(function(e){return _.field(Os,e)})),Qe.refreshDrags(n.drags,e.background),xl.trace("background data reloaded",{fileName:"BackgroundEditDo.hx",lineNumber:428,className:"bikas.game.BackgroundEditDo",methodName:"createBackgroundEdit"})})));var i=function(){for(var t=0,i=n.drags;t<i.length;){var r=i[t];++t,Qe.updatePositionView(e.background,r,n.undo_list,n.redo_list)}};return n.general_elements.push(wa.addButton(t,"Edit Descriptions (no undo)",(function(){var r=wa.addScrollBox(t,420,250);n.descriptions_elements.push(r);for(var a=0,s=e.background.background_objects.descriptions;a<s.length;){var l=s[a];++a;var o=wa.addFieldEdit(r,l,"name");null!=n.last_drag&&l.name==n.last_drag.object_description.name&&(o.style.fontWeight="700"),n.descriptions_elements.push(o),n.descriptions_elements.push(wa.addFieldEdit(r,l,"scale_z"," --- scale_z",null,i)),n.descriptions_elements.push(wa.addFieldEdit(r,l,"offset_x"," --- offset_x",null,i)),n.descriptions_elements.push(wa.addFieldEdit(r,l,"offset_y"," --- offset_y",null,i))}n.descriptions_elements.push(wa.addButton(t,"Remove Descriptions",(function(){for(var e=0,t=n.descriptions_elements;e<t.length;){var i=t[e];++e,i.remove()}n.descriptions_elements=[]})))}))),n.general_elements.push(wa.addButton(t,"Edit Positions (no undo)",(function(){var r=wa.addScrollBox(t,420,250);n.positions_elements.push(r);for(var a=0,l=e.background.level.positions;a<l.length;){var o=[l[a]];++a;var _=[wa.addFieldEdit(r,o[0],"name")];null!=n.last_drag&&o[0].name==n.last_drag.object_position.name&&(_[0].style.fontWeight="700");var p=[wa.addFieldEdit(r,o[0],"z","--- z",null,i)],u=[wa.addFieldEdit(r,o[0],"x","--- x",null,i)],h=[wa.addFieldEdit(r,o[0],"y","--- y",null,i)];n.positions_elements.push(_[0]),n.positions_elements.push(p[0]),n.positions_elements.push(u[0]),n.positions_elements.push(h[0]),n.positions_elements.push(wa.addButton(r,"--- remove",function(t,i,r,a,l){return function(){s.remove(n.positions_elements,a[0]),s.remove(n.positions_elements,r[0]),s.remove(n.positions_elements,i[0]),s.remove(n.positions_elements,t[0]),a[0].remove(),r[0].remove(),i[0].remove(),t[0].remove();for(var o=0,_=n.drags;o<_.length;){var p=_[o];if(++o,p.object_position==l[0]){Qe.removeDragObject(e.background_edit,e.background,p,n.undo_list,n.redo_list);break}}}}(h,u,p,_,o)))}n.positions_elements.push(wa.addButton(t,"Remove Positions",(function(){for(var e=0,t=n.positions_elements;e<t.length;){var i=t[e];++e,i.remove()}n.positions_elements=[]})))}))),n},Qe.addDragAndDropBackgroundEdit=function(e,t){for(var n=0,i=e.background.background_objects.descriptions;n<i.length;){var r=i[n];++n;for(var a=Qe.getSpriteNameWithoutScale(r.name),s=!1,l=0,o=t.drops;l<o.length;){var _=o[l];if(++l,a==Qe.getSpriteNameWithoutScale(_.description.name)){s=!0;break}}if(!s){var p=new qe;p.description=r,p.sprite=Ra.createSpriteByName(p.description.name,0,0),t.drops.push(p)}}t.drop_container=Ra.createGroup();for(var u=qe.spacing,h=qe.spacing,c=0,d=0,m=t.drops;d<m.length;){var f=m[d];++d;var g=f.sprite.width/f.sprite.height,v=f.sprite.height/f.sprite.width;f.sprite.height=v<g?(f.sprite.width=qe.max_size,qe.max_size/g):(f.sprite.width=qe.max_size/v,qe.max_size),f.sprite.x=u,f.sprite.y=h,u+=qe.max_size+qe.spacing,qe.count_per_row<++c&&(c=0,h+=qe.max_size+(u=qe.spacing)),t.drop_container.add(f.sprite)}t.drop_container_original_width=t.drop_container.width,t.drop_container_original_height=t.drop_container.height,t.drop_background=Ra.createSprite(Os.menu_background,0,0),t.drop_background.alpha=1,t.drop_background.x=-qe.spacing,t.drop_background.y=-qe.spacing,t.drop_background.width=t.drop_container_original_width+4*qe.spacing,t.drop_background.height=t.drop_container_original_height+4*qe.spacing,t.drop_container.addAt(t.drop_background,0),e.menu_container.add(t.drop_container)},Qe.destroy=function(e){for(var t=0,n=e.general_elements;t<n.length;){var i=n[t];++t,i.remove()}for(var r=0,a=e.descriptions_elements;r<a.length;){var s=a[r];++r,s.remove()}for(var l=0,o=e.positions_elements;l<o.length;){var _=o[l];++l,_.remove()}for(var p=0,u=e.drops;p<u.length;){var h=u[p];++p,h.sprite.parent.removeChild(h.sprite),h.sprite.destroy(!0)}e.drop_container.destroy(!0),e.drop_container=null,e.element=null,e.camera_drag=null,e.camera_pos=null,e.basic=null,e.drags=null,e.current_drag=null,e.last_drag=null,e.background_edit_type_buttons=null,e.general_elements=null,e.descriptions_elements=null,e.positions_elements=null,e.drops=null},Qe.updateBackgroundEdit=function(e,t){if(null!=e.background&&null!=e.background_edit){var n=t.pointer,i=e.step.dc,r=e.js_info;if(0<Math.abs(t.move_to_sides)&&(e.background.camera.x+=t.move_to_sides*i),null!=t.drop_container&&(t.js_info_last_width!=r.current_game_width||t.js_info_last_height!=r.current_game_height)){t.js_info_last_width=r.current_game_width,t.js_info_last_height=r.current_game_height;var a=qe.max_width_offset+r.current_game_width,s=qe.max_height,l=a/t.drop_container_original_width,o=s/t.drop_container_original_height;t.drop_container.height=l<o?(t.drop_container.width=t.drop_container_original_width*l,t.drop_container_original_height*l):(t.drop_container.width=t.drop_container_original_width*o,t.drop_container_original_height*o),t.drop_container.x=qe.offset_x,t.drop_container.y=qe.offset_y}var _=t.editing_enabled&&!Ni.isPressed(e.keyboard_keys_pressed,16);if(t.drop_container.visible=!!_,_){var p=Xs.right_mouse_button_down;if(!p&&null!=t.right_mouse_down_point){var u=Qe.getClosestSpriteOverPointer(n,t.drags);if(null!=u)return Qe.removeDragObject(t,e.background,u,t.undo_list,t.redo_list),void(t.right_mouse_down_point=null)}t.right_mouse_down_point=p?n.current:null}if(n.state==qa.DOWNED&&_){var h=Qe.getClosestDropOverPointer(n,t.drops);if(null!=h){var c=h.description,d=e.background.eye,m=e.background.camera,f=n.current,g=Ve.getPlaneY(e.background),v=ma.getPointZUsingY(f,d,m,g),b=ma.getPointXUsingZ(f,d,m,v),y=new Ge;y.name=c.name,y.x=b,y.y=0,y.z=v;for(var x=Qe.pushNewBackgroundPositionObject(t,e.background,c,y,t.undo_list,t.redo_list),z=0,w=t.drags;z<w.length;){var k=w[z];if(++z,k.sprite==x){t.current_drag=k;break}}}if(null==h&&(t.current_drag=Qe.getClosestSpriteOverPointer(n,t.drags)),null!=t.current_drag)if(t.last_drag=t.current_drag,t.type==Je.EditSelect)null!=t.current_drag&&(t.current_drag=null);else if(t.type==Je.EditSetOriginalZ)null!=t.current_drag&&(t.current_drag.sprite.position.z=t.current_drag.object_description.scale_z,fa.set(t.current_drag.sprite.init_position,t.current_drag.sprite.position),rs.updateSpritePoints(t.current_drag.sprite),Ve.updateSpriteOrderAfterZChanged(e.background,t.current_drag.sprite),Qe.updatePosition(e.background,t.current_drag,t.undo_list,t.redo_list),t.current_drag=null);else{var S=ma.getProjectionWithCamera(e.background.eye,e.background.camera,t.current_drag.sprite.position);t.current_drag.offset.x=S.x-n.current.x,t.current_drag.offset.y=S.y-n.current.y,t.current_drag.init.x=S.x,t.current_drag.init.y=S.y}}if(null!=t.current_drag){var C=n.current.x+t.current_drag.offset.x,N=n.current.y+t.current_drag.offset.y,P=t.current_drag.sprite.position,M=e.background.eye,I=e.background.camera,A=new Yr(C,N);if(e.background_edit.type==Je.EditZX)P.z=ma.getPointZUsingY(A,M,I,P.y),P.x=ma.getPointXUsingZ(A,M,I,P.z);else if(e.background_edit.type==Je.EditZ)P.z=ma.getPointZUsingY(A,M,I,P.y);else if(e.background_edit.type==Je.EditX){A.y=t.current_drag.init.y;var T=ma.getPointZUsingY(A,M,I,P.y);P.x=ma.getPointXUsingZ(A,M,I,T)}else e.background_edit.type==Je.EditXY?(P.x=ma.getPointXUsingZ(A,M,I,P.z),P.y=ma.getPointYUsingZ(A,M,I,P.z)):e.background_edit.type==Je.EditY?(A.x=t.current_drag.init.x,P.y=ma.getPointYUsingZ(A,M,I,P.z)):e.background_edit.type==Je.EditZXVertical&&(A.x=t.current_drag.init.x,P.z=ma.getPointZUsingY(A,M,I,P.y),P.x=ma.getPointXUsingZ(A,M,I,P.z));P.z=Math.round(P.z),P.x=Math.round(P.x),P.y=Math.round(P.y),Qe.updateDragObjectAfterDrag(t,e.background,t.current_drag)}n.state==qa.UPPED&&null!=t.current_drag&&null!=t.current_drag.sprite&&null!=t.current_drag.sprite.sprite.parent&&(Qe.updatePosition(e.background,t.current_drag,t.undo_list,t.redo_list),t.current_drag=null)}},Qe.createAndAddBackgroundEditTypeButton=function(e,t,n){var i=new He;i.type=t,i.name=n;var r="#ACACAC",a="#000000";return i.button=wa.addButton(e.element,n,(function(){for(var t=0,n=e.background_edit_type_buttons;t<n.length;){var s=n[t];++t,s.button.style.color=r}e.type=i.type,i.button.style.color=a})),i.button.style.fontWeight="800",t==e.type?i.button.style.color=a:i.button.style.color=r,e.background_edit_type_buttons.push(i),i},Qe.updateDragObjectAfterDrag=function(e,t,n){for(var i=n.sprite.position,r=n.lods[0],a=0,s=n.lods;a<s.length;){var l=s[a];++a,Math.abs(i.z-l.scale_z)<Math.abs(i.z-r.scale_z)&&(r=l)}n.object_description!=r&&(rs.replaceSprite(n.sprite,Zs.getTexture(r.name),r.scale_z,t.default_fov_z),n.object_description=r,n.object_position.name=r.name),fa.set(n.sprite.init_position,i),rs.updateSpritePoints(n.sprite),Ve.updateSpriteOrderAfterZChanged(t,n.sprite)},Qe.getSpriteNameWithoutScale=function(e){var t=e.indexOf("_scale_");return-1!=t?e.substring(0,t):e},Qe.pushNewBackgroundPositionObject=function(e,t,n,i,r,a){t.level.positions.push(i);var s=Ve.pushSprite3D(t,Zs.getTexture(i.name),i.x,i.y,i.z,n.scale_z,n.offset_x,n.offset_y);Ve.insertSpriteToContainer(t,s),t.background_sprites.push(s),t.sprite_and_description_map.set(s,n),t.sprite_and_position_map.set(s,i),Qe.refreshDrags(e.drags,t);var l=new Xe;return l.description=n,l.original_position=i,l.position=i,l.type=We.PositionAdded,r.push(l),null!=a&&a.splice(0,a.length),s},Qe.removeDragObject=function(e,t,n,i,r){var a=new Xe;a.description=n.object_description,a.original_position=n.object_position,a.position=n.object_position,a.type=We.PositionRemoved,i.push(a),s.remove(e.drags,n),e.current_drag==n&&(e.current_drag=null),s.remove(t.level.positions,n.object_position),t.sprite_and_description_map.remove(n.sprite),t.sprite_and_position_map.remove(n.sprite),s.remove(t.background_sprites,n.sprite),s.remove(t.all_sprites,n.sprite),n.sprite.sprite.parent.removeChild(n.sprite.sprite),n.sprite.sprite.destroy(!0),null!=r&&r.splice(0,r.length)},Qe.applyUndoOrRedoAction=function(e,t,n,i){if(0!=n.length){for(var r=n.pop(),a=null,s=0,l=e.drags;s<l.length;){var o=l[s];if(++s,o.object_position==r.original_position){a=o;break}}if(r.type==We.PositionChanged)if(null!=a){var _=Math.round(r.position.x+a.object_description.offset_x),u=Math.round(r.position.y+Ve.getPlaneY(t)+a.object_description.offset_y),h=Math.round(r.position.z);a.sprite.position.x=_,a.sprite.position.y=u,a.sprite.position.z=h,Qe.updatePosition(t,a,i),Qe.updateDragObjectAfterDrag(e,t,a)}else xl.trace("warning: drag object not found for "+r.position.name,{fileName:"BackgroundEditDo.hx",lineNumber:1034,className:"bikas.game.BackgroundEditDo",methodName:"applyUndoOrRedoAction"});else r.type==We.PositionAdded?null!=a?Qe.removeDragObject(e,t,a,i):xl.trace("warning: drag object not found for "+r.position.name,{fileName:"BackgroundEditDo.hx",lineNumber:1043,className:"bikas.game.BackgroundEditDo",methodName:"applyUndoOrRedoAction"}):r.type==We.PositionRemoved?Qe.pushNewBackgroundPositionObject(e,t,r.description,r.position,i):xl.trace("warning: unhandled "+p.string(r.type),{fileName:"BackgroundEditDo.hx",lineNumber:1053,className:"bikas.game.BackgroundEditDo",methodName:"applyUndoOrRedoAction"})}},Qe.refreshDrags=function(e,t){var n=t.background_sprites,i=t.background_objects.descriptions;e.splice(0,e.length);for(var r=0;r<n.length;){var a=n[r];++r;var s=new Ye(a);s.object_description=t.sprite_and_description_map.get(a),s.object_position=t.sprite_and_position_map.get(a),s.lods.push(s.object_description);for(var l=s.object_description.name,o=Qe.getSpriteNameWithoutScale(l),_=0;_<i.length;){var p=i[_];++_;var u=Qe.getSpriteNameWithoutScale(p.name);p.name!=l&&o==u&&s.lods.push(p)}e.push(s)}},Qe.updatePositionView=function(e,t,n,i){var r=t.object_position.x+t.object_description.offset_x,a=t.object_position.y+Ve.getPlaneY(e)+t.object_description.offset_y,s=t.object_position.z,l=t.sprite.position;l.x=r,l.y=a,l.z=s,fa.set(t.sprite.init_position,l),rs.updateSpritePoints(t.sprite),Ve.updateSpriteOrderAfterZChanged(e,t.sprite)},Qe.updatePosition=function(e,t,n,i){var r=t.sprite.position,a=Math.round(r.x-t.object_description.offset_x),s=Math.round(r.y-Ve.getPlaneY(e)-t.object_description.offset_y),l=Math.round(r.z),o=t.object_position;if(o.z!=l||o.x!=a||o.y!=s){var _=new Xe;_.description=t.object_description,_.original_position=o,_.position=new Ge,_.position.name=o.name,_.position.x=o.x,_.position.y=o.y,_.position.z=o.z,_.type=We.PositionChanged,n.push(_),null!=i&&i.splice(0,i.length)}o.z=l,o.x=a,o.y=s},Qe.getClosestDropOverPointer=function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;var r=e.current,a=Ra.getContainerBounds(i.sprite);if(pa.pointInRectangle(r,a))return i}return null},Qe.getClosestSpriteOverPointer=function(e,t){for(var n=[],i=0;i<t.length;){var r=t[i];++i;var a=e.current,s=r.sprite.sprite,l=Ra.getContainerBounds(s);pa.pointInRectangle(a,l)&&(Ra.isSprite(s)&&xl.trace("TODO: detect pixels under mouse",{fileName:"BackgroundEditDo.hx",lineNumber:1220,className:"bikas.game.BackgroundEditDo",methodName:"getClosestSpriteOverPointer"}),n.push(r))}if(0<n.length){for(var o=n[0],_=0;_<n.length;){var p=n[_];++_,p.sprite.position.z<o.sprite.position.z&&(o=p)}return o}return null};var $e=function(e,t,n,i){this.min=e,this.mid=t,this.max=n,this.current=i};(n["bikas.game.Range"]=$e).__name__=["bikas","game","Range"],$e.prototype={min:null,mid:null,max:null,current:null,__class__:$e};var et=function(){this.count_to_zero=0,this.count=0,this.direction=1};(n["bikas.game.FastestRotation"]=et).__name__=["bikas","game","FastestRotation"],et.prototype={direction:null,count:null,count_to_zero:null,__class__:et};var tt=function(e,t,n,i){null==i&&(i=.1),null==n&&(n=.8),null==t&&(t=.3),null==e&&(e=.9),this.panic=new $e(0,.5,1,.1),this.crazyness=new $e(0,.5,1,.8),this.aggression=new $e(0,.5,1,.3),this.ability=new $e(0,.5,1,.9),this.ability.current=e,this.aggression.current=t,this.crazyness.current=n,this.panic.current=i};(n["bikas.game.Personality"]=tt).__name__=["bikas","game","Personality"],tt.prototype={ability:null,aggression:null,crazyness:null,panic:null,__class__:tt};var nt=function(e,t,n,i){this.target_mood=e,this.coeff=t,this.duration=i,this.end_time_stamp=n+i};(n["bikas.game.MoodEvent"]=nt).__name__=["bikas","game","MoodEvent"],nt.prototype={target_mood:null,coeff:null,duration:null,end_time_stamp:null,update:function(e){var t=(this.end_time_stamp-e)/this.duration;return t<0?(this.target_mood.current=this.target_mood.min,!1):(this.target_mood.current=this.target_mood.min+t*this.coeff*(this.target_mood.max-this.target_mood.min),!0)},__class__:nt};var it=function(){this.on_stop=null,this.decision_end_time_stamp=0,this.decision_made_time_stamp=0,this.in_progress=!1,this.allow=!0};(n["bikas.game.Decision"]=it).__name__=["bikas","game","Decision"],it.prototype={allow:null,in_progress:null,make_every:null,do_for:null,decision_made_time_stamp:null,decision_end_time_stamp:null,on_stop:null,__class__:it};var rt=function(){this.rotation_direction_cache=1,this.starting_angle_cache=0,this.additional_started=!1,this.initial_started=!1,it.call(this),this.make_every=new $e(.03333333333333333,.1,.3,.1),this.do_for=new $e(2,4,6,4)};(n["bikas.game.UnstuckDecision"]=rt).__name__=["bikas","game","UnstuckDecision"],rt.__super__=it,rt.prototype=r(it.prototype,{initial_started:null,additional_started:null,starting_angle_cache:null,rotation_direction_cache:null,__class__:rt});var at=function(){this.recover_mode=!1,this.fastest_way_cache=null,this.rotation_trigger=.16666666666666666*Math.PI,this.wheels_off_time_min=.2,it.call(this),this.make_every=new $e(.03333333333333333,.5,2,.03333333333333333),this.do_for=new $e(5,8,10,8)};(n["bikas.game.AirRotationDecision"]=at).__name__=["bikas","game","AirRotationDecision"],at.__super__=it,at.prototype=r(it.prototype,{wheels_off_time_min:null,rotation_trigger:null,fastest_way_cache:null,recover_mode:null,rotate_until_angle:null,rotate_direction:null,__class__:at});var st=function(){this.wheel_index_cache=0,this.angular_velocity_trigger_max=1,this.rotation_trigger=Math.PI/12,this.other_wheel_off_time=.06666666666666667,this.main_wheel_off_time=.2,it.call(this),this.make_every=new $e(.2,.3,.4,.3),this.do_for=new $e(.016666666666666666,.03333333333333333,.05,.016666666666666666)};(n["bikas.game.GroundRotationDecision"]=st).__name__=["bikas","game","GroundRotationDecision"],st.__super__=it,st.prototype=r(it.prototype,{main_wheel_off_time:null,other_wheel_off_time:null,rotation_trigger:null,angular_velocity_trigger_max:null,wheel_index_cache:null,__class__:st});var lt=function(){this.direction_cache=1,it.call(this),this.make_every=new $e(.5,2,4,2),this.do_for=new $e(.016666666666666666,.06666666666666667,.1,.016666666666666666)};(n["bikas.game.RandomRotationDecision"]=lt).__name__=["bikas","game","RandomRotationDecision"],lt.__super__=it,lt.prototype=r(it.prototype,{direction_cache:null,__class__:lt});var ot=function(){this.chance_of_activation=new $e(.1,.5,1,.5),it.call(this),this.make_every=new $e(3,15,30,15)};(n["bikas.game.RandomJumpDecision"]=ot).__name__=["bikas","game","RandomJumpDecision"],ot.__super__=it,ot.prototype=r(it.prototype,{chance_of_activation:null,__class__:ot});var _t=function(){this.angle_progress_cache=0,this.angle_cache=0,this.direction_cache=1,this.distance_from_ground_min=new $e(350,500,1200,350),this.air_time_min=new $e(.1,.2,.5,.2),this.rotation_max=Math.PI/6,this.velocity_down_max=200,it.call(this),this.make_every=new $e(.2,1,2,.2),this.do_for=new $e(100,100,100,100)};(n["bikas.game.FlipDecision"]=_t).__name__=["bikas","game","FlipDecision"],_t.__super__=it,_t.prototype=r(it.prototype,{velocity_down_max:null,rotation_max:null,air_time_min:null,distance_from_ground_min:null,direction_cache:null,angle_cache:null,angle_progress_cache:null,__class__:_t});var pt=function(){this.chance_of_wheelie=new $e(.2,.5,1,.5),this.wheel_index_cache=0,this.current_rotation_target=.1111111111111111*Math.PI,this.rotation_ok_range=.027777777777777776*Math.PI,this.rotation_target_max=.16666666666666666*Math.PI,this.rotation_target_min=.08333333333333333*Math.PI,this.back_wheel_chance_coeff=.7,this.stable_drive_time=new $e(.5,1.5,4,.5),this.velocity_to_max_coeff_action_cut_min=.8,this.velocity_to_max_coeff_min=.5,this.car_angle_max=5*Math.PI/180,this.accumulated_angle_max=5,it.call(this),this.make_every=new $e(2,4,8,3),this.do_for=new $e(2,3,5,4.4)};(n["bikas.game.WheelieDecision"]=pt).__name__=["bikas","game","WheelieDecision"],pt.__super__=it,pt.prototype=r(it.prototype,{accumulated_angle_max:null,car_angle_max:null,velocity_to_max_coeff_min:null,velocity_to_max_coeff_action_cut_min:null,stable_drive_time:null,back_wheel_chance_coeff:null,rotation_target_min:null,rotation_target_max:null,rotation_ok_range:null,current_rotation_target:null,wheel_index_cache:null,chance_of_wheelie:null,__class__:pt});var ut=function(){this.stable_drive_time=new $e(.03333333333333333,.1,.4,.03333333333333333),it.call(this),this.make_every=new $e(.2,1.5,5,.1),this.do_for=new $e(.3,.7,1,.3)};(n["bikas.game.NitroDecision"]=ut).__name__=["bikas","game","NitroDecision"],ut.__super__=it,ut.prototype=r(it.prototype,{stable_drive_time:null,__class__:ut});var ht=function(){this.chance_of_jump=null,it.call(this),this.make_every=new $e(.1,.3,2,.1)};(n["bikas.game.JumpDecision"]=ht).__name__=["bikas","game","JumpDecision"],ht.__super__=it,ht.prototype=r(it.prototype,{chance_of_jump:null,__class__:ht});var ct=function(){it.call(this),this.make_every=new $e(.1,.3,.5,.1)};(n["bikas.game.AbilityDecision"]=ct).__name__=["bikas","game","AbilityDecision"],ct.__super__=it,ct.prototype=r(it.prototype,{__class__:ct});var dt=function(){this.calculation_time_stamp=0,this.count=0,this.total_velocity=0,this.average_velocity=-1};(n["bikas.game.AverageVelocity"]=dt).__name__=["bikas","game","AverageVelocity"],dt.prototype={average_velocity:null,total_velocity:null,count:null,calculation_time_stamp:null,__class__:dt};var mt=function(){this.average_velocity=new dt,this.front_wheel_off_time=0,this.back_wheel_off_time=0,this.body_collide_time_stamp=0,this.front_wheel_not_collide_time_stamp=0,this.back_wheel_not_collide_time_stamp=0,this.accumulated_angle=0,this.accumulated_angle_check=new it,this.movement_vector=d_.get(),this.angle_changes=[],this.current_position_delta=d_.get(),this.previous_position_delta=d_.get(),this.last_position=d_.get()};(n["bikas.game.BotCache"]=mt).__name__=["bikas","game","BotCache"],mt.prototype={body_angle:null,body_angle_before:null,last_position:null,previous_position_delta:null,current_position_delta:null,angle_changes:null,movement_vector:null,accumulated_angle_check:null,accumulated_angle:null,back_wheel_not_collide_time_stamp:null,front_wheel_not_collide_time_stamp:null,body_collide_time_stamp:null,back_wheel_off_time:null,front_wheel_off_time:null,stable_drive_time_stamp:null,stable_drive_time:null,wheels_off_time:null,distance_x_changed_in_frame:null,average_velocity:null,__class__:mt};var ft=function(){this.ray_cache=null,this.temp_point=d_.get(0,0),this.drive_direction=1,this.finish_time_in_seconds=-1,this.personality_applied=!1,this.constant_drive=!0,this.finished_race=!1,this.behavior_activated=!0,this.active_decisions=[],this.all_decisions=[],this.stunt_decisions=[],this.drive_decisions=[],this.ability_decision=null,this.jump_pickup_decision=null,this.jump_over_decision=null,this.nitro_decision=null,this.wheelie_decision=null,this.flip_decision=null,this.random_jump_decision=null,this.random_rotation_decision=null,this.ground_decision=null,this.air_decision=null,this.unstuck_decision=null,this.mood_events=[]};(n["bikas.game.Bot"]=ft).__name__=["bikas","game","Bot"],ft.prototype={car:null,config:null,cache:null,bot_cache:null,abilities:null,personality:null,mood_events:null,unstuck_decision:null,air_decision:null,ground_decision:null,random_rotation_decision:null,random_jump_decision:null,flip_decision:null,wheelie_decision:null,nitro_decision:null,jump_over_decision:null,jump_pickup_decision:null,ability_decision:null,drive_decisions:null,stunt_decisions:null,all_decisions:null,active_decisions:null,behavior_activated:null,finished_race:null,constant_drive:null,personality_applied:null,finish_time_in_seconds:null,drive_direction:null,current_would_jump_over:null,current_would_not_jump_over:null,current_would_pickup:null,current_would_not_pickup:null,temp_point:null,ray_cache:null,__class__:ft};var gt=function(){};(n["bikas.game.BotDo"]=gt).__name__=["bikas","game","BotDo"],gt.createBot=function(e,t,n,i,r){var a=new ft;a.car=e,a.config=t,a.cache=n,a.abilities=i,a.personality=r;var s=a.bot_cache=new mt;s.accumulated_angle_check.make_every=new $e(.5,.5,.5,.5),e.main_body;for(var l=0;l<60;)l++,s.angle_changes.push(0);return a.ray_cache=new p_(d_.get(),d_.get()),a.ray_cache.get_direction().set_x(0),a.ray_cache.get_direction().set_y(1),a.unstuck_decision=new rt,a.air_decision=new at,a.ground_decision=new st,a.random_rotation_decision=new lt,a.random_jump_decision=new ot,a.flip_decision=new _t,a.wheelie_decision=new pt,a.nitro_decision=new ut,a.jump_over_decision=new ht,a.jump_over_decision.make_every=new $e(.05,.1,.2,.1),a.jump_over_decision.chance_of_jump=new $e(.5,.75,1,.75),a.jump_pickup_decision=new ht,a.jump_pickup_decision.make_every=new $e(.1,.2,.5,.1),a.jump_pickup_decision.chance_of_jump=new $e(.6,.8,1,.8),a.ability_decision=new ct,a.all_decisions=[a.unstuck_decision,a.air_decision,a.ground_decision,a.random_rotation_decision,a.random_jump_decision,a.flip_decision,a.wheelie_decision,a.nitro_decision,a.jump_over_decision,a.jump_pickup_decision,a.ability_decision],a.stunt_decisions=[a.flip_decision,a.wheelie_decision],a.drive_decisions=[a.air_decision,a.ground_decision],a.active_decisions=[],a.constant_drive=!0,a},gt.destroy=function(e){if(null!=e.abilities&&(Me.destroyAbilities(e.abilities),e.abilities=null),null!=e.bot_cache){var t=e.bot_cache;null!=t.last_position&&(t.last_position.dispose(),t.last_position=null),null!=t.current_position_delta&&(t.current_position_delta.dispose(),t.previous_position_delta.dispose()),t.current_position_delta=null,(t.previous_position_delta=null)!=t.movement_vector&&(t.movement_vector.dispose(),t.movement_vector=null),e.bot_cache=null}null!=e.temp_point&&(e.temp_point.dispose(),e.temp_point=null),null!=e.ray_cache&&(e.ray_cache.get_origin().dispose(),e.ray_cache.get_direction().dispose(),e.ray_cache=null),Ct.destroy(e.car,e.config,e.cache),e.car=null,e.config=null,e.cache=null,e.abilities=null,e.personality=null,e.mood_events=null,e.all_decisions=null,e.active_decisions=null,e.current_would_jump_over=null,e.current_would_not_jump_over=null,e.current_would_pickup=null,e.current_would_not_pickup=null},gt.findFastestRotation=function(e,t,n,i){(n<t||t<-n)&&(t=n);var r=0,a=0,s=t,l=0;for(a=0<e?2*Math.PI-e:-e;0<a;)if(++l,a-=s,n<(s+=i)&&(s=n),a-(s*s*.5/i+.5*s)<=0){(r=Math.round(s/i))<0&&(r=0);break}a=0<e?e:2*Math.PI+e,s=t;for(var o=0,_=0;0<a;)if(++o,a+=s,(s-=i)<-n&&(s=-n),a-(s*s*.5/i-.5*s)<=0){(_=Math.round(-s/i))<0&&(_=0);break}var p=new et;return p.count_to_zero=l+r<=o+_?(p.direction=1,p.count=l,r):(p.direction=-1,p.count=o,_),p},gt.getRotationCountUntilZeroAngle=function(e,t,n,i,r,a){var s=i*r*a;n*=a;for(var l=0,o=1e3;;){if(o--<0)return xl.trace("warning: loop broke",{fileName:"BotDo.hx",lineNumber:259,className:"bikas.game.BotDo",methodName:"getRotationCountUntilZeroAngle"}),0;if(n<(t+=s)?t=n:t<-n&&(t=-n),++l,(e=gt.normalizeAngle(e+=t))<=n&&-n<=e)return l}},gt.getClosestRotationDirection=function(e,t){var n=e.bot_cache.body_angle,i=e.car.main_body.get_angularVel(),r=e.config.rotation_angular_velocity_max,a=(e.config.rotation_angular_impulse_coeff,gt.getRotationCountUntilZeroAngle(n,i,r,1,e.car.total_inertia,t));return gt.getRotationCountUntilZeroAngle(n,i,r,-1,e.car.total_inertia,t)<a?-1:1},gt.normalizeAngle=function(e){var t=Xr.PI2;return(e=(e%t+t)%t)>Math.PI&&(e-=t),e},gt.shouldMakeDecision=function(e,t){return null!=e&&!!e.allow&&!e.in_progress&&t-e.decision_made_time_stamp>=e.make_every.current&&(e.decision_made_time_stamp=t,!0)},gt.isInRangeFromOtherCar=function(e,t,n,i){for(var r=0;r<t.length;){var a=t[r];if(++r,a!=e){var s=a.main_body_position_x-e.main_body_position_x;if(n<=s&&s<=i)return!0}}return!1},gt.gatherAndProcessData=function(e,t,n,i,r,a,s){n.body_angle_before=n.body_angle,n.body_angle=gt.normalizeAngle(e.main_body.get_rotation()),n.distance_x_changed_in_frame=e.main_body_position_x-n.last_position.get_x(),n.angle_changes.shift(),n.previous_position_delta.set_x(n.current_position_delta.get_x()),n.previous_position_delta.set_y(n.current_position_delta.get_y()),n.current_position_delta.set_x(e.main_body_position_x-n.last_position.get_x()),n.current_position_delta.set_y(e.main_body_position_y-n.last_position.get_y());var l=n.previous_position_delta,o=n.current_position_delta,_=o.cross(l),p=o.dot(l),u=Math.atan2(_,p);if(n.angle_changes.push(u),n.last_position.set_x(e.main_body_position_x),n.last_position.set_y(e.main_body_position_y),gt.shouldMakeDecision(n.accumulated_angle_check,a)){for(var h=n.accumulated_angle=0,c=n.angle_changes;h<c.length;){var d=c[h];++h,n.accumulated_angle+=d*r}n.accumulated_angle*=1/Math.PI*180}t.body_collide&&(n.body_collide_time_stamp=a),t.back_collide?n.back_wheel_not_collide_time_stamp=0:0==n.back_wheel_not_collide_time_stamp&&(n.back_wheel_not_collide_time_stamp=a),t.front_collide?n.front_wheel_not_collide_time_stamp=0:0==n.front_wheel_not_collide_time_stamp&&(n.front_wheel_not_collide_time_stamp=a),n.back_wheel_off_time=0,(n.front_wheel_off_time=0)<n.back_wheel_not_collide_time_stamp&&(n.back_wheel_off_time=a-n.back_wheel_not_collide_time_stamp),0<n.front_wheel_not_collide_time_stamp&&(n.front_wheel_off_time=a-n.front_wheel_not_collide_time_stamp),.2<n.back_wheel_off_time||.2<n.front_wheel_off_time?n.stable_drive_time_stamp=0:0==n.stable_drive_time_stamp&&(n.stable_drive_time_stamp=a),0==n.stable_drive_time_stamp?n.stable_drive_time=0:n.stable_drive_time=a-n.stable_drive_time_stamp,n.back_wheel_off_time<n.front_wheel_off_time?n.wheels_off_time=n.back_wheel_off_time:n.wheels_off_time=n.front_wheel_off_time;var m=n.average_velocity;i?(m.count++,m.total_velocity+=e.main_body.get_velocity().get_length(),a>=m.calculation_time_stamp+dt.time_frame&&(m.average_velocity=m.total_velocity/m.count,m.calculation_time_stamp=a,m.total_velocity=0,m.count=0)):(m.calculation_time_stamp=a+2,m.average_velocity=-1,m.total_velocity=0,m.count=0)},gt.pushToActiveDecisions=function(e,t,n){-1==e.indexOf(t)&&(t.decision_end_time_stamp=n+t.do_for.current,t.in_progress=!0,e.push(t))},gt.inProgress=function(e){return null!=e&&!!e.allow&&e.in_progress},gt.applyRange=function(e,t){var n=e.current;t.current=n<=.5?t.min+(t.mid-t.min)*n*2:t.mid+(t.max-t.mid)*(n-.5)*2},gt.applyInvertedRange=function(e,t){var n=1-e.current;t.current=n<=.5?t.min+(t.mid-t.min)*n*2:t.mid+(t.max-t.mid)*(n-.5)*2},gt.addPanicMoodEvent=function(e,t,n){t.push(new nt(e.panic,1,n,3))},gt.update=function(e,t,n,i,r,a,s,l,o,_,p,u){var h=s.dc,c=s.level_seconds,d=s.step_size;Ct.updateState(h,e.car,e.cache),gt.gatherAndProcessData(e.car,e.cache,e.bot_cache,e.behavior_activated,h,c,d),e.behavior_activated&&(e.personality_applied||(gt.updateDecisionInfluence(e,e.personality),e.personality_applied=!0),0==i.type&&0==i.development.bot_decisions_enabled||gt.updateDecisionMaking(e,t,n,r,a,s,l,o,_,p,u),e.constant_drive&&Ct.drive(e.car,e.config,e.cache,h),gt.updateActiveDecisions(e,n,s))},gt.updateDecisionInfluence=function(e,t){e.air_decision.allow&&gt.applyInvertedRange(t.ability,e.air_decision.make_every),e.ground_decision.allow&&gt.applyInvertedRange(t.ability,e.ground_decision.make_every),e.random_rotation_decision.allow&&gt.applyInvertedRange(t.panic,e.random_rotation_decision.make_every),e.random_jump_decision.allow&&(gt.applyInvertedRange(t.panic,e.random_jump_decision.make_every),gt.applyRange(t.panic,e.random_jump_decision.chance_of_activation)),e.flip_decision.allow&&(gt.applyInvertedRange(t.crazyness,e.flip_decision.make_every),gt.applyInvertedRange(t.crazyness,e.flip_decision.air_time_min),gt.applyInvertedRange(t.crazyness,e.flip_decision.distance_from_ground_min)),e.wheelie_decision.allow&&(gt.applyInvertedRange(t.crazyness,e.wheelie_decision.make_every),gt.applyInvertedRange(t.crazyness,e.wheelie_decision.stable_drive_time),gt.applyRange(t.crazyness,e.wheelie_decision.chance_of_wheelie)),e.nitro_decision.allow&&(gt.applyInvertedRange(t.ability,e.nitro_decision.do_for),gt.applyInvertedRange(t.crazyness,e.nitro_decision.make_every),gt.applyInvertedRange(t.crazyness,e.nitro_decision.stable_drive_time)),e.jump_over_decision.allow&&(gt.applyInvertedRange(t.ability,e.jump_over_decision.make_every),gt.applyRange(t.ability,e.jump_over_decision.chance_of_jump)),e.jump_pickup_decision.allow&&(gt.applyInvertedRange(t.ability,e.jump_pickup_decision.make_every),gt.applyRange(t.ability,e.jump_pickup_decision.chance_of_jump))},gt.tryUnstuckDecision=function(e,t){0<=e.bot_cache.average_velocity.average_velocity&&e.bot_cache.average_velocity.average_velocity<=rt.min_average_velocity_threshold&&(e.unstuck_decision.initial_started=!1,e.unstuck_decision.additional_started=!1,gt.pushToActiveDecisions(e.active_decisions,e.unstuck_decision,t))},gt.tryAirDecision=function(e,t,n){e.bot_cache.wheels_off_time>=e.air_decision.wheels_off_time_min&&Math.abs(e.bot_cache.body_angle)>e.air_decision.rotation_trigger&&(t<e.bot_cache.body_collide_time_stamp+.1&&Math.abs(e.bot_cache.body_angle)>.25*Math.PI&&(e.air_decision.recover_mode||(e.air_decision.recover_mode=!0,e.air_decision.rotate_direction=gt.getClosestRotationDirection(e,n),e.air_decision.rotate_until_angle=pa.getRandomBetween(at.rotate_until_angle_min,at.rotate_until_angle_max))),gt.pushToActiveDecisions(e.active_decisions,e.air_decision,t))},gt.tryGroundDecision=function(e,t){var n=e.bot_cache,i=e.ground_decision;n.back_wheel_off_time>i.main_wheel_off_time&&n.front_wheel_off_time<i.other_wheel_off_time&&n.body_angle>i.rotation_trigger&&e.car.main_body.get_angularVel()>=-i.angular_velocity_trigger_max?(i.wheel_index_cache=0,gt.pushToActiveDecisions(e.active_decisions,i,t)):n.front_wheel_off_time>i.main_wheel_off_time&&n.back_wheel_off_time<i.other_wheel_off_time&&-n.body_angle>-i.rotation_trigger&&e.car.main_body.get_angularVel()<=i.angular_velocity_trigger_max&&(i.wheel_index_cache=1,gt.pushToActiveDecisions(e.active_decisions,i,t))},gt.tryFlipDecision=function(e,t){var n=e.bot_cache,i=e.flip_decision;if(n.wheels_off_time>=i.air_time_min.current&&n.body_angle<i.rotation_max&&n.body_angle>-i.rotation_max){e.ray_cache.get_origin().set_x(e.car.main_body_position_x),e.ray_cache.get_origin().set_y(e.car.main_body_position_y);var r=e.car.main_body.get_space().rayCast(e.ray_cache,!1,zi.ray_to_ground);if(null!=r){var a=!1;if(0<e.config.rotation_angular_impulse_coeff){for(var s=66/e.config.rotation_angular_impulse_coeff,l=Math.round(pa.clamp(s,30,300)),o=r.get_distance(),_=e.car.main_body.get_position().get_y()+o,p=e.car.main_body.get_space().get_gravity().get_y()/3600,u=e.car.main_body.get_velocity().get_y()/60,h=e.car.main_body.get_position().get_y(),c=0,d=l;c<d&&(c++,!(_<(h+=u+=p))););h<_&&(a=!0)}a&&(i.direction_cache=2*Math.round(Math.random())-1,i.angle_cache=n.body_angle,i.angle_progress_cache=0,gt.pushToActiveDecisions(e.active_decisions,i,t)),r.dispose()}}},gt.tryWheelieDecision=function(e,t){var n=e.bot_cache;if(n.stable_drive_time>e.wheelie_decision.stable_drive_time.current){var i=e.wheelie_decision;if(Math.abs(n.body_angle)<=i.car_angle_max&&Math.random()<i.chance_of_wheelie.current&&e.car.main_body.get_velocity().get_length()/e.config.drive_velocity_max>=i.velocity_to_max_coeff_min){var r=Math.random();i.current_rotation_target=pa.getRandomBetween(i.rotation_target_min,i.rotation_target_max),r<=i.back_wheel_chance_coeff?(i.wheel_index_cache=0,i.current_rotation_target*=-1):(i.wheel_index_cache=1,i.current_rotation_target*=1),gt.pushToActiveDecisions(e.active_decisions,i,t)}}},gt.tryJumpOverDecision=function(e,t,n){for(var i=e.car.main_body_position_x+e.car.main_body.get_velocity().get_x()*e.config.info_max_height_jump_time,r=0;r<n.length;){var a=n[r];if(++r,null!=a.get_space()&&!(e.car.main_body_position_x>a.get_position().get_x()-50||Math.abs(a.get_position().get_x()-i)>100+e.bot_cache.distance_x_changed_in_frame)){var s=!1;if(0<a.get_shapes().get_length()&&a.get_shapes().at(0).get_filter().shouldCollide(zi.car_body)&&(s=!0),s){a!=e.current_would_jump_over&&a!=e.current_would_not_jump_over&&(Math.random()<e.jump_over_decision.chance_of_jump.current?e.current_would_jump_over=a:e.current_would_not_jump_over=a);var l=a.get_bounds().get_y(),o=l+a.get_bounds().get_height(),_=e.car.main_body.get_bounds().get_y();if(!(_+e.car.main_body.get_bounds().get_height()<l||o<_)&&e.current_would_jump_over==a){Me.tryJump(e.abilities.jump_power,e.car,e.config,e.cache,t);break}}}}},gt.tryJumpPickupDecision=function(e,t,n){for(var i=e.car.main_body_position_x+e.car.main_body.get_velocity().get_x()*e.config.info_max_height_jump_time,r=0;r<n.length;){var a=n[r];if(++r,a.pickable&&!(e.car.main_body_position_x>a.position.get_x()-a.radius||Math.abs(a.position.get_x()-i)>2*a.radius+e.bot_cache.distance_x_changed_in_frame||-1!=a.picked_by_cars.indexOf(e.car))){e.temp_point.set_x(a.position.get_x()),e.temp_point.set_y(a.position.get_y());var s=e.car.main_body.worldPointToLocal(e.temp_point),l=(s.get_x(),s.get_y());s.dispose(),s=null,a!=e.current_would_pickup&&a!=e.current_would_not_pickup&&(a.is_bad_item?Math.random()<e.jump_over_decision.chance_of_jump.current&&(e.current_would_not_pickup=a):Math.random()<e.jump_pickup_decision.chance_of_jump.current?e.current_would_pickup=a:e.current_would_not_pickup=a);var o=e.car.bounds.min_y-a.radius;if(e.car.bounds.max_y,a.radius,!(l<o-e.config.info_max_height_jump_distance)){if(a.type==wi.BotJumpIndicator){if(a.position.get_y()>e.car.distance_from_bottom_y_to_top_y+e.config.info_max_height_jump_distance)continue}else if(a.distance_from_the_ground>e.car.distance_from_bottom_y_to_top_y+e.config.info_max_height_jump_distance)continue;var _=a.distance_from_the_ground-a.radius>e.car.distance_from_bottom_y_to_top_y,p=a.distance_from_the_ground-a.radius<=e.car.distance_from_bottom_y_to_top_y;if(!a.is_bad_item&&p&&a==e.current_would_pickup)break;if(a.is_bad_item||!_||a!=e.current_would_pickup){if(a.is_bad_item||a!=e.current_would_pickup)if(a.is_bad_item&&p&&a==e.current_would_not_pickup){if(Me.tryJump(e.abilities.jump_power,e.car,e.config,e.cache,t))break}else{if(a.is_bad_item&&_&&a==e.current_would_not_pickup)break;!a.is_bad_item||e.current_would_not_pickup}}else if(Me.tryJump(e.abilities.jump_power,e.car,e.config,e.cache,t))break}}}},gt.updateDecisionMaking=function(e,t,n,i,r,a,s,l,o,_,u){a.dc;var h=a.level_seconds,c=a.step_size,d=e.car,m=d.main_body,f=e.cache,g=e.config,v=e.bot_cache,b=e.active_decisions,y=e.air_decision,x=e.unstuck_decision,z=e.ground_decision,w=e.random_rotation_decision,k=e.random_jump_decision,S=e.flip_decision,C=e.wheelie_decision,N=e.nitro_decision,P=e.jump_over_decision,M=e.jump_pickup_decision,I=e.ability_decision,A=gt.inProgress(C),T=gt.inProgress(x);gt.shouldMakeDecision(x,h)&&!gt.inProgress(y)&&gt.tryUnstuckDecision(e,h),!gt.shouldMakeDecision(y,h)||gt.inProgress(S)||A||T||gt.tryAirDecision(e,h,c),!gt.shouldMakeDecision(z,h)||A||T||gt.tryGroundDecision(e,h),!gt.shouldMakeDecision(w,h)||A||T||(w.direction_cache=2*Math.round(Math.random())-1,gt.pushToActiveDecisions(b,w,h)),!gt.shouldMakeDecision(k,h)||A||T||Math.random()<k.chance_of_activation.current&&Me.isAllowedToJump(e.abilities.jump_power,h)&&Me.tryJump(e.abilities.jump_power,d,g,f,h),gt.shouldMakeDecision(S,h)&&gt.tryFlipDecision(e,h),gt.shouldMakeDecision(C,h)&&gt.tryWheelieDecision(e,h),gt.shouldMakeDecision(P,h)&&1==e.drive_direction&&m.get_velocity().get_x()>.25*g.drive_velocity_max&&Me.isAllowedToJump(e.abilities.jump_power,h)&&gt.tryJumpOverDecision(e,h,i),gt.shouldMakeDecision(M,h)&&1==e.drive_direction&&m.get_velocity().get_x()>.25*g.drive_velocity_max&&Me.isAllowedToJump(e.abilities.jump_power,h)&&gt.tryJumpPickupDecision(e,h,r),gt.shouldMakeDecision(N,h)&&0<e.abilities.nitro_power_charge&&.1<v.stable_drive_time&&(e.abilities.nitro_power_charge--,Me.activateOrExtendConstantPower(e.abilities.nitro_power,d,Pe.nitro_time_per_1_pick)),null!=e.abilities.received_ability&&h>=e.abilities.bot_ability_receive_time_stamp&&(e.abilities.current_ability=e.abilities.received_ability,e.abilities.received_ability=null),gt.shouldMakeDecision(I,h)&&e.abilities.current_ability!=ge.None&&(e.abilities.current_ability==ge.Bomb?gt.isInRangeFromOtherCar(d,n,300,700)&&Me.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):e.abilities.current_ability==ge.Dynamite?gt.isInRangeFromOtherCar(d,n,-700,-300)&&m.get_velocity().get_x()>.75*g.drive_velocity_max&&Me.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):e.abilities.current_ability==ge.Armor?gt.isInRangeFromOtherCar(d,n,-500,500)&&Me.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):e.abilities.current_ability==ge.Nitro?.1<v.stable_drive_time&&Me.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):e.abilities.current_ability==ge.Magnet?gt.isInRangeFromOtherCar(d,n,100,ze.magnet_distance)&&Me.useCurrentAbility(d,t,e.abilities,s,l,o,_,u):xl.trace("warning: unhandled type "+p.string(e.abilities.current_ability),{fileName:"BotDo.hx",lineNumber:1108,className:"bikas.game.BotDo",methodName:"updateDecisionMaking"}))},gt.updateActiveDecisions=function(e,t,n){var i,r=n.dc,a=n.level_seconds,s=(n.step_size,e.car),l=e.cache,o=e.config,_=e.bot_cache;gt.inProgress(e.unstuck_decision)&&(e.unstuck_decision.in_progress=gt.updateUnstuckAction(e.unstuck_decision,s,l,_),Ct.rotate(s,o,e.unstuck_decision.rotation_direction_cache*r)),gt.inProgress(e.air_decision)&&(e.air_decision.in_progress=gt.updateAirAction(e.air_decision,s,o,l,_,a,r)),gt.inProgress(e.ground_decision)&&(e.ground_decision.in_progress=gt.updateGroundAction(e.ground_decision,s,o,l,r)),gt.inProgress(e.random_rotation_decision)&&Ct.rotate(s,o,e.random_rotation_decision.direction_cache*r),gt.inProgress(e.flip_decision)&&(e.flip_decision.in_progress=gt.updateFlipAction(e.flip_decision,s,o,l,_,r)),gt.inProgress(e.wheelie_decision)&&(e.wheelie_decision.in_progress=gt.updateWheelieAction(e.wheelie_decision,s,o,l,_,r));for(var p=0,u=e.active_decisions.length;p<u;)(a>=(i=e.active_decisions[p]).decision_end_time_stamp||!i.allow||!i.in_progress)&&(e.active_decisions.splice(p,1),i.in_progress=!1,null!=i.on_stop&&i.on_stop(),--p,--u),++p},gt.updateUnstuckAction=function(e,t,n,i){if(!e.initial_started){e.initial_started=!0,e.starting_angle_cache=t.main_body.get_rotation();var r=57.29577951308232*i.body_angle,a=pa.getRandomBetween(130,140);.2<t.main_body.get_angularVel()?a-=pa.getRandomBetween(5,15):t.main_body.get_angularVel()<-.2&&(a+=pa.getRandomBetween(5,15)),e.rotation_direction_cache=0<=r&&r<=a?-1:1}if(e.initial_started&&!e.additional_started&&Math.abs(pa.angleDifferenceRad(t.main_body.get_rotation(),e.starting_angle_cache))>=rt.initial_rotation&&(e.additional_started=!0),e.additional_started){if(Math.abs(pa.angleDifferenceRad(t.main_body.get_rotation(),e.starting_angle_cache))>=rt.max_rotation)return!1;if(n.back_collide||n.front_collide)return!1}return!0},gt.updateAirAction=function(e,t,n,i,r,a,s){if(e.recover_mode||!i.back_collide&&!i.front_collide){if(e.recover_mode){var l=Math.abs(r.body_angle),o=Math.abs(r.body_angle_before),_=pa.angleDifferenceRad(l,e.rotate_until_angle),p=pa.angleDifferenceRad(o,e.rotate_until_angle);return a-.11>r.body_collide_time_stamp&&r.body_angle<Math.PI/2||0<_&&p<0||_<0&&0<p?e.recover_mode=!1:(Ct.rotate(t,n,e.rotate_direction*s),!0)}return 0<r.body_angle&&-2<t.main_body.get_angularVel()?(Ct.rotate(t,n,-s),!0):r.body_angle<0&&t.main_body.get_angularVel()<2&&(Ct.rotate(t,n,s),!0)}return!1},gt.updateGroundAction=function(e,t,n,i,r){return 0==e.wheel_index_cache?(Ct.rotate(t,n,-r),!i.back_collide):(Ct.rotate(t,n,r),!i.front_collide)},gt.updateFlipAction=function(e,t,n,i,r,a){if(i.front_collide)return!1;if(i.back_collide)return!1;for(var s=t.main_body.get_arbiters().iterator();s.hasNext();)if(s.next().isCollisionArbiter())return!1;Ct.rotate(t,n,e.direction_cache*a);var l=Math.atan2(Math.sin(e.angle_cache-r.body_angle),Math.cos(e.angle_cache-r.body_angle));return e.angle_cache=r.body_angle,e.angle_progress_cache+=l,!(Math.abs(e.angle_progress_cache)>=2*Math.PI)},gt.updateWheelieAction=function(e,t,n,i,r,a){var s=t.main_body;if(Math.abs(r.body_angle)>Math.PI/2)return!1;if(s.get_velocity().get_length()/n.drive_velocity_max<e.velocity_to_max_coeff_action_cut_min)return!1;if(.3<r.wheels_off_time)return!1;var l=e.current_rotation_target;return r.body_angle>l+e.rotation_ok_range&&-2<s.get_angularVel()?Ct.rotate(t,n,-a):r.body_angle<l-e.rotation_ok_range&&s.get_angularVel()<2&&Ct.rotate(t,n,a),!0};var vt=function(){this.offset=d_.get(),this.current_zoom=1,this.camera_target_pos=d_.get(),this.target_pos=d_.get(),this.target_speed=d_.get(),this.current_pos=d_.get(),this.current_speed=d_.get(),this.center=d_.get(320,240),this.follow_position_offset=d_.get(0,0),this.additional_offset=d_.get(0,0),this.view_offset=d_.get(0,0),this.zoom_max_speed=10,this.zoom_max=.75,this.zoom_min=1,this.offset_max_speed=d_.get(10,10),this.offset_max_distance=d_.get(200,200),this.smooth_steps=50};(n["bikas.game.Camera"]=vt).__name__=["bikas","game","Camera"],vt.prototype={smooth_steps:null,offset_max_distance:null,offset_max_speed:null,zoom_min:null,zoom_max:null,zoom_max_speed:null,view_offset:null,additional_offset:null,follow_position_offset:null,center:null,current_speed:null,current_pos:null,target_speed:null,target_pos:null,camera_target_pos:null,current_zoom:null,offset:null,__class__:vt};var bt=function(){};(n["bikas.game.CameraDo"]=bt).__name__=["bikas","game","CameraDo"],bt.createCamera=function(){return new vt},bt.reset=function(e){e.current_speed.setxy(0,0),e.current_pos.setxy(0,0),e.target_speed.setxy(0,0),e.target_pos.setxy(0,0),e.current_zoom=1,e.offset.setxy(0,0),e.camera_target_pos.set_x(0),e.camera_target_pos.set_y(0)},bt.init=function(e,t,n,i){e.offset.setxy(0,0),e.current_speed.setxy(0,0),e.current_pos.setxy(n.x,n.y),e.target_pos.setxy(t.x,t.y),e.current_zoom=i},bt.setCurrentPositionRelativeToTarget=function(e,t,n,i,r,a){e.camera_target_pos.setxy(t.x+r,t.y+a),e.current_pos.set(e.camera_target_pos),bt.updateCamera(e,t,n,i,1)},bt.updateCarCamera=function(e,t,n,i,r,a){null==a&&(a=-1),e.offset.set_x(e.target_speed.get_x()/e.offset_max_speed.get_x()*e.offset_max_distance.get_x()),e.offset.set_y(e.target_speed.get_y()/e.offset_max_speed.get_y()*e.offset_max_distance.get_y()),e.offset.set_x(pa.clamp(e.offset.get_x(),-e.offset_max_distance.get_x(),e.offset_max_distance.get_x())),e.offset.set_y(pa.clamp(e.offset.get_y(),-e.offset_max_distance.get_y(),e.offset_max_distance.get_y())),e.camera_target_pos.setxy(t.x+e.follow_position_offset.get_x()+e.offset.get_x()/i.scale_x,t.y+e.follow_position_offset.get_y()+e.offset.get_y()/i.scale_y),bt.updateCamera(e,t,n,i,r,a,!0)},bt.updateStaticCamera=function(e,t,n,i,r,a){null==a&&(a=-1),e.camera_target_pos.setxy(t.x+e.follow_position_offset.get_x(),t.y+e.follow_position_offset.get_y()),bt.updateCamera(e,t,n,i,r,a,!1)},bt.updateCamera=function(e,t,n,i,r,a,s){if(null==s&&(s=!1),null==a&&(a=-1),s&&(e.target_speed.set_x((t.x-e.target_pos.get_x())/r),e.target_speed.set_y((t.y-e.target_pos.get_y())/r)),0<a)e.current_zoom=a;else{var l=e.zoom_min+e.target_speed.get_length()/e.zoom_max_speed*(e.zoom_max-e.zoom_min);l=pa.clamp(l,e.zoom_max,e.zoom_min);var o=e.current_zoom,_=1/e.smooth_steps,p=l*_,u=1-_,h=o*Math.pow(u,r)+p*((Math.pow(u,r-1+1)-1)/(u-1));e.current_zoom=h}i.scale_x=e.current_zoom,i.scale_y=e.current_zoom;var c=e.current_pos,d=e.target_speed,m=e.camera_target_pos,f=1/e.smooth_steps,g=d.get_x()+m.get_x()*f,v=d.get_y()+m.get_y()*f,b=1-f,y=Math.pow(b,r),x=(Math.pow(b,r-1+1)-1)/(b-1),z=c.get_x()*y+g*x,w=c.get_y()*y+v*x;e.current_pos.set_x(z),e.current_pos.set_y(w),n.x=bt.getStagePositionX(e,i.scale_x),n.y=bt.getStagePositionY(e,i.scale_y),e.target_pos.set_x(t.x),e.target_pos.set_y(t.y)},bt.getStagePositionX=function(e,t){return-(e.current_pos.get_x()+e.view_offset.get_x()+e.additional_offset.get_x())*t+e.center.get_x()},bt.getStagePositionY=function(e,t){return-(e.current_pos.get_y()+e.view_offset.get_y()+e.additional_offset.get_y())*t+e.center.get_y()},bt.getCustomScale=function(e,t){return 1-(1-e.current_zoom)*t},bt.writeCustomPositionByScale=function(e,t,n,i,r){r.x=-(e.current_pos.get_x()+e.view_offset.get_x()+e.additional_offset.get_x()-e.offset.get_x())*i*t+e.center.get_x(),r.y=-(e.current_pos.get_y()+e.view_offset.get_y()+e.additional_offset.get_y()-e.offset.get_y())*i*t+e.center.get_y()};var yt=n["bikas.game.CaptureType"]={__ename__:["bikas","game","CaptureType"],__constructs__:["Gif","Webm","PngImagesInTar"]};yt.Gif=["Gif",0],yt.Gif.toString=i,(yt.Gif.__enum__=yt).Webm=["Webm",1],yt.Webm.toString=i,(yt.Webm.__enum__=yt).PngImagesInTar=["PngImagesInTar",2],yt.PngImagesInTar.toString=i,(yt.PngImagesInTar.__enum__=yt).__empty_constructs__=[yt.Gif,yt.Webm,yt.PngImagesInTar];var xt=n["bikas.game.CaptureGameUI"]={__ename__:["bikas","game","CaptureGameUI"],__constructs__:["ShowEverything","HideEverything","JustHidePauseButton"]};xt.ShowEverything=["ShowEverything",0],xt.ShowEverything.toString=i,(xt.ShowEverything.__enum__=xt).HideEverything=["HideEverything",1],xt.HideEverything.toString=i,(xt.HideEverything.__enum__=xt).JustHidePauseButton=["JustHidePauseButton",2],xt.JustHidePauseButton.toString=i,(xt.JustHidePauseButton.__enum__=xt).__empty_constructs__=[xt.ShowEverything,xt.HideEverything,xt.JustHidePauseButton];var zt=function(){};(n["bikas.game.CapturedSound"]=zt).__name__=["bikas","game","CapturedSound"],zt.prototype={name:null,volume:null,frame:null,__class__:zt};var wt=function(){this.all_command_lines=[],this.captured_sounds=[],this.capturer=null,this.count=0,this.started=!1,this.progress="",this.game_ui=xt.HideEverything,this.time=5,this.file_name="",this.name="",this.type=yt.Webm};(n["bikas.game.CaptureControl"]=wt).__name__=["bikas","game","CaptureControl"],wt.prototype={type:null,name:null,file_name:null,time:null,game_ui:null,progress:null,started:null,count:null,capturer:null,captured_sounds:null,all_command_lines:null,__class__:wt};var kt=function(){};(n["bikas.game.CaptureDo"]=kt).__name__=["bikas","game","CaptureDo"],kt.create=function(e,t){wa.addText(t,"Capture",!1,!0);var n=e.temp.capture_control;wt.capture_control_for_sounds=n,e.temp.updates.push((function(){kt.captureUpdate(n)})),e.temp.levelloads.push((function(){kt.refreshCaptureUI(n,e)})),wa.addEnumEdit(t,n,"type","",!1),wa.addFieldEdit(t,n,"name"),wa.addFieldEdit(t,n,"time"),wa.addEnumEdit(t,n,"game_ui","",!1,(function(t){kt.refreshCaptureUI(n,e)})),wa.addFieldWatch(t,n,"progress"),wa.addButton(t,"capture video",(function(){kt.startCapture(n)})),wa.addButton(t,"stop and save video",(function(){kt.stopAndSaveCapture(n)})),wa.addButton(t,"cancel video",(function(){kt.cancelCapture(n)})),wa.addButton(t,"print audio command lines",(function(){for(var e="\n",t=0,i=n.all_command_lines;t<i.length;){var r=i[t];++t,e+=r+"\n\n"}xl.trace("all audio command lines:",{fileName:"CaptureDo.hx",lineNumber:62,className:"bikas.game.CaptureDo",methodName:"create"}),xl.trace(e,{fileName:"CaptureDo.hx",lineNumber:63,className:"bikas.game.CaptureDo",methodName:"create"})})),wa.addButton(t,"capture screenshot",(function(){kt.captureAndSaveScreenshot(n)}))},kt.setUIVisibility=function(e,t){e.pause_button.visible=t,e.wheel.sprite.visible=t,e.ability_item_container.visible=t,e.coin_display.coin.visible=t,e.coin_display.text.visible=t,e.ongoing_powers_container.visible=t,kn.coin_display_debug_visibility=t,null!=e.player&&(e.player.jump_button.container.visible=t,e.player.nitro_button.container.visible=t),null!=e.stunt&&(e.stunt.score_container_visible=t,e.stunt.score_container.visible=t),null!=e.runtime_information_container&&(e.runtime_information_container.visible=t)},kt.refreshCaptureUI=function(e,t){e.game_ui==xt.ShowEverything?kt.setUIVisibility(t,!0):e.game_ui==xt.HideEverything?kt.setUIVisibility(t,!1):e.game_ui==xt.JustHidePauseButton&&(kt.setUIVisibility(t,!0),t.pause_button.visible=!1,null!=t.runtime_information_container&&(t.runtime_information_container.visible=!1))},kt.captureAndSaveScreenshot=function(e){if(Xs.renderer.type==Ws.CANVAS){var t=hn.game.temp.runtime_info;null!=t&&(null!=t.build_text&&(t.build_text.visible=!1),null!=t.code_text&&(t.code_text.visible=!1),null!=t.fps_text&&(t.fps_text.visible=!1),null!=t.last_scale_text&&(t.last_scale_text.visible=!1),null!=t.memory_text&&(t.memory_text.visible=!1)),Xs.renderer.render(Xs.game);var n=to.get_document().createElement("img");n.src=Xs.canvas.toDataURL("image/png");var i=to.get_document().createElement("a");i.href=n.src;var r="adventure_drivers_"+ka.getCurrentDateForFileSaving("_","_");""!=e.name&&(r="adventure_drivers_"+e.name+"_"+ka.getCurrentDateForFileSaving("_","_")),i.download=r+".png",to.get_document().body.appendChild(i),i.click(),to.get_document().body.removeChild(i),null!=t&&(null!=t.build_text&&(t.build_text.visible=!0),null!=t.code_text&&(t.code_text.visible=!0),null!=t.fps_text&&(t.fps_text.visible=!0),null!=t.last_scale_text&&(t.last_scale_text.visible=!0),null!=t.memory_text&&(t.memory_text.visible=!0))}else xl.trace("warning: CANVAS is required",{fileName:"CaptureDo.hx",lineNumber:114,className:"bikas.game.CaptureDo",methodName:"captureAndSaveScreenshot"})},kt.startCapture=function(e){Xs.canvas.focus(),Xs.renderer.type==Ws.CANVAS?isNaN(e.time)&&e.time<0?xl.trace("error: invalid capture time",{fileName:"CaptureDo.hx",lineNumber:161,className:"bikas.game.CaptureDo",methodName:"startCapture"}):e.time>60*e.time*2?xl.trace("error: capture time is over 2 minutes long (it would consume too much RAM)",{fileName:"CaptureDo.hx",lineNumber:165,className:"bikas.game.CaptureDo",methodName:"startCapture"}):e.started?xl.trace("warning: capture already started",{fileName:"CaptureDo.hx",lineNumber:169,className:"bikas.game.CaptureDo",methodName:"startCapture"}):(Xs.canvas.focus(),e.capturer=null,e.file_name="video_adventure_drivers_"+ka.getCurrentDateForFileSaving("_","_"),""!=e.name&&(e.file_name="video_adventure_drivers_"+e.name+"_"+ka.getCurrentDateForFileSaving("_","_")),e.type==yt.Gif?e.capturer=parent.CCapture({name:e.file_name,format:"gif",workersPath:"libraries/",framerate:60}):e.type==yt.Webm?e.capturer=parent.CCapture({name:e.file_name,format:"webm",framerate:60,quality:99}):e.type==yt.PngImagesInTar&&(e.capturer=parent.CCapture({name:e.file_name,format:"png"})),e.started=!0,e.capturer.start(),xl.trace("capture: start",{fileName:"CaptureDo.hx",lineNumber:215,className:"bikas.game.CaptureDo",methodName:"startCapture"}),e.progress="started",e.count=0,e.captured_sounds=[]):xl.trace("error: CANVAS is required",{fileName:"CaptureDo.hx",lineNumber:157,className:"bikas.game.CaptureDo",methodName:"startCapture"})},kt.cancelCapture=function(e){e.started&&(xl.trace("capture: stopping...",{fileName:"CaptureDo.hx",lineNumber:223,className:"bikas.game.CaptureDo",methodName:"cancelCapture"}),e.capturer.stop(),xl.trace("capture: stopped",{fileName:"CaptureDo.hx",lineNumber:225,className:"bikas.game.CaptureDo",methodName:"cancelCapture"}),e.capturer=null,e.started=!1,e.progress="",xl.trace("canceled",{fileName:"CaptureDo.hx",lineNumber:229,className:"bikas.game.CaptureDo",methodName:"cancelCapture"}))},kt.stopAndSaveCapture=function(e){if(e.started){e.progress="stoping...",xl.trace("capture: stopping...",{fileName:"CaptureDo.hx",lineNumber:236,className:"bikas.game.CaptureDo",methodName:"stopAndSaveCapture"}),e.capturer.stop(),e.progress="saving...",xl.trace("capture: saving...",{fileName:"CaptureDo.hx",lineNumber:239,className:"bikas.game.CaptureDo",methodName:"stopAndSaveCapture"}),e.capturer.save();var t=kt.generateCommandLineForSounds(e);e.all_command_lines.push(t),e.capturer=null,e.started=!1,e.progress=""}},kt.generateCommandLineForSounds=function(e){var t="ffmpeg -i";t+=' "'+e.file_name+'.webm"';for(var n=0,i=e.captured_sounds;n<i.length;){var r=i[n];++n,t+=' -i "sounds/'+r.name+'.wav"'}t+=" -filter_complex",t+=' "';for(var a=1,s=0,l=e.captured_sounds;s<l.length;){var o=l[s];++s;var _=Math.round(o.frame/60*1e3);t+="["+a+"]adelay="+_+"|"+_+",volume="+Math.round(1e3*o.volume)/1e3+"[aud"+a+"];",++a}a=1;for(var p=0,u=e.captured_sounds;p<u.length;)u[p],++p,t+="[aud"+a+"]",++a;return t+="amix="+--a,t+='"',t+=' -c:v copy "audio_'+e.file_name+'.webm"'},kt.captureSound=function(e,t,n){if(e.started){var i=new zt;i.name=t,i.frame=e.count,i.volume=n,e.captured_sounds.push(i),30<=e.captured_sounds.length?xl.trace("reached maximum sound limit of 30, recording no more sounds",{fileName:"CaptureDo.hx",lineNumber:291,className:"bikas.game.CaptureDo",methodName:"captureSound"}):xl.trace("frame: "+e.count+", capture sound: "+t+", volume: "+n,{fileName:"CaptureDo.hx",lineNumber:293,className:"bikas.game.CaptureDo",methodName:"captureSound"})}},kt.captureUpdate=function(e){e.started&&(e.count++,xl.trace("TODO: support canvas recording",{fileName:"CaptureDo.hx",lineNumber:305,className:"bikas.game.CaptureDo",methodName:"captureUpdate"}),e.progress="second: "+Math.round(e.count/60*10)/10+"/"+e.time,e.count>=60*e.time&&kt.stopAndSaveCapture(e))};var St=function(){};(n["bikas.game.CarConfigDo"]=St).__name__=["bikas","game","CarConfigDo"],St.roundConfigFloats=function(e){e.drive_impulse=Math.round(100*e.drive_impulse)/100,e.drive_velocity_max=Math.round(100*e.drive_velocity_max)/100,e.drive_wheel_angular_impulse=Math.round(100*e.drive_wheel_angular_impulse)/100,e.drive_wheel_angular_velocity_max=Math.round(100*e.drive_wheel_angular_velocity_max)/100,e.rotation_angular_impulse_coeff=Math.round(100*e.rotation_angular_impulse_coeff)/100,e.rotation_angular_velocity_max=Math.round(100*e.rotation_angular_velocity_max)/100,e.nitro_impulse=Math.round(100*e.nitro_impulse)/100,e.nitro_velocity_to_drive_velocity_max_coeff=Math.round(100*e.nitro_velocity_to_drive_velocity_max_coeff)/100,e.jump_impulse=Math.round(100*e.jump_impulse)/100,e.jump_forward_min_velocity=Math.round(100*e.jump_forward_min_velocity)/100,e.grip_increase_coeff=Math.round(100*e.grip_increase_coeff)/100,e.grip_decrease_coeff=Math.round(100*e.grip_decrease_coeff)/100,e.info_max_height_jump_time=Math.round(100*e.info_max_height_jump_time)/100,e.info_max_height_jump_distance=Math.round(100*e.info_max_height_jump_distance)/100,e.info_zero_to_max_drive=Math.round(100*e.info_zero_to_max_drive)/100,e.info_zero_to_max_nitro=Math.round(100*e.info_zero_to_max_nitro)/100},St.copyConfig=function(e){var t=new Nt;return t.drive_impulse=e.drive_impulse,t.drive_velocity_max=e.drive_velocity_max,t.drive_wheel_angular_impulse=e.drive_wheel_angular_impulse,t.drive_wheel_angular_velocity_max=e.drive_wheel_angular_velocity_max,t.rotation_angular_impulse_coeff=e.rotation_angular_impulse_coeff,t.rotation_angular_velocity_max=e.rotation_angular_velocity_max,t.nitro_impulse=e.nitro_impulse,t.nitro_velocity_to_drive_velocity_max_coeff=e.nitro_velocity_to_drive_velocity_max_coeff,t.jump_impulse=e.jump_impulse,t.jump_forward_min_velocity=e.jump_forward_min_velocity,t.grip_increase_coeff=e.grip_increase_coeff,t.grip_decrease_coeff=e.grip_decrease_coeff,t.info_max_height_jump_time=e.info_max_height_jump_time,t.info_max_height_jump_distance=e.info_max_height_jump_distance,t.info_zero_to_max_drive=e.info_zero_to_max_drive,t.info_zero_to_max_nitro=e.info_zero_to_max_nitro,t},St.getFullConfigText=function(e){var t="\n";return t+="---------------------------------\n",t+="var c:CarConfig = new CarConfig();\n",t+="drive_impulse = "+e.drive_impulse+";\n",t+="drive_velocity_max = "+e.drive_velocity_max+";\n",t+="drive_wheel_angular_impulse = "+e.drive_wheel_angular_impulse+";\n",t+="drive_wheel_angular_velocity_max = "+e.drive_wheel_angular_velocity_max+";\n",t+="rotation_angular_impulse_coeff = "+e.rotation_angular_impulse_coeff+";\n",t+="rotation_angular_velocity_max = "+e.rotation_angular_velocity_max+";\n",t+="nitro_impulse = "+e.nitro_impulse+";\n",t+="nitro_velocity_to_drive_velocity_max_coeff = "+e.nitro_velocity_to_drive_velocity_max_coeff+";\n",t+="jump_impulse = "+e.jump_impulse+";\n",t+="// info\n",t+="info_max_height_jump_time = "+e.info_max_height_jump_time+";\n",t+="info_max_height_jump_distance = "+e.info_max_height_jump_distance+";\n",t+="info_zero_to_max_drive = "+e.info_zero_to_max_drive+";\n",t+="info_zero_to_max_nitro = "+e.info_zero_to_max_nitro+";\n",t+="return c;\n",t+="---------------------------------"},St.getMinimalConfigText=function(e){var t="\n";return t+="---------------------------------\n",t+="\t\tsuper();\n",t+="\t\t\n",t+="\t\tdrive_impulse = "+e.drive_impulse+";\n",t+="\t\t\n",t+="\t\trotation_angular_impulse_coeff = "+e.rotation_angular_impulse_coeff+";\n",t+="\t\trotation_angular_velocity_max = "+e.rotation_angular_velocity_max+";\n",t+="\t\t\n",t+="\t\tnitro_impulse = "+e.nitro_impulse+";\n",t+="\t\tjump_impulse = "+e.jump_impulse+";\n",t+="\t\t\n",t+="\t\t// info\n",t+="\t\tinfo_max_height_jump_time = "+e.info_max_height_jump_time+";\n",t+="\t\tinfo_max_height_jump_distance = "+e.info_max_height_jump_distance+";\n",t+="---------------------------------"},St.getMinimalConfigTextForFunction=function(e){var t="\n";return t+="---------------------------------\n",t+="\t\tvar c:CarConfig = new CarConfig();\n",t+="\t\t\n",t+="\t\tc.drive_impulse = "+e.drive_impulse+";\n",t+="\t\t\n",t+="\t\tc.rotation_angular_impulse_coeff = "+e.rotation_angular_impulse_coeff+";\n",t+="\t\tc.rotation_angular_velocity_max = "+e.rotation_angular_velocity_max+";\n",t+="\t\t\n",t+="\t\tc.nitro_impulse = "+e.nitro_impulse+";\n",t+="\t\tc.jump_impulse = "+e.jump_impulse+";\n",t+="\t\t\n",t+="\t\t// info\n",t+="\t\tc.info_max_height_jump_time = "+e.info_max_height_jump_time+";\n",t+="\t\tc.info_max_height_jump_distance = "+e.info_max_height_jump_distance+";\n",t+="\t\t\n",t+="\t\treturn c;\n",t+="---------------------------------"};var Ct=function(){};(n["bikas.game.CarControlDo"]=Ct).__name__=["bikas","game","CarControlDo"],Ct.drive=function(e,t,n,i){null==i&&(i=1);var r=t.drive_impulse+t.drive_impulse_additional,a=t.drive_velocity_max+t.drive_velocity_max_additional;if(n.impulse.set_x(0),n.impulse.set_y(0),n.front_collide&&n.back_collide){var s=n.impulse;s.set_x(s.get_x()+r*i*e.total_mass*2)}else if(n.front_collide||n.back_collide){var l=n.impulse;l.set_x(l.get_x()+r*i*e.total_mass*2*.75)}if(n.back_collide||n.front_collide){var o=e.main_body.get_velocity().get_length();if(n.impulse.rotate(e.main_body.get_rotation()),o<a/2){var _=1+(a/2-o)/(a/2);n.impulse.muleq(_)}n.velocity.set_x(e.main_body.get_velocity().get_x()+n.impulse.get_x()),n.velocity.set_y(e.main_body.get_velocity().get_y()+n.impulse.get_y()),n.velocity.get_length()>o?o<=a&&e.main_body.applyImpulse(n.impulse):e.main_body.applyImpulse(n.impulse)}var p=.346*Math.pow(e.back_wheel_diameter/2,2),u=.346*Math.pow(e.front_wheel_diameter/2,2);Ct.applySmoothedAngularImpulse(e.back_wheel_body,p,t.drive_wheel_angular_velocity_max),Ct.applySmoothedAngularImpulse(e.front_wheel_body,u,t.drive_wheel_angular_velocity_max)},Ct.rotate=function(e,t,n){null==n&&(n=1);var i=t.rotation_angular_impulse_coeff*n*e.total_inertia;Ct.applySmoothedAngularImpulse(e.main_body,i,t.rotation_angular_velocity_max*t.rotation_angular_velocity_max_additional_coeff)},Ct.applySmoothedAngularImpulse=function(e,t,n){var i=e.get_angularVel();if(0<i&&0<t||i<0&&t<0)if(Math.abs(i)<n/2)e.applyAngularImpulse(t);else{var r=1-ca.getT(n/2,n,Math.abs(i));r=pa.clamp(r,0,1),e.applyAngularImpulse(t*r)}else e.applyAngularImpulse(t)},Ct.customAngularImpulse=function(e,t,n){e.main_body.get_angularVel()<=n&&Tt.applyRotationAngularImpulse(e,t)},Ct.nitro=function(e,t,n,i){var r=t.nitro_impulse+t.nitro_impulse_additional;n.impulse.setxy(r*e.total_mass*i,0),n.impulse.rotate(e.main_body.get_rotation());var a=e.main_body.get_velocity().get_length();e.main_body.get_velocity().add(n.impulse).get_length()>a?a<=t.drive_velocity_max*t.nitro_velocity_to_drive_velocity_max_coeff*t.nitro_velocity_additional_coeff&&Tt.applyImpulseToMainBodies(e,n.impulse):Tt.applyImpulseToMainBodies(e,n.impulse)},Ct.customImpulse=function(e,t,n,i){t.impulse.set(n);var r=e.main_body.get_velocity().get_length();e.main_body.get_velocity().add(t.impulse).get_length()>r?r<=i&&Tt.applyImpulseToMainBodies(e,t.impulse):Tt.applyImpulseToMainBodies(e,t.impulse)},Ct.jump=function(e,t,n){var i=0;0<e.main_body.get_velocity().get_x()?e.main_body.get_velocity().get_x()<t.jump_forward_min_velocity&&(i=t.jump_forward_min_velocity-e.main_body.get_velocity().get_x()):i=t.jump_forward_min_velocity,n.impulse.setxy(i*e.total_mass,t.jump_impulse*e.total_mass),e.main_body.applyImpulse(n.impulse)},Ct.updateState=function(e,t,n){n.back_collide=Ct.hasCollisionArbiter(t.back_wheel_body),n.front_collide=Ct.hasCollisionArbiter(t.front_wheel_body),n.body_collide=Ct.hasCollisionArbiter(t.main_body),n.body_collide?n.updates_since_body_collided=0:n.updates_since_body_collided+=e,n.back_collide?n.updates_since_back_wheel_collided=0:n.updates_since_back_wheel_collided+=e,n.front_collide?n.updates_since_front_wheel_collided=0:n.updates_since_front_wheel_collided+=e,n.back_collide||n.front_collide?n.updates_since_any_wheel_collided=0:n.updates_since_any_wheel_collided+=e,n.body_collide||n.back_collide||n.front_collide?n.updates_since_anything_collided=0:n.updates_since_anything_collided+=e},Ct.hasCollisionArbiter=function(e){if(null==e.get_space())return!1;if(e.get_isSleeping())return!1;for(var t=e.get_arbiters().iterator();t.hasNext();)if(t.next().isCollisionArbiter())return!0;return!1},Ct.destroy=function(e,t,n){null!=e&&(e.group_entity=null,e.main_body_entity=null,e.main_body_background_sprite=null,e.front_wheel_body_entity=null,(e.back_wheel_body_entity=null)!=e.main_body&&(null!=e.main_body.get_group()&&(e.main_body.get_group().set_group(null),e.main_body.set_group(null)),e.main_body=null),e.back_wheel_body=null,e.all_bodies=null,e.all_bodies_init_rotations=null,e.main_bodies=null,e.all_constraints=null,e.front_suspension=null,e.back_suspension=null,(e.baggages=null)!=e.exhaust_position&&(e.exhaust_position.dispose(),e.exhaust_position=null),null!=e.initial_main_body_position&&(e.initial_main_body_position.dispose(),e.initial_main_body_position=null),null!=e.distance_from_main_body_to_back_wheel_body&&(e.distance_from_main_body_to_back_wheel_body.dispose(),e.distance_from_main_body_to_back_wheel_body=null),e.bounds=null),null!=n&&(null!=n.impulse&&(n.impulse.dispose(),n.impulse=null),null!=n.velocity&&(n.velocity.dispose(),n.velocity=null))};var Nt=function(){this.info_zero_to_max_nitro=.5,this.info_zero_to_max_drive=1,this.info_max_height_jump_distance=200,this.info_max_height_jump_time=.72,this.rotation_angular_velocity_max_additional_coeff=1,this.nitro_velocity_additional_coeff=1,this.nitro_impulse_additional=0,this.drive_velocity_max_additional=0,this.drive_impulse_additional=0,this.armor_coeff=0,this.grip_decrease_coeff=1,this.grip_increase_coeff=1,this.jump_forward_min_velocity=150,this.jump_impulse=-600,this.nitro_velocity_to_drive_velocity_max_coeff=1.6,this.nitro_impulse=40,this.rotation_angular_velocity_max=6,this.rotation_angular_impulse_coeff=1,this.drive_wheel_angular_velocity_max=33,this.drive_wheel_angular_impulse=5,this.drive_velocity_max=700,this.drive_impulse=4.5};(n["bikas.game.CarConfig"]=Nt).__name__=["bikas","game","CarConfig"],Nt.prototype={drive_impulse:null,drive_velocity_max:null,drive_wheel_angular_impulse:null,drive_wheel_angular_velocity_max:null,rotation_angular_impulse_coeff:null,rotation_angular_velocity_max:null,nitro_impulse:null,nitro_velocity_to_drive_velocity_max_coeff:null,jump_impulse:null,jump_forward_min_velocity:null,grip_increase_coeff:null,grip_decrease_coeff:null,armor_coeff:null,drive_impulse_additional:null,drive_velocity_max_additional:null,nitro_impulse_additional:null,nitro_velocity_additional_coeff:null,rotation_angular_velocity_max_additional_coeff:null,info_max_height_jump_time:null,info_max_height_jump_distance:null,info_zero_to_max_drive:null,info_zero_to_max_nitro:null,__class__:Nt};var Pt=function(){this.updates_since_anything_collided=0,this.updates_since_any_wheel_collided=0,this.updates_since_front_wheel_collided=0,this.updates_since_back_wheel_collided=0,this.updates_since_body_collided=0,this.front_collide=!1,this.back_collide=!1,this.body_collide=!1,this.velocity=d_.get(0,0),this.impulse=d_.get(0,0)};(n["bikas.game.CarCache"]=Pt).__name__=["bikas","game","CarCache"],Pt.prototype={impulse:null,velocity:null,body_collide:null,back_collide:null,front_collide:null,updates_since_body_collided:null,updates_since_back_wheel_collided:null,updates_since_front_wheel_collided:null,updates_since_any_wheel_collided:null,updates_since_anything_collided:null,__class__:Pt};var Mt=function(){this.all_constraints=[]};(n["bikas.game.CarSuspension"]=Mt).__name__=["bikas","game","CarSuspension"],Mt.prototype={body:null,pivot_wheel_to_suspension_body:null,pivot_suspension_body_to_main_body:null,weld_suspension_body_to_main_body:null,all_constraints:null,__class__:Mt};var It=function(){this.current_time=60,this.initial_distance_from_main_body=0,this.interactive=!0,this.timeout=!1};(n["bikas.game.CarBaggage"]=It).__name__=["bikas","game","CarBaggage"],It.prototype={body:null,timeout:null,interactive:null,initial_distance_from_main_body:null,current_time:null,__class__:It};var At=function(){this.main_body_position_y=0,this.main_body_position_x=0,this.total_inertia=0,this.total_mass=0,this.front_wheel_body_inertia=0,this.front_wheel_body_mass=0,this.back_wheel_body_inertia=0,this.back_wheel_body_mass=0,this.main_body_inertia=0,this.main_body_mass=0,this.bounds=new Qr,this.exhaust_position=null,this.baggages=[],this.all_constraints=[],this.main_bodies=[],this.all_bodies_init_rotations=[],this.all_bodies=[],this.main_body_background_sprite=null};(n["bikas.game.Car"]=At).__name__=["bikas","game","Car"],At.prototype={name:null,stage_name:null,group_entity:null,main_body_entity:null,main_body_background_sprite:null,front_wheel_body_entity:null,back_wheel_body_entity:null,main_body:null,back_wheel_body:null,front_wheel_body:null,all_bodies:null,all_bodies_init_rotations:null,main_bodies:null,all_constraints:null,front_suspension:null,back_suspension:null,baggages:null,back_wheel_diameter:null,front_wheel_diameter:null,exhaust_position:null,initial_main_body_position:null,distance_from_main_body_to_back_wheel_body:null,distance_from_main_body_to_bottom_y:null,distance_from_main_body_to_top_y:null,distance_from_bottom_y_to_top_y:null,bounds:null,main_body_mass:null,main_body_inertia:null,back_wheel_body_mass:null,back_wheel_body_inertia:null,front_wheel_body_mass:null,front_wheel_body_inertia:null,total_mass:null,total_inertia:null,main_body_position_x:null,main_body_position_y:null,__class__:At};var Tt=function(){};(n["bikas.game.CarDo"]=Tt).__name__=["bikas","game","CarDo"],Tt.createCar=function(e,t,n,i,r){var a=new At;a.group_entity=e,a.name=a.group_entity.prefab.prefab_name,a.stage_name=a.group_entity.prefab.prefab_link_name,a.main_body_entity=t,a.back_wheel_body_entity=n,a.front_wheel_body_entity=i,a.main_body=t.body,a.back_wheel_body=n.body,a.front_wheel_body=i.body,a.main_body.setShapeFilters(zi.car_body),a.back_wheel_body.setShapeFilters(zi.car_wheel),a.front_wheel_body.setShapeFilters(zi.car_wheel),a.main_body.set_group(new Yo(!1)),a.main_body.get_group().set_group(r);for(var s=0,l=a.group_entity.group.entities;s<l.length;){var o=l[s];if(++s,"baggage"==o.name||"baggage_self"==o.name)if(null==o.body)xl.trace("warning: body == null for "+o.name+" ("+o.guid+")",{fileName:"CarDo.hx",lineNumber:48,className:"bikas.game.CarDo",methodName:"createCar"});else{var _=new It;_.body=o.body,"baggage"==o.name?_.body.setShapeFilters(zi.car_baggage):"baggage_self"==o.name&&_.body.setShapeFilters(zi.car_baggage_self),_.body.setShapeMaterials($i.car_baggage_default),_.interactive=!0;var p=a.main_body.get_position().sub(_.body.get_position());_.initial_distance_from_main_body=p.get_length(),p.dispose(),a.baggages.push(_),_.body.set_group(a.main_body.get_group())}else"exhaust"==o.name&&(a.exhaust_position=d_.get(o.position.x-a.main_body_entity.position.x,o.position.y-a.main_body_entity.position.y))}a.back_wheel_diameter=2*a.back_wheel_body_entity.circle.radius,a.back_wheel_diameter<30&&xl.trace("warning: back_wheel_diameter:"+a.back_wheel_diameter+" for car "+a.name+" is too small",{fileName:"CarDo.hx",lineNumber:83,className:"bikas.game.CarDo",methodName:"createCar"}),a.back_suspension=Tt.createSuspension(a.main_body,a.back_wheel_body,a.back_wheel_diameter,!0),a.front_wheel_diameter=2*a.front_wheel_body_entity.circle.radius,a.front_wheel_diameter<30&&xl.trace("warning: front_wheel_diameter:"+a.front_wheel_diameter+" for car "+a.name+" is too small",{fileName:"CarDo.hx",lineNumber:90,className:"bikas.game.CarDo",methodName:"createCar"}),a.front_suspension=Tt.createSuspension(a.main_body,a.front_wheel_body,a.front_wheel_diameter,!1),a.main_body.setShapeMaterials($i.car_body_default),a.back_wheel_body.setShapeMaterials($i.car_wheel_default),a.front_wheel_body.setShapeMaterials($i.car_wheel_default),a.back_suspension.body.setShapeMaterials($i.car_suspension_default),a.front_suspension.body.setShapeMaterials($i.car_suspension_default),a.main_bodies.push(a.main_body),a.main_bodies.push(a.back_wheel_body),a.main_bodies.push(a.front_wheel_body),a.main_bodies.push(a.back_suspension.body),a.main_bodies.push(a.front_suspension.body);for(var u=0,h=a.main_bodies;u<h.length;){var c=h[u];++u,c!=a.main_body&&c.set_group(r)}a.initial_main_body_position=a.main_body.get_position().copy(),a.distance_from_main_body_to_back_wheel_body=a.main_body.get_position().sub(a.back_wheel_body.get_position()),a.distance_from_main_body_to_back_wheel_body.set_x(Math.abs(a.distance_from_main_body_to_back_wheel_body.get_x())),a.distance_from_main_body_to_back_wheel_body.set_y(Math.abs(a.distance_from_main_body_to_back_wheel_body.get_y())),a.distance_from_main_body_to_bottom_y=Math.abs(a.distance_from_main_body_to_back_wheel_body.get_y()+a.back_wheel_body.get_bounds().get_height()/2),a.distance_from_main_body_to_top_y=-a.main_body.get_bounds().get_height()/2,a.distance_from_bottom_y_to_top_y=Math.abs(a.distance_from_main_body_to_top_y)+Math.abs(a.distance_from_main_body_to_bottom_y),a.main_body_mass=a.main_body.get_mass(),a.main_body_inertia=a.main_body.get_inertia(),a.back_wheel_body_mass=a.back_wheel_body.get_mass(),a.back_wheel_body_inertia=a.back_wheel_body.get_inertia(),a.front_wheel_body_mass=a.front_wheel_body.get_mass(),a.front_wheel_body_inertia=a.front_wheel_body.get_inertia(),a.total_mass=0;for(var d=a.total_inertia=0,m=a.main_bodies;d<m.length;){var f=m[d];++d,a.total_mass+=f.get_mass(),a.total_inertia+=f.get_inertia()}for(var g=0,v=a.group_entity.group.entities;g<v.length;){var b=v[g];++g,null!=b.body&&a.all_bodies.push(b.body),null!=b.constraint&&a.all_constraints.push(b.constraint)}a.all_bodies.push(a.back_suspension.body),a.all_bodies.push(a.front_suspension.body);for(var y=0,x=a.back_suspension.all_constraints;y<x.length;){var z=x[y];++y,a.all_constraints.push(z)}for(var w=0,k=a.front_suspension.all_constraints;w<k.length;){var S=k[w];++w,a.all_constraints.push(S)}for(var C=0,N=a.all_bodies;C<N.length;){var P=N[C];++C,a.all_bodies_init_rotations.push(P.get_rotation())}return a.bounds=Tt.getBounds(a),de.remove(t),pe.remove(n),pe.remove(i),t.polygon=null,n.circle=null,i.circle=null,Tt.update(a),a},Tt.createSuspension=function(e,t,n,i){var r,a=2.8*n,s=.7*n,l=(a/2-.3*n)*(r=i?1:-1),o=-.078*a*r,_=(-a/2-.078*n)*r;return Tt.createCarSuspension(e,t,a,s,l,o,_)},Tt.createCarSuspension=function(e,t,n,i,r,a,s){var l,o,_=new Mt,p=t.get_position().get_x()+r,u=t.get_position().get_y();return _.body=new y_(w_.get_DYNAMIC(),d_.get(p,u)),_.body.get_shapes().add(new j_(j_.box(n,i))),_.body.setShapeFilters(zi.car_suspension),_.body.set_disableCCD(!0),l=d_.get(0,0),o=_.body.worldPointToLocal(t.localPointToWorld(d_.get(0,0))),_.pivot_wheel_to_suspension_body=new Bo(t,_.body,l,o),_.pivot_wheel_to_suspension_body.set_frequency(10),_.pivot_wheel_to_suspension_body.set_damping(1),l=d_.get(a,0),o=e.worldPointToLocal(_.body.localPointToWorld(l)),_.pivot_suspension_body_to_main_body=new Bo(_.body,e,l,o),_.pivot_suspension_body_to_main_body.set_frequency(10),_.pivot_suspension_body_to_main_body.set_damping(1),l=d_.get(s,0),o=e.worldPointToLocal(_.body.localPointToWorld(l)),_.weld_suspension_body_to_main_body=new Fo(_.body,e,l,o),_.weld_suspension_body_to_main_body.set_stiff(!1),_.weld_suspension_body_to_main_body.set_frequency(12),_.weld_suspension_body_to_main_body.set_damping(2),_.all_constraints.push(_.pivot_wheel_to_suspension_body),_.all_constraints.push(_.pivot_suspension_body_to_main_body),_.all_constraints.push(_.weld_suspension_body_to_main_body),_},Tt.getBounds=function(e){for(var t,n=1e4,i=1e4,r=-1e4,a=-1e4,s=e.main_body.get_position(),l=[e.main_body],o=0;o<l.length;){var _=l[o];++o,(t=_.get_bounds().copy()).get_min().subeq(s),t.get_max().subeq(s),t.get_min().get_x()<n&&(n=t.get_min().get_x()),t.get_min().get_y()<i&&(i=t.get_min().get_y()),t.get_max().get_x()>r&&(r=t.get_max().get_x()),t.get_max().get_y()>a&&(a=t.get_max().get_y())}return 1e4!=n&&1e4!=i&&-1e4!=r&&-1e4!=a||xl.trace("warning: something ain't right with bounds",{fileName:"CarDo.hx",lineNumber:274,className:"bikas.game.CarDo",methodName:"getBounds"}),new Qr(n,i,r,a)},Tt.isWorldPointInBounds=function(e,t){var n=e.main_body.worldPointToLocal(t);return n.get_x()>=e.bounds.min_x&&n.get_x()<=e.bounds.max_x&&n.get_y()>=e.bounds.min_y&&n.get_y()<=e.bounds.max_y?(n.dispose(),!0):(n.dispose(),!1)},Tt.doesWorldCircleTouchCarBounds=function(e,t,n){var i=e.main_body.worldPointToLocal(t),r=n/2;return i.get_x()+r>=e.bounds.min_x&&i.get_x()-r<=e.bounds.max_x&&i.get_y()+r>=e.bounds.min_y&&i.get_y()-r<=e.bounds.max_y?(i.dispose(),!0):(i.dispose(),!1)},Tt.doesWorldBoundsTouchBounds=function(e,t,n){var i=e.main_body.worldPointToLocal(t),r=e.main_body.worldPointToLocal(n),a=!(i.get_x()>e.bounds.max_x||r.get_x()<e.bounds.min_x||i.get_y()>e.bounds.max_y||r.get_y()<e.bounds.min_y);return i.dispose(),r.dispose(),a},Tt.setPosition=function(e,t,n){for(var i=e.main_body.get_position().copy(),r=0,a=e.all_bodies;r<a.length;){var s=a[r];++r;var l=i.sub(s.get_position()),o=d_.get(t+l.get_x(),n+l.get_y());s.get_position().set(o),l.dispose(),o.dispose()}i.dispose(),Tt.update(e)},Tt.setDeltaPosition=function(e,t,n){for(var i=e.main_body.get_position().copy(),r=0,a=e.all_bodies;r<a.length;){var s=a[r];++r;var l=i.sub(s.get_position()),o=d_.get(i.get_x()+t+l.get_x(),i.get_y()+n+l.get_y());s.get_position().set(o),l.dispose(),o.dispose()}i.dispose()},Tt.setRotation=function(e,t){for(var n=e.main_body.get_position().copy(),i=e.main_body.get_rotation(),r=0,a=e.all_bodies.length;r<a;){var s=r++,l=e.all_bodies[s],o=e.all_bodies_init_rotations[s],_=n.sub(l.get_position());_.rotate(-i),l.set_rotation(t+o),l.get_position().setxy(n.get_x()+_.get_x(),n.get_y()+_.get_y()),_.dispose()}n.dispose()},Tt.setVelocity=function(e,t,n){for(var i=0,r=e.all_bodies;i<r.length;){var a=r[i];++i,a.get_velocity().setxy(t,n)}},Tt.setAngularVelocity=function(e,t){for(var n=0,i=e.all_bodies;n<i.length;){var r=i[n];++n,r.set_angularVel(t)}},Tt.applyImpulse=function(e,t){for(var n=t.mul(1/e.all_bodies.length),i=0,r=e.all_bodies;i<r.length;){var a=r[i];++i,a.applyImpulse(n)}},Tt.applyImpulsePerMassUnit=function(e,t){for(var n=0,i=e.all_bodies;n<i.length;){var r=i[n];++n,r.applyImpulse(t.mul(r.get_mass(),!0))}},Tt.applyImpulseToMainBodiesPerMassUnit=function(e,t){for(var n=0,i=e.main_bodies;n<i.length;){var r=i[n];++n,r.applyImpulse(t.mul(r.get_mass(),!0))}},Tt.applyImpulseToMainBodies=function(e,t){for(var n=0,i=0,r=e.main_bodies;i<r.length;){var a=r[i];++i,n+=a.get_mass()}for(var s=0,l=e.main_bodies;s<l.length;){var o=l[s];++s,o.applyImpulse(t.mul(o.get_mass()/n))}},Tt.applyRotationAngularImpulse=function(e,t){e.main_body.applyAngularImpulse(t)},Tt.update=function(e){var t=e.main_body.get_position();e.main_body_position_x=t.get_x(),e.main_body_position_y=t.get_y()},Tt.setCarSpace=function(e,t){for(var n=0,i=e.all_bodies;n<i.length;){var r=i[n];++n,r.get_space()!=t&&r.set_space(t)}for(var a=0,s=e.all_constraints;a<s.length;){var l=s[a];++a,l.get_space()!=t&&l.set_space(t)}};var Dt=function(){this.bot_sheep=[]};(n["bikas.game.EscapeFromWolfChallenge"]=Dt).__name__=["bikas","game","EscapeFromWolfChallenge"],Dt.prototype={challenge_type:null,player_sheep:null,player_wolf:null,bot_wolf:null,bot_sheep:null,wolf_finish_position:null,__class__:Dt};var Et=function(){};(n["bikas.game.MountainRushChallenge"]=Et).__name__=["bikas","game","MountainRushChallenge"],Et.prototype={flips_text:null,mountain_finish_position:null,__class__:Et};var Ot=function(){this.arrow_animation_current_time=0,this.animate_arrow=!1,this.fall_time=-1,this.fall_end_time=-1,this.fall_start_time=-1};(n["bikas.game.BarrelPlatform"]=Ot).__name__=["bikas","game","BarrelPlatform"],Ot.prototype={barrel:null,ground:null,arrow:null,fall_start_time:null,fall_end_time:null,fall_time:null,animate_arrow:null,arrow_animation_current_time:null,__class__:Ot};var Bt=function(){this.current_damage=0,this.barrel_platforms=[]};(n["bikas.game.SurvivalChallenge"]=Bt).__name__=["bikas","game","SurvivalChallenge"],Bt.prototype={barrel_platforms:null,text:null,current_damage:null,__class__:Bt};var Lt=function(){};(n["bikas.game.BalancingChallenge"]=Lt).__name__=["bikas","game","BalancingChallenge"],Lt.prototype={box:null,__class__:Lt};var jt=function(){this.current_time=0};(n["bikas.game.BulletTaxiChallenge"]=jt).__name__=["bikas","game","BulletTaxiChallenge"],jt.prototype={text:null,current_time:null,__class__:jt};var Ft=function(){};(n["bikas.game.AchievementChallenge"]=Ft).__name__=["bikas","game","AchievementChallenge"],Ft.prototype={__class__:Ft};var Rt=function(){this.balloons_attached=!1};(n["bikas.game.CreditsChallenge"]=Rt).__name__=["bikas","game","CreditsChallenge"],Rt.prototype={balloons_attached:null,__class__:Rt};var Gt=n["bikas.game.ChallengeTextState"]={__ename__:["bikas","game","ChallengeTextState"],__constructs__:["None","PhaseIn","Show","PhaseOut"]};Gt.None=["None",0],Gt.None.toString=i,(Gt.None.__enum__=Gt).PhaseIn=["PhaseIn",1],Gt.PhaseIn.toString=i,(Gt.PhaseIn.__enum__=Gt).Show=["Show",2],Gt.Show.toString=i,(Gt.Show.__enum__=Gt).PhaseOut=["PhaseOut",3],Gt.PhaseOut.toString=i,(Gt.PhaseOut.__enum__=Gt).__empty_constructs__=[Gt.None,Gt.PhaseIn,Gt.Show,Gt.PhaseOut];var Zt=function(){this.state=Gt.None};(n["bikas.game.ChallengeText"]=Zt).__name__=["bikas","game","ChallengeText"],Zt.prototype={state:null,bitmap_text:null,current_time:null,__class__:Zt};var Ut=function(){this.credits=null,this.achievement=null,this.bullet_taxi=null,this.balancing=null,this.survival=null,this.mountain_rush=null,this.escape_from_wolf=null,this.current_explosion_animations=[]};(n["bikas.game.Challenges"]=Ut).__name__=["bikas","game","Challenges"],Ut.prototype={current_explosion_animations:null,escape_from_wolf:null,mountain_rush:null,survival:null,balancing:null,bullet_taxi:null,achievement:null,credits:null,__class__:Ut};var Vt=function(){};(n["bikas.game.ChallengeDo"]=Vt).__name__=["bikas","game","ChallengeDo"],Vt.createEscapeFromWolfChallenge=function(e,t,n,i,r,a){var s=new Dt;s.challenge_type=a;var l=n.slice();if(l.sort(Vt.sortBotsByInitialPositionX),3!=l.length)return xl.trace("warning: there should be exactly 3 bots",{fileName:"ChallengeDo.hx",lineNumber:67,className:"bikas.game.ChallengeDo",methodName:"createEscapeFromWolfChallenge"}),null;for(var o=0;o<l.length;){var _=l[o];++o;for(var p=0,u=_.stunt_decisions;p<u.length;){var h=u[p];++p,h.allow=!1}_.personality_applied=!1}if(a==br.ChallengeEscapeFromWolf)s.player_sheep=t,s.player_wolf=null,s.bot_wolf=l[0],s.bot_sheep.push(l[1]),s.bot_sheep.push(l[2]);else{s.player_sheep=null,s.player_wolf=t,s.bot_sheep.push(l[0]),s.bot_sheep.push(l[1]),s.bot_sheep.push(l[2]);for(var c=0,d=s.bot_sheep;c<d.length;){var m=d[c];++c,m.personality.ability=new $e(1,1,1,1),m.personality_applied=!1}}s.wolf_finish_position=Vt.findPositionOfEntity(e,"wolf finish position");for(var f=new hr,g=new hr,v=0,b=s.bot_sheep;v<b.length;){var y=b[v];++v,y.config=wr.getUpgradedCarConfigCopy(i,f,r,y.car.name)}var x=null;return null!=s.player_sheep?(s.player_sheep.config=wr.getUpgradedCarConfigCopy(i,f,r,t.car.name),s.bot_wolf.config=wr.getUpgradedCarConfigCopy(i,g,r,t.car.name),x=s.bot_wolf.car):null!=s.player_wolf&&(s.player_wolf.config=wr.getUpgradedCarConfigCopy(i,g,r,t.car.name),x=s.player_wolf.car),x.main_body.set_group(null),x.main_body.setShapeFilters(zi.car_wolf_body),x.back_wheel_body.setShapeFilters(zi.car_wolf_wheel),x.front_wheel_body.setShapeFilters(zi.car_wolf_wheel),xl.trace("escape from wolf challenge created",{fileName:"ChallengeDo.hx",lineNumber:123,className:"bikas.game.ChallengeDo",methodName:"createEscapeFromWolfChallenge"}),s},Vt.createMountainRushChallenge=function(e,t,n,i,r){var a=new Et,s=new hr;t.config=wr.getUpgradedCarConfigCopy(i,s,r,t.car.name);for(var l=0;l<n.length;){var o=n[l];++l,o.config=wr.getUpgradedCarConfigCopy(i,s,r,o.car.name)}return a.mountain_finish_position=Vt.findPositionOfEntity(e,"mountain finish position"),a.flips_text=Ra.createBitmapText(cn.toonish_36,42,"left","TEXT"),a.flips_text.anchor.set(.5,.5),xl.trace("mountain rush challenge created",{fileName:"ChallengeDo.hx",lineNumber:147,className:"bikas.game.ChallengeDo",methodName:"createMountainRushChallenge"}),a},Vt.createSurvivalChallenge=function(e,t,n,i,r,a){var s=new Bt;s.text=Ra.createBitmapText(cn.toonish_36,42,"left","TEXT"),s.text.anchor.set(.5,.5);var l=new hr;t.config=wr.getUpgradedCarConfigCopy(i,l,r,t.car.name);for(var o=0,_=e.group.entities;o<_.length;){var p=_[o];if(++o,null!=p.prefab&&"explosive_barrel_on_crate"==p.prefab.prefab_name){for(var u=new Ot,h=0,c=p.group.entities;h<c.length;){var d=c[h];if(++h,"explosive_barrel_marker"==d.name)u.arrow=d;else if(null!=d.prefab)if("explosive_metal_barrel"==d.prefab.prefab_name)for(var m=0,f=d.group.entities;m<f.length;){var g=f[m];++m,null!=g.body&&(u.barrel=g)}else if("static_crate"==d.prefab.prefab_name)for(var v=0,b=d.group.entities;v<b.length;){var y=b[v];++v,null!=y.body&&(u.ground=y)}}if(null==u.arrow&&(xl.trace("warning: platform.arrow == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),1))break;if(null==u.barrel&&(xl.trace("warning: platform.barrel == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),1))break;if(null==u.ground&&(xl.trace("warning: platform.ground == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),1))break;for(var x=0;x<a.length;){var z=a[x];if(++x,z.body==u.barrel.body){xl.trace("success!",{fileName:"ChallengeDo.hx",lineNumber:202,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),z.explosion_radius=150;break}}s.barrel_platforms.push(u)}}return s.barrel_platforms.length!=Bt.barrel_fall_time_array.length&&xl.trace("warning: barrel fall time and barrel platform array lengths are not equal",{fileName:"ChallengeDo.hx",lineNumber:214,className:"bikas.game.ChallengeDo",methodName:"createSurvivalChallenge"}),s.barrel_platforms.sort(Vt.sortBarrelPlatformsByX),s},Vt.createBalancingChallenge=function(e,t,n,i,r,a){var s=new Lt,l=new hr;return t.config=wr.getUpgradedCarConfigCopy(i,l,r,t.car.name),0<a.length&&(s.box=a[0]),s},Vt.createBulletTaxiChallenge=function(e,t,n,i,r){var a=new jt,s=new hr;return s.acceleration=9,s.top_speed=9,t.config=wr.getUpgradedCarConfigCopy(i,s,r,t.car.name),t.config.nitro_velocity_to_drive_velocity_max_coeff=1.5,a.text=Ra.createBitmapText(cn.toonish_36,42,"left","TEXT"),a.text.anchor.set(.5,.5),a},Vt.createAchievementChallenge=function(e,t,n){return new Ft},Vt.createCreditsChallenge=function(e,t,n){return new Rt},Vt.findEntity=function(e,t){for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];if(++n,r.name==t)return r}return xl.trace("warning: could not find "+t,{fileName:"ChallengeDo.hx",lineNumber:301,className:"bikas.game.ChallengeDo",methodName:"findEntity"}),null},Vt.findPositionOfEntity=function(e,t){for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];if(++n,r.name==t)return r.position}return xl.trace("warning: could not find "+t,{fileName:"ChallengeDo.hx",lineNumber:311,className:"bikas.game.ChallengeDo",methodName:"findPositionOfEntity"}),new Yr(0,0)},Vt.sortBarrelPlatformsByX=function(e,t){return e.ground.position.x>t.ground.position.x?1:e.ground.position.x<t.ground.position.x?-1:0},Vt.sortBotsByInitialPositionX=function(e,t){return e.car.initial_main_body_position.get_x()>t.car.initial_main_body_position.get_x()?1:e.car.initial_main_body_position.get_x()<t.car.initial_main_body_position.get_x()?-1:0},Vt.createExplosionAnimation=function(e,t,n){var i=T.createNewAnimation(Os.animation_explosion,!0);return i.frame_time_coeff=Os.animation_explosion.frames.length/Ce.total_explosion_time,e.add(i.group),i.group.x=t,i.group.y=n,i.group.scale.x=2,i.group.scale.y=2,i},Vt.endRace=function(e,t,n,i){1==Xs.config.type&&3==Xs.config.release.sitelock_type&&Ya.PokiSDK.gameplayStop(),e.finished_race=!0,e.behavior_activated=!1,null!=i&&(i.behavior_activated=!1),Me.deactivateAbilities(e.abilities),e.nitro_button.state!=rr.Empty&&(e.nitro_button.state=rr.TransitionOut),e.ability_button.state!=fe.None&&(e.ability_button.state=fe.None,be.pushToOld(e.ability_button)),t.current_camera_time=0,t.current_time=0,t.state=vn.WaitForFinished,t.type=n},Vt.disableCar=function(e){for(var t=0,n=e.all_bodies;t<n.length;){var i=n[t];++t,i.setShapeFilters(zi.only_to_ground)}for(var r=0,a=e.all_constraints;r<a.length;){var s=a[r];++r,s.set_active(!1)}e.main_body_entity.display.sprite.alpha=0,null!=e.main_body_background_sprite&&(e.main_body_background_sprite.alpha=0)},Vt.applyExplosion=function(e,t,n){Un.playSoundInGameLevel(Os.sound_explosion,n,e.get_position(),t,1600,1),Me.applyExplosionImpulseToBodies(e.get_space(),[],e.get_position(),150,!1,200,600,1,2,.9)},Vt.destroyAllChallenges=function(e){for(var t=0,n=e.current_explosion_animations;t<n.length;){var i=n[t];++t,T.destroyAnimation(i,!0)}e.current_explosion_animations=[],null!=e.escape_from_wolf&&(e.escape_from_wolf.player_sheep=null,e.escape_from_wolf.player_wolf=null,e.escape_from_wolf.bot_wolf=null,e.escape_from_wolf.bot_sheep=null,e.escape_from_wolf=null),null!=e.mountain_rush&&(e.mountain_rush.flips_text.destroy(!0),e.mountain_rush=null),null!=e.survival&&(e.survival.text.destroy(!0),e.survival.barrel_platforms=null,e.survival.text=null,e.survival=null),null!=e.balancing&&(e.balancing.box=null,e.balancing=null),null!=e.bullet_taxi&&(e.bullet_taxi.text.destroy(!0),e.bullet_taxi.text=null,e.bullet_taxi=null),null!=e.achievement&&(e.achievement=null),null!=e.credits&&(e.credits=null)},Vt.updateChallengesCommonStuff=function(e,t){for(var n=0,i=e.current_explosion_animations;n<i.length;){var r=i[n];++n;var a=pa.clamp(t.dc,0,2);if(T.nextFrameStep(r,a)){T.destroyAnimation(r,!0),s.remove(e.current_explosion_animations,r);break}}},Vt.updateEscapeFromWolfChallenge=function(e,t,n,i,r,a,l,o){var _=null;if(e.challenge_type==br.ChallengeEscapeFromWolf)_=e.bot_wolf.car;else if(e.challenge_type==br.ChallengeHuntThePrey&&(_=e.player_wolf.car,!e.player_wolf.finished_race))for(var p=0,u=e.bot_sheep;p<u.length;){var h=u[p];++p,h.finished_race&&Vt.endRace(r,i,yn.LevelEndFail,l)}if(_.main_body_position_x>=e.wolf_finish_position.x){null!=e.player_wolf?e.player_wolf.behavior_activated=!1:null!=e.bot_wolf&&(e.bot_wolf.behavior_activated=!1);var c=_.back_wheel_body;c.set_angularVel(.5*c.get_angularVel());var d=_.front_wheel_body;d.set_angularVel(.5*d.get_angularVel())}for(var m=e.player_sheep,f=e.player_wolf,g=_.main_body.get_arbiters().iterator();g.hasNext();){var v=g.next();if(v.isCollisionArbiter()){if(null!=m&&!m.finished_race&&(v.get_body1()==m.car.main_body||v.get_body2()==m.car.main_body)){var b=Vt.createExplosionAnimation(n.group.container,m.car.main_body.get_position().get_x(),e.player_sheep.car.main_body.get_position().get_y());return a.push(b),Vt.applyExplosion(m.car.main_body,m.car,o),m.behavior_activated=!1,Vt.disableCar(m.car),e.player_sheep=null,void Vt.endRace(r,i,yn.LevelEndFail,l)}for(var y=0,x=e.bot_sheep;y<x.length;){var z=x[y];if(++y,v.get_body1()==z.car.main_body||v.get_body2()==z.car.main_body){var w=Vt.createExplosionAnimation(n.group.container,z.car.main_body.get_position().get_x(),z.car.main_body.get_position().get_y());if(a.push(w),null!=m?Vt.applyExplosion(z.car.main_body,m.car,o):null!=f&&Vt.applyExplosion(z.car.main_body,f.car,o),z.behavior_activated=!1,Vt.disableCar(z.car),s.remove(e.bot_sheep,z),e.challenge_type==br.ChallengeHuntThePrey&&0==e.bot_sheep.length)return void Vt.endRace(r,i,yn.LevelEndWin,l);break}}}}},Vt.updateMountainRushChallenge=function(e,t,n,i,r,a,s,l,o){o&&(null==e.flips_text.parent&&r.add(e.flips_text),e.flips_text.position.x=t.current_game_width-150,e.flips_text.position.y=t.current_game_height/6);var _=Et.flip_count,p=i.stats.total_back_flips+i.stats.total_front_flips;e.flips_text.text=p+"/"+_+" flips",s.car.main_body_position_x>e.mountain_finish_position.x&&s.behavior_activated&&Vt.endRace(s,a,_<=p?yn.LevelEndWin:yn.LevelEndFail,l)},Vt.updateSurvivalChallenge=function(e,t,n,i,r,a,s,l,o,_,p){for(var u=0,h=e.barrel_platforms.length;u<h;){var c=u++,d=e.barrel_platforms[c];if(d.animate_arrow){d.arrow_animation_current_time+=n.step_size;var m=pa.clamp0to1(d.arrow_animation_current_time/Ot.arrow_animation_time);d.arrow.display.sprite.alpha=1-m,d.arrow.position.y+=Ot.arrow_speed_y,he.refresh(d.arrow),1==m&&(d.animate_arrow=!1)}if(null!=d.ground.body.get_space()&&!(s.car.main_body.get_velocity().get_x()<=0)){var f=(d.barrel.position.x-s.car.main_body.get_position().get_x())/s.car.main_body.get_velocity().get_x(),g=1;c<Bt.barrel_fall_time_array.length&&(g=Bt.barrel_fall_time_array[c]),f<=g&&(d.animate_arrow=!0,d.ground.display.sprite.alpha=0,d.ground.body.set_space(null))}}if(s.car.main_body.get_userData().just_exploded){s.car.main_body.get_userData().just_exploded=!1;var v=s.car.main_body.get_userData().last_explosion_t,b=s.car.main_body.get_userData().last_final_explosion_modifier*v*Bt.damage_coeff;e.current_damage+=b,e.current_damage=e.current_damage}if(o){var y=Math.ceil(Bt.total_health-e.current_damage);if(y<=0&&(y=0,s.behavior_activated)){var x=Vt.createExplosionAnimation(i.group.container,s.car.main_body.get_position().get_x(),s.car.main_body.get_position().get_y());_.push(x),Vt.applyExplosion(s.car.main_body,s.car,p),s.behavior_activated=!1,Vt.disableCar(s.car),Vt.endRace(s,a,yn.LevelEndFail,l)}null==e.text.parent&&r.add(e.text),e.text.position.x=t.current_game_width+Bt.text_offset,e.text.position.y=t.current_game_height/6,e.text.text="Health: "+y+"/"+Bt.total_health}},Vt.updateBalancingChallenge=function(e,t,n,i,r,a,s,l){null!=e.box&&(e.box.state!=Gi.Broken&&e.box.state!=Gi.Removed||s.behavior_activated&&Vt.endRace(s,a,yn.LevelEndFail,l))},Vt.updateBulletTaxiChallenge=function(e,t,n,i,r,a,s,l){if(s.behavior_activated){null==e.text.parent&&r.add(e.text);var o=pa.clamp0to1(e.current_time/jt.max_time);e.text.position.x=t.current_game_width+jt.text_offset,e.text.position.y=t.current_game_height/6;var _=Math.round((1-o)*jt.max_time);e.text.text=1==_?_+" second left":_+" seconds left",e.current_time+=n.step_size,s.abilities.nitro_power.activated||Me.activateOrExtendConstantPower(s.abilities.nitro_power,s.car,60*jt.max_time),1==o&&Vt.endRace(s,a,yn.LevelEndFail,l)}},Vt.updateAchievementChallenge=function(e,t,n,i,r,a,s,l){s.behavior_activated},Vt.updateCreditsChallenge=function(e,t,n,i,r,a,s,l,o){if(t.camera.zoom_min=.7,t.camera.zoom_max=.7,t.temp_dc_coeff=.5,Gn.setInGameControlsAlpha(t,0),l.behavior_activated&&(l.constant_drive=!1,e.balloons_attached||null!=t.partition_top&&null!=t.entity_partition_container&&(Gn.spawnAttachment(t,t.partition_top,t.entity_partition_container,l.car,De.AttachmentBalloon,-1),Gn.spawnAttachment(t,t.partition_top,t.entity_partition_container,l.car,De.AttachmentBalloon,-1),e.balloons_attached=!0),e.balloons_attached&&l.car.main_body_position_y<-5e3)){var _=s;if(null==_.challenge_button.parent&&t.menu_container.add(_.challenge_button),_.challenge_button.position.x=t.js_info.current_game_width/2,_.challenge_button.position.y=t.js_info.current_game_height/2,Gn.isObjectDownedInRadius(_.challenge_button,t.pointer,_.challenge_button.height/2+15)&&Gn.gotoNewLevel(t,i,t.inter_level_menu_save))return!1}return!0};var qt=function(){};(n["bikas.game.ContainerConnection"]=qt).__name__=["bikas","game","ContainerConnection"],qt.prototype={source_container:null,connected_container:null,__class__:qt};var Wt=function(){};(n["bikas.game.ContainerBody"]=Wt).__name__=["bikas","game","ContainerBody"],Wt.prototype={body:null,partition_objects:null,__class__:Wt};var Xt=function(){};(n["bikas.game.ContainerDo"]=Xt).__name__=["bikas","game","ContainerDo"],Xt.createAndConnectContainers=function(e,t){var n=new qt;return n.source_container=e,n.connected_container=t,n},Xt.updateConnectedContainers=function(e){e.connected_container.x=e.source_container.x,e.connected_container.y=e.source_container.y,e.connected_container.rotation=e.source_container.rotation},Xt.createContainerBody=function(e,t){var n=new Wt;return n.body=null!=t?t:new y_(e,d_.get(0,0)),n.partition_objects=[],n},Xt.addDisplayObject=function(e,t,n,i,r,a){null==a&&(a=-1);var s=Ea.insertNewObjectToLiveTree(t,n,i,!0,r,a);e.partition_objects.push(s)},Xt.setSpace=function(e,t){e.body.set_space(t)},Xt.destroyContainerBody=function(e,t,n){e.body.set_space(null);for(var i=0,r=e.partition_objects;i<r.length;){var a=r[i];++i,Ea.destroyLiveObject(t,a,n)}e.body=null,e.partition_objects=null},Xt.updateContainerBody=function(e){for(var t=e.body,n=0,i=e.partition_objects;n<i.length;){var r=i[n];++n,r.display_object.position.x=t.get_position().get_x(),r.display_object.position.y=t.get_position().get_y(),r.display_object.rotation=t.get_rotation()}};var Ht=function(){this.finish_times=[]};(n["bikas.game.CarRank"]=Ht).__name__=["bikas","game","CarRank"],Ht.prototype={name:null,finish_times:null,total_time:null,average_time:null,median_time:null,worst_time:null,best_time:null,difference_time:null,__class__:Ht};var Yt=n["bikas.game.RestartMode"]={__ename__:["bikas","game","RestartMode"],__constructs__:["Quick","LevelFinish"]};Yt.Quick=["Quick",0],Yt.Quick.toString=i,(Yt.Quick.__enum__=Yt).LevelFinish=["LevelFinish",1],Yt.LevelFinish.toString=i,(Yt.LevelFinish.__enum__=Yt).__empty_constructs__=[Yt.Quick,Yt.LevelFinish];var Jt=function(){this.initraces=[],this.levelloads=[],this.updates=[],this.car_ranks=[],this.runtime_info=null,this.camera_control=new en,this.capture_control=new wt,this.current_ai_decisions="",this.restart_mode=Yt.Quick};(n["bikas.game.Temp"]=Jt).__name__=["bikas","game","Temp"],Jt.prototype={restart_mode:null,current_ai_decisions:null,capture_control:null,camera_control:null,runtime_info:null,car_ranks:null,updates:null,levelloads:null,initraces:null,__class__:Jt};var Kt=n["bikas.game.CameraControlType"]={__ename__:["bikas","game","CameraControlType"],__constructs__:["Free","ImitatePlayer","AttachedToPlayer"]};Kt.Free=["Free",0],Kt.Free.toString=i,(Kt.Free.__enum__=Kt).ImitatePlayer=["ImitatePlayer",1],Kt.ImitatePlayer.toString=i,(Kt.ImitatePlayer.__enum__=Kt).AttachedToPlayer=["AttachedToPlayer",2],Kt.AttachedToPlayer.toString=i,(Kt.AttachedToPlayer.__enum__=Kt).__empty_constructs__=[Kt.Free,Kt.ImitatePlayer,Kt.AttachedToPlayer];var Qt=n["bikas.game.InterpolationType"]={__ename__:["bikas","game","InterpolationType"],__constructs__:["Linear","SmoothStart","SmoothEnd","SmoothStartEnd"]};Qt.Linear=["Linear",0],Qt.Linear.toString=i,(Qt.Linear.__enum__=Qt).SmoothStart=["SmoothStart",1],Qt.SmoothStart.toString=i,(Qt.SmoothStart.__enum__=Qt).SmoothEnd=["SmoothEnd",2],Qt.SmoothEnd.toString=i,(Qt.SmoothEnd.__enum__=Qt).SmoothStartEnd=["SmoothStartEnd",3],Qt.SmoothStartEnd.toString=i,(Qt.SmoothStartEnd.__enum__=Qt).__empty_constructs__=[Qt.Linear,Qt.SmoothStart,Qt.SmoothEnd,Qt.SmoothStartEnd];var $t=function(){this.fixed_zoom_target=1,this.smooth_steps_before=50,this.right_mouse_down_zoom=1,this.right_mouse_down_point=null,this.camera_pos=new Yr(0,0),this.drag_down_position=new Yr(0,0)};(n["bikas.game.ManualCamera"]=$t).__name__=["bikas","game","ManualCamera"],$t.prototype={drag_down_position:null,camera_pos:null,right_mouse_down_point:null,right_mouse_down_zoom:null,smooth_steps_before:null,fixed_zoom_target:null,__class__:$t};var en=function(){this.running=!1,this.current_follow_time=0,this.current_time=0,this.current_deattach_coeff=1,this.deattach_point=new Yr(0,0),this.camera_position=new Yr(0,0),this.offset_end=new Yr(0,0),this.offset_start=new Yr(0,-300),this.end_zoom=1,this.start_zoom=.3,this.speed=10,this.degrees=0,this.smooth_steps=0,this.interpolation_type=Qt.SmoothStartEnd,this.type=Kt.AttachedToPlayer,this.slow_down_while_following_at=-1};(n["bikas.game.CameraControl"]=en).__name__=["bikas","game","CameraControl"],en.prototype={slow_down_while_following_at:null,type:null,interpolation_type:null,smooth_steps:null,degrees:null,speed:null,start_zoom:null,end_zoom:null,offset_start:null,offset_end:null,camera_position:null,deattach_point:null,current_deattach_coeff:null,current_time:null,current_follow_time:null,interpolate_func:null,running:null,__class__:en};var tn=n["bikas.game.TitleTransitionState"]={__ename__:["bikas","game","TitleTransitionState"],__constructs__:["None","Init","FadeIn","PopInTitle","ScaleUpTitle","AlphaOutTitle","Done"]};tn.None=["None",0],tn.None.toString=i,(tn.None.__enum__=tn).Init=["Init",1],tn.Init.toString=i,(tn.Init.__enum__=tn).FadeIn=["FadeIn",2],tn.FadeIn.toString=i,(tn.FadeIn.__enum__=tn).PopInTitle=["PopInTitle",3],tn.PopInTitle.toString=i,(tn.PopInTitle.__enum__=tn).ScaleUpTitle=["ScaleUpTitle",4],tn.ScaleUpTitle.toString=i,(tn.ScaleUpTitle.__enum__=tn).AlphaOutTitle=["AlphaOutTitle",5],tn.AlphaOutTitle.toString=i,(tn.AlphaOutTitle.__enum__=tn).Done=["Done",6],tn.Done.toString=i,(tn.Done.__enum__=tn).__empty_constructs__=[tn.None,tn.Init,tn.FadeIn,tn.PopInTitle,tn.ScaleUpTitle,tn.AlphaOutTitle,tn.Done];var nn=function(){this.current_time=0};(n["bikas.game.TitleTransition"]=nn).__name__=["bikas","game","TitleTransition"],nn.prototype={state:null,current_time:null,container:null,background:null,title:null,__class__:nn};var rn=function(){this.code=[],this.fps=[]};(n["bikas.game.RuntimeTextInformation"]=rn).__name__=["bikas","game","RuntimeTextInformation"],rn.prototype={fps:null,code:null,build_text:null,last_scale_text:null,fps_text:null,code_text:null,memory_text:null,__class__:rn};var an=function(){};(n["bikas.game.MovingCircle"]=an).__name__=["bikas","game","MovingCircle"],an.prototype={sprite:null,frame:null,min_scale:null,max_scale:null,__class__:an};var sn=function(){};(n["bikas.game.UpgradeValues"]=sn).__name__=["bikas","game","UpgradeValues"],sn.prototype={__class__:sn};var ln=function(e,t,n,i,r){this.level=e,this.step_size=t,this.decay=n,this.width_cut=i,this.height=r};(n["bikas.game.PerlinStuff"]=ln).__name__=["bikas","game","PerlinStuff"],ln.prototype={level:null,step_size:null,decay:null,width_cut:null,height:null,__class__:ln};var on=function(e,t){this.current=e,this.max=t};(n["bikas.game.Wait"]=on).__name__=["bikas","game","Wait"],on.prototype={current:null,max:null,__class__:on};var _n=function(e){this.offset=new Yr,this.object=e};(n["bikas.game.ObjectDrag"]=_n).__name__=["bikas","game","ObjectDrag"],_n.prototype={object:null,offset:null,__class__:_n};var pn=function(){this.is_button=!1,this.default_value=null,this.current_value=null,this.values=null,this.field="",this.object=null};(n["bikas.game.DebugOption"]=pn).__name__=["bikas","game","DebugOption"],pn.prototype={text:null,object:null,field:null,values:null,current_value:null,default_value:null,is_button:null,__class__:pn};var un=function(){};(n["bikas.game.ResolutionOption"]=un).__name__=["bikas","game","ResolutionOption"],un.prototype={forced:null,text:null,width:null,height:null,__class__:un};var hn=e.bikas.game.DebugDo=function(){};(n["bikas.game.DebugDo"]=hn).__name__=["bikas","game","DebugDo"],hn.createDebugMenu=function(e,t,n){var i=e.debug_element,r=e.pointer,a=null,s=e.config.development;wa.addButton(i,"reload iframe",(function(){Xs.game.removeAllListeners();for(var t=0,n=Xs.top_listeners;t<n.length;){var r=n[t];++t,r.element.removeEventListener(r.type,r.func)}for(;null!=i.firstChild;)i.removeChild(i.firstChild);var a=to.get_document().getElementById("fps"),s=to.get_document().getElementById("ms"),l=to.get_document().getElementById("memory");a.parentNode.removeChild(a),s.parentNode.removeChild(s),l.parentNode.removeChild(l),Gn.destroyLevel(e,!0,!1),Xs.game.destroy(),Gn.nullTheExternalFunctionCalls(),to.get_window().parent.window.is_reload=!0;var o=Gn.getIframeElement();o.contentWindow.location.reload(),o.src=o.src})),e.config.development.show_update_times&&(wa.addFieldWatch(i,n,"game_update_time"),wa.addFieldWatch(i,n,"dc"),wa.addFieldWatch(i,hn,"physics_update_time"),wa.addFieldWatch(i,hn,"total_space_steps"),wa.addFieldEdit(i,Rn,"physics_velocity_iterations"),wa.addFieldEdit(i,Rn,"physics_position_iterations")),e.temp.updates.push((function(){Ni.isPressed(e.keyboard_keys_pressed,82)?e.temp_dc_coeff=3:Ni.isReleased(e.keyboard_keys_released,82)&&(e.temp_dc_coeff=1),Ni.isReleased(e.keyboard_keys_released,70)&&(e.physics_running=!e.physics_running)})),wa.addButton(i,"show/hide guideliness",(function(){if(null==a){a=Ra.createGraphics(),e.game_container.add(a);var n=t.current_game_width,i=t.current_game_height;a.lineStyle(4,0,1),a.moveTo(0,0),a.lineTo(n,0),a.moveTo(0,i/3),a.lineTo(n,i/3),a.moveTo(0,2*i/3),a.lineTo(n,2*i/3),a.moveTo(0,i),a.lineTo(n,i),a.moveTo(0,0),a.lineTo(0,i),a.moveTo(n/3,0),a.lineTo(n/3,i),a.moveTo(2*n/3,0),a.lineTo(2*n/3,i),a.moveTo(n,0),a.lineTo(n,i)}else a.destroy(!0),a=null})),wa.addButton(i,"pause/unpause",(function(){e.game_running=!e.game_running})),wa.addButton(i,"update once and pause",(function(){e.game_running=!0,e.pause_after_1_update=!0}));var l=[],o=function(e,t,n,i){null==i&&(i=!0);var r=new un;r.text=e,r.width=t,r.height=n,r.forced=i,l.push(r)};o("1280x720",1280,720,!1),o("960x720",960,720,!1),o("1280x720 (no scale)",1280,720),o("877x405 (iPhone X)",877,405),o("720x405 (default)",720,405),o("640x360 (no scale)",640,360),o("640x480 (no scale)",640,480),o("480x270 (no scale)",480,270),o("600x300 (no scale)",600,300),o("750x500 (no scale)",750,500),o("600x500 (no scale)",600,500),o("500x500 (no scale)",500,500),o("500x600 (no scale)",500,600),o("500x750 (no scale)",500,750),o("300x600 (no scale)",300,600),o("360x640 (no scale)",360,640),o("283x614 (iPhone X)",283,614);for(var _=[],p=0;p<l.length;){var u=l[p];++p,_.push(u.text)}var h="720x405 (default)";if(null!=t.force_size)for(var c=0;c<l.length;){var d=l[c];if(++c,d.forced&&d.width==t.force_size.width&&d.height==t.force_size.height){h=d.text;break}}wa.addItemSelect(i,h,_,"resolution",!1,(function(n,i){for(var r=i,a=0;a<l.length;){var s=l[a];++a,s.text==r&&(s.forced?t.force_size=new ea(s.width,s.height):(t.max_game_width=s.width,t.max_game_height=s.height,t.force_size=null))}Hs.scaleAndCenter(e.game_container,t)})),wa.addText(i,"Gameplay Bot",!1,!0),wa.addButton(i,"Start Gameplay Bot",(function(){e.gameplay_bot_enabled=!0,e.use_bot_to_control_player=!0,xl.trace("gameplay_bot: ON",{fileName:"DebugDo.hx",lineNumber:728,className:"bikas.game.DebugDo",methodName:"createDebugMenu"})})),wa.addButton(i,"Stop Gameplay Bot",(function(){e.gameplay_bot_enabled=!1,e.use_bot_to_control_player=!1,xl.trace("gameplay_bot: OFF",{fileName:"DebugDo.hx",lineNumber:737,className:"bikas.game.DebugDo",methodName:"createDebugMenu"})})),e.config.development.capture_mode&&kt.create(e,i),wa.addBoolEdit(i,e.config.development,"bot_decisions_enabled"),wa.addBoolEdit(i,e.config.development,"filter_out_bots"),wa.addItemSelect(i,e.game_save.current_car,or.all_cars,"current_car",!1,(function(t,n){e.game_save.current_car=or.all_cars[t]})),wa.addButton(i,"teleport player to finish",(function(){Gn.teleportPlayerToFinish(e)}));var m=new $t;e.temp.camera_control.type=Kt.Free,$t.zoom_speed=e.config.development.capture_mode?($t.smooth_steps=100,$t.scroll_coeff=10,$t.zoom_coeff=.005,.001):($t.smooth_steps=5,$t.scroll_coeff=30,$t.zoom_coeff=.005,1e3),e.temp.updates.push((function(){if(Ni.isPressed(e.keyboard_keys_released,67))if(s.manual_camera_control)s.manual_camera_control=!1,s.fixed_camera_zoom=-1,e.camera.smooth_steps=m.smooth_steps_before,null!=e.player&&(e.player.behavior_activated=!0),e.level_type==Fn.InRacing&&Gn.setInGameControlsAlpha(e,1);else{s.manual_camera_control=!0,s.fixed_camera_zoom=m.fixed_zoom_target,m.smooth_steps_before=e.camera.smooth_steps,m.fixed_zoom_target=e.camera.current_zoom,e.camera.smooth_steps=$t.smooth_steps,e.temp.camera_control.camera_position.x=e.camera.target_pos.get_x();var t=e.camera.target_pos.get_y();e.temp.camera_control.camera_position.y=t-50,null!=e.player&&(e.player.behavior_activated=!1),e.level_type==Fn.InRacing&&Gn.setInGameControlsAlpha(e,0)}if(s.manual_camera_control){if(Ni.isPressed(e.keyboard_keys_pressed,16)){var n=Xs.right_mouse_button_down;if(n){if(null!=m.right_mouse_down_point){var i=$t.zoom_coeff,a=-(r.main_pointer_object.current.y-m.right_mouse_down_point.y)*i+m.right_mouse_down_zoom;m.fixed_zoom_target=pa.clamp(a,.1,1)}}else if(r.main_pointer_object.state==qa.DOWNED){m.drag_down_position.x=r.main_pointer_object.current.x,m.drag_down_position.y=r.main_pointer_object.current.y;var l=e.camera.target_pos.get_x(),o=e.camera.target_pos.get_y();m.camera_pos=new Yr(l,o)}else if(r.main_pointer_object.state==qa.IS_DOWN){var _=$t.scroll_coeff,p=r.main_pointer_object.current.x-m.drag_down_position.x,u=r.main_pointer_object.current.y-m.drag_down_position.y;e.temp.camera_control.camera_position.x=-p*_+m.camera_pos.x,e.temp.camera_control.camera_position.y=-u*_+m.camera_pos.y}n?null==m.right_mouse_down_point&&(-1==s.fixed_camera_zoom&&(s.fixed_camera_zoom=1),m.right_mouse_down_point=new Yr(r.main_pointer_object.current.x,r.main_pointer_object.current.y),m.right_mouse_down_zoom=s.fixed_camera_zoom):m.right_mouse_down_point=null,Ni.isPressed(e.keyboard_keys_pressed,80)&&(null!=e.player?(e.temp.camera_control.camera_position.x=e.player.car.main_body_entity.position.x,e.temp.camera_control.camera_position.y=e.player.car.main_body_entity.position.y):null!=e.menu_camera_position&&(e.temp.camera_control.camera_position.x=e.menu_camera_position.x,e.temp.camera_control.camera_position.y=e.menu_camera_position.y))}s.fixed_camera_zoom<m.fixed_zoom_target?(s.fixed_camera_zoom+=e.step.dc*$t.zoom_speed,s.fixed_camera_zoom>m.fixed_zoom_target&&(s.fixed_camera_zoom=m.fixed_zoom_target)):s.fixed_camera_zoom>m.fixed_zoom_target&&(s.fixed_camera_zoom-=e.step.dc*$t.zoom_speed,s.fixed_camera_zoom<m.fixed_zoom_target&&(s.fixed_camera_zoom=m.fixed_zoom_target))}})),wa.addButton(i,"reset tutorial in game_save",(function(){e.game_save.tutorial_shown_controls=!1,e.game_save.tutorial_shown_jump=!1,e.game_save.tutorial_shown_nitro=!1,e.game_save.tutorial_shown_power=!1})),wa.addButton(i,"print coin data",(function(){for(var t=0,n=e.game_save.level_saves;t<n.length;){var i=n[t];++t,xl.trace("level: "+i.description_name+",coins: "+i.coins,{fileName:"DebugDo.hx",lineNumber:1745,className:"bikas.game.DebugDo",methodName:"createDebugMenu"})}})),wa.addText(i,"Inter-level Menu Car Shop",!1,!0),wa.addButton(i,"unlock last car",(function(){0<e.game_save.locked_cars.length&&e.game_save.locked_cars.pop()})),wa.addButton(i,"add 50 coins",(function(){e.game_save.coins+=50})),wa.addButton(i,"remove 50 coins",(function(){e.game_save.coins-=50}))},hn.createRuntimeTextInformation=function(e,t,n,i){var r=0==e.type&&e.development.show_build_information||1==e.type&&e.release.show_build_information,a=0==e.type&&e.development.show_performance_information||1==e.type&&e.release.show_performance_information;if(0==r&&0==a)return null;var s=new rn,l=ka.getTimer(),o=cn.consolas_24;s.fps_text=new ps(Xs.game,0,0,o,"",20,"center"),s.fps_text.anchor.set(0,0),s.fps_text.y=5,s.code_text=new ps(Xs.game,0,0,o,"",20,"center"),s.code_text.anchor.set(0,0),s.code_text.y=5,s.memory_text=new ps(Xs.game,0,0,o,"",20,"center"),s.memory_text.anchor.set(0,0),s.memory_text.y=5,s.build_text=new ps(Xs.game,0,0,o,"",20,"center"),s.build_text.anchor.set(0,0);var _=n.build_time,p=new Date(_);s.build_text.x=5,s.build_text.y=5;var u="";if(Xs.renderer.type==PIXI.RENDERER_TYPE.CANVAS?u="canvas":Xs.renderer.type==PIXI.RENDERER_TYPE.WEBGL?u="webgl":xl.trace("warning: unrecognized renderType "+Xs.renderer.type,{fileName:"DebugDo.hx",lineNumber:3050,className:"bikas.game.DebugDo",methodName:"createRuntimeTextInformation"}),r){s.build_text.text="build: ",s.build_text.text+=ka.getWellFormattedDate(p),s.build_text.text+=" "+u;var h="";n.desktop?h=n.windows?"windows":n.macOS?"macOS":n.linux?"linux":n.chromeOS?"chromeOS":"desktop":n.android?h="android":n.iOS?h="iOS":n.vita?h="vita":n.kindle?h="kindle":n.windowsPhone&&(h="windowsPhone"),s.build_text.text+="-"+h,Howler.usingWebAudio?s.build_text.text+="-web_audio":Howler.noAudio?s.build_text.text+="-no_audio":s.build_text.text+="-html5_audio",1==e.type&&0==e.release.sitelock_type&&(s.build_text.text+="-NO_ST!!!"),t.add(s.build_text)}return a&&(t.add(s.fps_text),t.add(s.code_text)),Xs.game_update_data.top_scripts.push((function(){if(a){var e=ka.getTimer(),t=1e3/(e-l);l=e,s.fps.push(t),60<s.fps.length&&s.fps.shift();for(var n=0,r=999,o=0,_=0,p=s.fps;_<p.length;){var u=p[_];++_,n+=u,u<r&&(r=u),o<u&&(o=u)}var h=n/s.fps.length;s.code.push(i.game_update_time),60<s.code.length&&s.code.shift();for(var c=0,d=999,m=0,f=0,g=s.code;f<g.length;){var v=g[f];++f,c+=v,v<d&&(d=v),m<v&&(m=v)}var b=c/s.code.length,y=(i.game_update_time,Math.round(100*i.level_seconds)/100+""),x=y.split(".");0==x.length?(x.push(y),x.push("")):1==x.length&&x.push(""),x[0];var z=x[1];0==z.length?z="00":1==z.length?z+="0":2<z.length&&(z=z.substring(0,2)),s.fps_text.text=" F:"+Math.round(h)+"/"+Math.round(r)+"/"+Math.round(o),s.code_text.text=" C:"+Math.round(b)+"/"+Math.round(d)+"/"+Math.round(m),s.fps_text.x=650,s.code_text.x=800}})),s},hn.bytesToMegabytesRounded=function(e){return Math.round(e/1048576)},hn.insertAfter=function(e,t){null==e.nextSibling?e.parentNode.appendChild(t):e.nextSibling.parentNode.insertBefore(t,e.nextSibling)},hn.applyLevelUpgradesToAll=function(e,t){var n=new hr,i=(t.car_upgrade_data,(e-1)/29);i=pa.clamp(i,0,1),n.top_speed=ca.linearRounded(0,9,i),n.acceleration=ca.linearRounded(0,9,i),n.handling=ca.linearRounded(0,9,i),n.armor=ca.linearRounded(0,9,i),xl.trace("apply level "+e+" upgrades to all cars: "+p.string(n),{fileName:"DebugDo.hx",lineNumber:3233,className:"bikas.game.DebugDo",methodName:"applyLevelUpgradesToAll"}),null!=wr.getCarSettingByName(t.car_settings,t.player.car.name)&&(t.player.config=wr.getUpgradedCarConfigCopy(t.car_upgrade_data,n,t.car_settings,t.player.car.name),null!=t.player_bot&&(t.player_bot.config=wr.getUpgradedCarConfigCopy(t.car_upgrade_data,n,t.car_settings,t.player.car.name)));for(var r=0,a=t.bots;r<a.length;){var s=a[r];++r,null!=wr.getCarSettingByName(t.car_settings,s.car.name)&&(s.config=wr.getUpgradedCarConfigCopy(t.car_upgrade_data,n,t.car_settings,s.car.name))}},hn.createStaticFieldEdits=function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;for(var r=i.split("."),a="",s="",l=0,o=r.length;l<o;){var _=l++;_==r.length-1?s=r[_]:a+=r[_],_<r.length-2&&(a+=".")}var p=d.resolveClass(a);wa.addFieldEdit(e,p,s)}},hn.createStaticFieldWatches=function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;for(var r=i.split("."),a="",s="",l=0,o=r.length;l<o;){var _=l++;_==r.length-1?s=r[_]:a+=r[_],_<r.length-2&&(a+=".")}var p=d.resolveClass(a);wa.addFieldWatch(e,p,s)}},hn.addPointDebug=function(e,t,n){wa.addFieldEdit(e,t,"x",n+".x"),wa.addFieldEdit(e,t,"y",n+".y")},hn.printDisplayObjectInformation=function(e,t){for(var n=t;null!=n;){var i=hn.getDisplayObjectName(n);xl.trace("is "+i,{fileName:"DebugDo.hx",lineNumber:3306,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"});var r=n;xl.trace("object.position.x: "+r.position.x,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),xl.trace("object.position.y: "+r.position.y,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),xl.trace("object.width: "+r.width,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),xl.trace("object.height: "+r.height,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),xl.trace("object.scale.x: "+r.scale.x,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),xl.trace("object.scale.y: "+r.scale.y,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),xl.trace("object.visible: "+(null==r.visible?"null":""+r.visible),{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),xl.trace("object.alpha: "+r.alpha,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),xl.trace("goto parent",{fileName:"DebugDo.hx",lineNumber:3320,className:"bikas.game.DebugDo",methodName:"printDisplayObjectInformation"}),n=n.parent}},hn.getNameOfDisplayObjectWithParentNames=function(e){hn.game;for(var t=e,n=[];null!=t;)n.push(hn.getDisplayObjectName(t)),t=t.parent;return n},hn.getDisplayObjectName=function(e){var t=hn.game;if(null==e)return"null";var n="no_name";null!=t&&(null!=t.stage_group&&e==t.stage_group.group.container&&(n="stage_group.group.container"),e==t.game_container&&(n="game_container"),e==t.background_container&&(n="background_container"),null!=t.background&&(e==t.background.background_container?n="background.background_container":e==t.background.foreground_container?n="background.foreground_container":e==t.background.plane_container&&(n="background.plane_container")),e==t.background_ground_group&&(n="background_ground_group"),e==t.ground_group&&(n="ground_group"),e==t.grass_group&&(n="grass_group"),e==t.ground_container&&(n="ground_container"),e==t.entity_container&&(n="entity_container"),e==t.foreground_container&&(n="foreground_container"),e==t.ingame_container&&(n="ingame_container"),e==t.ability_item_container&&(n="ability_item_container"),e==t.ongoing_powers_container&&(n="ongoing_powers_container"),e==t.menu_container&&(n="menu_container"),e==t.runtime_information_container&&(n="runtime_information_container"));var i=e;null!=i.name&&(n=i.name);var r="",a="",s=!1;if(p.is(e,ls))r="Graphics";else if(p.is(e,us)){r="Sprite";var l=e;if(null==l.texture)a="null";else{a="could not find";for(var o=0,u=_.fields(Os);o<u.length;){var h=u[o];if(++o,l.texture==_.field(Os,h)){a=h;break}}}-1!=us.destroyed_sprite_list.indexOf(l)&&(s=!0)}else if(p.is(e,hs))r="Group",-1!=hs.destroyed_group_list.indexOf(e)&&(s=!0);else{var c=d.getClass(e);r=null==c?"null":d.getClassName(c)}return n+="(",n+="class:"+r,""!=a&&(n+=",texture:"+a),e.visible||(n+=",visible:false"),s&&(n+=",destroyed!!!"),n+=")"},hn.getAllSprites=function(e,t){var n=p.is(e,PIXI.Sprite),i=p.is(e,PIXI.Container);if(n)t.push(e);else if(i)for(var r=eo.__cast(e,PIXI.Container).children,a=0;a<r.length;){var s=r[a];++a,hn.getAllSprites(s,t)}},hn.putPoint=function(e,t,n){return null==n&&(n=10),null==t&&(t=16711680),hn.putMarker(e.x,e.y,t,n)},hn.putMarker=function(e,t,n,i){if(null==i&&(i=10),null==n&&(n=16711680),null==hn.debug_container)return null;var r=new ls(Xs.game),a=i/2;return r.lineStyle(1,n,1),r.moveTo(-a,-a),r.lineTo(a,a),r.moveTo(a,-a),r.lineTo(-a,a),r.position.set(e,t),r.cacheAsBitmap=!0,hn.debug_container.add(r),r},hn.putLinePoints=function(e,t,n){return null==n&&(n=16711680),hn.putLine(e.x,e.y,t.x,t.y,n)},hn.putLine=function(e,t,n,i,r,a){if(null==a&&(a=1),null==r&&(r=16711680),null==hn.debug_container)return null;var s=Ra.createGraphics();return s.lineStyle(a,r,1),s.moveTo(e,t),s.lineTo(n,i),hn.debug_container.add(s),s},hn.putRectangle=function(e,t,n,i,r){if(null==i&&(i=16777215),null==n&&(n=!1),null==t&&(t=16711680),null==hn.debug_container&&null==r)return null;null==r&&(r=hn.debug_container);var a=Ra.createGraphics();return a.position.set(e.x,e.y),n&&a.beginFill(i),a.lineStyle(2,t,1),a.moveTo(0,0),a.lineTo(e.width,0),a.lineTo(e.width,e.height),a.lineTo(0,e.height),a.lineTo(0,0),n&&a.endFill(),a.cacheAsBitmap=!0,r.add(a),a},hn.putCircle=function(e,t,n,i,r,a){if(null==r&&(r=16777215),null==i&&(i=!1),null==n&&(n=16711680),null==hn.debug_container&&null==a)return null;null==a&&(a=hn.debug_container);var s=new ls(Xs.game);return s.position.set(e.x,e.y),i&&s.beginFill(r),s.lineStyle(2,n,1),s.drawCircle(0,0,2*t),i&&s.endFill(),s.cacheAsBitmap=!0,a.add(s),s},hn.putTrajectory=function(e,t,n,i,r,a,s){if(null==s&&(s=10),null==a&&(a=-65536),null!=hn.debug_container)for(var l=n,o=t,_=e,p=i,u=r;p<u;){var h=p++,c=l.x*h*h/2+o.x*h+_.x,d=l.y*h*h/2+o.y*h+_.y;hn.putMarker(c,d,a,s)}};var cn=function(){};(n["bikas.game.Fonts"]=cn).__name__=["bikas","game","Fonts"];var dn=function(){};(n["bikas.game.FlyWithGraphics"]=dn).__name__=["bikas","game","FlyWithGraphics"],dn.prototype={container:null,body:null,wings:null,fly:null,__class__:dn};var mn=function(){};(n["bikas.game.AnimBody"]=mn).__name__=["bikas","game","AnimBody"],mn.prototype={anim:null,body:null,__class__:mn};var fn=function(){};(n["bikas.game.PostRequest"]=fn).__name__=["bikas","game","PostRequest"],fn.prototype={xhr:null,json:null,on_finished:null,__class__:fn};var gn=function(){this.transition_current_time=0};(n["bikas.game.LevelLoadScreen"]=gn).__name__=["bikas","game","LevelLoadScreen"],gn.prototype={transition_current_time:null,container:null,background:null,middle_container:null,title:null,loading_track_text:null,loader_background:null,loader_foreground:null,track_loader_foreground_original_frame:null,track_loader_foreground_current_frame:null,__class__:gn};var vn=n["bikas.game.LevelEndState"]={__ename__:["bikas","game","LevelEndState"],__constructs__:["None","WaitForFinished","FinishedAnimation","WaitForLevelStats","InLevelStats","InAd","InNext"]};vn.None=["None",0],vn.None.toString=i,(vn.None.__enum__=vn).WaitForFinished=["WaitForFinished",1],vn.WaitForFinished.toString=i,(vn.WaitForFinished.__enum__=vn).FinishedAnimation=["FinishedAnimation",2],vn.FinishedAnimation.toString=i,(vn.FinishedAnimation.__enum__=vn).WaitForLevelStats=["WaitForLevelStats",3],vn.WaitForLevelStats.toString=i,(vn.WaitForLevelStats.__enum__=vn).InLevelStats=["InLevelStats",4],vn.InLevelStats.toString=i,(vn.InLevelStats.__enum__=vn).InAd=["InAd",5],vn.InAd.toString=i,(vn.InAd.__enum__=vn).InNext=["InNext",6],vn.InNext.toString=i,(vn.InNext.__enum__=vn).__empty_constructs__=[vn.None,vn.WaitForFinished,vn.FinishedAnimation,vn.WaitForLevelStats,vn.InLevelStats,vn.InAd,vn.InNext];var bn=n["bikas.game.LevelEndNextState"]={__ename__:["bikas","game","LevelEndNextState"],__constructs__:["None","NextInterLevelMenu","NextCreditsLevel","NextRestartLevel"]};bn.None=["None",0],bn.None.toString=i,(bn.None.__enum__=bn).NextInterLevelMenu=["NextInterLevelMenu",1],bn.NextInterLevelMenu.toString=i,(bn.NextInterLevelMenu.__enum__=bn).NextCreditsLevel=["NextCreditsLevel",2],bn.NextCreditsLevel.toString=i,(bn.NextCreditsLevel.__enum__=bn).NextRestartLevel=["NextRestartLevel",3],bn.NextRestartLevel.toString=i,(bn.NextRestartLevel.__enum__=bn).__empty_constructs__=[bn.None,bn.NextInterLevelMenu,bn.NextCreditsLevel,bn.NextRestartLevel];var yn=n["bikas.game.LevelEndType"]={__ename__:["bikas","game","LevelEndType"],__constructs__:["LevelEndWin","LevelEndFail"]};yn.LevelEndWin=["LevelEndWin",0],yn.LevelEndWin.toString=i,(yn.LevelEndWin.__enum__=yn).LevelEndFail=["LevelEndFail",1],yn.LevelEndFail.toString=i,(yn.LevelEndFail.__enum__=yn).__empty_constructs__=[yn.LevelEndWin,yn.LevelEndFail];var xn=function(){this.current_time=0,this.current_camera_time=0,this.camera_position=new Yr(0,0)};(n["bikas.game.LevelEnd"]=xn).__name__=["bikas","game","LevelEnd"],xn.prototype={type:null,state:null,next_state:null,camera_position:null,current_camera_time:null,finished_text:null,challenge_button:null,current_time:null,__class__:xn};var zn=function(){this.place_number=-1};(n["bikas.game.CurrentPlace"]=zn).__name__=["bikas","game","CurrentPlace"],zn.prototype={container:null,anim:null,place_number:null,player_position:null,__class__:zn};var wn=function(){this.challenge_text=null,this.engine_sound_allowed=!1,this.finished=!1,this.current_time=0,this.current_number=5};(n["bikas.game.RaceCountdown"]=wn).__name__=["bikas","game","RaceCountdown"],wn.prototype={container:null,animation:null,current_number:null,current_time:null,finished:null,engine_sound_allowed:null,challenge_text:null,__class__:wn};var kn=function(){this.current_anim_time=0,this.displayed_amount=-1,this.digit_count=1};(n["bikas.game.CoinDisplay"]=kn).__name__=["bikas","game","CoinDisplay"],kn.prototype={coin:null,text:null,digit_count:null,displayed_amount:null,current_anim_time:null,__class__:kn};var Sn=function(e,t,n,i,r){null==r&&(r=1),null==i&&(i=5),null==n&&(n=10),null==t&&(t=10),null==e&&(e=60),this.current_duration=0,this.current_delay=e,this.duration=t,this.smooth_in_duration=n,this.smooth_out_duration=i,this.time_coeff=r};(n["bikas.game.SlowDownTime"]=Sn).__name__=["bikas","game","SlowDownTime"],Sn.prototype={duration:null,smooth_in_duration:null,smooth_out_duration:null,time_coeff:null,current_delay:null,current_duration:null,__class__:Sn};var Cn=function(){this.amount=0,this.current_time=0};(n["bikas.game.CameraShake"]=Cn).__name__=["bikas","game","CameraShake"],Cn.prototype={current_time:null,amount:null,__class__:Cn};var Nn=function(){this.wait_time=2,this.wait_before_phase_in_time=0};(n["bikas.game.Notify"]=Nn).__name__=["bikas","game","Notify"],Nn.prototype={primary_text:null,secondary_text:null,wait_before_phase_in_time:null,wait_time:null,__class__:Nn};var Pn=n["bikas.game.NotificationState"]={__ename__:["bikas","game","NotificationState"],__constructs__:["WaitBeforePhaseIn","PhaseIn","Wait","PhaseOut","None"]};Pn.WaitBeforePhaseIn=["WaitBeforePhaseIn",0],Pn.WaitBeforePhaseIn.toString=i,(Pn.WaitBeforePhaseIn.__enum__=Pn).PhaseIn=["PhaseIn",1],Pn.PhaseIn.toString=i,(Pn.PhaseIn.__enum__=Pn).Wait=["Wait",2],Pn.Wait.toString=i,(Pn.Wait.__enum__=Pn).PhaseOut=["PhaseOut",3],Pn.PhaseOut.toString=i,(Pn.PhaseOut.__enum__=Pn).None=["None",4],Pn.None.toString=i,(Pn.None.__enum__=Pn).__empty_constructs__=[Pn.WaitBeforePhaseIn,Pn.PhaseIn,Pn.Wait,Pn.PhaseOut,Pn.None];var Mn=function(){this.current_time=0,this.show_current=null,this.show_cue=[],this.state=Pn.None};(n["bikas.game.Notifications"]=Mn).__name__=["bikas","game","Notifications"],Mn.prototype={state:null,container:null,show_cue:null,show_current:null,primary_text:null,secondary_text:null,current_time:null,__class__:Mn};var In=function(){this.line_sprites=[],this.data=null};(n["bikas.game.TexturedPolygonEntity"]=In).__name__=["bikas","game","TexturedPolygonEntity"],In.prototype={entity:null,draw_bounds:null,data:null,line_sprites:null,__class__:In};var An=function(){this.line_sprites=[],this.sprites=[],this.sprite_objects=[],this.global_polygons_bounds=[],this.global_polygons=[],this.polygons=[],this.entities=[],this.has_physics_body=!1};(n["bikas.game.TerrainPolygon"]=An).__name__=["bikas","game","TerrainPolygon"],An.prototype={texture_name:null,texture:null,main_entity_position:null,has_physics_body:null,entities:null,polygons:null,global_polygons:null,global_polygons_bounds:null,sprite_objects:null,sprites:null,line_sprites:null,terrain:null,global_bounds:null,__class__:An};var Tn=function(){};(n["bikas.game.Marker"]=Tn).__name__=["bikas","game","Marker"],Tn.prototype={name:null,entity:null,position:null,bitmap_text:null,point_graphics:null,__class__:Tn};var Dn=n["bikas.game.PauseMenuCardConfirmationType"]={__ename__:["bikas","game","PauseMenuCardConfirmationType"],__constructs__:["None","GotoMainMenu","GotoGarage"]};Dn.None=["None",0],Dn.None.toString=i,(Dn.None.__enum__=Dn).GotoMainMenu=["GotoMainMenu",1],Dn.GotoMainMenu.toString=i,(Dn.GotoMainMenu.__enum__=Dn).GotoGarage=["GotoGarage",2],Dn.GotoGarage.toString=i,(Dn.GotoGarage.__enum__=Dn).__empty_constructs__=[Dn.None,Dn.GotoMainMenu,Dn.GotoGarage];var En=function(){};(n["bikas.game.PauseDebugOption"]=En).__name__=["bikas","game","PauseDebugOption"],En.prototype={bitmap_text:null,callback:null,__class__:En};var On=function(){this.pause_debug_options=[],this.confirm_card=null,this.confirm_type=Dn.None};(n["bikas.game.PauseMenu"]=On).__name__=["bikas","game","PauseMenu"],On.prototype={container:null,background:null,button_play:null,button_restart:null,button_main_menu:null,button_garage:null,button_sounds:null,button_music:null,confirm_type:null,confirm_card:null,pause_debug_options:null,__class__:On};var Bn=n["bikas.game.TutorialState"]={__ename__:["bikas","game","TutorialState"],__constructs__:["TutorialNone","TutorialPhaseOut","TutorialControls","TutorialJump","TutorialNitro","TutorialPower"]};Bn.TutorialNone=["TutorialNone",0],Bn.TutorialNone.toString=i,(Bn.TutorialNone.__enum__=Bn).TutorialPhaseOut=["TutorialPhaseOut",1],Bn.TutorialPhaseOut.toString=i,(Bn.TutorialPhaseOut.__enum__=Bn).TutorialControls=["TutorialControls",2],Bn.TutorialControls.toString=i,(Bn.TutorialControls.__enum__=Bn).TutorialJump=["TutorialJump",3],Bn.TutorialJump.toString=i,(Bn.TutorialJump.__enum__=Bn).TutorialNitro=["TutorialNitro",4],Bn.TutorialNitro.toString=i,(Bn.TutorialNitro.__enum__=Bn).TutorialPower=["TutorialPower",5],Bn.TutorialPower.toString=i,(Bn.TutorialPower.__enum__=Bn).__empty_constructs__=[Bn.TutorialNone,Bn.TutorialPhaseOut,Bn.TutorialControls,Bn.TutorialJump,Bn.TutorialNitro,Bn.TutorialPower];var Ln=function(){this.wheel_angle=0,this.wheel_anim_current_time=0,this.phase_in_current_time=0,this.current_time=0,this.jump_marker=null,this.controls_marker=null,this.state=Bn.TutorialNone};(n["bikas.game.TutorialMenu"]=Ln).__name__=["bikas","game","TutorialMenu"],Ln.prototype={state:null,container:null,background:null,white_circle:null,text:null,keyboard_controls:null,wheel:null,finger:null,jump_button:null,nitro_button:null,power_button:null,controls_marker:null,jump_marker:null,current_time:null,phase_in_current_time:null,wheel_anim_current_time:null,wheel_angle:null,__class__:Ln};var jn=n["bikas.game.GameState"]={__ename__:["bikas","game","GameState"],__constructs__:["InGameLoad","InTransitionToLevelLoad","InLevelLoad","InTransitionToLevel","InLevel","InPause"]};jn.InGameLoad=["InGameLoad",0],jn.InGameLoad.toString=i,(jn.InGameLoad.__enum__=jn).InTransitionToLevelLoad=["InTransitionToLevelLoad",1],jn.InTransitionToLevelLoad.toString=i,(jn.InTransitionToLevelLoad.__enum__=jn).InLevelLoad=["InLevelLoad",2],jn.InLevelLoad.toString=i,(jn.InLevelLoad.__enum__=jn).InTransitionToLevel=["InTransitionToLevel",3],jn.InTransitionToLevel.toString=i,(jn.InTransitionToLevel.__enum__=jn).InLevel=["InLevel",4],jn.InLevel.toString=i,(jn.InLevel.__enum__=jn).InPause=["InPause",5],jn.InPause.toString=i,(jn.InPause.__enum__=jn).__empty_constructs__=[jn.InGameLoad,jn.InTransitionToLevelLoad,jn.InLevelLoad,jn.InTransitionToLevel,jn.InLevel,jn.InPause];var Fn=n["bikas.game.LevelType"]={__ename__:["bikas","game","LevelType"],__constructs__:["InRacing","InMainMenu","InInterLevelMenu"]};Fn.InRacing=["InRacing",0],Fn.InRacing.toString=i,(Fn.InRacing.__enum__=Fn).InMainMenu=["InMainMenu",1],Fn.InMainMenu.toString=i,(Fn.InMainMenu.__enum__=Fn).InInterLevelMenu=["InInterLevelMenu",2],Fn.InInterLevelMenu.toString=i,(Fn.InInterLevelMenu.__enum__=Fn).__empty_constructs__=[Fn.InRacing,Fn.InMainMenu,Fn.InInterLevelMenu];var Rn=function(){this.car_original_rotations=new Ml,this.camera_free=!1,this.draw_polygon_textures=!0,this.current_drag=null,this.drags=[],this.debug_element=null,this.temp=new Jt,this.use_bot_to_control_player=!1,this.gameplay_bot_enabled=!1,this.gameplay_bot=new Vn,this.lagged_logo=null,this.menu_camera_position=null,this.current_gameplay_music=null,this.collected_in_level=null,this.level_stats=null,this.main_menu=null,this.inter_level_menu=null,this.race_countdown=null,this.current_place=null,this.attachments=[],this.jump_over_bodies=[],this.temp_interactive_objects=[],this.pickable_items=[],this.chickens=[],this.looped_animations=[],this.connected_containers=[],this.immune_bodies=[],this.explosives=[],this.forward_ramps=[],this.boxes=[],this.level_bottom_position=null,this.level_end_position=null,this.level_start_position=null,this.terrain_polygons=[],this.textured_polygons=[],this.visible_bounds=new Qr,this.bots=[],this.player_bot=null,this.player=null,this.bot_cars=[],this.all_cars=[],this.wheel=null,this.textured_polygon_entities=[],this.camera=null,this.wait=null,this.slow_down_time=null,this.overlay_transitions=[],this.transitions=[],this.stunt=null,this.background=null,this.camera_shake=new Cn,this.markers=null,this.all_body_entities=null,this.challenges=new Ut,this.next_level_save=null,this.current_level_save=null,this.real_time_ground_graphics=[],this.real_time_background_ground_graphics=[],this.marker_group=null,this.mesh_line_sprites=[],this.ground_meshes=[],this.cave_meshes=[],this.notifications=new Mn,this.moving_circles=[],this.level_descriptions=[],this.all_reward_descs=[],this.background_edit=null,this.music_enabled=!0,this.sounds_enabled=!0,this.ongoing_powers_display=new jr,this.race_seconds=0,this.race_start_at_second=0,this.use_cached_terrain_polygons=!1,this.pre_wait_steps_current=0,this.pre_simulate_world_steps_current=0,this.background_camera_offset=new ji(0,0,0),this.background_ratio=.3333333333333333,this.camera_view_ratio=.3333333333333333,this.current_camera_refresh_height_cache=0,this.current_camera_refresh_width_cache=0,this.current_camera_height_coeff=.6666666666666666,this.current_camera_width_coeff=.5,this.game_running=!0,this.pause_after_1_update=!1,this.level_end_enabled=!0,this.keyboard_keys_released=[],this.keyboard_keys_pressed=[],this.current_level_index=0,this.delta_update_coeff_by_effect=1,this.debug_dc_coeff=1,this.temp_dc_coeff=1,this.initial_game_save_loaded=!1,this.physics_running=!1,this.level_running=!1,this.is_webgl=!0,this.level_type=null,this.previous_state=null,this.state=null};(n["bikas.game.Game"]=Rn).__name__=["bikas","game","Game"],Rn.prototype={config:null,state:null,previous_state:null,level_type:null,is_webgl:null,game_container:null,background_container:null,ground_container:null,entity_container:null,foreground_container:null,ingame_container:null,ability_item_container:null,ongoing_powers_container:null,menu_container:null,runtime_information_container:null,engine:null,world:null,level_running:null,physics_running:null,bitmap_assets:null,animation_assets:null,library_group:null,stage_group_original:null,stage_group:null,initial_game_save_loaded:null,size:null,level_area:null,js_info:null,step:null,pointer:null,temp_dc_coeff:null,debug_dc_coeff:null,delta_update_coeff_by_effect:null,current_level_index:null,keyboard_keys_pressed:null,keyboard_keys_released:null,level_end_enabled:null,pause_after_1_update:null,game_running:null,current_camera_width_coeff:null,current_camera_height_coeff:null,current_camera_refresh_width_cache:null,current_camera_refresh_height_cache:null,camera_view_ratio:null,background_ratio:null,background_camera_offset:null,pre_simulate_world_steps_current:null,pre_wait_steps_current:null,use_cached_terrain_polygons:null,race_start_at_second:null,race_seconds:null,game_save:null,ongoing_powers_display:null,sounds_enabled:null,music_enabled:null,background_edit:null,game_save_serial_data:null,car_settings:null,car_upgrade_data:null,chest_reward_item_descs:null,achievement_descs:null,challenge_descs:null,all_reward_descs:null,level_descriptions:null,upgrades:null,ability_probabilities:null,first_level_save:null,main_menu_save:null,inter_level_menu_save:null,credits_save:null,achievement_save:null,moving_circles:null,pause_button:null,pause_menu:null,tutorial_menu:null,level_load_screen:null,level_end:null,coin_display:null,notifications:null,background_ground_group:null,ground_group:null,grass_group:null,cave_meshes:null,ground_meshes:null,mesh_line_sprites:null,marker_group:null,real_time_background_ground_graphics:null,real_time_ground_graphics:null,current_level_save:null,next_level_save:null,challenges:null,all_body_entities:null,markers:null,camera_shake:null,background:null,stunt:null,transitions:null,overlay_transitions:null,slow_down_time:null,wait:null,camera:null,textured_polygon_entities:null,wheel:null,all_cars:null,bot_cars:null,player:null,player_bot:null,bots:null,visible_bounds:null,textured_polygons:null,terrain_polygons:null,entity_partition_container:null,partition_top:null,level_start_position:null,level_end_position:null,level_bottom_position:null,boxes:null,forward_ramps:null,explosives:null,immune_bodies:null,connected_containers:null,looped_animations:null,chickens:null,pickable_items:null,temp_interactive_objects:null,jump_over_bodies:null,attachments:null,current_place:null,race_countdown:null,inter_level_menu:null,main_menu:null,level_stats:null,collected_in_level:null,current_gameplay_music:null,menu_camera_position:null,lagged_logo:null,gameplay_bot:null,gameplay_bot_enabled:null,use_bot_to_control_player:null,temp:null,debug_element:null,drags:null,current_drag:null,draw_polygon_textures:null,camera_free:null,car_original_rotations:null,__class__:Rn};var Gn=e.bikas.game.GameDo=function(){};(n["bikas.game.GameDo"]=Gn).__name__=["bikas","game","GameDo"],Gn.createGame=function(e,t,n,i,r,a,s){var l=function(e){var t="";return t=(t=-1<e.indexOf("://")?e.split("/")[2]:e.split("/")[0]).split(":")[0],t=h.replace(t,"www.","")},o=function(e){try{if(null!=window.location.ancestorOrigins)for(var t=window.location.ancestorOrigins,n=0;n<t.length;){var i=t[n],r=l(i);if(-1==e.indexOf(r))return!1;++n}}catch(e){}if(to.get_window().top!=to.get_window().self){var a=l(to.get_document().referrer);if(-1==e.indexOf(a))return!1}var s=l(to.get_window().location.hostname);return-1!=e.indexOf(s)};if(1!=e.type||3!=e.release.sitelock_type){if(1==e.type&&1==e.release.sitelock_type&&!o(["bikas.net"])&&e.release.game_exit)return null;if(1==e.type&&2==e.release.sitelock_type&&!o(["lagged.com"])&&e.release.game_exit)return null}var _,u,c=new Rn;(hn.game=c).pointer=i,c.js_info=t,c.pointer=i,c.config=e,c.engine=a,c.bitmap_assets=s,c.game_save_serial_data=Zn.describeData(),c.game_container=r,c.background_container=Ra.createGroup(),c.ground_container=Ra.createGroup(),c.entity_container=Ra.createGroup(),c.foreground_container=Ra.createGroup(),c.ingame_container=Ra.createGroup(),c.ability_item_container=Ra.createGroup(),c.ongoing_powers_container=Ra.createGroup(),c.menu_container=Ra.createGroup(),c.runtime_information_container=Ra.createGroup(),(u=(_=c).game_container).add(_.background_container),u.add(_.ground_container),u.add(_.entity_container),u.add(_.foreground_container),u.add(_.ingame_container),_.ingame_container.add(_.ability_item_container),_.ingame_container.add(_.ongoing_powers_container),u.add(_.menu_container),u.add(_.runtime_information_container),1!=e.type&&(hn.debug_container=Ra.createGroup(),u.add(hn.debug_container));var d=0,m=0;d=ka.getTimer();for(var f=0,g=m=1e4;f<g;){f++;var v=new d_;v.dispose(),v=null}xl.trace("Vec2 ("+m+") allocation time: "+(ka.getTimer()-d)+"ms",{fileName:"GameDo.hx",lineNumber:412,className:"bikas.game.GameDo",methodName:"createGame"}),d=ka.getTimer();for(var b=0,y=m=1e4;b<y;)b++,Yr.destroyed_point_list.push(new Yr(0,0));xl.trace("Point ("+m+") allocation time: "+(ka.getTimer()-d)+"ms",{fileName:"GameDo.hx",lineNumber:419,className:"bikas.game.GameDo",methodName:"createGame"}),null!=Os.animation_power_bomb_burning&&T.translateAnimationData(Os.animation_power_bomb_burning,-28.5,11.5),c.temp.runtime_info=hn.createRuntimeTextInformation(c.config,c.runtime_information_container,t,n),c.pause_button=Ra.createSprite(Os.button_pause,.5,.5,0,0),c.pause_button.x=c.pause_button.width/2+40,c.pause_button.y=c.pause_button.height/2+40,c.ingame_container.add(c.pause_button),c.coin_display=new kn,c.coin_display.coin=Ra.createSpriteByName("coin_pick",.5,.5),c.coin_display.text=Ra.createBitmapText(cn.bell_gothic_std_black_very_light_26,24,"left","00001"),c.coin_display.text.anchor.x=1,c.coin_display.text.anchor.y=.5,c.coin_display.coin.position.y=c.coin_display.coin.height/2+5,c.coin_display.text.position.y=c.coin_display.coin.position.y+2,c.ingame_container.add(c.coin_display.coin),c.ingame_container.add(c.coin_display.text);var x=c.level_load_screen=new gn;x.track_loader_foreground_original_frame=Os.track_loader_foreground.frame.clone(),x.track_loader_foreground_current_frame=Os.track_loader_foreground.frame.clone(),x.container=Ra.createGroup(),x.background=Ra.createSprite(Os.menu_background,0,0,0,0),x.middle_container=Ra.createGroup(),x.title=Ra.createSprite(Os.logo_small,.5,.5,-60,0),x.loading_track_text=Ra.createSprite(Os.track_loader_text,.5,.5,0,0),x.loader_background=Ra.createSprite(Os.track_loader_background,0,.5,-Os.track_loader_background.width/2,146),x.loader_foreground=Ra.createSprite(Os.track_loader_foreground,0,.5,-Os.track_loader_background.width/2,146),x.container.add(x.background),x.container.add(x.middle_container),x.middle_container.add(x.title),x.middle_container.add(x.loading_track_text),x.middle_container.add(x.loader_background),x.middle_container.add(x.loader_foreground);var z=c.pause_menu=new On;z.container=Ra.createGroup(),z.background=Ra.createSprite(Os.menu_background),z.button_play=Ra.createSprite(Os.button_play,.5,.5),z.button_restart=Ra.createSprite(Os.button_restart,.5,.5),z.button_main_menu=Ra.createSprite(Os.button_main_menu,.5,.5),z.button_garage=Ra.createSprite(Os.button_garage,.5,.5),z.button_sounds=Ra.createSprite(Os.button_sounds_on,.5,.5),z.button_music=Ra.createSprite(Os.button_music_on,.5,.5),z.background.alpha=.8,z.container.add(z.background),z.container.add(z.button_play),z.container.add(z.button_restart),z.container.add(z.button_main_menu),z.container.add(z.button_garage),z.container.add(z.button_sounds),z.container.add(z.button_music);var w=function(e,t,n){var i=new En;i.bitmap_text=Ra.createBitmapText(cn.consolas_24,26,"left",t,0,0),i.bitmap_text.position.x=10,i.bitmap_text.position.y=200+50*e.pause_debug_options.length,i.callback=n,e.pause_debug_options.push(i),e.container.add(i.bitmap_text)};1==c.config.type&&(c.config.release.add_gameplay_bot_button_in_pause_menu&&w(z,"gameplay_bot: "+(null==c.gameplay_bot_enabled?"null":""+c.gameplay_bot_enabled),(function(e){c.gameplay_bot_enabled=!c.gameplay_bot_enabled,e.bitmap_text.text="gameplay_bot: "+(null==c.gameplay_bot_enabled?"null":""+c.gameplay_bot_enabled),c.gameplay_bot_enabled?c.use_bot_to_control_player=!0:c.use_bot_to_control_player=!1})),c.config.release.add_race_finish_button_in_pause_menu&&w(z,"finish race",(function(e){Gn.teleportPlayerToFinish(c)})),c.config.release.add_clear_rewarded_ads_in_pause_menu&&w(z,"clear rewarded ads",(function(e){c.game_save.rewarded_ads.splice(0,c.game_save.rewarded_ads.length)})));var k=c.tutorial_menu=new Ln;k.container=Ra.createGroup(),k.background=Ra.createSprite(Os.menu_background),k.background.alpha=.9,k.text=Ra.createBitmapText(cn.bell_gothic_std_black_dark_26,42),k.white_circle=Ra.createSpriteByName("white_circle",.5,.5),k.keyboard_controls=Ra.createSpriteByName("tutorial_controls",.5,.5),k.wheel=Ra.createSpriteByName("wheel",.5,.5),k.finger=Ra.createSpriteByName("pirstas_visas",0,0),k.jump_button=Ra.createSprite(Os.animation_jump_green_button.frames[0].texture,.5,.5),k.nitro_button=Ra.createSprite(Os.animation_nitro_button.frames[0].texture,.5,.5),k.power_button=Ra.createSprite(Os.animation_power_icons.frames[0].texture,.5,.5),k.container.add(k.background),k.container.add(k.white_circle),k.container.add(k.keyboard_controls),k.container.add(k.wheel),k.container.add(k.finger),k.container.add(k.jump_button),k.container.add(k.nitro_button),k.container.add(k.power_button),k.container.add(k.text);var S=c.level_end=new xn;S.finished_text=Ra.createSprite(Os.finished_text,.5,.5,0,0),xn.challenge_win_button_texture=Zs.getTexture("button_play"),xn.challenge_fail_button_texture=Zs.getTexture("button_restart"),S.challenge_button=Ra.createSprite(xn.challenge_win_button_texture,.5,.5),c.level_stats=Ti.create();var C=Ra.createSprite(Zs.retrieveAsset("wheel"),0,0,0,0);C.anchor.x=.5,C.anchor.y=.5,C.x=t.current_game_width-C.width/2,C.y=t.current_game_height-C.height/2,c.ingame_container.add(C),c.wheel=qr.create(C);var N=c.wheel,P=t.current_game_width-N.sprite.width*Vr.corner_distance_coeff,M=t.current_game_height-N.sprite.height*Vr.corner_distance_coeff;N.sprite.x!=P&&(N.sprite.x=P),N.sprite.y!=M&&(N.sprite.y=M),c.level_descriptions=wr.createLevelDescriptions(c.config),c.game_save=wr.createGameSave(c.level_descriptions),Gn.applyGameSave(c,c.game_save),c.car_settings=wr.createCarSettings(),c.car_upgrade_data=wr.createCarUpgradeData(),c.chest_reward_item_descs=Fr.createRewardsForChests(),c.achievement_descs=Fr.createRewardsForAchievements(),c.challenge_descs=Fr.createRewardsForChallenges();for(var I=0,A=c.chest_reward_item_descs;I<A.length;){var D=A[I];++I;for(var E=0,O=c.all_reward_descs;E<O.length;){var B=O[E];++E,D.id==B.id&&xl.trace("warning: no 2 reward description can exist with same id: "+D.name+", "+B.name,{fileName:"GameDo.hx",lineNumber:635,className:"bikas.game.GameDo",methodName:"createGame"})}c.all_reward_descs.push(D)}for(var L=0,j=c.achievement_descs;L<j.length;){var F=j[L];++L;for(var R=0,G=c.all_reward_descs;R<G.length;){var Z=G[R];++R,F.item.desc.id==Z.id&&xl.trace("warning: no 2 reward description can exist with same id: "+F.item.desc.name+", "+Z.name,{fileName:"GameDo.hx",lineNumber:643,className:"bikas.game.GameDo",methodName:"createGame"})}c.all_reward_descs.push(F.item.desc)}for(var U=0,V=c.challenge_descs;U<V.length;){var q=V[U];++U;for(var W=0,X=c.all_reward_descs;W<X.length;){var H=X[W];++W,q.item.desc.id==H.id&&xl.trace("warning: no 2 reward description can exist with same id: "+q.item.desc.name+", "+H.name,{fileName:"GameDo.hx",lineNumber:651,className:"bikas.game.GameDo",methodName:"createGame"})}c.all_reward_descs.push(q.item.desc)}c.upgrades=wr.createUpgrades(),c.ability_probabilities=[];var Y=function(e,t,n,i){var r=new Ne;r.type=t,r.first_car_multiplier=n,r.last_car_multiplier=i,e.push(r)};Y(c.ability_probabilities,ge.Bomb,.4,.8),Y(c.ability_probabilities,ge.Dynamite,1,.2),Y(c.ability_probabilities,ge.Armor,1,.2),Y(c.ability_probabilities,ge.Nitro,.1,1.1),c.camera=bt.createCamera();var J=d_.get(0,1200);c.world=ie.createWorld(J,.15,.15);var K=function(t){1==e.type&&8==t.keyCode&&null!=c.debug_element&&(c.debug_element.hidden=!c.debug_element.hidden),0==e.type&&p.is(t.target,HTMLTextAreaElement)||Ni.updateKeyboard(c.keyboard_keys_pressed,c.keyboard_keys_released,t)};if(to.get_document().addEventListener("keydown",K),to.get_document().addEventListener("keyup",K),ka.getTimer(),0==e.type){if(Gn.redirectExternalFunctionCalls(),parent.is_reload){Gn.setGameAndEditorVisibility(c,!0);var Q=Gn.getIframeElement();null!=Q&&Q.focus(),Gn.setupToLoadWorkingStageAndWorkingLibrary(c)}else if(c.config.development.editor_enabled)if(c.config.development.show_editor_first){Gn.setGameAndEditorVisibility(c,!1);var $=Gn.getEditorElement();null!=$&&$.focus()}else{Gn.setGameAndEditorVisibility(c,!0);var ee=Gn.getIframeElement();null!=ee&&ee.focus(),Gn.setupToLoadWorkingStageAndWorkingLibrary(c)}else Gn.setupToLoadWorkingStageAndWorkingLibrary(c);c.debug_element=to.get_document().getElementById("gamedebug"),Xs.top_listeners.push(new Us(to.get_document(),"keydown",K)),null==c.debug_element?xl.trace("no debug menu",{fileName:"GameDo.hx",lineNumber:786,className:"bikas.game.GameDo",methodName:"createGame"}):hn.createDebugMenu(c,t,n)}else if(1==e.type){for(var te=null,ne=0,re=c.game_save.level_saves;ne<re.length;){var ae=re[ne];if(++ne,ae.description.type==vr.LevelMainMenu&&null!=ae.description&&null!=ae.description.level_data_save){te=ae.description.level_data_save;break}}for(var se=null,oe=0,_e=Os.level_data_saves;oe<_e.length;){var pe=_e[oe];if(++oe,"library"==pe.name){se=pe;break}}null!=te&&null!=se?(Rn.load_stage_header=le.unserializeStageEngine(c.engine.engine_serial_data,Sl.decode(te.data)),Rn.load_library_header=le.unserializeLibraryEngine(c.engine.engine_serial_data,Sl.decode(se.data))):(null==te&&xl.trace("warning: found_level_data_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"createGame"}),null==se&&xl.trace("warning: found_library_data_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"createGame"}),Gn.setupToLoadWorkingStageAndWorkingLibrary(c))}return c},Gn.setupToLoadWorkingStageAndWorkingLibrary=function(e){""!=Os.working_stage&&""!=Os.working_library&&(Rn.load_stage_header=le.unserializeStageEngine(e.engine.engine_serial_data,Sl.decode(Os.working_stage)),Rn.load_library_header=le.unserializeLibraryEngine(e.engine.engine_serial_data,Sl.decode(Os.working_library)),xl.trace("set to load stage and library",{fileName:"GameDo.hx",lineNumber:838,className:"bikas.game.GameDo",methodName:"setupToLoadWorkingStageAndWorkingLibrary"}))},Gn.getEditorElement=function(){var e=to.get_document().getElementById("BikasEditor2D");return null==e&&(e=to.get_window().parent.document.getElementById("BikasEditor2D")),e},Gn.getIframeElement=function(){return null!=to.get_window().parent?to.get_window().parent.document.getElementById("game_iframe"):null},Gn.nullTheExternalFunctionCalls=function(){var e=to.get_window().parent.window;null!=e.bikas&&(e.bikas.game.GameDo.loadDataFromEditor=null,e.bikas.game.GameDo.saveDataFromEditor=null,e.bikas.game.GameDo.doPolyBoolOperation=null)},Gn.redirectExternalFunctionCalls=function(){var e=to.get_window().parent.window;null==e.bikas&&(e.bikas={},e.bikas.game={},e.bikas.game.GameDo={}),e.bikas.game.GameDo.loadDataFromEditor=null,e.bikas.game.GameDo.saveDataFromEditor=null,e.bikas.game.GameDo.doPolyBoolOperation=null,e.bikas.game.GameDo.loadDataFromEditor=Gn.loadDataFromEditor,e.bikas.game.GameDo.saveDataFromEditor=Gn.saveDataFromEditor,e.bikas.game.GameDo.doPolyBoolOperation=Gn.doPolyBoolOperation},Gn.setGameAndEditorVisibility=function(e,t){var n=Gn.getEditorElement();if(null!=n){var i=to.get_document().getElementById("gamedebug"),r=!n.classList.contains("hidden_class"),a=!i.classList.contains("hidden_class");if(t&&r?(n.classList.remove("hidden_class"),n.focus()):t||r||n.classList.add("hidden_class"),t&&!a){i.classList.remove("hidden_class");var s=Gn.getIframeElement();null!=s&&(s.classList.remove("hidden_class"),s.focus()),Xs.canvas.classList.remove("hidden_class"),Xs.paused=!1}else if(!t&&a){i.classList.add("hidden_class"),Xs.canvas.classList.add("hidden_class");var l=Gn.getIframeElement();null!=l&&l.classList.add("hidden_class"),Xs.paused=!0}}},Gn.createPostRequest=function(e,t,n,i,r){null==i&&(i=""),null==n&&(n="String"),null==t&&(t="filename.txt");var a=new fn;return a.xhr=new XMLHttpRequest,a.on_finished=r,a.xhr.addEventListener("load",(function(e){xl.trace("successfully saved: "+t,{fileName:"GameDo.hx",lineNumber:944,className:"bikas.game.GameDo",methodName:"createPostRequest"}),null!=a.on_finished&&a.on_finished()})),a.xhr.addEventListener("error",(function(e){xl.trace("error while saving: "+t,{fileName:"GameDo.hx",lineNumber:950,className:"bikas.game.GameDo",methodName:"createPostRequest"})})),a.xhr.open("POST",e,!0),a.xhr.setRequestHeader("Content-Type","application/json"),a.json=JSON.stringify({name:t,type:n,data:i}),a},Gn.saveDataFromEditor=function(e,t,n){for(var i=[],r=0,a=e.length;r<a;){var s=r++,l=Gn.createPostRequest("http://localhost:8000",e[s],t[s],n[s]);i.push(l)}for(var o=1,_=i.length;o<_;){var p=[o++];i[p[0]-1].on_finished=function(e){return function(){i[e[0]].xhr.send(i[e[0]].json)}}(p)}i[i.length-1].on_finished=function(){xl.trace("saving done",{fileName:"GameDo.hx",lineNumber:981,className:"bikas.game.GameDo",methodName:"saveDataFromEditor"})},i[0].xhr.send(i[0].json)},Gn.loadDataFromEditor=function(e,t){xl.trace("Open: Game",{fileName:"GameDo.hx",lineNumber:990,className:"bikas.game.GameDo",methodName:"loadDataFromEditor"});var n=hn.game;Gn.setGameAndEditorVisibility(n,!0),Rn.load_stage_header=le.unserializeStageEngine(n.engine.engine_serial_data,Gn.toBytes(e)),Rn.load_library_header=le.unserializeLibraryEngine(n.engine.engine_serial_data,Gn.toBytes(t)),0!=n.config.type||n.config.development.transitions_enabled?(Gn.setGameState(n,jn.InGameLoad),Gn.setGameState(n,jn.InTransitionToLevelLoad)):Gn.setGameState(n,jn.InLevel)},Gn.toBytes=function(e){for(var t=kl.alloc(e.length),n=0,i=e.length;n<i;){var r=n++;t.set(r,e[r])}return t},Gn.hideGameAndOpenEditor=function(e){xl.trace("Open: Editor",{fileName:"GameDo.hx",lineNumber:1016,className:"bikas.game.GameDo",methodName:"hideGameAndOpenEditor"}),Gn.setGameAndEditorVisibility(e,!1),Gn.destroyLevel(e,!0,!1),Gn.getEditorElement().activateEditor(),to.get_window().parent.window.focusEditor()},Gn.doPolyBoolOperation=function(e,t,n){null==n&&(n="union");var i=parent.PolyBool,r=null;return null!=i&&("union"==n?r=i.union({regions:e,inverted:!1},{regions:t,inverted:!1}):"intersect"==n?r=i.intersect({regions:e,inverted:!1},{regions:t,inverted:!1}):"difference"==n?r=i.difference({regions:e,inverted:!1},{regions:t,inverted:!1}):"xor"==n&&(r=i.xor({regions:e,inverted:!1},{regions:t,inverted:!1}))),null==r?null:r.regions},Gn.setGameState=function(e,t){e.previous_state=e.state,e.state=t},Gn.showPause=function(e,t){e.state!=jn.InPause&&(Gn.setGameState(e,jn.InPause),1==e.config.type&&3==e.config.release.sitelock_type&&e.level_type==Fn.InRacing&&Ya.PokiSDK.gameplayStop())},Gn.gotoNewLevel=function(e,t,n){return!(null==n&&(xl.trace("warning: level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"gotoNewLevel"}),1)||(e.pre_simulate_world_steps_current=0,(e.pre_wait_steps_current=0)!=e.config.type||e.config.development.transitions_enabled?(e.next_level_save=n,Gn.setGameState(e,jn.InLevel),Gn.setGameState(e,jn.InTransitionToLevelLoad),1):(Gn.setGameState(e,jn.InLevel),Gn.loadNewLevel(e,t,n),0)))},Gn.gotoRestartLevel=function(e,t){return!(null==e.current_level_save&&(xl.trace("warning: game.current_level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"gotoRestartLevel"}),1)||(e.pre_simulate_world_steps_current=0,(e.pre_wait_steps_current=0)!=e.config.type||e.config.development.transitions_enabled?(e.next_level_save=e.current_level_save,Gn.setGameState(e,jn.InLevel),Gn.setGameState(e,jn.InTransitionToLevelLoad),1):(Gn.setGameState(e,jn.InLevel),Gn.reloadLevel(e,t),0)))},Gn.saveGameSaveToStorage=function(e,t){var n="adventure_drivers";t.save_date=ka.getCurrentDateForFileSaving(),Zn.saveToStorage(e,t,n)?xl.trace("saved game: "+n+" (version: "+t.save_data_version+", date: "+t.save_date+")",{fileName:"GameDo.hx",lineNumber:1150,className:"bikas.game.GameDo",methodName:"saveGameSaveToStorage"}):xl.trace("failed to save game: "+n,{fileName:"GameDo.hx",lineNumber:1152,className:"bikas.game.GameDo",methodName:"saveGameSaveToStorage"})},Gn.loadGameSaveFromStorage=function(e){var t="adventure_drivers",n=Zn.loadFromStorage(e,t);if(null==n)return xl.trace("failed to load game or the save does not exist yet: "+t,{fileName:"GameDo.hx",lineNumber:1160,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),null;xl.trace("loaded game save: "+t+" (version: "+n.save_data_version+", date: "+n.save_date+")",{fileName:"GameDo.hx",lineNumber:1163,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),xl.trace("\tcurrent_car: "+n.current_car,{fileName:"GameDo.hx",lineNumber:1164,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),xl.trace("\tchests: "+n.chests,{fileName:"GameDo.hx",lineNumber:1165,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),xl.trace("\tcoins: "+n.coins,{fileName:"GameDo.hx",lineNumber:1166,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),xl.trace("\tupgrade_points: "+n.upgrade_points,{fileName:"GameDo.hx",lineNumber:1167,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),xl.trace("\tcar_own_list: "+p.string(n.car_own_list),{fileName:"GameDo.hx",lineNumber:1168,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),xl.trace("\tachievements_completed: "+p.string(n.achievements_completed),{fileName:"GameDo.hx",lineNumber:1169,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),xl.trace("\tchallenges_completed: "+p.string(n.challenges_completed),{fileName:"GameDo.hx",lineNumber:1170,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),xl.trace("\ttotal ongoing_powers: "+(n.ongoing_powers.level_items.length+n.ongoing_powers.permanent_items.length),{fileName:"GameDo.hx",lineNumber:1171,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"});for(var i=0,r=0,a=n.level_saves;r<a.length;){var s=a[r];++r,s.completed&&++i}return xl.trace("\ttotal levels completed: "+i,{fileName:"GameDo.hx",lineNumber:1179,className:"bikas.game.GameDo",methodName:"loadGameSaveFromStorage"}),n},Gn.applyGameSave=function(e,t){if(null!=t){xl.trace("applied game save:  (version: "+t.save_data_version+", date: "+t.save_date+")",{fileName:"GameDo.hx",lineNumber:1191,className:"bikas.game.GameDo",methodName:"applyGameSave"}),e.game_save=t;for(var n=[],i=0,r=e.game_save.level_saves;i<r.length;){var a=r[i];if(++i,null==a.description)for(var l=0,o=e.level_descriptions;l<o.length;){var _=o[l];if(++l,_.name==a.description_name){a.description=_;break}}null==a.description&&(xl.trace("warning: could not find description for "+a.description_name+" (removing level_save from the list)",{fileName:"GameDo.hx",lineNumber:1208,className:"bikas.game.GameDo",methodName:"applyGameSave"}),n.push(a))}for(var p=0;p<n.length;){var u=n[p];++p,s.remove(e.game_save.level_saves,u)}for(var h=0,c=e.game_save.level_saves;h<c.length;){var d=c[h];++h,d.description.type==vr.LevelMainMenu?e.main_menu_save=d:d.description.type==vr.LevelInterLevelMenu?e.inter_level_menu_save=d:d.description.type==vr.LevelRegular?1==d.description.level_number&&(e.first_level_save=d):d.description.type==vr.LevelChallenge&&(d.description.challenge_type==br.ChallengeAchievement?e.achievement_save=d:d.description.challenge_type==br.ChallengeCredits&&(e.credits_save=d))}null==e.inter_level_menu_save&&xl.trace("warning: game.inter_level_menu_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"}),null==e.main_menu_save&&xl.trace("warning: game.main_menu_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"}),null==e.first_level_save&&xl.trace("warning: game.first_level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"}),null==e.achievement_save&&xl.trace("warning: game.achievement_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"}),null==e.credits_save&&xl.trace("warning: game.credits_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"applyGameSave"});for(var m=e.game_save.ongoing_powers.level_items.concat(e.game_save.ongoing_powers.permanent_items),f=[],g=0;g<m.length;){var v=m[g];++g;for(var b=0,y=e.all_reward_descs;b<y.length;){var x=y[b];if(++b,v.id==x.id){v.desc=x;break}}null==v.desc&&(xl.trace("warning: reward item has no matching id "+v.id+" ("+v.description_text+") - removing from gongoing powers",{fileName:"GameDo.hx",lineNumber:1258,className:"bikas.game.GameDo",methodName:"applyGameSave"}),f.push(v))}for(var z=0;z<f.length;){var w=f[z];++z,s.remove(e.game_save.ongoing_powers.level_items,w),s.remove(e.game_save.ongoing_powers.permanent_items,w)}if(null!=e.ongoing_powers_display){e.ongoing_powers_display.current_items=[];for(var k=0,S=e.game_save.ongoing_powers.permanent_items;k<S.length;){var C=S[k];++k,e.ongoing_powers_display.current_items.push(C)}for(var N=0,P=e.game_save.ongoing_powers.level_items;N<P.length;){var M=P[N];++N,e.ongoing_powers_display.current_items.push(M)}}}else xl.trace("warning: game_save == null",{fileName:"GameDo.hx",lineNumber:1188,className:"bikas.game.GameDo",methodName:"applyGameSave"})},Gn.loadEngineAndLevel=function(e,t,n,i,r){var a=i.group;if(ka.getTimer(),null!=r){var s=r.group;null!=s&&(e.library_group=ie.overloadLibrary(n,s,e.library_group,e.bitmap_assets))}e.stage_group_original=ie.copyEntity(a,n,!1);for(var l=null,o=0,_=e.game_save.level_saves;o<_.length;){var p=_[o];if(++o,p.description.name==i.save.name){l=p;break}}if(null==l){if(!(0<e.game_save.level_saves.length))return xl.trace("warning: couldn't find level save for level "+i.save.name+" (and no other level saves exist)",{fileName:"GameDo.hx",lineNumber:1309,className:"bikas.game.GameDo",methodName:"loadEngineAndLevel"}),!1;xl.trace("warning: couldn't find level save for level "+i.save.name+" (using first level save instead)",{fileName:"GameDo.hx",lineNumber:1306,className:"bikas.game.GameDo",methodName:"loadEngineAndLevel"}),l=e.game_save.level_saves[0]}return Gn.loadLevel(e,t,a,n,l)},Gn.loadNewLevel=function(e,t,n){if(Gn.destroyLevel(e,!1,!1),null==n&&(xl.trace("warning: level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"loadNewLevel"}),1))return!1;if(null==n.description.level_data_save&&(xl.trace("warning: level_save.description.level_data_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"loadNewLevel"}),1))return!1;var i=e.engine.engine_serial_data,r=le.unserializeStageEngine(i,Sl.decode(n.description.level_data_save.data));return!(null==r&&(xl.trace("warning: stage_header == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"loadNewLevel"}),1))&&(e.stage_group_original=ie.copyEntity(r.group,i,!1),Gn.loadLevel(e,t,r.group,i,n))},Gn.reloadLevel=function(e,t){Gn.destroyLevel(e,!1,!0);var n=e.engine.engine_serial_data,i=ie.copyEntity(e.stage_group_original,n,!1);return Gn.loadLevel(e,t,i,n,e.current_level_save)},Gn.loadLevel=function(e,t,n,i,r){var a=ka.getTimer();if(xl.trace("loadLevel: "+r.description.name+" ("+r.description.nice_name+")",{fileName:"GameDo.hx",lineNumber:1358,className:"bikas.game.GameDo",methodName:"loadLevel"}),!Gn.makeLevel(e,n,i,r))return xl.trace("warning: failed to make level",{fileName:"GameDo.hx",lineNumber:1362,className:"bikas.game.GameDo",methodName:"loadLevel"}),Gn.destroyLevel(e,!1,!1),!1;e.physics_running=!0,e.level_running=!0,e.coin_display.text.visible=kn.coin_display_debug_visibility,e.coin_display.coin.visible=kn.coin_display_debug_visibility,e.ongoing_powers_container.visible=kn.coin_display_debug_visibility,e.level_type==Fn.InMainMenu?(e.coin_display.text.visible=!1,e.coin_display.coin.visible=!1,e.ongoing_powers_container.visible=!1,Gn.initMenu(e,t)):e.level_type==Fn.InInterLevelMenu?Gn.initMenu(e,t):e.level_type==Fn.InRacing?null!=e.player?((r.description.level_number-1)%2==0?e.current_gameplay_music=Os.music_stereospice_fun_surf_rock_142_sec:e.current_gameplay_music=Os.music_stereospice_fun_surf_rock_92_sec,Gn.initRace(e,t)):xl.trace("warning: game.player == null",{fileName:"GameDo.hx",lineNumber:1394,className:"bikas.game.GameDo",methodName:"loadLevel"}):xl.trace("warning: unhandled "+p.string(e.current_level_save.description.type),{fileName:"GameDo.hx",lineNumber:1397,className:"bikas.game.GameDo",methodName:"loadLevel"});var s=new Vs;return s.dc=1,s.level_seconds=0,s.step_size=.016666666666666666,Gn.updateLevel(e,s),Gn.updateBackground(e,1),xl.trace("loadLevel finished in "+(ka.getTimer()-a)+"ms",{fileName:"GameDo.hx",lineNumber:1411,className:"bikas.game.GameDo",methodName:"loadLevel"}),ba.trackLevelStart(e.current_level_save.description.name),!0},Gn.makeLevel=function(e,t,n,i){if(e.all_body_entities=[],e.markers=[],t.position.x=0,t.position.y=0,t.transform.scale_x=1,t.transform.scale_y=1,t.transform.rotation=0,null!=e.current_level_save&&e.current_level_save.description.name!=i.description.name&&(e.game_save.previous_level_name=e.current_level_save.description.name),e.current_level_save=i,e.game_save.current_level_name=e.current_level_save.description.name,ie.linkPrefabLinks(t,e.library_group),!Gn.preprocessEntities(t,e.library_group,i,e))return!1;var r=ie.overloadStage(n,t,e.stage_group,e.library_group,e.bitmap_assets);if(null==r)return!1;if(e.stage_group=r,!Gn.sortGraphicsInStageGroup(t,e.config))return!1;if(e.stage_group.group.container=Ra.createGroup(),ie.flattenAndAddStage(n,e.stage_group,e.entity_container),!ie.createBodiesForEntities(e.stage_group,e.all_body_entities,new Ki,new yi))return!1;if(!Gn.createObjectsBasedOnEntities(e,e.stage_group,new Yo(!0)))return!1;if(e.current_level_save.description.type==vr.LevelMainMenu?e.level_type=Fn.InMainMenu:e.current_level_save.description.type==vr.LevelInterLevelMenu?e.level_type=Fn.InInterLevelMenu:e.level_type=Fn.InRacing,!Gn.createLevelObjects(e))return!1;if(null!=e.player&&null==e.level_start_position&&(e.level_start_position=new Yr,xl.trace("warning: level_start_position == null",{fileName:"GameDo.hx",lineNumber:1516,className:"bikas.game.GameDo",methodName:"makeLevel"})),!Gn.createLevelObjectsBasedOnObjects(e))return!1;Gn.centerStage(e,1),Gn.setSpace(e,e.world.space);for(var a=0,s=e.temp.levelloads;a<s.length;){var l=s[a];++a,l()}return null!=e.player&&Gn.refreshCameraCenter(e,e.camera,e.js_info,e.player.car.main_body_entity.position),!0},Gn.preprocessEntities=function(e,t,n,i){for(var r=function(e,t,n){-1==e.indexOf(n)&&(s.remove(t.group.entities,n),e.push(n))},a=null,l=a=function(e,t,n){for(var i=e.group.entities.slice(),s=0;s<i.length;){var l=i[s];if(++s,-1!=n.indexOf(l.name)&&r(t,e,l),null!=l.bitmap_images&&null!=l.bitmap_images.images)for(var o=0,_=l.bitmap_images.images;o<_.length;){var p=_[o];if(++o,-1!=n.indexOf(p.source_name)){r(t,e,l);break}}null!=l.prefab_link&&null!=l.prefab_link.prefab_entity&&-1!=n.indexOf(l.prefab_link.prefab_entity.name)&&r(t,e,l),null!=l.prefab&&-1!=n.indexOf(l.prefab.prefab_name)&&r(t,e,l),null!=l.group&&a(l,t,n)}},o=i.game_save,_=[],u=[],h=null,c=0==i.config.type&&i.config.development.filter_out_bots,d=0,m=e.group.entities;d<m.length;){var f=m[d];++d,"car"!=f.name&&"player"!=f.name||(i.car_original_rotations.set(f,f.transform.rotation),f.transform.rotation=0,(null==h||"player"==f.name||"player"!=h.name&&f.position.y<=h.position.y)&&(h=f),u.push(f))}if(n.description.type==vr.LevelChallenge){if(0==u.length)return xl.trace("warning: no cars recognized (note: car prefab_links should be named 'car')",{fileName:"GameDo.hx",lineNumber:1628,className:"bikas.game.GameDo",methodName:"preprocessEntities"}),!1;for(var g=0;g<u.length;){var v=u[g];++g,v.name="bot"}null!=h&&(h.name="player")}else if(0==i.config.type&&i.config.development.use_editor_cars){for(var b=0;b<u.length;){var y=u[b];++b,y.name="bot",c&&r(_,e,y)}null!=h&&(h.name="player")}else if(n.description.type==vr.LevelRegular){for(var x=0;x<u.length;){var z=u[x];++x,r(_,e,z)}var w=[];if(!c){wr.setBotCarLineup(o,i.game_save.level_saves);for(var k=0,S=o.current_bot_car_lineup;k<S.length;){var C=S[k];++k,w.push(C)}}var N=Math.floor(w.length/2);w.splice(N,0,o.current_car);for(var P=[],M=null,I=0,A=0,T=w.length;A<T;){var D=A++,E=w[D],O=ie.createDefaultEntity();D==N?(O.name="player",M=O):(O.name="bot",P.push(O)),O.position.x=I,O.position.y=0,I+=100,O.prefab_link=new Q;for(var B=0,L=t.group.entities;B<L.length;){var j=L[B];if(++B,j.name==E){O.prefab_link.guid=j.guid,O.prefab_link.prefab_entity=j;break}}null==O.prefab_link.prefab_entity&&xl.trace("warning: couldn't find "+E+" prefab",{fileName:"GameDo.hx",lineNumber:1701,className:"bikas.game.GameDo",methodName:"preprocessEntities"})}for(var F=0;F<P.length;){var R=P[F];++F,e.group.entities.push(R)}null!=M&&e.group.entities.push(M)}else n.description.type!=vr.LevelMainMenu&&n.description.type!=vr.LevelInterLevelMenu&&xl.trace("warning: unhandled "+p.string(n.description.type),{fileName:"GameDo.hx",lineNumber:1720,className:"bikas.game.GameDo",methodName:"preprocessEntities"});var G=[];0==i.config.type&&i.config.development.filter_out_interactive_objects&&(G=["box1","barrel","shack","fruit_stand","crate","forward_ramp","booster","bar","explosive_metal_barrel"]),0<G.length&&l(e,_,G);for(var Z=e.group.entities.slice(),U=0;U<Z.length;){var V=Z[U];++U,"treasure_chest_pick"==V.name&&-1!=n.chests_collected_guids.indexOf(V.guid)&&(s.remove(e.group.entities,V),_.push(V))}for(var q=0;q<_.length;){var W=_[q];++q,ie.destroyEntityIncludingChildren(W)}return!0},Gn.sortGraphicsInStageGroup=function(e,t){var n;n=[["background_ground"],["root1","root2","root3","root4"],["mushroom1","mushroom2","mushroom3","mushroom4","mushroom5"],["totem"],["map","map_item_empty","map_item_finished","map_item_finished100","map_item_locked"],["palm_tree1","palm_tree2","palm_tree3","palm_tree4","small_palm_tree1","small_palm_tree2","small_palm_tree3"],["surfboard1","surfboard2","surfboard3","dressing_cabin","table_with_umbrella","minishop"],["banana_tree1","banana_tree2","banana_tree3","banana_tree4"],["bar"],["car_upgrades_board"],["simple_ramp","forward_ramp"],["cars"],["grass1","grass2","grass3","grass4","grass5","grass6","small_plant1","rock","coconuts"],["prefabs"],["power_question"],["ground"],["markers"]];for(var i=[],r=0;r<n.length;)++r,i.push([]);i.push([]);for(var a=function(e,t,n,i,r){null==r&&(r="");for(var a=-1,s=0,l=t.length;s<l;){var o=s++;if(-1!=t[o].indexOf(i)){a=o;break}}if(-1==a)for(var _=0,p=t.length;_<p;){var u=_++;if(-1!=t[u].indexOf(r)){a=u;break}}return-1!=a&&(n[a].push(e),!0)},l=0,o=e.group.entities;l<o.length;){var _=o[l];++l;var p=!1;if(null!=_.polygon&&_.polygon.draw_type==U.TEXTURE)p=a(_,n,i,"ground");else if("bot"==_.name||"player"==_.name||"car"==_.name)p=a(_,n,i,"cars");else if(null!=_.bitmap_images)1==_.bitmap_images.images.length&&(p=a(_,n,i,_.bitmap_images.images[0].source_name));else if(null!=_.prefab_link)p=a(_,n,i,_.prefab_link.prefab_entity.name,"prefabs");else if(null==_.prefab&&null==_.prefab_link&&null==_.bitmap_images&&null==_.body&&null==_.polygon&&null==_.group){var u=_.name;0==t.type&&t.development.render_markers&&(p=a(_,n,i,u,"markers"))}p||i[i.length-1].push(_)}for(var h=0;h<i.length;){var c=i[h];++h;for(var d=0;d<c.length;){var m=c[d];++d,s.remove(e.group.entities,m)}}for(var f=0;f<i.length;){var g=i[f];++f;for(var v=0;v<g.length;){var b=g[v];++v,e.group.entities.push(b)}}return!0},Gn.createObjectsBasedOnEntities=function(e,t,n){if(null!=t.prefab_link)return xl.trace("warning: entity shouldn't have prefab_link, all prefab_links should be flattened "+t.name,{fileName:"GameDo.hx",lineNumber:1918,className:"bikas.game.GameDo",methodName:"createObjectsBasedOnEntities"}),!1;if("player"==t.name||"bot"==t.name){for(var i=null,r=null,a=null,s=0,l=t.group.entities;s<l.length;){var o=l[s];switch(++s,o.name){case"back_wheel_body":r=o;break;case"front_wheel_body":a=o;break;case"main_body":i=o}}if(null==i&&xl.trace("warning: car does not have main_body",{fileName:"GameDo.hx",lineNumber:1938,className:"bikas.game.GameDo",methodName:"createObjectsBasedOnEntities"}),null==r&&xl.trace("warning: car does not have back_wheel_body",{fileName:"GameDo.hx",lineNumber:1941,className:"bikas.game.GameDo",methodName:"createObjectsBasedOnEntities"}),null==a&&xl.trace("warning: car does not have front_wheel_body",{fileName:"GameDo.hx",lineNumber:1944,className:"bikas.game.GameDo",methodName:"createObjectsBasedOnEntities"}),null!=i&&null!=r&&null!=a)if("player"==t.name&&null==e.player){var _=Tt.createCar(t,i,r,a,n),p=wr.getUpgradedCarConfigCopy(e.car_upgrade_data,e.game_save.car_upgrades,e.car_settings,_.name),u=new Pt,h=Me.createAbilities();e.player=lr.createPlayer(_,p,u,h,e.ingame_container),e.player_bot=gt.createBot(_,p,u,h,new tt),e.all_cars.push(_),Gn.connectAdditionalCarGraphicsToMainCarBodyEntity(e,_)}else if("bot"==t.name){var c=Tt.createCar(t,i,r,a,n),d=new hr,m=0;e.current_level_save.description.type==vr.LevelRegular&&e.current_level_save.description.level_number<5&&(m=-1),d.top_speed=pa.clamp0toInfinityInt(e.game_save.car_upgrades.top_speed+m),d.acceleration=pa.clamp0toInfinityInt(e.game_save.car_upgrades.acceleration+m),d.handling=pa.clamp0toInfinityInt(e.game_save.car_upgrades.handling+m),d.armor=pa.clamp0toInfinityInt(e.game_save.car_upgrades.armor+m);var f=wr.getUpgradedCarConfigCopy(e.car_upgrade_data,d,e.car_settings,c.name),g=new Pt,v=Me.createAbilities(),b=wr.getBotPersonalityByName(e.car_settings,c.name),y=gt.createBot(c,f,g,v,b);y.personality_applied=!1,e.bots.push(y),e.all_cars.push(c),e.bot_cars.push(c),Gn.connectAdditionalCarGraphicsToMainCarBodyEntity(e,c)}}else if("level start"==t.name)e.level_start_position=ga.copy(t.position);else if("level end"==t.name)e.level_end_position=ga.copy(t.position);else if("bottom"==t.name)e.level_bottom_position=ga.copy(t.position);else if("menu camera"==t.name)e.menu_camera_position=ga.copy(t.position);else if(null!=t.bitmap_images&&1==t.bitmap_images.images.length){var x=t.bitmap_images.images[0].source_name;if("chicken"==x){var z=t.display.sprite,w=T.createAnimationUsingSprite(Os.animation_chicken,z,.5);T.gotoFrame(w,Math.floor(Math.random()*w.data.frames.length));var k=new mn;k.anim=w,k.body=t.body,e.chickens.push(k)}else"power_question"==x?e.pickable_items.push(Ci.createPickableItem(t,wi.PowerQuestion)):"coin_pick"==x?e.pickable_items.push(Ci.createPickableItem(t,wi.Coin)):"nitro_pick"==x?e.pickable_items.push(Ci.createPickableItem(t,wi.Nitro)):"treasure_chest_pick"==x?e.pickable_items.push(Ci.createPickableItem(t,wi.TreasureChest)):"power_nitro"==x?e.pickable_items.push(Ci.createPickableItem(t,wi.Nitro)):"bot_jump_pick"==x?e.pickable_items.push(Ci.createPickableItem(t,wi.BotJumpIndicator)):"attachment_balloons"==x?e.pickable_items.push(Ci.createPickableItem(t,wi.AttachmentBalloons)):"attachment_anchor"==x?e.pickable_items.push(Ci.createPickableItem(t,wi.AttachmentAnchor)):"booster"==x&&e.forward_ramps.push(Ji.createForwardRamp(t,Xi.Booster))}if(null!=t.prefab)if("box1"==t.prefab.prefab_name||"barrel"==t.prefab.prefab_name||"shack"==t.prefab.prefab_name||"fruit_stand"==t.prefab.prefab_name||"crate"==t.prefab.prefab_name){var S=Ji.createBox(t);e.boxes.push(S),e.jump_over_bodies.push(S.body)}else if("forward_ramp"==t.prefab.prefab_name){var C=Ji.createForwardRamp(t,Xi.Ramp);e.forward_ramps.push(C)}else if("booster"==t.prefab.prefab_name){var N=Ji.createForwardRamp(t,Xi.Booster);e.forward_ramps.push(N)}else if("bar"!=t.prefab.prefab_name&&"explosive_metal_barrel"==t.prefab.prefab_name){var P=t.group.entities[0],M=Ji.createTempInteractiveObject(P,qi.Explosive);e.temp_interactive_objects.push(M),e.jump_over_bodies.push(M.body)}if(null!=t.polygon&&t.polygon.draw_type==U.TEXTURE&&(null!=t.body&&t.body.setShapeFilters(zi.ground),e.textured_polygon_entities.push(t)),null==t.prefab&&null==t.prefab_link&&null==t.bitmap_images&&null==t.body&&null==t.polygon&&null==t.group){for(var I=0,A=t.name,D=0,E=e.markers;D<E.length;){var O=E[D];++D,t.name==O.name&&++I}0<I&&(A=t.name+" ("+I+")");var B=0==e.config.type&&e.config.development.render_markers,L=Gn.createMarker(t,A,B);e.markers.push(L)}if(null!=t.group)for(var j=0,F=t.group.entities;j<F.length;){var R=F[j];if(++j,!Gn.createObjectsBasedOnEntities(e,R,n))return!1}return!0},Gn.connectAdditionalCarGraphicsToMainCarBodyEntity=function(e,t){t.main_body_entity;for(var n=0,i=t.group_entity.group.entities;n<i.length;){var r=i[n];if(++n,null!=r.bitmap_images&&2<=r.bitmap_images.images.length)return void xl.trace("warning: car "+t.name+" has at least 2 bitmap images in it - the game no longer supports it!",{fileName:"GameDo.hx",lineNumber:2141,className:"bikas.game.GameDo",methodName:"connectAdditionalCarGraphicsToMainCarBodyEntity"})}for(var a=0,s=t.group_entity.group.entities;a<s.length;){var l=s[a];if(++a,l!=t.main_body_entity&&null==l.body&&null!=l.bitmap_images&&0<l.bitmap_images.images.length){var o=l.bitmap_images.images[0];-1==o.source_name.indexOf("background")&&-1==o.source_name.indexOf("top")||(t.main_body_background_sprite=l.display.sprite,Gn.connectEntitiesByPositionAndRotation(e.connected_containers,t.main_body_entity,l))}}},Gn.connectEntitiesByPositionAndRotation=function(e,t,n){var i=t.display.sprite,r=i.position.x,a=i.position.y,s=n.display.sprite,l=r-s.x,o=a-s.y,_=s.width,p=s.height;if(0==_||0==p)xl.trace("warning: width: "+_+", height: "+p,{fileName:"GameDo.hx",lineNumber:2185,className:"bikas.game.GameDo",methodName:"connectEntitiesByPositionAndRotation"});else{var u=s.anchor.x+l/_,h=s.anchor.y+o/p;n.position.x-=l,n.position.y-=o,he.refresh(n),s.anchor.x=u,s.anchor.y=h,n.bitmap_images.images[0].offset_x=u*_,n.bitmap_images.images[0].offset_y=h*_;var c=Xt.createAndConnectContainers(i,s);Xt.updateConnectedContainers(c),e.push(c)}},Gn.createLevelObjectsBasedOnObjects=function(e){if(Xs.renderer.type==PIXI.RENDERER_TYPE.CANVAS)for(var t=0,n=e.textured_polygon_entities;t<n.length;){var i=n[t];++t;var r=Gn.createAndAddTexturedPolygonEntity(i,2*e.js_info.max_game_width,2*e.js_info.max_game_height);null!=r?e.textured_polygons.push(r):xl.trace("warning: textured polygon for "+i.name+" was not created",{fileName:"GameDo.hx",lineNumber:2221,className:"bikas.game.GameDo",methodName:"createLevelObjectsBasedOnObjects"})}else{for(var a=0,s=e.textured_polygon_entities;a<s.length;){var l=s[a];++a;var o=l.polygon.texture.fill_source_name+"_separate",_=Zs.getTexture(o),p=null;null!=_&&((p=er.createMesh(_,l.polygon.points)).position.x=l.position.x,p.position.y=l.position.y),_==Os.tile_dark_separate?e.cave_meshes.push(p):_==Os.tile_separate?e.ground_meshes.push(p):xl.trace("warning: texture "+o+" is not supported or does not exist",{fileName:"GameDo.hx",lineNumber:2242,className:"bikas.game.GameDo",methodName:"createLevelObjectsBasedOnObjects"}),Gn.createAndAddGrass(e.mesh_line_sprites,l)}e.use_cached_terrain_polygons}return null!=e.player&&(e.stunt=Ur.create(e.ingame_container,e.player.car)),e.tutorial_menu.controls_marker=Gn.findMarker(e.markers,"controls tutorial"),e.tutorial_menu.jump_marker=Gn.findMarker(e.markers,"jump tutorial"),e.background=Gn.createBackground(e.current_level_save.description.name,e.background_container,e.foreground_container,e.js_info,e.level_bottom_position.y),!0},Gn.createLevelObjects=function(e){if(1==e.config.type&&2==e.config.release.sitelock_type&&(e.level_type!=Fn.InMainMenu&&e.level_type!=Fn.InRacing||(e.lagged_logo=Ra.createSpriteByName("lagged_logo",0,.5,0,0),e.lagged_logo.anchor.x=0,e.lagged_logo.anchor.y=.5,e.lagged_logo.hitArea=new PIXI.Rectangle(-5,-30,200,60),e.lagged_logo.interactive=!0,e.lagged_logo.buttonMode=!0,e.lagged_logo.interactiveChildren=!1,e.lagged_logo.pointerdown=function(e){to.get_window().open("http://lagged.com/","_blank")},e.menu_container.addAt(e.lagged_logo,0),e.lagged_logo.x=e.pause_button.x+80,e.lagged_logo.y=e.pause_button.y+3)),e.level_type==Fn.InRacing||e.level_type==Fn.InInterLevelMenu){e.ongoing_powers_display.current_items=[];for(var t=0,n=e.game_save.ongoing_powers.permanent_items;t<n.length;){var i=n[t];++t,e.ongoing_powers_display.current_items.push(i)}for(var r=0,a=e.game_save.ongoing_powers.level_items;r<a.length;){var s=a[r];++r,e.ongoing_powers_display.current_items.push(s)}}if(e.level_type==Fn.InRacing){if(e.collected_in_level=new gr,e.race_countdown=new wn,e.race_countdown.container=Ra.createGroup(),e.race_countdown.animation=T.createNewAnimation(Os.animation_race_start,!1),e.race_countdown.container.add(e.race_countdown.animation.sprite),e.race_countdown.current_number=wn.max_countdown_state,e.race_countdown.current_time=wn.init_wait,e.current_place=new zn,e.current_place.container=Ra.createGroup(),e.current_place.anim=T.createNewAnimation(Os.animation_current_position,!1),e.current_place.container.add(e.current_place.anim.sprite),e.current_place.player_position=new PIXI.Point,e.ingame_container.add(e.current_place.container),e.current_level_save.description.type!=vr.LevelRegular)if(e.current_level_save.description.type==vr.LevelChallenge){e.race_countdown.challenge_text=Ra.createBitmapText(cn.toonish_36,42,"left","TEXT"),e.race_countdown.challenge_text.anchor.set(.5,.5);var l=e.current_level_save.description.challenge_type;l==br.ChallengeEscapeFromWolf?(e.challenges.escape_from_wolf=Vt.createEscapeFromWolfChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings,e.current_level_save.description.challenge_type),e.race_countdown.challenge_text.text="Challenge: Escape From Wolf!"):l==br.ChallengeHuntThePrey?(e.challenges.escape_from_wolf=Vt.createEscapeFromWolfChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings,e.current_level_save.description.challenge_type),e.race_countdown.challenge_text.text="Challenge: Hunt The Prey!"):l==br.ChallengeMountainRush?(e.challenges.mountain_rush=Vt.createMountainRushChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings),e.race_countdown.challenge_text.text="Challenge: Do "+Et.flip_count+" Flips!"):l==br.ChallengeSurvival?(e.challenges.survival=Vt.createSurvivalChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings,e.temp_interactive_objects),e.race_countdown.challenge_text.text="Challenge: Survive!"):l==br.ChallengeBalancing?(e.challenges.balancing=Vt.createBalancingChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings,e.boxes),e.race_countdown.challenge_text.text="Challenge: Don't Break The Box!"):l==br.ChallengeBulletTaxi?(e.challenges.bullet_taxi=Vt.createBulletTaxiChallenge(e.stage_group,e.player,e.bots,e.car_upgrade_data,e.car_settings),e.race_countdown.challenge_text.text="Challenge: Reach Destination in "+jt.max_time+" Seconds!"):l==br.ChallengeAchievement?(e.challenges.achievement=Vt.createAchievementChallenge(e.stage_group,e.player,e.bots),e.race_countdown.challenge_text.text=""):l==br.ChallengeCredits?(e.challenges.credits=Vt.createCreditsChallenge(e.stage_group,e.player,e.bots),e.race_countdown.challenge_text.text=""):xl.trace("warning: unhandled "+p.string(l),{fileName:"GameDo.hx",lineNumber:2382,className:"bikas.game.GameDo",methodName:"createLevelObjects"})}else xl.trace("warning: unhandled "+p.string(e.current_level_save.description.type),{fileName:"GameDo.hx",lineNumber:2385,className:"bikas.game.GameDo",methodName:"createLevelObjects"});return!0}if(e.level_type==Fn.InInterLevelMenu)return e.inter_level_menu=bi.create(e.game_save,e.stage_group,e.game_save.level_saves,e.upgrades,e.car_settings,e.chest_reward_item_descs,e.achievement_descs,e.challenge_descs,e.markers),Gn.saveGameSaveToStorage(e.game_save_serial_data,e.game_save),!0;if(e.level_type!=Fn.InMainMenu)return xl.trace("warning: unhandled level_type == "+p.string(e.level_type),{fileName:"GameDo.hx",lineNumber:2423,className:"bikas.game.GameDo",methodName:"createLevelObjects"}),!1;var o=null,_=Bi.LoadedGameNoSave;return _=e.initial_game_save_loaded?(o=e.game_save,Bi.ContinueGame):(e.initial_game_save_loaded=!0,null==(o=Gn.loadGameSaveFromStorage(e.game_save_serial_data))?(o=null,Bi.LoadedGameNoSave):Bi.LoadedGameWithSave),e.main_menu=Ri.create(e.markers,_,o),!0},Gn.createAndAddTexturedPolygonEntity=function(e,t,n){var i=Oa.PatternFill,r=new In,a=(r.entity=e).polygon.texture.fill_source_name;Gn.createAndAddGrass(r.line_sprites,e);for(var s=[],l=0,o=e.polygon.points;l<o.length;){var _=o[l];++l,s.push(Yr.create(_.x,_.y))}if(i==Oa.PatternFill){var p=Ra.createGraphics();p.x=e.position.x,p.y=e.position.y;var u=Zs.retrieveAsset(a+"_pattern"),h=!1;null==e.body&&(h=!0),r.data=ja.createPolygonTextureDataUsingPatternFill(p,s,u,h)}else if(i==Oa.Tiles)return xl.trace("warning: not supported",{fileName:"GameDo.hx",lineNumber:2469,className:"bikas.game.GameDo",methodName:"createAndAddTexturedPolygonEntity"}),null;return r.draw_bounds=new Qr(0,0,0,0),r},Gn.createTerrainPolygons=function(e,t,n){null==n&&(n=300);for(var i=[],r=0;r<e.length;){var a=e[r];if(++r,null==a.polygon)xl.trace("warning: entity.polygon == null",{fileName:"GameDo.hx",lineNumber:2520,className:"bikas.game.GameDo",methodName:"createTerrainPolygons"});else if(null==a.polygon.texture)xl.trace("warning: entity.polygon.texture == null",{fileName:"GameDo.hx",lineNumber:2523,className:"bikas.game.GameDo",methodName:"createTerrainPolygons"});else{for(var s=a.polygon.texture.fill_source_name,l=null,o=0;o<i.length;){var _=i[o];if(++o,_.texture_name==s){l=_;break}}var p=null;null==l?((p=new An).texture_name=s,p.texture=Zs.retrieveAsset(s),i.push(p)):p=l,p.entities.push(a)}}for(var u=0;u<i.length;){var h=i[u];++u;var c=h.entities[0];h.main_entity_position=ga.copy(c.position),null!=c.body?h.has_physics_body=!0:h.has_physics_body=!1;for(var d=[],m=0,f=c.polygon.points;m<f.length;){var g=f[m];++m,d.push(Yr.create(g.x,g.y))}h.polygons.push(d);for(var v=1,b=h.entities.length;v<b;){for(var y=v++,x=h.entities[y],z=[],w=0,k=x.polygon.points;w<k.length;){var S=k[w];++w;var C=S.x+x.position.x-h.main_entity_position.x,N=S.y+x.position.y-h.main_entity_position.y;z.push(Yr.create(C,N))}h.polygons.push(z)}}for(var P=0;P<i.length;){var M=i[P];++P,M.terrain=Ms.create(M.polygons,Math.floor(t-M.main_entity_position.y+n),M.texture)}return i},Gn.createSpritesForTerrainPolygons=function(e){for(var t=0;t<e.length;){var n=e[t];if(++t,null!=n.terrain){var i=n.main_entity_position.x,r=n.main_entity_position.y;n.sprite_objects=Ms.createSpriteObjects(n.terrain.all_terrain_rects,i,r,Rn.texture_offset_add),n.global_bounds=pa.copyBounds(n.terrain.bounds),ha.moveBounds(n.global_bounds,i,r),n.global_polygons_bounds=[],n.global_polygons=[];for(var a=0,s=n.polygons;a<s.length;){var l=s[a];++a;for(var o=[],_=0;_<l.length;){var p=l[_];++_,o.push(Yr.create(p.x+i,p.y+r))}n.global_polygons.push(o);var u=Ka.getPolygonBounds(o);n.global_polygons_bounds.push(u)}}}for(var h=[],c=[],d=0;d<e.length;){var m=e[d];++d,m.has_physics_body?c.push(m):h.push(m)}for(var f=0;f<h.length;){var g=h[f];++f;for(var v=0;v<c.length;){var b=c[v];if(++v,pa.boundsIntersectOrContain(g.global_bounds,b.global_bounds))for(var y=g.sprite_objects.length,x=0;x<y;){var z=g.sprite_objects[x];if(pa.boundsIntersectOrContain(z.global_bounds,b.global_bounds))for(var w=0,k=b.global_polygons_bounds.length;w<k;){var S=w++,C=b.global_polygons_bounds[S];if(pa.boundsIntersectOrContain(z.global_bounds,C)){var N=b.global_polygons[S];if(!Ka.boundsIntersectWithPolygon(z.global_bounds,N)){var P=new Yr(z.global_bounds.min_x,z.global_bounds.min_y);if(Ka.pointInPolygon(P,N)){Ms.destroySpriteObject(g.sprite_objects[x]),g.sprite_objects.splice(x,1),--x,--y;break}}}}++x}}}for(var M=0,I=0;I<e.length;){var A=e[I];++I,A.sprites=Ms.createSprites(A.sprite_objects);for(var T=0,D=A.entities;T<D.length;){var E=D[T];++T,Gn.createAndAddGrass(A.line_sprites,E)}A.entities=null,M+=A.line_sprites.length,M+=A.sprites.length}xl.trace("total sprites created for all terrains: "+M,{fileName:"GameDo.hx",lineNumber:2699,className:"bikas.game.GameDo",methodName:"createSpritesForTerrainPolygons"})},Gn.createBackground=function(e,t,n,i,r){var a=Ra.createSprite(Os.background_sea),s=Ra.createSprite(Os.background_sky,0,1);a.x=0,a.width=i.current_game_width,s.x=0,s.width=i.current_game_width,new ji(0,0,800),new ji(0,0,800);var l=Ve.createBackground(800,a,s,r+300,642);t.add(l.plane_container),t.add(l.background_container),n.add(l.foreground_container);var o=Os.background_objects_obj;return Ve.overloadBackground(l,o,"default",e,(function(e){return _.field(Os,e)})),Gn.addWavesToBackground(l),l},Gn.addWavesToBackground=function(e){var t=["background_waves_1","background_waves_2","background_waves_3","background_waves_4","background_waves_5","background_waves_6","background_waves_7","background_waves_8","background_waves_9","background_waves_10","background_waves_11","background_waves_12","background_waves_13"],n=[923,1067,1236,1440,1689,2e3,2400,2933,3680,4800,6667,10400,21600];if(Xs.js_info.android||Xs.js_info.iOS||!Xs.js_info.desktop)for(var i=1,r=Math.ceil(t.length/2);i<r;){var a=i++;t.splice(a,1),n.splice(a,1)}Ve.removeAllSpritesFromContainer(e),Ve.addWaves(e,t,n,1,(function(e){return _.field(Os,e)})),Ve.addAndSortAllSpritesToContainer(e)},Gn.centerStage=function(e,t){e.entity_container.x=0,e.entity_container.y=0},Gn.createTreePartition=function(e){for(var t=[],n=[],i=[],r=[],a=[t,n,i,r],s=0,l=e.terrain_polygons;s<l.length;){var o=l[s];if(++s,null!=o.sprites)for(var _=0,p=o.sprites;_<p.length;){var u=p[_];++_,o.has_physics_body?n.push(Pa.create(u,!1)):t.push(Pa.create(u,!1))}}var h=null,c=h=function(e,t,n){if(null!=n.group)for(var i=0,r=n.group.entities;i<r.length;){var a=r[i];++i,h(e,t,a)}if(null!=n.bitmap_images){var s=!1;null!=n.body&&n.body.isDynamic()&&(s=!0);for(var l=0;l<t.length;){var o=t[l];if(++l,o.connected_container==n.display.sprite){s=!0;break}}e.push(Pa.create(n.display.sprite,s,n.name))}};null==e.stage_group?xl.trace("error: game.stage_group == null",{fileName:"GameDo.hx",lineNumber:2852,className:"bikas.game.GameDo",methodName:"createTreePartition"}):c(i,e.connected_containers,e.stage_group);var d=i;d.sort((function(e,t){var n=e.display_object.parent.getChildIndex(e.display_object),i=t.display_object.parent.getChildIndex(t.display_object);return i<n?1:n<i?-1:0}));for(var m=0;m<d.length;){var f=d[m];++m,null!=f.display_object.parent&&f.display_object.parent.removeChild(f.display_object)}for(var g=0,v=e.terrain_polygons;g<v.length;){var b=v[g];++g;for(var y=0,x=b.line_sprites;y<x.length;){var z=x[y];++y,r.push(Pa.create(z,!1))}}var w=[];if(0==e.config.type&&e.config.development.render_markers)for(var k=0,S=e.markers;k<S.length;){var C=S[k];++k,null!=C.point_graphics&&w.push(Pa.create(C.point_graphics,!1)),null!=C.bitmap_text&&w.push(Pa.create(C.bitmap_text,!1))}e.background_ground_group=Ra.createGroup(),e.entity_container.addAt(e.background_ground_group,0),e.grass_group=Ra.createGroup(),e.entity_container.add(e.grass_group),e.ground_group=Ra.createGroup(),e.entity_container.add(e.ground_group),0<w.length&&(e.marker_group=Ra.createGroup(),e.entity_container.add(e.marker_group));for(var N=0,P=e.textured_polygons;N<P.length;){var M=P[N];++N,M.data.is_background_ground?e.background_ground_group.add(M.data.real_time_graphics):e.ground_group.add(M.data.real_time_graphics)}for(var I=0,A=e.textured_polygons;I<A.length;){var T=A[I];++I;for(var D=0,E=T.line_sprites;D<E.length;){var O=E[D];++D,r.push(Pa.create(O,!1))}}for(var B=0,L=e.cave_meshes;B<L.length;){var j=L[B];++B,e.background_ground_group.add(j)}for(var F=0,R=e.ground_meshes;F<R.length;){var G=R[F];++F,e.ground_group.add(G)}for(var Z=0,U=e.mesh_line_sprites;Z<U.length;){var V=U[Z];++Z,r.push(Pa.create(V,!1))}var q=[],W=Ea.createPartitionContainer(e.stage_group.group.container,d);if(0<t.length){var X=Ea.createPartitionContainer(e.background_ground_group,t);q.push(X)}if(q.push(W),0<r.length){var H=Ea.createPartitionContainer(e.grass_group,r);q.push(H)}if(0<n.length){var Y=Ea.createPartitionContainer(e.ground_group,n);q.push(Y)}if(0<w.length){var J=Ea.createPartitionContainer(e.marker_group,w);q.push(J)}e.entity_partition_container=W,e.partition_top=Ea.createPartition(q,Ta.HorizontalBinaryTree,512,512,5120);for(var K=0;K<a.length;){var Q=a[K];++K;for(var $=0;$<Q.length;){var ee=Q[$];++$,Pa.destroy(ee)}}a=null},Gn.destroyLevel=function(e,t,n){e.level_end.state=vn.None,ks.setVolume(Os.music_avocado_easy_times_in_hawaii,0),ks.setVolume(Os.music_beach_waves,0),ks.setVolume(Os.music_stereospice_fun_surf_rock_142_sec,0),ks.setVolume(Os.music_stereospice_fun_surf_rock_92_sec,0),ks.stopMusic(Os.music_avocado_easy_times_in_hawaii),ks.stopMusic(Os.music_beach_waves),ks.stopMusic(Os.music_stereospice_fun_surf_rock_142_sec),ks.stopMusic(Os.music_stereospice_fun_surf_rock_92_sec),Gn.safeRemove(e.pause_menu.container),Gn.safeRemove(e.level_end.finished_text),Gn.safeRemove(e.level_end.challenge_button),Ie.cancelAll(),null!=e.lagged_logo&&(e.lagged_logo.destroy(!0),e.lagged_logo=null),Gn.setTutorial(e,Bn.TutorialNone),null!=e.stage_group&&Gn.setSpace(e,null);for(var i=0,r=e.textured_polygons;i<r.length;){var a=r[i];if(++i,null!=a.data.points){for(var s=0,l=a.data.points;s<l.length;){var o=l[s];++s,Yr.destroy(o)}a.data.points=null}null!=a.data.tiles&&a.data.tiles.parent.removeChild(a.data.tiles),null!=a.data.mask_graphics&&a.data.mask_graphics.parent.removeChild(a.data.mask_graphics),null!=a.data.line_group&&a.data.line_group.parent.removeChild(a.data.line_group);for(var _=0,p=a.line_sprites;_<p.length;){var u=p[_];++_,u.destroy(!0)}a.line_sprites=null,ja.destroy(a.data)}e.textured_polygons=[];for(var h=0,c=e.cave_meshes;h<c.length;){var d=c[h];++h,d.parent.removeChild(d),d.destroy()}e.cave_meshes=[];for(var m=0,f=e.ground_meshes;m<f.length;){var g=f[m];++m,g.parent.removeChild(g),g.destroy()}e.ground_meshes=[];for(var v=0,b=e.mesh_line_sprites;v<b.length;){var y=b[v];++v,y.destroy(!0)}if(e.mesh_line_sprites=[],n){for(var x=0,z=e.terrain_polygons;x<z.length;){var w=z[x];++x;for(var k=0,S=w.sprites;k<S.length;){var C=S[k];++k,null!=C.parent&&C.parent.removeChild(C)}for(var N=0,P=w.line_sprites;N<P.length;){var M=P[N];++N,null!=M.parent&&M.parent.removeChild(M)}}e.use_cached_terrain_polygons=!0}else{for(var I=0,A=e.terrain_polygons;I<A.length;){var D=A[I];if(++I,D.entities=null,(D.texture=null)!=D.main_entity_position&&(Yr.destroy(D.main_entity_position),D.main_entity_position=null),(D.global_bounds=null)!=D.polygons)for(var E=0,O=D.polygons;E<O.length;){var B=O[E];++E;for(var L=0;L<B.length;){var j=B[L];++L,Yr.destroy(j)}}if((D.polygons=null)!=D.global_polygons)for(var F=0,R=D.global_polygons;F<R.length;){var G=R[F];++F;for(var Z=0;Z<G.length;){var U=G[Z];++Z,Yr.destroy(U)}}D.global_polygons=null;for(var V=0,q=D.sprite_objects;V<q.length;){var W=q[V];++V,Ms.destroySpriteObject(W)}D.sprite_objects=null;for(var X=0,H=D.sprites;X<H.length;){var Y=H[X];++X,Y.destroy(!0)}D.sprites=null;for(var J=0,K=D.line_sprites;J<K.length;){var Q=K[J];++J,Q.destroy(!0)}(D.line_sprites=null)!=D.terrain&&Ms.destroy(D.terrain),D.terrain=null}e.terrain_polygons=[],e.use_cached_terrain_polygons=!1}if(e.textured_polygon_entities=[],null!=e.markers)for(var $=0,ee=e.markers;$<ee.length;){var te=ee[$];++$,Gn.destroyMarker(te)}(e.markers=null)!=e.background_ground_group&&(e.background_ground_group.destroy(!1),e.background_ground_group=null),null!=e.ground_group&&(e.ground_group.destroy(!1),e.ground_group=null),null!=e.grass_group&&(e.grass_group.destroy(!0),e.grass_group=null),null!=e.marker_group&&(e.marker_group.destroy(!0),e.marker_group=null),null!=e.player&&(lr.destroy(e.player),null!=e.player_bot&&(e.player_bot.abilities=null)),e.player=null;for(var ne=0,ie=e.bots;ne<ie.length;){var re=ie[ne];++ne,gt.destroy(re)}e.bots=[],null!=e.player_bot&&gt.destroy(e.player_bot),e.all_cars=[],e.bot_cars=[],null!=e.camera&&bt.reset(e.camera);for(var ae=0,se=e.boxes;ae<se.length;){var le=se[ae];++ae,Ji.destroyBox(le)}e.boxes=[];for(var oe=0,_e=e.forward_ramps;oe<_e.length;){var pe=_e[oe];++oe,Ji.destroyForwardRamp(pe)}e.forward_ramps=[];for(var ue=0,he=e.pickable_items;ue<he.length;){var ce=he[ue];++ue,Ci.destroyPickableItem(ce)}e.pickable_items=[];for(var de=0,me=e.explosives;de<me.length;){var fe=me[de];++de,Me.destroyExplosive(fe,e.partition_top)}e.immune_bodies=[],e.explosives=[],null!=e.background&&(Ve.destroyBackground(e.background),e.background=null);for(var ge=0,ve=e.connected_containers;ge<ve.length;){var be=ve[ge];++ge,be.connected_container=null,be.source_container=null}e.connected_containers=[];for(var ye=0,xe=e.looped_animations;ye<xe.length;){var ze=xe[ye];++ye,T.destroyAnimation(ze)}e.looped_animations=[];for(var we=0,ke=e.chickens;we<ke.length;){var Se=ke[we];++we,T.destroyAnimation(Se.anim),Se.anim=null,Se.body=null}e.chickens=[];for(var Ce=0,Ne=e.temp_interactive_objects;Ce<Ne.length;){var Pe=Ne[Ce];++Ce,Ji.destroyTempInteractiveObject(Pe)}e.temp_interactive_objects=[];for(var Ae=0,Te=e.attachments;Ae<Te.length;){var De=Te[Ae];++Ae,Oe.destroy(De)}e.attachments=[],null!=e.stunt&&(Ur.destroy(e.stunt),e.stunt=null),null!=e.main_menu&&(Ri.destroy(e.main_menu),e.main_menu=null),null!=e.inter_level_menu&&(bi.destroy(e.inter_level_menu,e.partition_top),e.inter_level_menu=null),Vt.destroyAllChallenges(e.challenges),null!=e.partition_top&&(Ea.destroy(e.partition_top),e.partition_top=null),(e.entity_partition_container=null)!=e.race_countdown&&(null!=e.race_countdown.container.parent&&e.race_countdown.container.parent.removeChild(e.race_countdown.container),T.destroyAnimation(e.race_countdown.animation,!0),e.race_countdown.container.destroy(!0),null!=e.race_countdown.challenge_text&&(Gn.safeRemove(e.race_countdown.challenge_text),e.race_countdown.challenge_text.destroy(!0),e.race_countdown.challenge_text=null),e.race_countdown=null),null!=e.current_place&&(T.destroyAnimation(e.current_place.anim,!0),e.current_place.container.destroy(!0),e.current_place=null),Fr.clearOngoingPowersDisplay(e.ongoing_powers_display),null!=e.level_stats&&Ti.remove(e.level_stats);for(var Ee=e.car_original_rotations.keys();Ee.hasNext();){var Be=Ee.next();e.car_original_rotations.remove(Be)}e.camera_shake.amount=0,e.camera_shake.current_time=0,e.level_start_position=null,e.level_end_position=null,e.physics_running=!1,e.level_running=!1,e.all_body_entities=null,e.menu_camera_position=null,e.collected_in_level=null,e.jump_over_bodies=[],Gn.destroyEngine(e,t)},Gn.destroyEngine=function(e,t){null!=e.stage_group&&(Gn.removeAndDestroyEntityIncludingChildren(e.stage_group),e.stage_group=null),t&&null!=e.library_group&&(Gn.removeAndDestroyEntityIncludingChildren(e.library_group),e.library_group=null),null!=e.world&&e.world.space.clear()},Gn.removeAndDestroyEntityIncludingChildren=function(e){oe.removeEntityIncludingChildren(e),ie.destroyEntityIncludingChildren(e)},Gn.resetCamera=function(e,t){t.camera_target_pos.set_x(0),t.camera_target_pos.set_y(0),t.target_pos.set_x(0),t.target_pos.set_y(0),null!=e.stage_group&&(e.stage_group.position.x=0,e.stage_group.position.y=0,e.stage_group.transform.scale_x=1,e.stage_group.transform.scale_y=1,e.stage_group.transform.rotation=0),bt.reset(t)},Gn.setSpace=function(e,t){ie.setSpaceIncludingChildren(e.stage_group,e.world.space),null!=e.player&&Tt.setCarSpace(e.player.car,t);for(var n=0,i=e.bots;n<i.length;){var r=i[n];++n,Tt.setCarSpace(r.car,t)}for(var a=0,s=e.attachments;a<s.length;){var l=s[a];++a,Oe.setSpace(l,t)}},Gn.initRace=function(e,t){if(e.camera.smooth_steps=Rn.countdown_camera_smooth_steps,e.camera.offset_max_speed.set_x(12),e.camera.offset_max_speed.set_y(12),e.camera.offset_max_distance.set_x(300),e.camera.offset_max_distance.set_y(300),e.camera.zoom_min=Rn.race_zoom_min,e.camera.zoom_max=Rn.race_zoom_max,e.camera.zoom_max_speed=12,Gn.setInGameControlsAlpha(e,1),t.level_seconds=0,Gn.resetCamera(e,e.camera),ga.add(e.player.car.main_body_entity.position,new Yr(0,0)),e.current_level_save.description.type==vr.LevelRegular){var n=!1;if(null!=e.game_save.ongoing_powers){for(var i=null,r=0,a=e.ongoing_powers_display.current_items;r<a.length;){var l=a[r];++r,l.desc.type==kr.OneTimeStartFirst&&(n=!0,null==i&&(i=[]),i.push(l))}if(null!=i)for(var o=0;o<i.length;){var _=i[o];++o,s.remove(e.ongoing_powers_display.current_items,_)}}if(n){for(var u=0,h=0,c=e.bots;h<c.length;){var d=c[h];++h,d.car.initial_main_body_position.get_x()>u&&(u=d.car.initial_main_body_position.get_x())}e.player.car.initial_main_body_position.set_x(u+1)}Gn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!0,!0,!1)}else e.current_level_save.description.type==vr.LevelChallenge?e.current_level_save.description.challenge_type==br.ChallengeEscapeFromWolf?(e.camera.offset_max_distance.set_x(100),e.camera.offset_max_distance.set_y(100),Gn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!0,!1)):e.current_level_save.description.challenge_type==br.ChallengeHuntThePrey?Gn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!0,!1):e.current_level_save.description.challenge_type==br.ChallengeMountainRush?Gn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!1,!0):e.current_level_save.description.challenge_type==br.ChallengeSurvival?(e.camera.offset_max_distance.set_x(400),e.camera.offset_max_distance.set_y(100),Gn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!0,!0,!1)):e.current_level_save.description.challenge_type==br.ChallengeBalancing?(e.camera.offset_max_distance.set_x(1),e.camera.offset_max_distance.set_y(1),Gn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!1,!1)):e.current_level_save.description.challenge_type==br.ChallengeBulletTaxi?(e.camera.offset_max_distance.set_x(300),e.camera.offset_max_distance.set_y(1),Gn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!0,!0,!1)):e.current_level_save.description.challenge_type==br.ChallengeAchievement||e.current_level_save.description.challenge_type==br.ChallengeCredits?Gn.lineUpCarsRelativeToPosition(e.level_start_position,e.car_original_rotations,e.player,e.bots,!1,!1,!0,!1):xl.trace("warning: unhandled "+p.string(e.current_level_save.description.challenge_type),{fileName:"GameDo.hx",lineNumber:3511,className:"bikas.game.GameDo",methodName:"initRace"}):xl.trace("warning: unhandled "+p.string(e.current_level_save.description.type),{fileName:"GameDo.hx",lineNumber:3514,className:"bikas.game.GameDo",methodName:"initRace"});e.player.finished_race=!1;for(var m=0,f=e.bots;m<f.length;){var g=f[m];++m,g.finished_race=!1}if(0!=e.config.type||e.config.development.race_countdown_enabled){Gn.refreshCameraCenter(e,e.camera,e.js_info,e.player.car.main_body_entity.position,.5),e.race_countdown.finished=!1,e.player.behavior_activated=!1,null!=e.player_bot&&(e.player_bot.behavior_activated=!1);for(var v=0,b=e.bots;v<b.length;){var y=b[v];++v,y.behavior_activated=!1}}else Gn.refreshCameraCenter(e,e.camera,e.js_info,e.player.car.main_body_entity.position,e.camera.zoom_max),e.race_countdown.finished=!0,e.race_countdown.engine_sound_allowed=!0,Gn.startRace(e,t);0==e.config.type&&(e.player.constant_drive=!1);for(var x=0,z=e.all_body_entities;x<z.length;){var w=z[x];++x,ce.refresh(w)}Gn.updateCamera(e,t),Gn.updatePolygonDraw(e);for(var k=0,S=e.temp.initraces;k<S.length;){var C=S[k];++k,C()}},Gn.initMenu=function(e,t){t.level_seconds=0,Gn.setInGameControlsAlpha(e,0),e.camera.smooth_steps=Rn.camera_smooth_steps,e.camera.offset_max_speed.set_x(0),e.camera.offset_max_speed.set_y(0),e.camera.offset_max_distance.set_x(0),e.camera.offset_max_distance.set_y(0),e.camera.zoom_min=1,e.camera.zoom_max=1,e.camera.current_zoom=1,e.camera.zoom_max_speed=12,e.camera.camera_target_pos.set_x(0),e.camera.camera_target_pos.set_y(0),e.camera.target_pos.set_x(0),e.camera.target_pos.set_y(0),Gn.resetCamera(e,e.camera),e.camera.smooth_steps=vi.camera_smooth_steps,null!=e.menu_camera_position&&Gn.refreshCameraCenter(e,e.camera,e.js_info,e.menu_camera_position,1),null!=e.inter_level_menu&&(va.set(e.inter_level_menu.scroll_target,e.menu_camera_position),e.inter_level_menu.downed=!1,e.inter_level_menu.dragging=!1);for(var n=0,i=e.all_body_entities;n<i.length;){var r=i[n];++n,ce.refresh(r)}Gn.updateCamera(e,t),Gn.updatePolygonDraw(e)},Gn.startRace=function(e,t){e.camera.smooth_steps=Rn.camera_smooth_steps,e.race_start_at_second=t.level_seconds,e.player.behavior_activated=!0,null!=e.player_bot&&(e.player_bot.behavior_activated=!0);for(var n=0,i=e.bots;n<i.length;){var r=i[n];++n,r.behavior_activated=!0;for(var a=0,s=r.all_decisions;a<s.length;){var l=s[a];++a,l.decision_made_time_stamp=t.level_seconds}}1==e.config.type&&3==e.config.release.sitelock_type&&Ya.PokiSDK.gameplayStart()},Gn.lineUpCarsRelativeToPosition=function(e,t,n,i,r,a,s,l){null==l&&(l=!1),null==s&&(s=!0),null==a&&(a=!0),null==r&&(r=!1);var o=0;null!=n&&++o,null!=i&&(o+=i.length);var _=e.x-200*(o-1)/2,p=0,u=[];if(null!=n&&u.push(n.car),null!=i)for(var h=0;h<i.length;){var c=i[h];++h,u.push(c.car)}r?ha.shuffleArray(u):u.sort(Gn.sortCarsByInitialPositionX);for(var d=0;d<u.length;){var m=u[d];++d,p=s?e.y-m.distance_from_main_body_to_bottom_y:m.main_body.get_position().get_y();var f=0;a?(f=_,r&&(f=e.x+pa.getRandomBetween(-600,600))):f=m.main_body.get_position().get_x();var g=t.get(m.group_entity);null!=g?Gn.teleportCar(m,f,p,.017453292519943*g):Gn.teleportCar(m,f,p),_+=200}},Gn.teleportCar=function(e,t,n,i){null==i&&(i=0),Tt.setPosition(e,t,n),Tt.setRotation(e,i),Tt.setVelocity(e,0,0),Tt.setAngularVelocity(e,0)},Gn.teleportPlayerToFinish=function(e){if(null!=e.player&&null!=e.level_end_position){var t=e.level_end_position.x+250,n=e.level_end_position.y;Gn.teleportCar(e.player.car,t,n),e.stage_group.position.x=t,e.stage_group.position.y=n,e.camera.target_speed.set_x(t),e.camera.target_speed.set_y(n),e.camera.current_pos.set_x(t),e.camera.current_pos.set_y(n),e.camera.target_pos.set_x(t),e.camera.target_pos.set_y(n)}},Gn.isObjectClickedInRadius=function(e,t,n){return Ha.isClicked(e.x,e.y,t,n)},Gn.isObjectDownedInRadius=function(e,t,n){return Ha.isDowned(e.x,e.y,t,n)},Gn.isBitmapTextDownedInBounds=function(e,t,n){var i=e.x-e.anchor.x*e.width-n,r=e.y-e.anchor.y*e.height-n,a=i+e.width+n,s=r+e.height+n;return Ha.isDownedInBounds(e.x,e.y,t,i,r,a,s)},Gn.moreGamesClick=function(){ba.trackMoreGamesClicked(),to.get_window().open("http://www.bikas.net","_blank")},Gn.bikasNetClick=function(){ba.trackBikasNetClicked(),to.get_window().open("http://www.bikas.net","_blank")},Gn.createMarker=function(e,t,n){var i=new Tn;return i.entity=e,i.name=t,i.position=i.entity.position,n&&(i.bitmap_text=new ps(Xs.game,0,0,"consolas_24",t,42,"center"),i.bitmap_text.x=-i.bitmap_text.width/2,i.bitmap_text.y=-69.72,i.point_graphics=Ra.createGraphics(),Fa.drawCross(i.point_graphics,25.2,1651777,3),Fa.drawCircle(i.point_graphics,42,3,1651777)),i},Gn.destroyMarker=function(e){null!=e.bitmap_text&&e.bitmap_text.destroy(!0),null!=e.point_graphics&&e.point_graphics.destroy(!0),e.entity=null,e.bitmap_text=null,e.point_graphics=null},Gn.findMarker=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i}return null},Gn.setInGameControlsAlpha=function(e,t){null!=e.wheel&&(e.wheel.sprite.alpha=t),e.ability_item_container.alpha=t,null!=e.player&&(e.player.jump_button.container.alpha=t)},Gn.applyCameraShake=function(e,t,n,i,r){if(null==i||null==r)return e.amount=t,void(e.current_time=n);var a=pa.distance(r.get_x(),r.get_y(),i.main_body_position_x,i.main_body_position_y);if(a<800)e.amount=t,e.current_time=n;else if(a<1600){var s=(a-800)/800;e.amount=pa.interpolate(t,0,s),e.current_time=pa.interpolate(n,0,s)}},Gn.pushNotification=function(e,t,n,i,r){null==r&&(r=2),null==i&&(i=0),null==n&&(n="");var a=new Nn;a.primary_text=t,a.secondary_text=n,a.wait_before_phase_in_time=i,a.wait_time=r,e.show_cue.push(a)},Gn.setTutorial=function(e,t){var n=e.js_info.desktop,i=e.tutorial_menu;i.current_time=0,i.phase_in_current_time=0,i.state,(i.state=t)!=Bn.TutorialNone?(null==i.container.parent&&e.menu_container.add(i.container),t!=Bn.TutorialPhaseOut?(i.container.alpha=1,i.white_circle.visible=!1,i.text.visible=!1,i.keyboard_controls.visible=!1,i.wheel.visible=!1,i.finger.visible=!1,i.jump_button.visible=!1,i.nitro_button.visible=!1,i.power_button.visible=!1,t==Bn.TutorialControls?n?i.keyboard_controls.visible=!0:(i.text.text="Drag wheel to control the car",i.text.visible=!0,i.wheel.visible=!0,i.finger.visible=!0):t==Bn.TutorialJump?(i.white_circle.visible=!0,i.text.visible=!0,i.jump_button.visible=!0,i.text.text=n?"Click here or press SPACE to jump":"Touch here to jump"):t==Bn.TutorialNitro?(i.white_circle.visible=!0,i.text.visible=!0,i.nitro_button.visible=!0,i.text.text=n?"Click here or press SHIFT to use nitro boost":"Touch here to use nitro boost"):t==Bn.TutorialPower&&(i.white_circle.visible=!0,i.text.visible=!0,i.power_button.visible=!0,i.text.text=n?"Click here or press ENTER to use power":"Touch here to use power")):i.current_time=0):null!=i.container.parent&&i.container.parent.removeChild(i.container)},Gn.animateTutorialWhiteCircle=function(e,t,n){t.current_time+=e.step.step_size,t.current_time>Ln.white_circle_time&&(t.current_time-=Ln.white_circle_time);var i=pa.clamp0to1(t.current_time/Ln.white_circle_time),r=n.width+30,a=n.width+60,s=ca.smoothForwardAndBackward(r,a,i);t.white_circle.position.x=n.position.x,t.white_circle.position.y=n.position.y,t.white_circle.width=s,t.white_circle.height=s},Gn.mirrorTransform=function(e,t){e.position.x=t.position.x,e.position.y=t.position.y,e.scale.x=t.scale.x,e.scale.y=t.scale.y,e.rotation=t.rotation},Gn.createAndAddGrass=function(e,t){if(null!=t.polygon){var n=Zs.retrieveAsset(t.polygon.texture.line_source_name);null==n&&(n=Os.zole);var i=.9*n.height,r=Math.PI/3;if(null!=t.body)for(var a=ja.createSpritesOnPolygon(t.polygon.points,n,r,i),s=0;s<a.length;){var l=a[s];++s,l.x+=t.position.x,l.y+=t.position.y,e.push(l)}}else xl.trace("warning: entity.polygon == null",{fileName:"GameDo.hx",lineNumber:3962,className:"bikas.game.GameDo",methodName:"createAndAddGrass"})},Gn.sortCarsByPosition=function(e,t){var n=e.main_body_position_x,i=t.main_body_position_x;return i<n?1:n<i?-1:0},Gn.sortCarsByInitialPositionX=function(e,t){return e.initial_main_body_position.get_x()>t.initial_main_body_position.get_x()?1:e.initial_main_body_position.get_x()<t.initial_main_body_position.get_x()?-1:0},Gn.calculateSpeedIncreaseBasedOnDistance=function(e,t,n,i,r,a){var s=e.main_body_position_x-t.main_body_position_x,l=pa.clamp(ca.getT(n,i,s),0,1);return ca.linear(r,a,l)},Gn.refreshCameraCenter=function(e,t,n,i,r){if(null==r&&(r=-1),null!=t){t.center.set_x(.5*n.current_game_width);var a=n.current_game_width/n.current_game_height,s=.3333333333333333,l=.3333333333333333,o=.5;if(e.level_type==Fn.InMainMenu&&(l=Fi.ratio_start,o=Fi.ratio_end),a<1.2){var _=ca.getT(1.2,.4618015963511973,a);_=pa.clamp(_,0,1),s=ca.linear(l,o,_),t.follow_position_offset.set_y(ca.smoothStart(0,760,_))}else s=l,t.follow_position_offset.set_y(0);e.camera_view_ratio=s,e.background_ratio=s,t.center.set_y(n.current_game_height*s),-1==r&&(r=e.camera.current_zoom),bt.init(e.camera,i,e.stage_group.position,r),bt.setCurrentPositionRelativeToTarget(e.camera,i,e.stage_group.position,e.stage_group.transform,0,e.camera.follow_position_offset.get_y()),e.current_camera_refresh_width_cache=n.current_game_width,e.current_camera_refresh_height_cache=n.current_game_height}},Gn.createFly=function(e){var t=25*Math.random(),n=Math.random()*Math.PI*2-Math.PI,i=e.x+Math.cos(n)*t,r=e.y+Math.sin(n)*t,a=E.create(new Yr(i,r),e,2,0,new la(.12,.18),new la(1.57,3.14),25),s=new dn;return s.fly=a,s.container=Ra.createGroup(),s.body=Ra.createSprite(Os.fly_no_wings,.5,.5),s.wings=Ra.createSprite(Os.fly_wings,.5,.5),s.wings.alpha=.5,s.container.add(s.body),s.container.add(s.wings),s},Gn.updateFly=function(e,t){E.update(e.fly,t),e.container.position.x=e.fly.position.x,e.container.position.y=e.fly.position.y,e.container.rotation=e.fly.angle+Math.PI/2},Gn.updateDisplayTransition=function(e,t,n,i,r){return null==r&&(r=.1),n&&null==t.parent&&(t.alpha=0,e.add(t)),null==t.parent||(n?(t.alpha=pa.clamp(t.alpha+i*r,0,1),1==t.alpha):(t.alpha=pa.clamp(t.alpha-i*r,0,1),0==t.alpha&&(e.remove(t),!0)))},Gn.updateMovingCircle=function(e,t){e.frame=k.getNextFrame(0,1,e.frame+.03*t);var n=ca.linearForwardAndBackward(e.min_scale,e.max_scale,e.frame);e.sprite.scale.set(n,n)},Gn.wait=function(e,t,n){return null==e.wait?(e.wait=new on(0,n),!1):(e.wait.current+=t,e.wait.current>=e.wait.max&&!(e.wait=null))},Gn.safeAdd=function(e,t){null==t.parent&&e.add(t)},Gn.safeRemove=function(e){null!=e.parent&&e.parent.removeChild(e)},Gn.spawnAttachment=function(e,t,n,i,r,a){if(null==a&&(a=-1),(null!=t||(xl.trace("warning: partition_top == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"spawnAttachment"}),0))&&(null!=n||(xl.trace("warning: entity_partition_container == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"spawnAttachment"}),0))){var s=d_.get(),l="";r==De.AttachmentBalloon?(s.set_x(pa.boundsMiddleX(i.bounds)),s.set_y(i.bounds.min_y),l="balloons"):r==De.AttachmentAnchor&&(null!=i.exhaust_position?(s.set_x(i.exhaust_position.get_x()+12),s.set_y(i.exhaust_position.get_y())):(s.set_x(i.bounds.min_x),s.set_y(pa.boundsMiddleY(i.bounds))),l="anchor");var o=i.main_body.localPointToWorld(s),_=Gn.spawnPrefabLink(e,t,n,l,o.get_x(),o.get_y());if(null!=_){var p=null;r==De.AttachmentBalloon?p=Oe.createBalloons(_,i.main_body,a):r==De.AttachmentAnchor&&(p=Oe.createAnchor(_,i.main_body,a)),Oe.setSpace(p,e.world.space),e.attachments.push(p),s.dispose(),o.dispose()}}},Gn.spawnPrefabLink=function(e,t,n,i,r,a){var s=e.stage_group,l=e.library_group,o=e.engine.engine_serial_data,_=ie.createDefaultEntity();_.position.x=r,_.position.y=a,_.prefab_link=new Q;for(var p=0,u=l.group.entities;p<u.length;){var h=u[p];if(++p,h.name==i){_.prefab_link.guid=h.guid,_.prefab_link.prefab_entity=h;break}}if(null==_.prefab_link.prefab_entity)return xl.trace("warning: couldn't find "+i+" prefab",{fileName:"GameDo.hx",lineNumber:4245,className:"bikas.game.GameDo",methodName:"spawnPrefabLink"}),null;s.group.entities.push(_),_.parent=s,ie.flatten(o,_),ie.flattenPolygonEntities(_);var c=null;if((c=function(e,t){if(null!=e.group)for(var n=0,i=e.group.entities;n<i.length;){var r=i[n];++n,c(r,t)}else e.container_link=t})(_,s.group.container),oe.addEntityIncludingChildren(_),!ie.createBodiesForEntities(_,e.all_body_entities,new Ki,new yi))return xl.trace("error: couldn't create bodies for "+i,{fileName:"GameDo.hx",lineNumber:4273,className:"bikas.game.GameDo",methodName:"spawnPrefabLink"}),null;if(!Gn.createObjectsBasedOnEntities(e,_,new Yo(!0)))return null;ie.setSpaceIncludingChildren(_,e.world.space);var d=null,m=[];(d=function(e,t){if(null!=t.group)for(var n=0,i=t.group.entities;n<i.length;){var r=i[n];++n,d(e,r)}null!=t.bitmap_images&&e.push(t)})(m,_);for(var f=0;f<m.length;){var g=m[f];++f,null!=g.display.sprite&&null!=g.display.sprite.parent&&g.display.sprite.parent.removeChild(g.display.sprite),null!=g.group?xl.trace("warning: can't add group here",{fileName:"GameDo.hx",lineNumber:4302,className:"bikas.game.GameDo",methodName:"spawnPrefabLink"}):Ea.insertNewObjectToLiveTree(t,n,g.display.sprite,!0)}return _},Gn.update=function(e,t){if(!Xs.paused&&(0==e.config.type&&Ni.isReleased(e.keyboard_keys_released,13)&&Ni.isPressed(e.keyboard_keys_pressed,17)&&Gn.hideGameAndOpenEditor(e),e.game_running)){e.pause_after_1_update&&(e.game_running=!1,e.pause_after_1_update=!1),(e.step=t).original_dc=t.delta/16.666666666666668,t.ui_dc=t.original_dc,t.dc=t.original_dc*e.temp_dc_coeff*e.delta_update_coeff_by_effect*e.debug_dc_coeff,e.temp_dc_coeff=1,t.dc<.1&&(t.dc=.1),t.step_size=.016666666666666666*t.dc,t.game_seconds+=t.step_size,ka.getTimer(),Xs.game,hn.step=t;var n=e.current_gameplay_music;if(null!=n){var i=!1;e.state==jn.InLevel&&null!=e.player&&(e.current_level_save==e.credits_save&&(e.race_countdown.engine_sound_allowed=!1),e.player.behavior_activated&&(i=!0,e.current_level_save==e.credits_save&&(n=Os.music_beach_waves))),i?ks.isMusicPlaying(n)||ks.fadeInMusic(n):ks.isMusicPlaying(n)&&ks.fadeOutMusic(n,.008333333333333333),ks.updateMusic(n,e.music_enabled)}if(0!=e.config.type||e.config.development.transitions_enabled){if(!Gn.updateTransitions(e,t,e.js_info))return}else Gn.updateStageAndLibraryReload(e,t);if(null==e.partition_top&&null!=e.stage_group){var r=!0;if(!e.use_cached_terrain_polygons)for(var a=0,s=e.terrain_polygons;a<s.length;){var l=s[a];if(++a,null!=l.terrain&&!l.terrain.finished){Ms.drawPortionOfTerrainRects(l.terrain,Rn.terrain_draw_count)&&Ms.finish(l.terrain,Rn.texture_offset_add),r=!1;break}}if(!r)return;e.use_cached_terrain_polygons||Gn.createSpritesForTerrainPolygons(e.terrain_polygons),Gn.createTreePartition(e)}if(null!=e.stage_group){if(e.state==jn.InLevel){var o=!0;e.level_type==Fn.InInterLevelMenu&&(e.inter_level_menu.state==gi.InRewardSelection&&(o=!1),null!=e.level_end&&e.level_end.state==vn.InAd&&(o=!1),null!=e.main_menu&&e.main_menu.in_ad&&(o=!1),null!=e.inter_level_menu&&e.inter_level_menu.in_ad&&(o=!1)),o&&Gn.isObjectClickedInRadius(e.pause_button,e.pointer,70)&&(ks.playSound(Os.sound_click,e.sounds_enabled),Gn.showPause(e,t))}if(e.state!=jn.InPause){if(e.level_type==Fn.InRacing)Gn.updateTutorial(e);else if(e.level_type==Fn.InMainMenu){if(Ri.update(e.main_menu,e.game_save,e.background,e.background_camera_offset,e.menu_camera_position,e.camera,e.partition_top,e.entity_partition_container,e.all_body_entities,e.menu_container,e.js_info,e.pointer,e.step,e.sounds_enabled,e.music_enabled),e.main_menu.trigger_game_type!=Li.None)if(e.main_menu.trigger_game_type==Li.ResumeGame)Gn.gotoNewLevel(e,t,e.inter_level_menu_save);else if(e.main_menu.trigger_game_type==Li.ContinueToFirstLevel)Gn.gotoNewLevel(e,t,e.first_level_save);else if(e.main_menu.trigger_game_type==Li.LoadGame){if(null!=e.main_menu.game_save||(xl.trace("warning: game.main_menu.game_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"update"}),0)){Gn.applyGameSave(e,e.main_menu.game_save);for(var _=null,p=0,u=e.game_save.level_saves;p<u.length;){var h=u[p];if(++p,h.description.name==e.game_save.current_level_name){_=h;break}}if(null==_&&(_=e.inter_level_menu_save),Gn.gotoNewLevel(e,t,_))return}}else if(e.main_menu.trigger_game_type==Li.StartNewGame&&(e.game_save=wr.createGameSave(e.level_descriptions),Gn.applyGameSave(e,e.game_save),Gn.gotoNewLevel(e,t,e.first_level_save)))return}else if(e.level_type==Fn.InInterLevelMenu&&(Gn.updateChallengesState(e.game_save,e.ongoing_powers_display,e.challenge_descs,e.notifications,t,e.inter_level_menu,e.camera),bi.update(e),e.inter_level_menu.trigger_game_save&&(e.inter_level_menu.trigger_game_save=!1,Gn.saveGameSaveToStorage(e.game_save_serial_data,e.game_save)),null!=e.inter_level_menu.level_map_next_level_save&&Gn.gotoNewLevel(e,t,e.inter_level_menu.level_map_next_level_save)))return;e.level_running&&null==e.tutorial_menu.container.parent&&Gn.updateLevel(e,t),Gn.updateDebugStuff(e,t)}else Gn.updatePause(e,e.pause_menu,e.pointer,t,e.js_info)}}},Gn.updateChallengesState=function(e,t,n,i,r,a,s){for(var l=0,o=0,_=e.level_saves;o<_.length;){var u=_[o];if(++o,u.description.type==vr.LevelRegular&&u.completed&&++l,u.description.type==vr.LevelChallenge&&u.completed)for(var h=0;h<n.length;){var c=n[h];if(++h,c.type==u.description.challenge_type){-1==e.challenges_completed.indexOf(c.id)&&e.challenges_completed.push(c.id);break}}}for(var d=0;d<n.length;){var m=n[d];++d,-1==e.challenges_unlocked.indexOf(m.id)&&(m.type==br.ChallengeEscapeFromWolf?4<=l&&e.challenges_unlocked.push(m.id):m.type==br.ChallengeMountainRush?8<=l&&e.challenges_unlocked.push(m.id):m.type==br.ChallengeBalancing?12<=l&&e.challenges_unlocked.push(m.id):m.type==br.ChallengeSurvival?16<=l&&e.challenges_unlocked.push(m.id):m.type==br.ChallengeBulletTaxi?20<=l&&e.challenges_unlocked.push(m.id):m.type==br.ChallengeHuntThePrey?24<=l&&e.challenges_unlocked.push(m.id):xl.trace("warning: unhandled "+p.string(m.type),{fileName:"GameDo.hx",lineNumber:4691,className:"bikas.game.GameDo",methodName:"updateChallengesState"}))}if(e.challenges_unlocked.length!=e.challenges_unlocked_shown.length)for(var f=0,g=e.challenges_unlocked;f<g.length;){var v=g[f];if(++f,-1==e.challenges_unlocked_shown.indexOf(v)){for(var b=null,y=0;y<n.length;){var x=n[y];if(++y,x.id==v){b=x;break}}null==b&&(xl.trace("warning: found_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),!0)||Gn.pushNotification(i,b.name+" Unlocked!"),e.challenges_unlocked_shown.push(v)}}var z=!1;if(null!=a.nearest_place&&"map"==a.nearest_place.marker.name&&pa.distance(a.nearest_place.marker.position.x,a.nearest_place.marker.position.y,s.current_pos.get_x(),s.current_pos.get_y())<5&&(z=!0),z&&e.challenges_unlocked.length!=e.challenges_unlocked_shown_on_map.length)for(var w=0,k=e.challenges_unlocked;w<k.length;){var S=k[w];if(++w,-1==e.challenges_unlocked_shown_on_map.indexOf(S)){for(var C=null,N=0;N<n.length;){var P=n[N];if(++N,P.id==S){C=P;break}}if(null!=C||(xl.trace("warning: found_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),0)){for(var M=null,I=0,A=a.level_map.levels;I<A.length;){var T=A[I];if(++I,T.challenge_desc==C){M=T;break}}null==M&&(xl.trace("warning: found_item == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),1)||(M.animate_in=!0,M.current_time=-ui.animate_in_wait_time)}e.challenges_unlocked_shown_on_map.push(S)}}if(z&&e.challenges_completed.length!=e.challenges_completed_claimed.length)for(var D=0,E=e.challenges_completed;D<E.length;){var O=E[D];if(++D,-1==e.challenges_completed_claimed.indexOf(O)){for(var B=null,L=0;L<n.length;){var j=n[L];if(++L,j.id==O){B=j;break}}if(null!=B||(xl.trace("warning: found_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),0)){for(var F=null,R=0,G=a.level_map.levels;R<G.length;){var Z=G[R];if(++R,Z.challenge_desc==B){F=Z;break}}null==F&&(xl.trace("warning: found_item == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateChallengesState"}),1)||(Gn.pushNotification(i,B.name+" Completed!"),wr.applyRewardItem(e,t,B.item,i))}e.challenges_completed_claimed.push(O)}}},Gn.updateStageAndLibraryReload=function(e,t){if(null!=Rn.load_stage_header){var n=Rn.load_stage_header,i=Rn.load_library_header;Rn.load_stage_header=null,Rn.load_library_header=null,Gn.loadEngineAndLevel(e,t,e.engine.engine_serial_data,n,i)}},Gn.updateTransitions=function(e,t,n){if(e.state==jn.InTransitionToLevelLoad||e.state==jn.InLevelLoad||e.state==jn.InTransitionToLevel){var i=e.level_load_screen;i.background.x=-5,i.background.y=-5,i.background.width=n.current_game_width+10,i.background.height=n.current_game_height+10,i.middle_container.position.x=0,i.middle_container.position.y=0,i.title.position.x=n.current_game_width/2,i.title.position.y=n.current_game_height/2,i.loading_track_text.position.x=n.current_game_width/2,i.loading_track_text.position.y=n.current_game_height-60-Os.track_loader_text.height,i.loader_background.position.x=n.current_game_width/2-Os.track_loader_background.width/2,i.loader_foreground.position.x=n.current_game_width/2-Os.track_loader_foreground.width/2,i.loader_background.position.y=n.current_game_height-60,i.loader_foreground.position.y=n.current_game_height-60}if(e.state==jn.InTransitionToLevelLoad){if(!Gn.updateTransitionToLevelLoad(e,t))return!1}else if(e.state==jn.InLevelLoad){if(!Gn.updateLevelLoad(e,t))return!1;e.level_load_screen.transition_current_time=0}else if(e.state==jn.InTransitionToLevel&&!Gn.updateTransitionToLevel(e,t))return!1;return!0},Gn.updateTransitionToLevelLoad=function(e,t){var n=e.level_load_screen;null==n.container.parent&&(e.menu_container.add(n.container),n.transition_current_time=0,e.previous_state==jn.InGameLoad?(n.container.alpha=1,n.middle_container.alpha=0,n.middle_container.alpha=1,n.transition_current_time=gn.transition_time):e.previous_state==jn.InLevel?(n.container.alpha=0,n.middle_container.alpha=1):xl.trace("warning: unhandled state: "+p.string(e.previous_state),{fileName:"GameDo.hx",lineNumber:4900,className:"bikas.game.GameDo",methodName:"updateTransitionToLevelLoad"}),n.loader_foreground.scale.x=.25),n.transition_current_time>gn.transition_time&&(n.transition_current_time=gn.transition_time,e.previous_state==jn.InGameLoad?Gn.updateStageAndLibraryReload(e,t):e.previous_state==jn.InLevel&&(null!=e.pause_menu.container.parent&&e.pause_menu.container.parent.removeChild(e.pause_menu.container),null==e.next_level_save||e.current_level_save==e.next_level_save?Gn.reloadLevel(e,t):Gn.loadNewLevel(e,t,e.next_level_save)),Gn.setGameState(e,jn.InLevelLoad)),n.transition_current_time+=t.ui_dc;var i=ca.linearClamped(0,1,n.transition_current_time/gn.transition_time);return e.previous_state==jn.InGameLoad?n.middle_container.alpha=i:e.previous_state==jn.InLevel&&(n.container.alpha=i),!1},Gn.updateLevelLoad=function(e,t){e.js_info;for(var n=!0,i=0,r=0,a=0,s=e.terrain_polygons;a<s.length;){var l=s[a];if(++a,null!=l.terrain&&!l.terrain.finished){Ms.drawPortionOfTerrainRects(l.terrain,Rn.terrain_draw_count)&&Ms.finish(l.terrain,Rn.texture_offset_add),n=!1;break}}for(var o=0,_=e.terrain_polygons;o<_.length;){var p=_[o];++o,null!=p.terrain&&(i+=Ms.getCutCount(p.terrain),r+=p.terrain.current_drawn_rect_count)}var u=!0;if(e.pre_simulate_world_steps_current<Rn.pre_simulate_world_steps){var h=!1;if(u=0==e.config.type&&!e.config.development.loader_enabled&&(h=!0),h){for(var c=0,d=e.pre_simulate_world_steps_current;c<d;)c++,e.world.space.step(.016666666666666666,10,10);e.pre_simulate_world_steps_current=Rn.pre_simulate_world_steps}else if(n)if(e.js_info.desktop)for(var m=0;m<4;)m++,e.pre_simulate_world_steps_current++,e.world.space.step(.016666666666666666,10,10);else e.pre_simulate_world_steps_current++,e.world.space.step(.016666666666666666,10,10)}var f=!0;if(e.pre_wait_steps_current<Rn.pre_wait_steps&&(f=!1,u&&e.pre_wait_steps_current++,f=0==e.config.type&&!e.config.development.loader_enabled&&(e.pre_wait_steps_current=Rn.pre_wait_steps,!0)),n&&u&&f){if(null==e.partition_top)return ka.getTimer(),e.use_cached_terrain_polygons||Gn.createSpritesForTerrainPolygons(e.terrain_polygons),Gn.createTreePartition(e),Gn.updateLevel(e,t),Gn.setGameState(e,jn.InTransitionToLevel),e.pre_simulate_world_steps_current=0,!(e.pre_wait_steps_current=0)}else{var g=4,v=1,b=1,y=2+g+v+b;0<i&&(g*=pa.clamp0to1(r/i)),0<Rn.pre_simulate_world_steps&&(v*=pa.clamp0to1(e.pre_simulate_world_steps_current/Rn.pre_simulate_world_steps)),0<Rn.pre_wait_steps&&(b*=pa.clamp0to1(e.pre_wait_steps_current/Rn.pre_wait_steps));var x=(2+g+v+b)/y,z=e.level_load_screen;z.loader_foreground.scale.x=x,z.transition_current_time=0}return!1},Gn.updateTransitionToLevel=function(e,t){var n=e.level_load_screen;n.transition_current_time+=t.ui_dc,n.transition_current_time>gn.transition_time&&(n.transition_current_time=gn.transition_time,null!=n.container.parent&&n.container.parent.removeChild(n.container),Gn.setGameState(e,jn.InLevel));var i=n.transition_current_time/gn.transition_time;return n.container.alpha=1-i,!1},Gn.updatePause=function(e,t,n,i,r){if(t.background.x=-5,t.background.y=-5,t.background.width=r.current_game_width+10,t.background.height=r.current_game_height+10,t.button_main_menu.x=r.current_game_width/2-157.5,t.button_main_menu.y=r.current_game_height/2,t.button_restart.x=r.current_game_width/2,t.button_restart.y=r.current_game_height/2,t.button_play.x=r.current_game_width/2+157.5,t.button_play.y=r.current_game_height/2,t.button_garage.visible=!1,t.button_music.x=r.current_game_width-90*2.7,t.button_music.y=90,t.button_sounds.x=r.current_game_width-90,t.button_sounds.y=90,null==t.container.parent)e.menu_container.add(t.container);else{if(null!=t.confirm_card){t.confirm_card.container.x=e.js_info.current_game_width/2-t.confirm_card.container.width/2,t.confirm_card.container.y=e.js_info.current_game_height/2-t.confirm_card.container.height/2;var a=bi.processCardClick(n,e.sounds_enabled,t.confirm_card.container,t.confirm_card.button_close,t.confirm_card.button_main);return void(a==di.DownedCloseButton||a==di.DownedOutside?(bi.destroyConfirmationCard(t.confirm_card),t.confirm_card=null):a==di.DownedMainButton&&(bi.destroyConfirmationCard(t.confirm_card),t.confirm_card=null,t.confirm_type==Dn.GotoMainMenu?Gn.gotoNewLevel(e,i,e.main_menu_save):t.confirm_type==Dn.GotoGarage?Gn.gotoNewLevel(e,i,e.inter_level_menu_save):xl.trace("warning: unhandled type "+p.string(t.confirm_type),{fileName:"GameDo.hx",lineNumber:5157,className:"bikas.game.GameDo",methodName:"updatePause"}),ks.playSound(Os.sound_click,e.sounds_enabled)))}if(Gn.isObjectClickedInRadius(e.pause_button,n,70)){for(var s=0,l=n.pointer_objects;s<l.length;){var o=l[s];++s,o.cancel_upped_and_clicked=!0}e.menu_container.remove(t.container),Gn.setGameState(e,jn.InLevel),1==e.config.type&&3==e.config.release.sitelock_type&&e.level_type==Fn.InRacing&&Ya.PokiSDK.gameplayStart(),ks.playSound(Os.sound_click,e.sounds_enabled)}else if(Gn.isObjectDownedInRadius(t.button_play,n,80)){for(var _=0,u=n.pointer_objects;_<u.length;){var h=u[_];++_,h.cancel_upped_and_clicked=!0}e.menu_container.remove(t.container),Gn.setGameState(e,jn.InLevel),1==e.config.type&&3==e.config.release.sitelock_type&&e.level_type==Fn.InRacing&&Ya.PokiSDK.gameplayStart(),ks.playSound(Os.sound_click,e.sounds_enabled)}else if(Gn.isObjectDownedInRadius(t.button_restart,n,80)){for(var c=0,d=n.pointer_objects;c<d.length;){var m=d[c];++c,m.cancel_upped_and_clicked=!0}0!=e.config.type||e.config.development.transitions_enabled?(e.next_level_save=e.current_level_save,Gn.setGameState(e,jn.InLevel),Gn.setGameState(e,jn.InTransitionToLevelLoad)):(e.menu_container.remove(t.container),Gn.setGameState(e,jn.InLevel),Gn.reloadLevel(e,i)),ks.playSound(Os.sound_click,e.sounds_enabled)}else if(Gn.isObjectDownedInRadius(t.button_main_menu,n,80)){var f="";e.current_level_save.description.type==vr.LevelRegular?f="Quit Level and\ngo to Main Menu?":e.current_level_save.description.type==vr.LevelChallenge?f="Quit Challenge and\ngo to Main Menu?":e.current_level_save.description.type==vr.LevelInterLevelMenu?f="Go to Main Menu?":e.current_level_save.description.type==vr.LevelMainMenu?f="":xl.trace("warning: unhandled "+p.string(e.current_level_save.description.type),{fileName:"GameDo.hx",lineNumber:5239,className:"bikas.game.GameDo",methodName:"updatePause"}),""!=f?(t.confirm_card=bi.createConfirmationCard("button_go",f),e.menu_container.add(t.confirm_card.container),t.confirm_type=Dn.GotoMainMenu):e.current_level_save==e.main_menu_save?Gn.gotoRestartLevel(e,i):(xl.trace("warning: game.current_level_save != game.main_menu_save",{fileName:"GameDo.hx",lineNumber:5249,className:"bikas.game.GameDo",methodName:"updatePause"}),Gn.gotoNewLevel(e,i,e.main_menu_save)),ks.playSound(Os.sound_click,e.sounds_enabled)}else Gn.isObjectDownedInRadius(t.button_garage,n,80)||(Gn.isObjectDownedInRadius(t.button_music,n,80)?(e.music_enabled=!e.music_enabled,e.music_enabled?t.button_music.setTexture(Os.button_music_on):t.button_music.setTexture(Os.button_music_off)):Gn.isObjectDownedInRadius(t.button_sounds,n,80)&&(e.sounds_enabled=!e.sounds_enabled,e.sounds_enabled?t.button_sounds.setTexture(Os.button_sounds_on):t.button_sounds.setTexture(Os.button_sounds_off)));for(var g=0,v=t.pause_debug_options;g<v.length;){var b=v[g];if(++g,Gn.isBitmapTextDownedInBounds(b.bitmap_text,n,10)){b.callback(b);break}}null!=t.confirm_card&&(t.confirm_card.container.x=r.current_game_width/2-t.confirm_card.container.width/2,t.confirm_card.container.y=r.current_game_height/2-t.confirm_card.container.height/2)}},Gn.updateLevel=function(e,t){var n=e.js_info,i=e.pointer,r=t.dc;t.level_seconds+=t.step_size,e.race_seconds=t.level_seconds-e.race_start_at_second,Ie.update(t);var a=1==e.config.type||0==e.config.type&&e.config.development.bots_enabled;if(e.ability_item_container.x=n.current_game_width-106,e.ability_item_container.y=n.current_game_height-400,null!=e.wheel&&null!=e.player&&qr.update(e.wheel,n,e.player.car,e.player.config,i,t,e.keyboard_keys_pressed,e.player.behavior_activated,e.player.finished_race),Gn.updateCarBaggage(e.all_cars,r),null!=e.player){if(lr.update(e.player,e.all_cars,t,n,i,e.keyboard_keys_pressed,e.race_countdown.engine_sound_allowed,e.use_bot_to_control_player,e.sounds_enabled),e.player.jump_button.container.x=105,e.player.jump_button.container.y=e.wheel.sprite.y,a)for(var s=0,l=e.bots;s<l.length;){var o=l[s];++s,gt.update(o,e.player,e.all_cars,e.config,e.jump_over_bodies,e.pickable_items,t,e.partition_top,e.entity_partition_container,e.world.space,e.explosives,e.sounds_enabled)}e.use_bot_to_control_player&&gt.update(e.player_bot,e.player,e.all_cars,e.config,e.jump_over_bodies,e.pickable_items,t,e.partition_top,e.entity_partition_container,e.world.space,e.explosives,e.sounds_enabled)}if(null!=e.player&&Gn.updateExplosives(e),null!=e.player){for(var _=0,u=e.boxes;_<u.length;){var h=u[_];++_,Ji.updateBox(h,e.partition_top,e.all_body_entities,e.camera_shake,e.player.car,e.all_cars,e.world.space,t,e.config,e.sounds_enabled)}for(var c=!1,d=0,m=e.forward_ramps;d<m.length;){var f=m[d];++d,Ji.updateForwardRamp(f,r,e.player,e.all_cars)&&(c=!0)}c?ks.isMusicPlaying(Os.sound_loop_acceleration_boost)||ks.fadeInMusic(Os.sound_loop_acceleration_boost,.1):ks.isMusicPlaying(Os.sound_loop_acceleration_boost)&&ks.fadeOutMusic(Os.sound_loop_acceleration_boost,.03333333333333333),ks.updateMusic(Os.sound_loop_acceleration_boost,e.sounds_enabled);for(var g=0,v=e.temp_interactive_objects;g<v.length;){var b=v[g];++g,Ji.updateTempInteractiveObject(b,e.all_body_entities,e.partition_top,e.entity_partition_container,e.player.car,e.explosives,t,e.config)}for(var y=0,x=e.pickable_items;y<x.length;){var z=x[y];++y,Ci.updatePickableItem(z,e,e.world.space,t.dc,t.level_seconds,e.sounds_enabled)}be.updateAbilityItem(e.player,i,e.js_info,e.partition_top,e.entity_partition_container,e.world.space,e.explosives,r,e.sounds_enabled)}for(var w=0,k=e.attachments;w<k.length;){var S=k[w];++w,Oe.update(S,t.step_size,t.dc)}null!=e.stunt&&null!=e.player&&Ur.update(n.current_game_width,n.current_game_height,t,e.stunt,e.player.car,e.player.config,e.player.cache,e.current_level_save.description.max_stunt_score,e.player.finished_race,e.coin_display.digit_count,e.sounds_enabled),null!=e.game_save.ongoing_powers&&Fr.updateOngoingPowersDisplay(e.ongoing_powers_container,e.ongoing_powers_display,e.camera_shake,n,i,e.step,e.sounds_enabled),Gn.updateAchievements(e,t),Gn.updateNotifications(e,n,t,e.notifications,e.sounds_enabled);for(var C=0;C<e.chickens.length;){var N=e.chickens[C];150<N.body.get_velocity().get_length()&&(e.looped_animations.push(N.anim),e.chickens.splice(C,1),--C),++C}for(var P=0,M=e.looped_animations;P<M.length;){var I=M[P];++P,T.nextFrameStep(I,r)}if(e.physics_running){Gn.updatePhysics(e.world.space,r);for(var A=0,D=e.all_cars;A<D.length;){var E=D[A];++A,Tt.update(E)}}for(var O=0,B=e.all_body_entities;O<B.length;){var L=B[O];++O,ce.refresh(L)}for(var j=0,F=e.connected_containers;j<F.length;){var R=F[j];++j,Xt.updateConnectedContainers(R)}if(null!=e.player){if(a)for(var G=0,Z=e.bots;G<Z.length;){var U=Z[G];++G,Me.updateConstantPowerAbilities(e.partition_top,e.entity_partition_container,U.abilities,U.car,U.config,U.cache,e.all_cars,t)}if(e.use_bot_to_control_player){var V=e.player_bot;null!=V&&Me.updateConstantPowerAbilities(e.partition_top,e.entity_partition_container,V.abilities,V.car,V.config,V.cache,e.all_cars,t)}else{var q=e.player;Me.updateConstantPowerAbilities(e.partition_top,e.entity_partition_container,q.abilities,q.car,q.config,q.cache,e.all_cars,t),q.abilities.nitro_power.activated?ks.isMusicPlaying(Os.sound_loop_nitro_use)||ks.fadeInMusic(Os.sound_loop_nitro_use,.1):ks.isMusicPlaying(Os.sound_loop_nitro_use)&&ks.fadeOutMusic(Os.sound_loop_nitro_use,.2),ks.updateMusic(Os.sound_loop_nitro_use,e.sounds_enabled)}}if(e.all_cars.sort(Gn.sortCarsByPosition),null!=e.player&&!Gn.updateChallenges(e,n,t))return!1;if(null!=e.player){if(Gn.updateLevelEnd(e,t,e.sounds_enabled),e.level_end.state==vn.InAd)return!1;if(e.level_end.state==vn.InNext){if(e.level_end.next_state==bn.NextInterLevelMenu){if(Gn.saveGameSaveToStorage(e.game_save_serial_data,e.game_save),Gn.gotoNewLevel(e,t,e.inter_level_menu_save))return!1}else if(e.level_end.next_state==bn.NextRestartLevel){if(Gn.gotoRestartLevel(e,t))return!1}else if(e.level_end.next_state==bn.NextCreditsLevel){if(Gn.saveGameSaveToStorage(e.game_save_serial_data,e.game_save),Gn.gotoNewLevel(e,t,e.credits_save))return!(e.game_save.credits_shown=!0)}else e.level_end.next_state!=bn.None&&xl.trace("warning: unhandled state "+p.string(e.level_end.next_state),{fileName:"GameDo.hx",lineNumber:5648,className:"bikas.game.GameDo",methodName:"updateLevel"});e.level_end.next_state=bn.None}}return Gn.updateCamera(e,t),Gn.updateGameVisibleBounds(e),Gn.updatePolygonDraw(e),null!=e.race_countdown&&(e.race_countdown.finished||Gn.updateCountdownAnimation(e,t,e.sounds_enabled)),null!=e.current_place&&Gn.updateCurrentPlace(e),Gn.updateBackground(e,r),null!=e.partition_top&&Ea.update(e.partition_top,e.visible_bounds),null!=e.player&&null!=e.partition_top&&null!=e.entity_partition_container&&e.player.behavior_activated&&Gn.updateCarModifiers(e,e.partition_top,e.entity_partition_container),null!=e.slow_down_time&&Gn.updateSlowDownEffect(e,t),null!=e.coin_display&&Gn.updateCoinDisplay(t,e.js_info,e.coin_display,e.game_save,e.collected_in_level),!0},Gn.updateExplosives=function(e){for(var t=0,n=null;t<e.explosives.length;){var i=e.explosives[t];if(Me.updateExplosive(i,e.partition_top,e.step),0<i.explosion_events_buffer.length){null==n&&(n=[]);for(var r=0,a=i.explosion_events_buffer;r<a.length;){var s=a[r];++r,n.push(s)}i.explosion_events_buffer=[]}i.state==Se.ExplosionExploded?(Gn.applyCameraShake(e.camera_shake,10,40,e.player.car,i.cbody.body.get_position()),Un.playSoundInGameLevel(Os.sound_explosion,e.sounds_enabled,i.cbody.body.get_position(),e.player.car,1600,1)):i.state==Se.Done&&(Me.destroyExplosive(i,e.partition_top),e.explosives.splice(t,1),--t),++t}if(null!=n)for(var l=0;l<n.length;){var o=n[l];++l,Gn.updateExplosionEvent(o,e.player,e.bots,e.ongoing_powers_display)}},Gn.updatePhysics=function(e,t){var n=ka.getTimer();hn.total_space_steps=0,t*=Rn.physics_dc_coeff,e.step(.016666666666666666*t,Rn.physics_velocity_iterations,Rn.physics_position_iterations),hn.physics_update_time=Math.round(10*(ka.getTimer()-n))/10},Gn.updateChallenges=function(e,t,n){var i=n,r=t;if(Vt.updateChallengesCommonStuff(e.challenges,i),null!=e.challenges.escape_from_wolf)Vt.updateEscapeFromWolfChallenge(e.challenges.escape_from_wolf,i,e.stage_group,e.level_end,e.player,e.challenges.current_explosion_animations,e.player_bot,e.sounds_enabled);else if(null!=e.challenges.mountain_rush)Vt.updateMountainRushChallenge(e.challenges.mountain_rush,r,i,e.stunt,e.ingame_container,e.level_end,e.player,e.player_bot,e.race_countdown.finished);else if(null!=e.challenges.survival)Vt.updateSurvivalChallenge(e.challenges.survival,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot,e.race_countdown.finished,e.challenges.current_explosion_animations,e.sounds_enabled);else if(null!=e.challenges.balancing)Vt.updateBalancingChallenge(e.challenges.balancing,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot);else if(null!=e.challenges.bullet_taxi)Vt.updateBulletTaxiChallenge(e.challenges.bullet_taxi,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot);else if(null!=e.challenges.achievement)Vt.updateAchievementChallenge(e.challenges.achievement,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot);else if(null!=e.challenges.credits)return Vt.updateCreditsChallenge(e.challenges.credits,e,r,i,e.stage_group,e.ingame_container,e.level_end,e.player,e.player_bot);return!0},Gn.updateCoinDisplay=function(e,t,n,i,r){n.coin.position.x=t.current_game_width-n.coin.width/2-5,n.text.position.x=n.coin.position.x-25;var a=i.coins;if(null!=r&&(a+=r.coins),n.displayed_amount!=a&&(n.current_anim_time>=kn.anim_time&&(n.current_anim_time=0),n.displayed_amount=a,n.text.text=n.displayed_amount+"",n.digit_count=n.text.text.length),n.current_anim_time<kn.anim_time){n.current_anim_time+=e.step_size;var s=pa.clamp0to1(n.current_anim_time/kn.anim_time),l=ca.smoothForwardAndBackward(1,kn.anim_scale,s);n.coin.scale.x=l,n.coin.scale.y=l,n.text.scale.x=l,n.text.scale.y=l}},Gn.updateExplosionEvent=function(e,t,n,i){var r=e.space.bodiesInCircle(e.explosion_center,e.explosion_radius,e.body_containment),a=1;if(a+=e.power_add_coeff,e.source_car==t.car)for(var l=0,o=i.current_items;l<o.length;){var _=o[l];++l,_.desc.type==kr.ConstantBombAndDynamitePower&&(a+=_.generated_amounts[0]/100,i.just_used_items.push(_))}for(var p=i.current_items.slice(),u=r.iterator();u.hasNext();){var h=u.next();if(!h.isStatic()){var c=1;if(-1!=t.car.all_bodies.indexOf(h)){c-=t.config.armor_coeff,t.abilities.shield_power.activated&&(c=0);for(var d=0;d<p.length;){var m=p[d];++d;var f=m.desc.type;f==kr.ConstantAllExplosivesImmunity||f==kr.OneTimeAllExplosivesImmunity?(c-=m.generated_amounts[0]/100,f==kr.OneTimeAllExplosivesImmunity?s.remove(i.current_items,m):i.just_used_items.push(m)):f==kr.ConstantExplosiveBarrelImmunity||f==kr.OneTimeExplosiveBarrelImmunity?e.type==ke.Barrel&&(c-=m.generated_amounts[0]/100,f==kr.OneTimeExplosiveBarrelImmunity?s.remove(i.current_items,m):i.just_used_items.push(m)):f!=kr.ConstantBombAndDynamiteImmunity&&f!=kr.OneTimeBombAndDynamiteImmunity||e.type!=ke.Bomb&&e.type!=ke.Dynamite||(c-=m.generated_amounts[0]/100,f==kr.OneTimeBombAndDynamiteImmunity?s.remove(i.current_items,m):i.just_used_items.push(m))}}else for(var g=0;g<n.length;){var v=n[g];++g,-1!=v.car.all_bodies.indexOf(h)&&(c-=v.config.armor_coeff,v.abilities.shield_power.activated&&(c=0))}var b=a*(c=pa.clamp0to1(c));if(!(b<=0)){var y=h.get_position().sub(e.explosion_center),x=y.get_length();y.dispose();var z=pa.clamp0to1(1-x/(2*e.explosion_radius)),w=ca.getTClamped(0,1,b),k=ca.linear(1,e.one_time_velocity_friction,w*z);k<0&&1<k&&(xl.trace("warning: friction can't be: "+k,{fileName:"GameDo.hx",lineNumber:6039,className:"bikas.game.GameDo",methodName:"updateExplosionEvent"}),k=pa.clamp0to1(k)),h.get_velocity().muleq(k);var S=ca.linear(e.min_impulse,e.max_impulse,z),C=d_.get(0,-S*h.get_mass());C.muleq(b),h.applyImpulse(C);var N=ca.linear(2,10,z)*h.get_inertia(),P=pa.getRandomSign();N*=b,h.applyAngularImpulse(N*P),h.isStatic()&&(h.get_userData().just_applied_impulse_length=C.get_length()),h.get_userData().just_exploded=!0,h.get_userData().last_explosion_t=z,h.get_userData().last_final_explosion_modifier=b,C.dispose()}}}},Gn.updateCarBaggage=function(e,t){for(var n=0;n<e.length;){var i=e[n];++n;for(var r=0,a=i.baggages;r<a.length;){var s=a[r];if(++r,s.interactive)if(s.timeout)s.current_time-=t,s.current_time<=0&&(s.interactive=!1,s.body.setShapeFilters(zi.only_to_ground));else{var l=pa.distance(i.main_body_position_x,i.main_body_position_y,s.body.get_position().get_x(),s.body.get_position().get_y());50<Math.abs(s.initial_distance_from_main_body-l)&&(s.timeout=!0)}}}},Gn.updateCountdownAnimation=function(e,t,n){var i=t.dc,r=e.race_countdown;if(null!=r.challenge_text&&(null==r.challenge_text.parent&&e.ingame_container.add(r.challenge_text),r.challenge_text.position.x=e.js_info.current_game_width/2,r.challenge_text.position.y=.4*e.js_info.current_game_height),r.container.x=e.js_info.current_game_width/2,r.container.y=.2*e.js_info.current_game_height,r.current_time<=0)if(r.current_time=wn.time_per_count+wn.time_per_wait,5==r.current_number)e.camera.additional_offset.set_y(wn.camera_additional_offset),e.ingame_container.add(r.container),T.gotoFrame(r.animation,0),r.current_number=4,ks.playSound(Os.sound_countdown_number,n);else if(4==r.current_number)T.gotoFrame(r.animation,1),r.current_number=3,r.engine_sound_allowed=!0,ks.playSound(Os.sound_countdown_number,n);else if(3==r.current_number)T.gotoFrame(r.animation,2),r.current_number=2,ks.playSound(Os.sound_countdown_number,n);else if(2==r.current_number)Gn.startRace(e,t),T.gotoFrame(r.animation,3),r.current_number=1,ks.playSound(Os.sound_countdown_go,n);else if(1==r.current_number)r.engine_sound_allowed=!0,r.current_number=0;else if(0==r.current_number)return r.engine_sound_allowed=!0,e.ingame_container.remove(r.container),null!=r.challenge_text&&(Gn.safeRemove(r.challenge_text),r.challenge_text.destroy(!0),r.challenge_text=null),void(r.finished=!0);if(r.current_number<=5&&1<=r.current_number){var a=1-(r.current_time-wn.time_per_wait)/wn.time_per_count;1<a&&(a=1);var s=ca.smoothStart(2.3,1,a),l=ca.smoothStart(0,1,a);r.container.scale.x=s,r.container.scale.y=s,r.container.alpha=l;var o=e.camera.additional_offset;o.set_y(o.get_y()+wn.camera_additional_offset_step*i),0<e.camera.additional_offset.get_y()&&e.camera.additional_offset.set_y(0),e.camera.additional_offset.set_y(0)}else if(0==r.current_number){e.camera.additional_offset.set_y(0);var _=1-(r.current_time-wn.time_per_wait)/wn.time_per_count;1<_&&(_=1),e.camera.additional_offset.set_y(0);var p=ca.smoothStart(1,0,_);r.container.alpha=p}r.current_time-=i},Gn.updateCurrentPlace=function(e){var t=e.current_place.player_position;if(t.x=e.player.car.main_body_position_x,t.y=e.player.car.main_body_position_y,Ra.toGlobal(e.stage_group.group.container,t),Ra.toLocal(e.ingame_container,t),e.current_place.container.x=t.x,e.current_place.container.y=t.y+e.player.car.distance_from_main_body_to_top_y-78,!e.player.finished_race){var n=e.all_cars.length-e.all_cars.indexOf(e.player.car);if(e.current_place.place_number!=n){var i=(e.current_place.place_number=n)-1;T.gotoFrame(e.current_place.anim,i)}}},Gn.updateTutorial=function(e){var t=e.tutorial_menu,n=e.js_info.desktop;if(t.state==Bn.TutorialNone&&null!=t.controls_marker&&null!=t.jump_marker&&null!=e.player&&"level_1"==e.game_save.current_level_name&&(t.state==Bn.TutorialNone&&(e.game_save.tutorial_shown_controls||e.player.car.main_body.get_position().get_x()>t.controls_marker.position.x&&(Gn.setTutorial(e,Bn.TutorialControls),e.game_save.tutorial_shown_controls=!0)),t.state==Bn.TutorialNone&&(e.game_save.tutorial_shown_jump||e.player.car.main_body.get_position().get_x()>t.jump_marker.position.x&&Me.isAbleToJump(e.player.cache)&&Me.isAllowedToJump(e.player.abilities.jump_power,e.step.level_seconds)&&(Gn.setTutorial(e,Bn.TutorialJump),e.game_save.tutorial_shown_jump=!0)),t.state==Bn.TutorialNone&&(e.game_save.tutorial_shown_nitro||0<e.player.abilities.nitro_power_charge&&(Gn.setTutorial(e,Bn.TutorialNitro),e.game_save.tutorial_shown_nitro=!0)),t.state==Bn.TutorialNone&&(e.game_save.tutorial_shown_power||e.player.abilities.current_ability!=ge.None&&e.player.ability_button.state==fe.ButtonMode&&(Gn.setTutorial(e,Bn.TutorialPower),e.game_save.tutorial_shown_power=!0))),null!=t.container.parent)if(t.background.width=e.js_info.current_game_width,t.background.height=e.js_info.current_game_height,t.state!=Bn.TutorialPhaseOut){if(t.phase_in_current_time+=e.step.step_size,t.container.alpha=ca.linearClamped(0,1,t.phase_in_current_time/Ln.phase_in_time),t.state==Bn.TutorialControls)if(n){if(t.keyboard_controls.position.x=e.js_info.current_game_width/2,t.keyboard_controls.position.y=e.js_info.current_game_height/2,Ha.isAnyDowned(e.pointer))return void Gn.setTutorial(e,Bn.TutorialPhaseOut);if(Ni.isAnyPressed(e.keyboard_keys_pressed,[65,68,37,39]))return void Gn.setTutorial(e,Bn.TutorialPhaseOut)}else{if(qr.update(e.wheel,e.js_info,e.player.car,e.player.config,e.pointer,e.step,e.keyboard_keys_pressed,e.player.behavior_activated,e.player.finished_race),null!=e.wheel.downed)return void Gn.setTutorial(e,Bn.TutorialNone);Gn.mirrorTransform(t.wheel,e.wheel.sprite),t.wheel_anim_current_time+=e.step.step_size;var i=pa.clamp0to1(t.wheel_anim_current_time/Ln.wheel_anim_time);t.wheel_angle=ca.smoothForwardAndBackward(Ln.wheel_anim_angle_start,Ln.wheel_anim_angle_end,i),t.wheel_angle*=.017453292519943,1==i&&(t.wheel_anim_current_time=0);var r=t.wheel.width/2;t.wheel.rotation=t.wheel_angle,t.finger.position.x=t.wheel.x+Math.cos(t.wheel_angle)*r,t.finger.position.y=t.wheel.y+Math.sin(t.wheel_angle)*r,t.text.position.x=t.wheel.x-t.text.width,t.text.position.y=t.wheel.y-t.wheel.height/2-t.text.height-20}else if(t.state==Bn.TutorialJump){if(Gn.mirrorTransform(t.jump_button,e.player.jump_button.container),t.text.position.x=t.jump_button.position.x-t.jump_button.width/2,t.text.position.y=t.jump_button.position.y-150,Gn.animateTutorialWhiteCircle(e,t,t.jump_button),Ha.isDowned(e.player.jump_button.container.x,e.player.jump_button.container.y,e.pointer,ir.radius))return void Gn.setTutorial(e,Bn.TutorialNone);if(Ni.isAnyPressed(e.keyboard_keys_pressed,tr.keys_jump))return void Gn.setTutorial(e,Bn.TutorialNone)}else if(t.state==Bn.TutorialNitro){if(Gn.mirrorTransform(t.nitro_button,e.player.nitro_button.container),t.text.position.x=t.nitro_button.position.x-t.nitro_button.width/2,t.text.position.y=t.nitro_button.position.y-150,Gn.animateTutorialWhiteCircle(e,t,t.nitro_button),Ha.isDowned(e.player.nitro_button.container.x,e.player.nitro_button.container.y,e.pointer,ar.radius))return void Gn.setTutorial(e,Bn.TutorialNone);if(Ni.isAnyPressed(e.keyboard_keys_pressed,tr.keys_nitro))return void Gn.setTutorial(e,Bn.TutorialNone)}else if(t.state==Bn.TutorialPower){if(t.power_button.texture!=e.player.ability_button.icon.sprite.texture&&t.power_button.setTexture(e.player.ability_button.icon.sprite.texture),Gn.mirrorTransform(t.power_button,e.player.ability_button.container),t.power_button.position.x=e.player.ability_button.parent_cache_x,t.power_button.position.y=e.player.ability_button.parent_cache_y,t.text.position.x=t.power_button.position.x-t.power_button.width/2-t.text.width-50,t.text.position.y=t.power_button.position.y-t.text.height/2,Gn.animateTutorialWhiteCircle(e,t,t.power_button),Ha.isDowned(t.power_button.position.x,t.power_button.position.y,e.pointer,e.player.ability_button.radius))return void Gn.setTutorial(e,Bn.TutorialNone);if(Ni.isAnyPressed(e.keyboard_keys_pressed,tr.keys_power))return void Gn.setTutorial(e,Bn.TutorialNone)}}else{t.current_time+=e.step.step_size;var a=ca.linearClamped(1,0,t.current_time/Ln.phase_out_time);0==(t.container.alpha=a)&&Gn.setTutorial(e,Bn.TutorialNone)}},Gn.updateCarModifiers=function(e,t,n){if(0<e.all_cars.length&&null!=e.player){for(var i=e.all_cars[e.all_cars.length-1],r=0,a=e.bots;r<a.length;){var l=a[r];++r;var o=Gn.calculateSpeedIncreaseBasedOnDistance(i,l.car,500,3e3,0,.1);l.config.drive_velocity_max_additional=l.config.drive_velocity_max*o}var _=Gn.calculateSpeedIncreaseBasedOnDistance(i,e.player.car,500,3e3,0,.1);e.player.config.drive_velocity_max_additional=e.player.config.drive_velocity_max*_;var p=1,u=1,h=1,c=1;if(null!=e.game_save.ongoing_powers){for(var d=null,m=0,f=e.ongoing_powers_display.current_items;m<f.length;){var g=f[m];++m;var v=g.desc.type;if(v==kr.ConstantFasterAcceleration)p+=g.generated_amounts[0]/100;else if(v==kr.ConstantMoreBoost)u+=g.generated_amounts[0]/100,h+=g.generated_amounts[0]/100;else if(v==kr.ConstantHandling)c+=g.generated_amounts[0]/100;else if(v==kr.OneTimeMoreBoost)e.player.abilities.nitro_power_charge+=Math.round(g.generated_amounts[0]),null==d&&(d=[]),d.push(g);else if(v==kr.OneTimeMoreBombs){var b=e.player;be.pickItem(b.ability_button,new PIXI.Point(0,0),new PIXI.Point(1,1),e.ability_item_container,!0),b.abilities.current_ability=ge.None,b.abilities.received_ability=ge.Bomb,null!=e.player_bot&&(e.player_bot.abilities.bot_ability_receive_time_stamp=e.step.level_seconds+1),null==d&&(d=[]),d.push(g)}else if(v==kr.OneTimeMoreDynamites){var y=e.player;be.pickItem(y.ability_button,new PIXI.Point(0,0),new PIXI.Point(1,1),e.ability_item_container,!0),y.abilities.current_ability=ge.None,y.abilities.received_ability=ge.Dynamite,null!=e.player_bot&&(e.player_bot.abilities.bot_ability_receive_time_stamp=e.step.level_seconds+1),null==d&&(d=[]),d.push(g)}else if(v==kr.OneTimeAtomicBomb){var x=e.player;be.pickItem(x.ability_button,new PIXI.Point(0,0),new PIXI.Point(1,1),e.ability_item_container,!0),x.abilities.current_ability=ge.None,x.abilities.current_ability_power_add_coeff=g.generated_amounts[0]/100,x.abilities.received_ability=ge.Bomb,null!=e.player_bot&&(e.player_bot.abilities.bot_ability_receive_time_stamp=e.step.level_seconds+1),null==d&&(d=[]),d.push(g)}else if(v==kr.OneTimePartyTime){for(var z=e.player,w=0,k=e.all_cars;w<k.length;){var S=k[w];++w,S!=z.car&&Gn.spawnAttachment(e,t,n,S,De.AttachmentBalloon,Ee.balloon_time)}null==d&&(d=[]),d.push(g)}}if(null!=d)for(var C=0;C<d.length;){var N=d[C];++C,s.remove(e.ongoing_powers_display.current_items,N)}}var P=e.player.config;P.drive_impulse_additional=P.drive_impulse*(p-1),P.nitro_impulse_additional=P.nitro_impulse*(u-1),P.nitro_velocity_additional_coeff=h,P.rotation_angular_velocity_max_additional_coeff=c}},Gn.updateAchievements=function(e,t){for(var n=0,i=e.achievement_descs;n<i.length;){var r=i[n];++n;for(var a=!1,s=0,l=e.game_save.achievements_completed;s<l.length;){var o=l[s];if(++s,r.id==o){a=!0;break}}if(!a){if(e.level_type==Fn.InRacing)if(r.type==Tr.Stunt3xFrontFlip)3<=e.stunt.stats.max_front_flips&&e.game_save.achievements_completed.push(r.id);else if(r.type==Tr.Stunt3xCombo)3<=e.stunt.stats.max_combos&&e.game_save.achievements_completed.push(r.id);else if(r.type==Tr.Stunt10BackFlipsInALevel)10<=e.stunt.stats.total_back_flips&&e.game_save.achievements_completed.push(r.id);else if(r.type==Tr.Stunt100Flips){for(var _=0,p=0,u=e.game_save.level_saves;p<u.length;){var h=u[p];++p,h.completed&&(_+=h.stunt_stats.total_back_flips,_+=h.stunt_stats.total_front_flips)}_+=e.stunt.stats.total_back_flips,100<=(_+=e.stunt.stats.total_front_flips)&&e.game_save.achievements_completed.push(r.id)}else r.type==Tr.Stunt10xCombo&&10<=e.stunt.stats.max_combos&&e.game_save.achievements_completed.push(r.id);else if(e.level_type==Fn.InInterLevelMenu){for(var c=0,d=0,m=0,f=0,g=e.game_save.level_saves;f<g.length;){var v=g[f];++f,v.description.type==vr.LevelRegular&&v.completed&&(++c,100==v.completion_percent&&++m,1==v.place&&++d)}r.type==Tr.Finish2Levels?2<=c&&e.game_save.achievements_completed.push(r.id):r.type==Tr.Finish6Levels?6<=c&&e.game_save.achievements_completed.push(r.id):r.type==Tr.Finish10LevelsWith100Score?10<=m&&e.game_save.achievements_completed.push(r.id):r.type==Tr.Finish20Levels1st?20<=d&&e.game_save.achievements_completed.push(r.id):r.type==Tr.Finish30LevelsWith100Score&&30<=m&&e.game_save.achievements_completed.push(r.id)}1==e.config.type&&2==e.config.release.sitelock_type&&Ca.updateAllAwards(e)}}if(e.game_save.achievements_shown.length!=e.game_save.achievements_completed.length)for(var b=0,y=e.game_save.achievements_completed;b<y.length;){var x=y[b];if(++b,-1==e.game_save.achievements_shown.indexOf(x)){for(var z=null,w=0,k=0,S=e.achievement_descs;k<S.length;){var C=S[k];if(++k,C.id==x){z=C;break}++w}if(null!=z||(xl.trace("warning: found_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.GameDo",methodName:"updateAchievements"}),0)){if(1==e.config.type&&3==e.config.release.sitelock_type){var N=(w+1)/e.achievement_descs.length;N=pa.clamp(N,.1,1),Ya.PokiSDK.happyTime(N)}Gn.pushNotification(e.notifications,"Achievement Unlocked!","("+z.name+": "+z.requirement+")")}e.game_save.achievements_shown.push(x)}}},Gn.updateNotifications=function(e,t,n,i,r){if(0<i.show_cue.length?(null==i.container&&(i.container=Ra.createGroup(),i.primary_text=Ra.createBitmapText(cn.toonish_36,Mn.primary_text_font_size,"left","Text",.5,.5),i.secondary_text=Ra.createBitmapText(cn.toonish_36,Mn.secondary_text_font_size,"left","Text",.5,.5),i.container.add(i.primary_text),i.container.add(i.secondary_text),i.container.alpha=0),i.state==Pn.None&&(null!=i.container.parent&&e.menu_container.remove(i.container),e.menu_container.add(i.container),i.container.alpha=0,i.primary_text.position.x=0,i.secondary_text.position.y=0,i.show_current=i.show_cue.shift(),i.current_time=0,i.state=Pn.WaitBeforePhaseIn,i.primary_text.text=i.show_current.primary_text,i.secondary_text.text=i.show_current.secondary_text)):i.state==Pn.None&&null!=i.container&&(null!=i.primary_text&&i.primary_text.destroy(!0),null!=i.secondary_text&&i.secondary_text.destroy(!0),i.container.destroy(!0),i.container=null,i.primary_text=null,i.secondary_text=null),i.state==Pn.WaitBeforePhaseIn&&(i.current_time+=n.step_size,i.current_time>=i.show_current.wait_before_phase_in_time&&(i.current_time=0,i.state=Pn.PhaseIn)),i.state==Pn.PhaseIn){i.current_time+=n.step_size;var a=pa.clamp0to1(i.current_time/Mn.phase_in_time),s=ca.smoothStart(2.5,1,a);i.container.scale.x=s,i.container.scale.y=s,1==(i.container.alpha=a)&&(Gn.applyCameraShake(e.camera_shake,10,5),i.state=Pn.Wait,i.current_time=0,ks.playSound(Os.sound_notification,r))}else if(i.state==Pn.Wait)i.current_time+=n.step_size,i.current_time>=i.show_current.wait_time&&(i.state=Pn.PhaseOut,i.current_time=0);else if(i.state==Pn.PhaseOut){i.current_time+=n.step_size;var l=pa.clamp0to1(i.current_time/Mn.phase_out_time);ca.smoothStart(1,0,l),i.container.alpha=1-l,1==l&&(i.state=Pn.None,i.show_current=null,i.current_time=0)}null!=i.container&&null!=i.container.parent&&(""==i.secondary_text.text?(i.primary_text.position.y=0,i.secondary_text.visible&&(i.secondary_text.visible=!1)):(i.primary_text.position.y=-Mn.distance_between_text/2,i.secondary_text.position.y=Mn.distance_between_text/2,i.secondary_text.visible||(i.secondary_text.visible=!0)),i.container.position.x=t.current_game_width/2,i.container.position.y=t.current_game_height*Mn.stage_height_coeff)},Gn.updateLevelEnd=function(e,t,n){if(e.level_end_enabled){if(e.player.car.main_body_position_x>=e.level_end_position.x){var i=e.player.car,r=Math.pow(.5,t.dc),a=i.front_wheel_body;a.set_angularVel(a.get_angularVel()*r);var l=i.back_wheel_body;l.set_angularVel(l.get_angularVel()*r),i.front_wheel_body.get_angularVel()<10&&i.front_wheel_body.set_angularVel(0),i.back_wheel_body.get_angularVel()<10&&i.back_wheel_body.set_angularVel(0),0==i.back_wheel_body.get_angularVel()&&0==i.front_wheel_body.get_angularVel()&&(i.main_body.get_velocity().muleq(Math.pow(.98,t.dc)),i.main_body.get_velocity().get_length()<.05&&i.main_body.get_velocity().setxy(0,0)),e.player.nitro_button.state==rr.TransitionOut&&lr.updateNitroTransitionOut(e.player.nitro_button,t.ui_dc)}for(var o=0,_=e.bots;o<_.length;){var u=_[o];if(++o,u.car.main_body_position_x>=e.level_end_position.x){var h=u.car,c=Math.pow(.5,t.dc),d=h.front_wheel_body;d.set_angularVel(d.get_angularVel()*c);var m=h.back_wheel_body;m.set_angularVel(m.get_angularVel()*c),h.front_wheel_body.get_angularVel()<10&&h.front_wheel_body.set_angularVel(0),h.back_wheel_body.get_angularVel()<10&&h.back_wheel_body.set_angularVel(0),0==h.back_wheel_body.get_angularVel()&&0==h.front_wheel_body.get_angularVel()&&(h.main_body.get_velocity().muleq(Math.pow(.98,t.dc)),h.main_body.get_velocity().get_length()<.05&&h.main_body.get_velocity().setxy(0,0)),u.finished_race||(xl.trace("finished race: "+u.car.name+" (bot) in "+Math.round(e.race_seconds)+" seconds",{fileName:"GameDo.hx",lineNumber:6887,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}),u.finished_race=!0,u.behavior_activated=!1,u.finish_time_in_seconds=e.race_seconds,Me.deactivateAbilities(u.abilities))}}}if(!e.player.finished_race&&e.level_end_enabled){var f=e.player;if(f.car.main_body_position_x>=e.level_end_position.x&&!f.finished_race){1==e.config.type&&3==e.config.release.sitelock_type&&Ya.PokiSDK.gameplayStop();var g=e.game_save.current_level_name;xl.trace("finished race: "+f.car.name+" (player, level: "+g+") in "+Math.round(e.race_seconds)+" seconds, stunt_score: "+e.stunt.stats.total_level_score+", coins: "+e.collected_in_level.coins+", chests: "+e.collected_in_level.chests_collected_guids.length,{fileName:"GameDo.hx",lineNumber:6908,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}),f.finished_race=!0,f.behavior_activated=!1,null!=e.player_bot&&(e.player_bot.behavior_activated=!1),Me.deactivateAbilities(e.player.abilities),f.nitro_button.state!=rr.Empty&&(f.nitro_button.state=rr.TransitionOut),f.ability_button.state!=fe.None&&(f.ability_button.state=fe.None,be.pushToOld(f.ability_button)),e.level_end.current_camera_time=0,e.level_end.current_time=0,e.level_end.state=vn.WaitForFinished,e.level_end.type=yn.LevelEndWin,ks.playSound(Os.sound_across_the_line,n)}}if(e.player.finished_race){var v=e.level_end;if(v.current_time+=t.ui_dc,v.state==vn.WaitForFinished&&(e.stunt.previous_stunt_time_stamp=0,v.current_time>=xn.wait_for_finish_time&&(v.state=vn.FinishedAnimation,v.current_time=0,v.finished_text.alpha=0,v.type==yn.LevelEndWin?(e.current_level_save.description.type==vr.LevelRegular?v.finished_text.setTexture(Zs.getTexture("finished_text")):v.finished_text.setTexture(Zs.getTexture("challenge_completed_text")),ba.trackLevelFinish(e.current_level_save.description.name)):v.type==yn.LevelEndFail?(v.finished_text.setTexture(Zs.getTexture("failed_text")),ba.trackLevelFailed(e.current_level_save.description.name)):xl.trace("warning: unhandled "+p.string(v.type),{fileName:"GameDo.hx",lineNumber:6967,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}),Gn.safeAdd(e.ingame_container,v.finished_text))),v.state==vn.FinishedAnimation){var b=ca.clamp(v.current_time/xn.finished_animation_time,0,1),y=ca.smoothStart(xn.finished_start_scale,xn.finished_end_scale,b),x=ca.smoothStart(0,1,b);v.finished_text.scale.x=y,v.finished_text.scale.y=y,v.finished_text.alpha=x,Gn.setInGameControlsAlpha(e,1-x),e.player.nitro_button.state=rr.TransitionOut,v.current_time>=xn.finished_animation_time&&(v.state=vn.WaitForLevelStats,v.current_time=0,Gn.applyCameraShake(e.camera_shake,xn.camera_shake_amount,xn.camera_shake_time,e.player.car,e.player.car.main_body.get_position()),ks.playSound(Os.sound_bang,n),v.type==yn.LevelEndWin&&1==e.current_place.place_number&&Gn.pushNotification(e.notifications,"1st Place!","",.5))}if(v.state==vn.WaitForLevelStats&&v.current_time>=xn.wait_for_level_stats_time&&(v.state=vn.InLevelStats,v.current_time=0),v.state==vn.InLevelStats){var z=0,w=Ii.None,k=e.current_place.place_number;if(e.current_level_save.description.type==vr.LevelRegular){var S;0!=e.stunt.current_score&&xl.trace("warning: stunt.current_score is still "+e.stunt.current_score,{fileName:"GameDo.hx",lineNumber:7024,className:"bikas.game.GameDo",methodName:"updateLevelEnd"});var C=e.stunt.stats.total_level_score,N=e.current_level_save.description.max_stunt_score;S=pa.clamp(C/N,0,1),Ti.update(e,e.level_stats,e.current_level_save,k,S,e.collected_in_level,e.game_save,e.all_cars.length,e.menu_container,e.js_info,e.pointer,e.step,e.sounds_enabled),z=e.level_stats.final_level_percent,w=e.level_stats.click_action}else e.current_level_save.description.type==vr.LevelChallenge?(v.type==yn.LevelEndWin?v.challenge_button.texture!=xn.challenge_win_button_texture&&v.challenge_button.setTexture(xn.challenge_win_button_texture):v.type==yn.LevelEndFail?v.challenge_button.texture!=xn.challenge_fail_button_texture&&v.challenge_button.setTexture(xn.challenge_fail_button_texture):xl.trace("warning: unhandled "+p.string(v.type),{fileName:"GameDo.hx",lineNumber:7051,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}),null==v.challenge_button.parent&&e.menu_container.add(v.challenge_button),v.challenge_button.position.x=e.js_info.current_game_width/2,v.challenge_button.position.y=e.js_info.current_game_height/2,Ni.isReleased(e.keyboard_keys_released,32)&&(v.type==yn.LevelEndWin?(z=100,w=Ii.StatsClickContinue):v.type==yn.LevelEndFail?w=Ii.StatsClickRestart:xl.trace("warning: unhandled "+p.string(v.type),{fileName:"GameDo.hx",lineNumber:7075,className:"bikas.game.GameDo",methodName:"updateLevelEnd"})),Gn.isObjectDownedInRadius(v.challenge_button,e.pointer,v.challenge_button.height/2+15)&&(v.type==yn.LevelEndWin?(z=100,w=Ii.StatsClickContinue):v.type==yn.LevelEndFail?w=Ii.StatsClickRestart:xl.trace("warning: unhandled "+p.string(v.type),{fileName:"GameDo.hx",lineNumber:7093,className:"bikas.game.GameDo",methodName:"updateLevelEnd"}))):xl.trace("warning: unhandled state",{fileName:"GameDo.hx",lineNumber:7098,className:"bikas.game.GameDo",methodName:"updateLevelEnd"});if(w!=Ii.None)if(w==Ii.StatsClickRestart)1==e.config.type&&2==e.config.release.sitelock_type?v.state=vn.InNext:1==e.config.type&&3==e.config.release.sitelock_type?(v.state=vn.InAd,Ya.PokiSDK.commercialBreak().then((function(){v.state=vn.InNext}))):v.state=vn.InNext,v.next_state=bn.NextRestartLevel;else if(w==Ii.StatsClickContinue)if(null==e.inter_level_menu_save)xl.trace("warning: couldn't find inter_level_menu_save",{fileName:"GameDo.hx",lineNumber:7135,className:"bikas.game.GameDo",methodName:"updateLevelEnd"});else{for(var P=[],M=0,I=e.game_save.ongoing_powers.level_items;M<I.length;){var A=I[M];++M,(-1==e.ongoing_powers_display.current_items.indexOf(A)||A.desc.expiration_type==Nr.OneLevel)&&P.push(A)}for(var T=0;T<P.length;){var D=P[T];++T,s.remove(e.game_save.ongoing_powers.level_items,D),s.remove(e.ongoing_powers_display.current_items,D)}var E=e.current_level_save.description.level_number-1;if(0<=E&&E<e.upgrades.points_per_level.length&&(e.game_save.upgrade_points+=e.upgrades.points_per_level[E]),e.game_save.coins+=e.collected_in_level.coins,e.current_level_save.completed=!0,-1==e.current_level_save.place)e.current_level_save.place=pa.clamp0toInfinityInt(k);else{var O=pa.clamp0toInfinityInt(e.current_level_save.place),B=pa.clamp0toInfinityInt(k);e.current_level_save.place=pa.minInt(O,B)}e.current_level_save.completion_percent=pa.maxInt(e.current_level_save.completion_percent,z),null!=e.current_level_save.stunt_stats?e.current_level_save.stunt_stats=Ur.getHighestStunts(e.current_level_save.stunt_stats,e.stunt.stats):e.current_level_save.stunt_stats=e.stunt.stats,e.current_level_save.coins=pa.maxInt(e.current_level_save.coins,e.collected_in_level.coins),e.current_level_save.chests_rewarded+=e.collected_in_level.chests_rewarded;for(var L=0,j=e.collected_in_level.chests_collected_guids;L<j.length;){var F=j[L];++L,e.current_level_save.chests_collected_guids.push(F)}v.next_state=bn.NextInterLevelMenu,e.game_save.credits_shown||null==e.credits_save||30==wr.getTotalRegularLevelsCompleted(e.game_save)&&(v.next_state=bn.NextCreditsLevel),1==e.config.type&&2==e.config.release.sitelock_type?(v.state=vn.InAd,Ca.showAd((function(){e.level_end.state=vn.InNext}))):1==e.config.type&&3==e.config.release.sitelock_type?(v.state=vn.InAd,Ya.PokiSDK.commercialBreak().then((function(){v.state=vn.InNext}))):v.state=vn.InNext}else xl.trace("warning: unhandled "+p.string(w),{fileName:"GameDo.hx",lineNumber:7246,className:"bikas.game.GameDo",methodName:"updateLevelEnd"})}else v.state!=vn.InAd&&(v.state,vn.InNext);null!=v.finished_text.parent&&(v.finished_text.position.x=e.js_info.current_game_width/2,v.finished_text.position.y=e.js_info.current_game_height/3*.5),v.current_camera_time+=t.ui_dc,v.current_camera_time>=xn.camera_time&&(v.current_camera_time=xn.camera_time);var R=e.player.car.main_body_entity.position,G=v.current_camera_time/xn.camera_time,Z=e.player.car.distance_from_main_body_to_bottom_y,U=e.level_end_position.x+.2666666666666667*e.js_info.current_game_width,V=e.level_end_position.y-Z,q=ca.linear(R.x,U,G),W=ca.linear(R.y,V,G);e.current_level_save.description.type==vr.LevelRegular&&(v.camera_position.x=q,v.camera_position.y=W,e.camera.camera_target_pos.set_x(v.camera_position.x),e.camera.camera_target_pos.set_y(v.camera_position.y),e.camera.target_pos.set_x(v.camera_position.x),e.camera.target_pos.set_y(v.camera_position.y),e.camera.smooth_steps=100)}},Gn.updateSlowDownEffect=function(e,t){var n=e.slow_down_time,i=t.original_dc*e.temp_dc_coeff;if(n.current_delay-=i,n.current_delay<=0){n.current_duration+=i;var r=1;if(n.current_duration<=n.smooth_in_duration){var a=pa.range(n.current_duration,0,n.smooth_in_duration);r=ca.linear(1,n.time_coeff,a)}else if(n.current_duration>=n.duration-n.smooth_out_duration){var s=pa.range(n.current_duration,n.duration-n.smooth_out_duration,n.duration);r=ca.linear(n.time_coeff,1,s)}else r=n.time_coeff;n.current_duration>=n.duration?(e.delta_update_coeff_by_effect=1,e.slow_down_time=null):e.delta_update_coeff_by_effect=r}},Gn.updateCamera=function(e,t){var n=t.dc,i=e.js_info;if(null!=e.camera){var r=-1;0==e.config.type&&(r=e.config.development.fixed_camera_zoom);var a=0==e.config.type&&e.config.development.manual_camera_control;if(i.current_game_width==e.current_camera_refresh_width_cache&&i.current_game_height==e.current_camera_refresh_height_cache||(null!=e.player&&null!=e.camera&&null!=e.stage_group?Gn.refreshCameraCenter(e,e.camera,i,e.player.car.main_body_entity.position):null!=e.menu_camera_position&&null!=e.camera&&null!=e.stage_group&&Gn.refreshCameraCenter(e,e.camera,i,e.menu_camera_position)),0<=e.camera_shake.current_time&&(e.camera_shake.current_time-=n,a&&(e.camera.additional_offset.set_x(Math.random()*e.camera_shake.amount*2-e.camera_shake.amount),e.camera.additional_offset.set_y(Math.random()*e.camera_shake.amount*2-e.camera_shake.amount),e.camera_shake.current_time<0&&(e.camera.additional_offset.set_x(0),e.camera.additional_offset.set_y(0)))),e.level_type==Fn.InRacing&&null!=e.camera&&null!=e.stage_group&&null!=e.player){var s=e.player.car.distance_from_main_body_to_bottom_y,l=e.camera.zoom_max,o=e.camera.zoom_min-l,_=100;if(0!=o){var p=(e.camera.current_zoom-l)/o;_=ca.linear(100,0,p)}e.camera.view_offset.set_y(-e.js_info.current_game_height*e.camera_view_ratio+s-_);var u=e.player.car.main_body_entity.position;a?e.temp.camera_control.type==Kt.ImitatePlayer?u=e.temp.camera_control.camera_position:e.temp.camera_control.type==Kt.Free&&(u=e.temp.camera_control.camera_position,e.camera.camera_target_pos.set_x(u.x),e.camera.camera_target_pos.set_y(u.y),e.camera.target_pos.set_x(u.x),e.camera.target_pos.set_y(u.y)):e.player.finished_race&&e.current_level_save.description.type==vr.LevelRegular&&(u=e.level_end.camera_position),bt.updateCarCamera(e.camera,u,e.stage_group.position,e.stage_group.transform,n,r)}else if((e.level_type==Fn.InMainMenu||e.level_type==Fn.InInterLevelMenu)&&null!=e.menu_camera_position&&null!=e.camera&&null!=e.stage_group){var h=e.camera.zoom_max,c=1-h,d=100;if(0!=c){var m=(e.camera.current_zoom-h)/c;d=ca.linear(100,0,m)}e.camera.view_offset.set_x(0),d=0,e.camera.view_offset.set_y(-e.js_info.current_game_height*e.camera_view_ratio-d);var f=e.menu_camera_position;a&&(f=e.temp.camera_control.camera_position,e.camera.camera_target_pos.set_x(f.x),e.camera.camera_target_pos.set_y(f.y),e.camera.target_pos.set_x(f.x),e.camera.target_pos.set_y(f.y)),bt.updateStaticCamera(e.camera,f,e.stage_group.position,e.stage_group.transform,n,r)}if(null!=e.stage_group){var g=e.stage_group,v=g.group.container,b=g.transform;v.x=g.position.x,v.y=g.position.y,v.scale.x!=b.scale_x&&(v.scale.x=b.scale_x),v.scale.y!=b.scale_y&&(v.scale.y=b.scale_y)}}else xl.trace("warning: game.camera == null",{fileName:"GameDo.hx",lineNumber:7321,className:"bikas.game.GameDo",methodName:"updateCamera"})},Gn.updateGameVisibleBounds=function(e){var t=e.stage_group.transform.scale_x;e.visible_bounds.min_x=-e.stage_group.position.x/t,e.visible_bounds.min_y=-e.stage_group.position.y/t,e.visible_bounds.max_x=e.visible_bounds.min_x+e.js_info.current_game_width/t,e.visible_bounds.max_y=e.visible_bounds.min_y+e.js_info.current_game_height/t,0==e.config.type&&e.config.development.reduce_visible_bounds_by_100_pixels&&(e.visible_bounds.min_x+=100,e.visible_bounds.min_y+=100,e.visible_bounds.max_x-=100,e.visible_bounds.max_y-=100)},Gn.updatePolygonDraw=function(e){for(var t=e.stage_group.transform.scale_x,n=e.stage_group.group.container,i=0,r=e.textured_polygons;i<r.length;){var a=r[i];++i;var s=a.data.real_time_graphics.position;a.draw_bounds.min_x=e.visible_bounds.min_x-s.x,a.draw_bounds.min_y=e.visible_bounds.min_y-s.y,a.draw_bounds.max_x=e.visible_bounds.max_x-s.x,a.draw_bounds.max_y=e.visible_bounds.max_y-s.y,ja.draw(a.data,a.draw_bounds,t,!0)}null!=e.background_ground_group&&(e.background_ground_group.x=n.x,e.background_ground_group.y=n.y,e.background_ground_group.scale.x=n.scale.x,e.background_ground_group.scale.y=n.scale.y),null!=e.ground_group&&(e.ground_group.x=n.x,e.ground_group.y=n.y,e.ground_group.scale.x=n.scale.x,e.ground_group.scale.y=n.scale.y),null!=e.grass_group&&(e.grass_group.x=n.x,e.grass_group.y=n.y,e.grass_group.scale.x=n.scale.x,e.grass_group.scale.y=n.scale.y),null!=e.marker_group&&(e.marker_group.x=n.x,e.marker_group.y=n.y,e.marker_group.scale.x=n.scale.x,e.marker_group.scale.y=n.scale.y)},Gn.updateBackground=function(e,t){if(null!=e.background){var n=e.js_info,i=e.background,r=e.camera;e.stage_group.transform.scale_x,e.camera_free||(i.camera.x=bt.getStagePositionX(r,1),i.camera.y=bt.getStagePositionY(r,1),i.camera.x+=e.background_camera_offset.x,i.camera.y+=e.background_camera_offset.y),i.camera.z=i.eye.z/r.current_zoom-i.eye.z,i.camera.z+=e.background_camera_offset.z;var a=n.current_game_width/2,s=n.current_game_height*e.background_ratio;Ve.updateBackground(i,n.current_game_width,n.current_game_height,a,s,t)}},Gn.updateDebugStuff=function(e,t){e.js_info,e.pointer,e.gameplay_bot_enabled&&qn.update(e,e.gameplay_bot);for(var n=0,i=e.temp.updates;n<i.length;){var r=i[n];++n,r()}};var Zn=function(){};(n["bikas.game.GameSerializerDo"]=Zn).__name__=["bikas","game","GameSerializerDo"],Zn.describeData=function(){re.pushClass;var e=re.pushBool,t=re.pushInt,n=(re.pushDouble,re.pushString),i=(re.pushEnum,re.pushArray),r=re.pushInstance,a=re.pushIgnore,s=re.createSerialData(),l=re.pushClass(s,zr,null);return t(l,"save_data_version"),n(l,"save_date"),n(l,"current_level_name"),n(l,"previous_level_name"),i(l,"level_saves",[12]),e(l,"credits_shown"),t(l,"chests"),t(l,"coins"),t(l,"upgrade_points"),r(l,"car_upgrades"),n(l,"current_car"),i(l,"car_own_list",[5]),i(l,"current_bot_car_lineup",[5]),i(l,"locked_cars",[5]),t(l,"bot_replaced_at_level_count"),i(l,"achievements_completed",[5]),i(l,"achievements_shown",[5]),i(l,"achievements_claimed",[5]),i(l,"challenges_unlocked",[5]),i(l,"challenges_unlocked_shown",[5]),i(l,"challenges_unlocked_shown_on_map",[5]),i(l,"challenges_completed",[5]),i(l,"challenges_completed_claimed",[5]),r(l,"ongoing_powers"),i(l,"rewarded_ads",[12]),e(l,"tutorial_shown_controls"),e(l,"tutorial_shown_jump"),e(l,"tutorial_shown_nitro"),e(l,"tutorial_shown_power"),n(l=re.pushClass(s,xr,null),"description_name"),a(l,"description"),e(l,"completed"),e(l,"locked"),t(l,"place"),t(l,"completion_percent"),r(l,"stunt_stats"),t(l,"coins"),t(l,"chests_rewarded"),i(l,"chests_collected_guids",[5]),t(l=re.pushClass(s,Gr,null),"max_front_flips"),t(l,"max_back_flips"),t(l,"max_front_wheelies"),t(l,"max_back_wheelies"),t(l,"max_combos"),t(l,"max_level_score"),t(l,"total_front_flips"),t(l,"total_back_flips"),t(l,"total_front_wheelies"),t(l,"total_back_wheelies"),t(l,"total_combos"),t(l,"total_perfect_landings"),t(l,"total_level_score"),t(l=re.pushClass(s,hr,null),"top_speed"),t(l,"acceleration"),t(l,"handling"),t(l,"armor"),i(l=re.pushClass(s,mr,null),"permanent_items",[12]),i(l,"level_items",[12]),n(l=re.pushClass(s,Mr,null),"id"),a(l,"desc"),i(l,"generated_amounts",[4]),n(l,"description_text"),e(l,"shown"),t(l=re.pushClass(s,fr,null),"type"),t(l,"levels_completed"),re.validateSerialData(s),re.createTypeTableForSerialData(s),s},Zn.saveToStorage=function(e,t,n){null==n&&(n="adventure_drivers");var i=re.serialize(e,t,[12]),r=Sl.encode(i);try{to.get_window().localStorage.setItem(n,r)}catch(e){return e instanceof $l&&(e=e.val),xl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:185,className:"bikas.game.GameSerializerDo",methodName:"saveToStorage"}),!1}return!0},Zn.loadFromStorage=function(e,t){null==t&&(t="adventure_drivers");var n=null;try{n=to.get_window().localStorage.getItem(t)}catch(e){return e instanceof $l&&(e=e.val),xl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:196,className:"bikas.game.GameSerializerDo",methodName:"loadFromStorage"}),null}if(null==n)return null;var i=eo.__cast(n,String),r=Sl.decode(i);if(null==r)return null;var a=re.unserialize(e,r);return eo.__cast(a,zr)},Zn.clearStorage=function(){try{to.get_window().localStorage.clear()}catch(e){e instanceof $l&&(e=e.val),xl.trace(e,{fileName:"GameSerializerDo.hx",lineNumber:227,className:"bikas.game.GameSerializerDo",methodName:"clearStorage"})}},Zn.stringToBinary=function(e){for(var t=e.split(","),n=kl.alloc(t.length),i=0,r=n.length;i<r;){var a=i++;n.set(a,p.parseInt(t[a]))}return n},Zn.binaryToString=function(e){for(var t=[],n=0,i=e.length;n<i;){var r=n++;t.push(e.get(r))}return t.join(",")};var Un=function(){};(n["bikas.game.GameSoundDo"]=Un).__name__=["bikas","game","GameSoundDo"],Un.playSoundInGameLevel=function(e,t,n,i,r,a){var s=i.main_body_position_x,l=i.main_body_position_y,o=pa.distance(n.get_x(),n.get_y(),s,l),_=ca.getTClamped(a,0,o/r);0<_&&ks.playSound(e,t,_)};var Vn=function(){this.current_wait_time=0};(n["bikas.game.GameplayBot"]=Vn).__name__=["bikas","game","GameplayBot"],Vn.prototype={current_wait_time:null,__class__:Vn};var qn=function(){};(n["bikas.game.GameplayBotDo"]=qn).__name__=["bikas","game","GameplayBotDo"],qn.gotoTargetPlace=function(e,t,n){var i=bi.findPlaceByName(e.places,n);return null!=i&&(e.scroll_target.x=i.marker.position.x,Math.abs(t.current_pos.get_x()-e.scroll_target.x)<1)},qn.update=function(e,t){var n=e.camera,i=e.game_save,r=e.sounds_enabled;if(e.level_type==Fn.InRacing){if(e.level_end.state==vn.InLevelStats){var a=e.level_stats;a.state==Mi.StatsWaiting&&(a.continue_available?1==a.continue_button.alpha&&Ti.clickContinue(e.collected_in_level,a,i,r):1==a.restart_button.alpha&&Ti.clickRestart(a,e.sounds_enabled))}}else if(e.level_type==Fn.InInterLevelMenu){var s=e.inter_level_menu;if(s.state==gi.InFreeScroll){if(t.current_wait_time+=e.step.step_size,t.current_wait_time>=Vn.wait_in_menu_time&&0<s.chests.length&&(t.current_wait_time=0,qn.gotoTargetPlace(s,n,vi.place_treasure)))for(var l=0,o=s.chests;l<o.length;){var _=o[l];if(++l,_.state==Wn.Closed){bi.clickChest(s,_);break}}if(t.current_wait_time>=Vn.wait_in_menu_time){for(var p=null,u=0,h=s.achievements;u<h.length;){var c=h[u];if(++u,-1!=i.achievements_completed.indexOf(c.desc.id)&&-1==i.achievements_claimed.indexOf(c.desc.id)){p=c;break}}null!=p&&(t.current_wait_time=0,qn.gotoTargetPlace(s,n,vi.place_achievements)&&bi.clickAchievement(s,p,i,e.ongoing_powers_display,e.notifications,e.achievement_save,r))}if(t.current_wait_time>=Vn.wait_in_menu_time)for(var d=0,m=e.upgrades.upgrade_costs;d<m.length;){var f=m[d];++d;var g=f.costs.length,v=0;if("top_speed"==f.name?v=i.car_upgrades.top_speed:"acceleration"==f.name?v=i.car_upgrades.acceleration:"handling"==f.name?v=i.car_upgrades.handling:"armor"==f.name&&(v=i.car_upgrades.armor),v<g){var b=f.costs[v];if(b<=e.game_save.upgrade_points){t.current_wait_time=0,qn.gotoTargetPlace(s,n,vi.place_upgrades)&&bi.clickUpgrade(s,f.name,b,i,r);break}}}if(t.current_wait_time>=Vn.wait_in_menu_time&&(t.current_wait_time=Vn.wait_in_menu_time),t.current_wait_time>=Vn.wait_in_menu_time)for(var y=0,x=s.level_map.levels;y<x.length;){var z=x[y];if(++y,z.could_be_next_level){var w=i.level_saves[z.level_save_index];if(w.description.type==vr.LevelRegular){t.current_wait_time=0,qn.gotoTargetPlace(s,n,vi.place_map)&&bi.clickLevel(s,w,r);break}}}}else if(s.state==gi.InRewardSelection){var k=s.reward_display;if(k.state==Hn.RewardSelect&&0<k.reward_selection.cards.length){var S=pa.getRandomBetweenInt(0,k.reward_selection.cards.length-1),C=k.reward_selection.cards[S];bi.clickRewardCard(e.partition_top,s,k,C,e.game_save,e.ongoing_powers_display,e.notifications,e.sounds_enabled)}}}};var Wn=n["bikas.game.ChestState"]={__ename__:["bikas","game","ChestState"],__constructs__:["Closed","Opened"]};Wn.Closed=["Closed",0],Wn.Closed.toString=i,(Wn.Closed.__enum__=Wn).Opened=["Opened",1],Wn.Opened.toString=i,(Wn.Opened.__enum__=Wn).__empty_constructs__=[Wn.Closed,Wn.Opened];var Xn=function(){this.additional_sprites_added=!1,this.state=Wn.Closed};(n["bikas.game.Chest"]=Xn).__name__=["bikas","game","Chest"],Xn.prototype={state:null,additional_sprites_added:null,chest_partition_object:null,chest:null,current_time:null,__class__:Xn};var Hn=n["bikas.game.RewardSelectionState"]={__ename__:["bikas","game","RewardSelectionState"],__constructs__:["RewardAnimateIn","RewardSelect","RewardAnimateOut"]};Hn.RewardAnimateIn=["RewardAnimateIn",0],Hn.RewardAnimateIn.toString=i,(Hn.RewardAnimateIn.__enum__=Hn).RewardSelect=["RewardSelect",1],Hn.RewardSelect.toString=i,(Hn.RewardSelect.__enum__=Hn).RewardAnimateOut=["RewardAnimateOut",2],Hn.RewardAnimateOut.toString=i,(Hn.RewardAnimateOut.__enum__=Hn).__empty_constructs__=[Hn.RewardAnimateIn,Hn.RewardSelect,Hn.RewardAnimateOut];var Yn=function(){this.selected_card_start_scale=0,this.current_time=0,this.chest_position=null,this.chest=null,this.reward_selection=null};(n["bikas.game.RewardSelectionDisplay"]=Yn).__name__=["bikas","game","RewardSelectionDisplay"],Yn.prototype={state:null,reward_selection:null,chest:null,chest_position:null,current_time:null,selected_card_start_scale:null,selected_card:null,__class__:Yn};var Jn=function(){this.main_button=null,this.icon=null};(n["bikas.game.RequirementAndRewardCard"]=Jn).__name__=["bikas","game","RequirementAndRewardCard"],Jn.prototype={container:null,background:null,close_button:null,icon:null,name_text:null,requirement_text:null,reward_text:null,requirement_highlight:null,reward_highlight:null,main_button:null,__class__:Jn};var Kn=n["bikas.game.AchievementDisplayState"]={__ename__:["bikas","game","AchievementDisplayState"],__constructs__:["Closed","Opened"]};Kn.Closed=["Closed",0],Kn.Closed.toString=i,(Kn.Closed.__enum__=Kn).Opened=["Opened",1],Kn.Opened.toString=i,(Kn.Opened.__enum__=Kn).__empty_constructs__=[Kn.Closed,Kn.Opened];var Qn=function(){this.card=null,this.white_circle_current_time=0,this.white_circle_partition_object=null,this.white_circle=null,this.state=Kn.Closed};(n["bikas.game.AchievementDisplay"]=Qn).__name__=["bikas","game","AchievementDisplay"],Qn.prototype={state:null,desc:null,entity:null,white_circle:null,white_circle_partition_object:null,white_circle_current_time:null,card:null,__class__:Qn};var $n=n["bikas.game.UpgradeUnitState"]={__ename__:["bikas","game","UpgradeUnitState"],__constructs__:["None","Downed","Clicked"]};$n.None=["None",0],$n.None.toString=i,($n.None.__enum__=$n).Downed=["Downed",1],$n.Downed.toString=i,($n.Downed.__enum__=$n).Clicked=["Clicked",2],$n.Clicked.toString=i,($n.Clicked.__enum__=$n).__empty_constructs__=[$n.None,$n.Downed,$n.Clicked];var ei=function(){this.upgrade_point_costs=[],this.filled=[],this.additional_sprites_added=!1,this.state=$n.None};(n["bikas.game.UpgradeUnit"]=ei).__name__=["bikas","game","UpgradeUnit"],ei.prototype={state:null,name:null,unfilled_entity:null,fill_start_position:null,plus_entity:null,plus_init_pos:null,plus_points_background_entity:null,additional_sprites_added:null,plus_points_text:null,filled:null,upgrade_point_costs:null,__class__:ei};var ti=function(){this.current_car=null,this.current_car_name="",this.units=[],this.additional_sprites_added=!1};(n["bikas.game.UpgradeDisplay"]=ti).__name__=["bikas","game","UpgradeDisplay"],ti.prototype={prefab_entity:null,points_background_entity:null,additional_sprites_added:null,points_text:null,units:null,car_location:null,current_car_name:null,current_car:null,__class__:ti};var ni=n["bikas.game.CarCardState"]={__ename__:["bikas","game","CarCardState"],__constructs__:["Select","AlreadySelected","Buy","CantBuy"]};ni.Select=["Select",0],ni.Select.toString=i,(ni.Select.__enum__=ni).AlreadySelected=["AlreadySelected",1],ni.AlreadySelected.toString=i,(ni.AlreadySelected.__enum__=ni).Buy=["Buy",2],ni.Buy.toString=i,(ni.Buy.__enum__=ni).CantBuy=["CantBuy",3],ni.CantBuy.toString=i,(ni.CantBuy.__enum__=ni).__empty_constructs__=[ni.Select,ni.AlreadySelected,ni.Buy,ni.CantBuy];var ii=function(){this.green_or_red_bar=null};(n["bikas.game.CarMetric"]=ii).__name__=["bikas","game","CarMetric"],ii.prototype={container:null,background_bar:null,foreground_bar:null,green_or_red_bar:null,text:null,__class__:ii};var ri=function(){this.metrics=[],this.state=ni.Select};(n["bikas.game.CarCard"]=ri).__name__=["bikas","game","CarCard"],ri.prototype={state:null,container:null,background:null,close_button:null,main_button:null,coin:null,text_background:null,text:null,metrics:null,__class__:ri};var ai=n["bikas.game.CarInShopState"]={__ename__:["bikas","game","CarInShopState"],__constructs__:["Closed","Opened"]};ai.Closed=["Closed",0],ai.Closed.toString=i,(ai.Closed.__enum__=ai).Opened=["Opened",1],ai.Opened.toString=i,(ai.Opened.__enum__=ai).__empty_constructs__=[ai.Closed,ai.Opened];var si=n["bikas.game.CarInShopShowType"]={__ename__:["bikas","game","CarInShopShowType"],__constructs__:["None","Locked","Owned","Selected","Priced"]};si.None=["None",0],si.None.toString=i,(si.None.__enum__=si).Locked=["Locked",1],si.Locked.toString=i,(si.Locked.__enum__=si).Owned=["Owned",2],si.Owned.toString=i,(si.Owned.__enum__=si).Selected=["Selected",3],si.Selected.toString=i,(si.Selected.__enum__=si).Priced=["Priced",4],si.Priced.toString=i,(si.Priced.__enum__=si).__empty_constructs__=[si.None,si.Locked,si.Owned,si.Selected,si.Priced];var li=function(){this.card=null,this.additional_sprites_added=!1,this.car_shop_name="",this.car_name="",this.show_type=si.None,this.state=ai.Closed};(n["bikas.game.CarInShop"]=li).__name__=["bikas","game","CarInShop"],li.prototype={state:null,show_type:null,car_name:null,car_shop_name:null,car_setting:null,car_entity:null,car_sprite:null,regular_texture:null,locked_texture:null,name_tag_entity:null,additional_sprites_added:null,name_tag_text:null,name_tag_coin:null,card:null,__class__:li};var oi=function(){this.cars=[]};(n["bikas.game.CarShop"]=oi).__name__=["bikas","game","CarShop"],oi.prototype={cars:null,__class__:oi};var _i=function(){};(n["bikas.game.ConfirmationCard"]=_i).__name__=["bikas","game","ConfirmationCard"],_i.prototype={container:null,background:null,bitmap_text:null,text_background:null,button_close:null,button_main:null,__class__:_i};var pi=n["bikas.game.LevelMapItemState"]={__ename__:["bikas","game","LevelMapItemState"],__constructs__:["Closed","Opened"]};pi.Closed=["Closed",0],pi.Closed.toString=i,(pi.Closed.__enum__=pi).Opened=["Opened",1],pi.Opened.toString=i,(pi.Opened.__enum__=pi).__empty_constructs__=[pi.Closed,pi.Opened];var ui=function(){this.could_be_next_level=!1,this.animate_in=!1,this.click_position=new Yr(0,0),this.challenge_card=null,this.level_card=null,this.challenge_desc=null,this.current_time=0,this.previous_level=null,this.level_save_index=-1,this.selected_circle_added_to_partition=!1,this.state=pi.Closed};(n["bikas.game.LevelMapItem"]=ui).__name__=["bikas","game","LevelMapItem"],ui.prototype={state:null,entity:null,sprite:null,selected_circle:null,selected_circle_added_to_partition:null,level_save_index:null,previous_level:null,current_time:null,challenge_desc:null,level_card:null,challenge_card:null,click_position:null,animate_in:null,could_be_next_level:null,__class__:ui};var hi=function(){this.levels=[]};(n["bikas.game.LevelMap"]=hi).__name__=["bikas","game","LevelMap"],hi.prototype={map_entity:null,levels:null,__class__:hi};var ci=function(){this.reward_ad_type=0,this.closed=!1};(n["bikas.game.RewardedAdMenu"]=ci).__name__=["bikas","game","RewardedAdMenu"],ci.prototype={confirm_card:null,closed:null,reward_ad_type:null,ad:null,text:null,show_time_stamp:null,__class__:ci};var di=n["bikas.game.CardPointerEventType"]={__ename__:["bikas","game","CardPointerEventType"],__constructs__:["DownedOutside","DownedInside","DownedCloseButton","DownedMainButton","None"]};di.DownedOutside=["DownedOutside",0],di.DownedOutside.toString=i,(di.DownedOutside.__enum__=di).DownedInside=["DownedInside",1],di.DownedInside.toString=i,(di.DownedInside.__enum__=di).DownedCloseButton=["DownedCloseButton",2],di.DownedCloseButton.toString=i,(di.DownedCloseButton.__enum__=di).DownedMainButton=["DownedMainButton",3],di.DownedMainButton.toString=i,(di.DownedMainButton.__enum__=di).None=["None",4],di.None.toString=i,(di.None.__enum__=di).__empty_constructs__=[di.DownedOutside,di.DownedInside,di.DownedCloseButton,di.DownedMainButton,di.None];var mi=function(){this.backward_button=null,this.forward_button=null,this.place=null,this.level_map_item=null,this.car_in_shop=null,this.upgrade_unit=null,this.achievement=null,this.chest=null,this.entity=null,this.distance=-1};(n["bikas.game.ClosestObject"]=mi).__name__=["bikas","game","ClosestObject"],mi.prototype={distance:null,entity:null,chest:null,achievement:null,upgrade_unit:null,car_in_shop:null,level_map_item:null,place:null,forward_button:null,backward_button:null,__class__:mi};var fi=function(){this.button=null};(n["bikas.game.InterLevelMenuPlace"]=fi).__name__=["bikas","game","InterLevelMenuPlace"],fi.prototype={marker:null,current_zoom:null,zoom_min:null,zoom_max:null,normal_texture:null,dark_texture:null,button:null,__class__:fi};var gi=n["bikas.game.InterLevelMenuState"]={__ename__:["bikas","game","InterLevelMenuState"],__constructs__:["InFreeScroll","InMapScroll","InRewardSelection","InAchievementShow","InCarBuyShow","InLevelMapItem"]};gi.InFreeScroll=["InFreeScroll",0],gi.InFreeScroll.toString=i,(gi.InFreeScroll.__enum__=gi).InMapScroll=["InMapScroll",1],gi.InMapScroll.toString=i,(gi.InMapScroll.__enum__=gi).InRewardSelection=["InRewardSelection",2],gi.InRewardSelection.toString=i,(gi.InRewardSelection.__enum__=gi).InAchievementShow=["InAchievementShow",3],gi.InAchievementShow.toString=i,(gi.InAchievementShow.__enum__=gi).InCarBuyShow=["InCarBuyShow",4],gi.InCarBuyShow.toString=i,(gi.InCarBuyShow.__enum__=gi).InLevelMapItem=["InLevelMapItem",5],gi.InLevelMapItem.toString=i,(gi.InLevelMapItem.__enum__=gi).__empty_constructs__=[gi.InFreeScroll,gi.InMapScroll,gi.InRewardSelection,gi.InAchievementShow,gi.InCarBuyShow,gi.InLevelMapItem];var vi=function(){this.current_rewarded_ad_menu=null,this.initial_chest_count=0,this.in_ad=!1,this.level_map_next_level_save=null,this.achievements=[],this.chests=[],this.trigger_game_save=!1,this.closest_click=null,this.closest_down=null,this.animate_forward_button_time=0,this.animate_forward_button=!1,this.animate_forward_wait_time=-1,this.scroll_help_wait_time_stamp=-1,this.auto_scrolled_from_tresure_chests=!1,this.camera_smooth_steps_init_current_time=0,this.map_zoom_wait_current_time=0,this.map_max_place=null,this.map_min_place=null,this.map_place=null,this.places=[],this.dragging=!1,this.downed=!1,this.scroll_border=null,this.scroll_target=new Yr(0,0),this.scroll_start_place=null,this.current_speed=0,this.seconds_before=0,this.down_point=new Yr(0,0),this.down_menu_camera_position=new Yr(0,0),this.skipped_initial_locations=!1,this.scrolled_to_debug_location=!1,this.state=gi.InFreeScroll};(n["bikas.game.InterLevelMenu"]=vi).__name__=["bikas","game","InterLevelMenu"],vi.prototype={state:null,stage_group:null,scrolled_to_debug_location:null,skipped_initial_locations:null,down_menu_camera_position:null,down_point:null,seconds_before:null,current_speed:null,scroll_start_place:null,scroll_target:null,scroll_border:null,downed:null,dragging:null,places:null,nearest_place:null,map_place:null,map_min_place:null,map_max_place:null,map_zoom_wait_current_time:null,camera_smooth_steps_init_current_time:null,auto_scrolled_from_tresure_chests:null,scroll_help_wait_time_stamp:null,animate_forward_wait_time:null,animate_forward_button:null,animate_forward_button_time:null,closest_down:null,closest_click:null,forward_button:null,backward_button:null,trigger_game_save:null,chests:null,available_descs:null,reward_display:null,achievements:null,upgrade_display:null,car_shop:null,level_map:null,level_map_next_level_save:null,in_ad:null,initial_chest_count:null,current_rewarded_ad_menu:null,__class__:vi};var bi=function(){};(n["bikas.game.InterLevelMenuDo"]=bi).__name__=["bikas","game","InterLevelMenuDo"],bi.create=function(e,t,n,i,r,a,l,o,_){var u=new vi;u.initial_chest_count=e.chests,u.stage_group=t,u.available_descs=a.slice();var h=function(e,t,n,i,r,a){null==a&&(a=""),null==r&&(r="");var s=Gn.findMarker(e,t);if(null==s&&(xl.trace("warning: marker == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),1))return null;var l=new fi;return l.marker=s,l.current_zoom=n,l.zoom_min=n,l.zoom_max=i,l.normal_texture=Zs.getTexture(r),l.dark_texture=Zs.getTexture(a),l.button=Ra.createSprite(l.normal_texture,0,0),l};u.places.push(h(_,vi.place_treasure,1,1,"scroll_treasure","scroll_treasure_with_background")),u.places.push(h(_,vi.place_achievements,.8,.8,"scroll_trophies","scroll_trophies_with_background")),u.places.push(h(_,vi.place_upgrades,1,1,"scroll_upgrades","scroll_upgrades_with_background")),u.places.push(h(_,vi.place_shop,1,.75,"scroll_shop","scroll_shop_with_background")),u.places.push(h(_,vi.place_map,1.25,1,"scroll_map","scroll_map_with_background")),u.scroll_border=Ra.createSpriteByName("scroll_border",0,0),vi.forward_button_arrow=Zs.getTexture("next_button"),vi.forward_button_go=Zs.getTexture("button_go_circle"),u.forward_button=Ra.createSpriteByName("next_button",.5,.5),u.backward_button=Ra.createSpriteByName("next_button",.5,.5),u.forward_button.scale.x=1,u.backward_button.scale.x=-1,Xn.chest_closed_texture=Zs.getTexture("treasure_chest_closed"),Xn.chest_opened_texture=Zs.getTexture("treasure_chest_opened");var c=function(e,t,n,i,r){for(var a=0,s=t.group.entities;a<s.length;){var l=s[a];if(++a,l.name==n){for(var o=0;o<i.length;){var _=i[o];if(++o,_.type==r){var u=new Qn;return u.entity=l,u.desc=_,void e.achievements.push(u)}}return void xl.trace("warning: couldn't find "+p.string(r),{fileName:"InterLevelMenuDo.hx",lineNumber:170,className:"bikas.game.InterLevelMenuDo",methodName:"create"})}}xl.trace("warning: couldn't find "+n,{fileName:"InterLevelMenuDo.hx",lineNumber:174,className:"bikas.game.InterLevelMenuDo",methodName:"create"})};c(u,t,"achievement_level_1_place_1",l,Tr.Finish2Levels),c(u,t,"achievement_level_1_place_2",l,Tr.Finish6Levels),c(u,t,"achievement_level_1_place_3",l,Tr.Stunt3xFrontFlip),c(u,t,"achievement_level_1_place_4",l,Tr.Stunt3xCombo),c(u,t,"achievement_level_2_place_1",l,Tr.Finish10LevelsWith100Score),c(u,t,"achievement_level_2_place_2",l,Tr.Stunt10BackFlipsInALevel),c(u,t,"achievement_level_2_place_3",l,Tr.Stunt100Flips),c(u,t,"achievement_level_3_place_1",l,Tr.Finish20Levels1st),c(u,t,"achievement_level_3_place_2",l,Tr.Stunt10xCombo),c(u,t,"achievement_level_4_place_1",l,Tr.Finish30LevelsWith100Score);var d,m,f,g,v,b,y,x=u.upgrade_display=new ti;if(x.prefab_entity=bi.findPrefabEntityByName("car_upgrades",t),x.points_background_entity=bi.findEntityByName("car_upgrades_point_background",t),x.points_text=Ra.createBitmapText(cn.tw_cen_mt_condensed_extra_bold_dark_29,42,"left","TEXT"),x.points_text.anchor.x=.5,x.points_text.anchor.y=.5,x.additional_sprites_added=!1,x.points_text.x=x.points_background_entity.position.x,x.points_text.y=x.points_background_entity.position.y,x.car_location=bi.findEntityByName("upgrades_car_location",t),null!=x.prefab_entity)for(var z=x.units,w=x.prefab_entity,k=1,S=0,C=i.upgrade_costs;S<C.length;){var N=C[S];++S,d=z,m=t,f=w,g=k,v=N.name,b=N.costs,y=void 0,(y=new ei).name=v,y.upgrade_point_costs=b,y.unfilled_entity=bi.findEntityByName("car_upgrades_unfilled_"+v,f),y.fill_start_position=new Yr,y.fill_start_position.x=-y.unfilled_entity.display.sprite.width/2,y.fill_start_position.y=-y.unfilled_entity.display.sprite.height/2,y.plus_entity=bi.findEntityByName("car_upgrades_plus_"+v,f),y.plus_init_pos=pa.copyPoint(y.plus_entity.position),y.plus_points_background_entity=bi.findEntityByName("car_upgrades_plus_points_background"+g,m),y.plus_points_text=Ra.createBitmapText(cn.tw_cen_mt_condensed_extra_bold_dark_29,36,"left","TEXT"),y.plus_points_text.anchor.x=.5,y.plus_points_text.anchor.y=.5,y.plus_points_text.position.x=y.plus_points_background_entity.position.x,y.plus_points_text.position.y=y.plus_points_background_entity.position.y,y.filled=[],d.push(y),++k}ri.buy_texture=Zs.getTexture("button_buy"),ri.select_texture=Zs.getTexture("button_select"),u.car_shop=new oi;var P=function(e,t,n,i,r){var a=bi.findEntityByName("name_tag_"+i,t);if(null!=a||(xl.trace("warning: name_tag_entity == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),0)){var s=bi.findEntityByName(i+"_full",t);if(null!=s||(xl.trace("warning: car_entity == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),0)){var l=new li;l.car_name=i,l.car_shop_name=r,l.car_entity=s,l.car_sprite=s.display.sprite,l.regular_texture=l.car_sprite.texture,Zs.doesTextureExist(l.car_name+"_locked")&&(l.locked_texture=Zs.getTexture(l.car_name+"_locked")),l.name_tag_entity=a;for(var o=0;o<n.length;){var _=n[o];if(++o,_.name==i){l.car_setting=_;break}}null==l.car_setting&&xl.trace("warning: car "+i+" has no car_setting",{fileName:"InterLevelMenuDo.hx",lineNumber:304,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),l.name_tag_text=Ra.createBitmapText(cn.bell_gothic_std_black_very_light_26,24,"left","TEXT"),l.name_tag_text.anchor.set(.5,.5),l.name_tag_coin=Ra.createSpriteByName("coin_pick",.5,.5),l.name_tag_coin.scale.x=.75,l.name_tag_coin.scale.y=.75,l.additional_sprites_added=!1,l.name_tag_text.position.x=l.name_tag_entity.position.x+10,l.name_tag_text.position.y=l.name_tag_entity.position.y,l.name_tag_coin.position.x=l.name_tag_entity.position.x,l.name_tag_coin.position.y=l.name_tag_entity.position.y,l.name_tag_entity.display.sprite.alpha=0,e.car_shop.cars.push(l)}}};P(u,t,r,"car_rudolf","Rudolf"),P(u,t,r,"car_bus","Folksgarden"),P(u,t,r,"car_farm_truck","Chickenship"),P(u,t,r,"car_semioval","Semioval"),P(u,t,r,"car_tourcycle","Tourcycle"),P(u,t,r,"car_ice_cream_truck","Coldwagon"),P(u,t,r,"car_bug","Bug"),P(u,t,r,"car_coyote","Coyote"),P(u,t,r,"car_cow","Cow"),P(u,t,r,"car_rider","Swordsman"),P(u,t,r,"car_taxi","Carrier"),ui.map_item_empty=Zs.getTexture("map_item_empty"),ui.map_item_empty_big=Zs.getTexture("map_item_empty_big"),ui.map_item_finished=Zs.getTexture("map_item_finished"),ui.map_item_finished100=Zs.getTexture("map_item_finished100"),ui.map_item_not_available=Zs.getTexture("map_item_not_available"),ui.map_item_challenge_locked=Zs.getTexture("map_item_challenge_locked"),ui.map_item_challenge_unlocked=Zs.getTexture("map_item_challenge_unlocked"),ui.map_item_challenge_completed=Zs.getTexture("map_item_challenge_completed"),u.level_map=new hi;for(var M=null,I=[],A=0,T=t.group.entities;A<T.length;){var D=T[A];++A,"level1"==D.name?M=D:"level"==D.name&&I.push(D)}var E=[],O=M;for(E.push(O);0<I.length;){for(var B=I[0],L=-1,j=0;j<I.length;){var F=I[j];++j;var R=pa.distance(O.position.x,O.position.y,F.position.x,F.position.y);(-1==L||R<L)&&(B=F,L=R)}s.remove(I,O=B),E.push(O)}for(var G=0,Z=null,U=0;U<E.length;){var V=E[U];++U;var q=new ui;q.entity=V,q.sprite=V.display.sprite,q.selected_circle=Ra.createSpriteByName("white_circle",.5,.5),q.selected_circle.position.x=q.entity.position.x,q.selected_circle.position.y=q.entity.position.y,q.selected_circle.width=2*q.sprite.width,q.selected_circle.height=2*q.sprite.height;for(var W=0,X=0;X<n.length;){var H=n[X];++X,H.description.level_number-1==G&&(q.level_save_index=W),++W}u.level_map.levels.push(q),q.previous_level=Z,Z=q,++G}for(var Y=0,J=0;J<n.length;){var K=n[J];if(++J,K.description.type==vr.LevelChallenge)for(var Q=0,$=t.group.entities;Q<$.length;){var ee=$[Q];if(++Q,ee.name==K.description.name){var te=new ui;te.level_save_index=Y;for(var ne=0;ne<o.length;){var ie=o[ne];if(++ne,ie.type==K.description.challenge_type){te.challenge_desc=ie;break}}null==te.challenge_desc&&xl.trace("warning: item.challenge_desc == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"create"}),te.entity=ee,te.sprite=ee.display.sprite,te.selected_circle=Ra.createSpriteByName("white_circle",.5,.5),te.selected_circle.position.x=te.entity.position.x,te.selected_circle.position.y=te.entity.position.y,te.selected_circle.width=2*te.sprite.width,te.selected_circle.height=2*te.sprite.height,u.level_map.levels.push(te);break}}++Y}return u},bi.tryToAddSpriteAfterThisDisplayObject=function(e,t,n,i,r,a,s){if(null==e||null==t)return null;var l=0,o=-1;if(null!=n){for(var _=0,p=t.all;_<p.length;){var u=p[_];if(++_,u.display_object==n){o=l;break}++l}-1==o&&xl.trace("warning: could not find index",{fileName:"InterLevelMenuDo.hx",lineNumber:479,className:"bikas.game.InterLevelMenuDo",methodName:"tryToAddSpriteAfterThisDisplayObject"})}var h=pa.clampInt(o+i,-1,t.all.length);return Ea.insertNewObjectToLiveTree(e,t,r,a,s,h)},bi.moveInterLevelMenuCamera=function(e,t){e.places[0],e.places[e.places.length-1];var n=e.scroll_target.x,i=e.nearest_place,r=0,a=n-i.marker.position.x;r=Math.abs(a)<=vi.snap_distance?0<t?e.places.indexOf(i)+1:e.places.indexOf(i)-1:0<t?a<=0?e.places.indexOf(i):e.places.indexOf(i)+1:a<=0?e.places.indexOf(i)-1:e.places.indexOf(i),r=pa.clampInt(r,0,e.places.length-1);var s=e.places[r];e.scroll_target.x=s.marker.position.x},bi.findInterLevelMenuNearestPlace=function(e){for(var t=e.scroll_target.x,n=e.places[0],i=0,r=e.places;i<r.length;){var a=r[i];++i,Math.abs(t-a.marker.position.x)<=Math.abs(t-n.marker.position.x)&&(n=a)}return n},bi.findPlaceByName=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.marker.name==t)return i}return null},bi.findPrefabEntityByName=function(e,t){for(var n=0,i=t.group.entities;n<i.length;){var r=i[n];if(++n,null!=r.prefab&&r.prefab.prefab_name==e)return r}return xl.trace("warning: couldn't find "+e,{fileName:"InterLevelMenuDo.hx",lineNumber:559,className:"bikas.game.InterLevelMenuDo",methodName:"findPrefabEntityByName"}),null},bi.findEntityByName=function(e,t){for(var n=0,i=t.group.entities;n<i.length;){var r=i[n];if(++n,r.name==e)return r}return xl.trace("warning: couldn't find "+e,{fileName:"InterLevelMenuDo.hx",lineNumber:569,className:"bikas.game.InterLevelMenuDo",methodName:"findEntityByName"}),null},bi.moveToIndex=function(e,t){return e!=t&&(-1==e||Math.abs(e-t)<.1?e=t:e<t?e+=.1:e-=.1),e},bi.isRectangularButtonDowned=function(e,t,n,i){if(null==n)return!1;if(!n.visible)return!1;if(0==n.alpha)return!1;var r=t.position.x+n.position.x-n.width*n.anchor.x-i/2,a=t.position.y+n.position.y-n.height*n.anchor.y-i/2,s=n.width*t.scale.x+i,l=n.height*t.scale.y+i;return!!Ha.isPointerObjectDownedRect(e,r,a,s,l)},bi.createConfirmationCard=function(e,t){var n=new _i;return n.container=Ra.createGroup(),n.background=Ra.createSpriteByName("map_card_background",0,0),n.bitmap_text=Ra.createBitmapText(cn.bell_gothic_std_black_dark_26,32,"center","TEXT"),n.text_background=Ra.createSpriteByName("map_card_text_background"),n.button_main=Ra.createSpriteByName(e,.5,.5),n.button_close=Ra.createSpriteByName("button_close"),n.text_background.anchor.x=.5,n.text_background.anchor.y=.5,n.text_background.position.x=n.background.width/2,n.text_background.position.y=100,n.bitmap_text.anchor.x=.5,n.bitmap_text.anchor.y=.5,n.bitmap_text.position.x=.5*n.background.width,n.bitmap_text.position.y=n.text_background.position.y,n.bitmap_text.text=t,n.button_main.position.x=n.background.width/2,n.button_main.position.y=n.background.height-n.button_main.height/2-35,n.button_close.anchor.x=vi.close_button_anchor_x,n.button_close.anchor.y=vi.close_button_anchor_y,n.button_close.position.x=n.background.width,n.button_close.position.y=0,n.container.add(n.background),n.container.add(n.text_background),n.container.add(n.bitmap_text),n.container.add(n.button_main),n.container.add(n.button_close),n},bi.processCardClick=function(e,t,n,i,r,a){null==a&&(a=!0);var s=Ha.getPointerDowned(e);if(null==s)return di.None;if(s.cancel_upped_and_clicked)return di.None;if(null!=i){var l=n.position.x+i.position.x,o=n.position.y+i.position.y,_=i.width/2*n.scale.x+vi.finger_radius/2;if(Ha.isPointerObjectDowned(l,o,s,_))return s.cancel_upped_and_clicked=!0,null!=n.parent&&n.parent.removeChild(n),ks.playSound(Os.sound_click,t),di.DownedCloseButton}if(null!=r&&(n.position.x,r.position.x,r.width,vi.finger_radius,n.position.y,r.position.y,r.height,vi.finger_radius,r.width,n.scale.x,vi.finger_radius,r.height,n.scale.y,vi.finger_radius,bi.isRectangularButtonDowned(s,n,r,vi.finger_radius)))return s.cancel_upped_and_clicked=!0,r.visible&&1==r.alpha&&ks.playSound(Os.sound_click,t),di.DownedMainButton;var p=n.position.x,u=n.position.y,h=p+n.width,c=u+n.height;return pa.pointInBoundedArea(s.current,p,u,h,c)?(s.cancel_upped_and_clicked=!0,di.DownedInside):(a&&(s.cancel_upped_and_clicked=!0,null!=n.parent&&n.parent.removeChild(n)),di.DownedOutside)},bi.processClosestObject=function(e,t,n,i,r,a,s,l,o,_,p,u){null==n&&(n=-1),null==t&&(t=-1),-1!=n&&t<=n&&(-1==e.distance||t<e.distance)&&(e.distance=t,e.entity=i,e.chest=r,e.achievement=a,e.upgrade_unit=s,e.car_in_shop=l,e.level_map_item=o,e.place=_,e.forward_button=p,e.backward_button=u)},bi.getClosestObjectToPointer=function(e,t){var n=new PIXI.Point(t.x,t.y),i=e.stage_group.group.container.toLocal(n,e.stage_group.group.container.parent),r=(vi.finger_radius,e.stage_group.group.container.scale.x,new mi);if(null!=e.forward_button){var a=pa.distance(t.x,t.y,e.forward_button.position.x,e.forward_button.position.y),s=e.forward_button.width/2;bi.processClosestObject(r,a,s,null,null,null,null,null,null,null,e.forward_button)}if(null!=e.backward_button){var l=pa.distance(t.x,t.y,e.backward_button.position.x,e.backward_button.position.y),o=Math.abs(e.backward_button.width/2);bi.processClosestObject(r,l,o,null,null,null,null,null,null,null,null,e.backward_button)}for(var _=0,p=e.stage_group.group.entities;_<p.length;){var u=p[_];if(++_,"some_entity_name_example"==u.name){var h=pa.distance(i.x,i.y,u.position.x,u.position.y),c=u.display.sprite.width/2;bi.processClosestObject(r,h,c,u)}}for(var d=0,m=e.chests;d<m.length;){var f=m[d];++d;var g=pa.distance(i.x,i.y,f.chest.x,f.chest.y),v=f.chest.width/2+vi.finger_radius/2;bi.processClosestObject(r,g,v,null,f)}for(var b=0,y=e.achievements;b<y.length;){var x=y[b];++b;var z=pa.distance(i.x,i.y,x.entity.position.x,x.entity.position.y),w=x.entity.display.sprite.width/2+vi.finger_radius/2,k=x.entity.display.sprite.height/2+vi.finger_radius/2;bi.processClosestObject(r,z,pa.max(w,k),null,null,x)}for(var S=0,C=e.upgrade_display.units;S<C.length;){var N=C[S];++S;var P=pa.distance(i.x,i.y,N.plus_entity.position.x,N.plus_entity.position.y),M=N.plus_entity.display.sprite.width/2+vi.finger_radius/2;bi.processClosestObject(r,P,M,null,null,null,N)}for(var I=0,A=e.car_shop.cars;I<A.length;){var T=A[I];++I;var D=pa.distance(i.x,i.y,T.car_entity.position.x,T.car_entity.position.y),E=T.car_entity.display.sprite.width/2+vi.finger_radius/2;bi.processClosestObject(r,D,E,null,null,null,null,T)}for(var O=0,B=e.level_map.levels;O<B.length;){var L=B[O];++O;var j=pa.distance(i.x,i.y,L.entity.position.x,L.entity.position.y),F=L.entity.display.sprite.width/2+vi.finger_radius/2;bi.processClosestObject(r,j,F,null,null,null,null,null,L)}for(var R=0,G=e.places;R<G.length;){var Z=G[R];++R;var U=Z.button.position.x-vi.finger_radius/2,V=Z.button.position.y-vi.finger_radius/2,q=U+Z.button.width+vi.finger_radius,W=V+Z.button.height+vi.finger_radius,X=(U+q)/2,H=(V+W)/2;if(pa.pointInBoundedArea(t,U,V,q,W)){var Y=pa.distance(t.x,t.y,X,H),J=Y+1;bi.processClosestObject(r,Y,J,null,null,null,null,null,null,Z)}}return 0<=r.distance?r:null},bi.updateAnimateNextTrigger=function(e,t,n){Math.abs(e.nearest_place.marker.position.x-e.scroll_target.x)<25?(-1==e.animate_forward_wait_time&&(e.animate_forward_wait_time=0),e.animate_forward_wait_time+=t.step_size,e.animate_forward_wait_time>n&&(e.animate_forward_button=!0)):e.animate_forward_wait_time=-1},bi.destroyRewardedAdMenu=function(e){null!=e.confirm_card&&(bi.destroyConfirmationCard(e.confirm_card),e.ad=null,e.confirm_card=null,e.closed=!0)},bi.clickChest=function(e,t){t.state=Wn.Opened,e.state=gi.InRewardSelection;var n=t.chest.toGlobal(new PIXI.Point(0,0)),i=e.stage_group.group.container.parent.toLocal(n);e.reward_display=new Yn,e.reward_display.reward_selection=null,e.reward_display.chest_position=new Yr(i.x,i.y),e.reward_display.chest=t},bi.clickRewardCard=function(e,t,n,i,r,a,l,o){r.chests--,bi.destroyChest(e,n.chest),s.remove(t.chests,n.chest),n.chest=null,n.chest_position=null,n.selected_card=i,n.selected_card_start_scale=n.selected_card.container.scale.x,n.state=Hn.RewardAnimateOut,n.current_time=0,wr.applyRewardItem(r,a,n.selected_card.item,l),ks.playSound(Os.sound_reward_select,o),t.trigger_game_save=!0},bi.clickUpgrade=function(e,t,n,i,r){"top_speed"==t?i.car_upgrades.top_speed++:"acceleration"==t?i.car_upgrades.acceleration++:"handling"==t?i.car_upgrades.handling++:"armor"==t&&i.car_upgrades.armor++,i.upgrade_points-=n,ks.playSound(Os.sound_upgrade,r,.6),e.trigger_game_save=!0},bi.clickAchievement=function(e,t,n,i,r,a,s){-1!=n.achievements_completed.indexOf(t.desc.id)&&-1==n.achievements_claimed.indexOf(t.desc.id)&&(n.achievements_claimed.push(t.desc.id),t.desc.item.desc.type==kr.AchievementLevel?e.level_map_next_level_save=a:wr.applyRewardItem(n,i,t.desc.item,r),ks.playSound(Os.sound_achievement_claimed,s),e.trigger_game_save=!0)},bi.clickLevel=function(e,t,n){e.state=gi.InFreeScroll,e.level_map_next_level_save=t,ks.playSound(Os.sound_level_select,n)},bi.createRequirementAndRewardCard=function(e,t,n,i,r,a,s,l,o,_,p,u,h,c,d,m,f){null==m&&(m=""),null==d&&(d="Reward"),null==c&&(c=""),null==h&&(h="."),null==u&&(u="Requirement");var g=new Jn;g.container=Ra.createGroup(),g.background=Ra.createSpriteByName(e,0,0),g.close_button=Ra.createSpriteByName("button_close"),null!=t&&(g.icon=Ra.createSpriteByName(t)),null!=n&&(g.main_button=Ra.createSpriteByName(n)),g.name_text=Ra.createBitmapText(cn.bell_gothic_std_black_dark_26,32,"center","TEXT"),g.requirement_text=Ra.createBitmapText(cn.avantgarde_lt_medium_dark_26,26,"left","TEXT"),g.reward_text=Ra.createBitmapText(cn.avantgarde_lt_medium_dark_26,26,"left","TEXT"),g.requirement_highlight=Ra.createSpriteByName("color_bar_yellow"),g.reward_highlight=Ra.createSpriteByName("color_bar_orange"),g.name_text.text=_,g.name_text.maxWidth=p,g.requirement_text.text=u+": ";var v=g.requirement_text.width,b=g.requirement_text.height+4;g.requirement_text.text+=c+h,g.reward_text.text=d+": ";var y=g.reward_text.width,x=g.reward_text.height+4;return g.reward_text.text+=m,g.close_button.anchor.x=vi.close_button_anchor_x,g.close_button.anchor.y=vi.close_button_anchor_y,g.close_button.position.x=g.background.width,g.close_button.position.y=0,null!=g.icon&&(g.icon.anchor.x=.5,g.icon.anchor.y=.5,g.icon.scale.x=1,g.icon.scale.y=1,null!=r&&(g.icon.position.x=r.x,g.icon.position.y=r.y)),null!=g.main_button&&(g.main_button.anchor.x=.5,g.main_button.anchor.y=.5,g.main_button.alpha=null!=i?i?1:vi.main_button_deactivated_alpha:1,null!=o&&(g.main_button.position.x=o.x,g.main_button.position.y=o.y)),g.name_text.anchor.x=.5,g.name_text.anchor.y=.5,g.name_text.position.x=a.x,g.name_text.position.y=a.y,g.requirement_highlight.width=v,g.requirement_highlight.height=b,g.requirement_highlight.anchor.x=g.requirement_text.anchor.x=0,g.requirement_highlight.anchor.y=g.requirement_text.anchor.y=0,g.requirement_highlight.position.x=g.requirement_text.position.x=s.x,g.requirement_highlight.position.y=g.requirement_text.position.y=s.y,g.requirement_text.maxWidth=f,g.reward_highlight.width=y,g.reward_highlight.height=x,g.reward_highlight.anchor.x=g.reward_text.anchor.x=0,g.reward_highlight.anchor.y=g.reward_text.anchor.y=0,g.reward_highlight.position.x=g.reward_text.position.x=l.x,g.reward_highlight.position.y=g.reward_text.position.y=l.y,g.reward_text.maxWidth=f,g.container.add(g.background),g.container.add(g.close_button),null!=g.icon&&g.container.add(g.icon),g.container.add(g.name_text),g.container.add(g.requirement_highlight),g.container.add(g.requirement_text),g.container.add(g.reward_highlight),g.container.add(g.reward_text),null!=g.main_button&&g.container.add(g.main_button),g},bi.destroyEntity=function(e,t,n){null!=e.body&&(s.remove(n,e),null!=e.body.get_space()&&e.body.set_space(null));for(var i=null,r=0,a=t.all_objects;r<a.length;){var l=a[r];++r,l.display_object==e.display.sprite&&(i=l)}null!=i&&Ea.destroyLiveObject(t,i,!1),oe.removeEntity(e),ie.destroyEntityIncludingChildren(e)},bi.destroyChest=function(e,t){Ea.destroyLiveObject(e,t.chest_partition_object,!0),t.chest_partition_object=null,t.chest=null},bi.destroyRewardDisplay=function(e){null!=e.reward_selection&&Fr.destroyRewardSelection(e.reward_selection),e.reward_selection=null,e.chest=null,e.chest_position=null,e.selected_card=null},bi.destroyAchievement=function(e){null!=e.card&&(bi.destroyRequirementAndRewardCard(e.card),e.card=null),null!=e.white_circle&&(e.white_circle.destroy(!0),e.white_circle=null)},bi.destroyUpgradeDisplay=function(e){for(var t=0,n=e.units;t<n.length;){var i=n[t];++t;for(var r=0,a=i.filled;r<a.length;){var s=a[r];++r,s.display_object.destroy(!0)}i.plus_points_text.destroy(!0),i.plus_points_text=null,i.unfilled_entity=null,i.fill_start_position=null,i.plus_entity=null,i.plus_init_pos=null,i.filled=null}e.prefab_entity=null,e.units=null},bi.destroyRequirementAndRewardCard=function(e){e.background.destroy(!0),e.close_button.destroy(!0),null!=e.icon&&(e.icon.destroy(!0),e.icon=null),null!=e.main_button&&(e.main_button.destroy(!0),e.main_button=null),e.name_text.destroy(!0),e.requirement_text.destroy(!0),e.reward_text.destroy(!0),e.requirement_highlight.destroy(!0),e.reward_highlight.destroy(!0),e.container.destroy(!0),e.background=null,e.close_button=null,e.icon=null,e.name_text=null,e.requirement_text=null,e.reward_text=null,e.requirement_highlight=null,e.reward_highlight=null,e.container=null},bi.destroyCarCard=function(e){for(var t=0,n=e.metrics;t<n.length;){var i=n[t];++t,i.background_bar.destroy(!0),i.foreground_bar.destroy(!0),i.text.destroy(!0),null!=i.green_or_red_bar&&i.green_or_red_bar.destroy(!0),i.container.destroy(!0),i.background_bar=null,i.foreground_bar=null,i.green_or_red_bar=null,i.text=null,i.container=null}e.metrics=null,e.background.destroy(!0),e.close_button.destroy(!0),e.main_button.destroy(!0),e.coin.destroy(!0),e.text.destroy(!0),e.background=null,e.close_button=null,e.main_button=null,e.coin=null,e.text=null,e.container.destroy(!0),e.container=null},bi.destroyCarInShop=function(e){e.name_tag_coin.destroy(!0),e.name_tag_text.destroy(!0),e.name_tag_coin=null,e.name_tag_text=null,e.name_tag_entity=null,(e.car_entity=null)!=e.card&&(bi.destroyCarCard(e.card),e.card=null)},bi.destroyConfirmationCard=function(e){e.background.destroy(!0),e.button_close.destroy(!0),e.button_main.destroy(!0),e.bitmap_text.destroy(!0),null!=e.container.parent&&e.container.parent.removeChild(e.container),e.container.destroy(!0),e.background=null,e.button_close=null,e.button_main=null,e.bitmap_text=null,e.container=null},bi.destroyLevelMapItem=function(e){e.entity=null,e.sprite=null,e.selected_circle.destroy(!0),null!=e.level_card&&(bi.destroyConfirmationCard(e.level_card),e.level_card=null),null!=e.challenge_card&&(bi.destroyRequirementAndRewardCard(e.challenge_card),e.challenge_card=null)},bi.destroyLevelMap=function(e){for(var t=0,n=e.levels;t<n.length;){var i=n[t];++t,bi.destroyLevelMapItem(i)}e.map_entity=null,e.levels=null},bi.destroy=function(e,t){if(null!=e.forward_button.parent&&(e.backward_button.parent.removeChild(e.backward_button),e.forward_button.parent.removeChild(e.forward_button)),null!=e.forward_button&&(e.backward_button.destroy(!0),e.forward_button.destroy(!0),e.backward_button=null,e.forward_button=null),null!=e.reward_display&&(bi.destroyRewardDisplay(e.reward_display),e.reward_display=null),null!=e.chests){for(var n=0,i=e.chests;n<i.length;){var r=i[n];++n,bi.destroyChest(t,r)}e.chests=null}if(null!=e.achievements){for(var a=0,s=e.achievements;a<s.length;){var l=s[a];++a,bi.destroyAchievement(l)}e.achievements=null}if(null!=e.upgrade_display&&(bi.destroyUpgradeDisplay(e.upgrade_display),e.upgrade_display.points_text.destroy(!0),e.upgrade_display.points_text=null,e.upgrade_display=null),null!=e.car_shop){for(var o=0,_=e.car_shop.cars;o<_.length;){var p=_[o];++o,bi.destroyCarInShop(p)}e.car_shop=null}if(null!=e.level_map&&(bi.destroyLevelMap(e.level_map),e.level_map=null),null!=e.places){for(var u=0,h=e.places;u<h.length;){var c=h[u];++u,c.button.destroy(!0)}e.places=null}null!=e.scroll_border&&(e.scroll_border.destroy(!0),e.scroll_border=null),null!=e.current_rewarded_ad_menu&&(bi.destroyRewardedAdMenu(e.current_rewarded_ad_menu),e.current_rewarded_ad_menu=null),e.down_menu_camera_position=null,e.down_point=null,e.scroll_target=null,e.stage_group=null,e.closest_click=null,e.available_descs=null},bi.update=function(e){var t=e.inter_level_menu;if(!t.in_ad){if(t.camera_smooth_steps_init_current_time<=vi.camera_smooth_steps_init_time){t.camera_smooth_steps_init_current_time+=e.step.step_size;var n=pa.clamp0to1(t.camera_smooth_steps_init_current_time/vi.camera_smooth_steps_init_time);e.camera.smooth_steps=ca.linear(vi.camera_smooth_steps_init,vi.camera_smooth_steps,n)}var i=Os.music_beach_waves;null!=i&&(ks.isMusicPlaying(i)||ks.fadeInMusic(i),ks.updateMusic(i,e.music_enabled));var r=Os.music_avocado_easy_times_in_hawaii;null!=r&&(ks.isMusicPlaying(r)||ks.fadeInMusic(r),ks.updateMusic(r,e.music_enabled)),bi.updateScrollButtons(e,t);var a=Ha.getPointerDown(e.pointer);bi.updateScrolling(e,t,a),bi.updatePointerInteractions(e,t,a),bi.updateChests(e,t),bi.updateAchievements(e,t),bi.updateUpgrades(e,t),bi.updateCarShop(e,t),bi.updateLevelMap(e,t),bi.updateRewardCardSelection(e,t),t.state==gi.InFreeScroll&&1==Xs.config.type&&3==Xs.config.release.sitelock_type&&bi.updateRewardedAds(t,e.menu_container,e.js_info,e.pointer,e.game_save,e.sounds_enabled)}},bi.updateScrollButtons=function(e,t){if(null!=t.places){if(null==t.forward_button.parent&&(e.menu_container.addAt(t.backward_button,0),e.menu_container.addAt(t.forward_button,0)),t.animate_forward_button){t.forward_button.texture!=vi.forward_button_go&&t.forward_button.setTexture(vi.forward_button_go),t.animate_forward_button_time+=e.step.step_size;var n=pa.clamp0to1(t.animate_forward_button_time/.6),i=ca.smoothForwardAndBackward(.8,1.1,n);t.forward_button.scale.x=i,t.forward_button.scale.y=i,1==n&&(t.animate_forward_button_time=0)}else t.forward_button.texture!=vi.forward_button_arrow&&t.forward_button.setTexture(vi.forward_button_arrow),t.forward_button.scale.x=1,t.forward_button.scale.y=1,t.animate_forward_button_time=0;t.forward_button.position.x=e.js_info.current_game_width-t.forward_button.texture.width/2,t.forward_button.position.y=e.js_info.current_game_height/2,t.backward_button.position.x=t.backward_button.texture.width/2,t.backward_button.position.y=e.js_info.current_game_height/2;var r=t.places.length,a=e.js_info.current_game_width;t.nearest_place=t.places[0];for(var s=0,l=t.places.length;s<l;){var o=s++,_=t.places[o];null==_.button.parent&&e.menu_container.addAt(_.button,0);var p=(o+0)/r,u=ca.linear(0,a,p),h=a-(ca.linear(0,a,(r-1)/r)+_.button.width);if(_.button.position.x=u+h/2,_.button.position.y=e.js_info.current_game_height-_.button.height-vi.place_button_space,Math.abs(e.camera.current_pos.get_x()-_.marker.position.x)<=Math.abs(e.camera.current_pos.get_x()-t.nearest_place.marker.position.x)&&(t.nearest_place=_),_.zoom_min!=_.zoom_max){var c=e.js_info.current_game_width/e.js_info.current_game_height,d=ca.getTClamped(1.7777777777777777,1.3333333333333333,c),m=ca.linear(t.nearest_place.zoom_min,t.nearest_place.zoom_max,d);m!=t.nearest_place.current_zoom&&(t.nearest_place.current_zoom=m)}}if(null!=t.scroll_border){null==t.scroll_border.parent&&e.menu_container.addAt(t.scroll_border,e.menu_container.children.length-1);var f,g=t.places.indexOf(t.nearest_place),v=pa.clampInt(g-1,0,t.places.length-1),b=pa.clampInt(g+1,0,t.places.length-1),y=t.places[v].marker.position.x,x=t.nearest_place.marker.position.x,z=t.places[b].marker.position.x,w=t.places[v].button.x,k=t.nearest_place.button.position.x,S=t.places[b].button.x;f=e.camera.current_pos.get_x()<y?0:e.camera.current_pos.get_x()>z?1:ca.getTFromABC(y,x,z,e.camera.current_pos.get_x());for(var C=ca.linearToABC(w,k,S,.5,f),N=-1.5,P=-1.5,M=0,I=t.places;M<I.length;){var A=I[M];++M,Math.abs(e.camera.current_pos.get_x()-A.marker.position.x)<100?(N=3,P=-6,0==g&&(P=-1),A.button.texture!=A.dark_texture&&A.button.setTexture(A.dark_texture)):A.button.texture!=A.normal_texture&&A.button.setTexture(A.normal_texture)}t.scroll_border.x=C+N,t.scroll_border.y=t.places[0].button.position.y+P,t.forward_button.alpha=g==b?.25:1,t.backward_button.alpha=g==v?.25:1}}},bi.updateScrolling=function(e,t,n){if(""!=vi.init_debug_scroll_location&&!t.scrolled_to_debug_location){var i=bi.findPlaceByName(t.places,vi.init_debug_scroll_location);null!=i&&(t.scroll_target.x=i.marker.position.x),t.scrolled_to_debug_location=!0}if(""==vi.init_debug_scroll_location&&!t.skipped_initial_locations){var r=!(t.skipped_initial_locations=!0);if(""!=e.game_save.previous_level_name)for(var a=0,s=e.game_save.level_saves;a<s.length;){var l=s[a];if(++a,l.description.name==e.game_save.previous_level_name){r=l.description.type==vr.LevelChallenge;break}}if(r)t.scroll_target.x=bi.findPlaceByName(t.places,vi.place_map).marker.position.x;else if(0==e.game_save.chests){t.scroll_target.x=bi.findPlaceByName(t.places,vi.place_achievements).marker.position.x;for(var o=!0,_=0,p=e.game_save.achievements_completed;_<p.length;){var u=p[_];if(++_,-1==e.game_save.achievements_claimed.indexOf(u)){o=!1;break}}o&&(t.scroll_target.x=bi.findPlaceByName(t.places,vi.place_upgrades).marker.position.x,0==e.game_save.upgrade_points&&(t.scroll_target.x=bi.findPlaceByName(t.places,vi.place_shop).marker.position.x))}e.menu_camera_position.x=t.scroll_target.x,e.camera.current_pos.set_x(e.menu_camera_position.x)}null==n?(t.downed=!1,t.dragging=!1):t.downed||(t.downed=!0,va.set(t.down_point,n.current)),(t.state==gi.InFreeScroll||t.state==gi.InMapScroll)&&t.downed&&!t.dragging&&Math.abs(n.current.x-t.down_point.x)>=vi.start_drag_distance&&(t.dragging=!0,t.seconds_before=e.step.level_seconds,va.set(t.down_menu_camera_position,e.menu_camera_position),va.set(t.down_point,n.current),t.scroll_start_place=t.nearest_place);var h=t.places[0].marker.position.x,c=t.places[t.places.length-1].marker.position.x;if(null!=n&&t.dragging){var d=n.current.x-t.down_point.x;t.scroll_target.x=t.down_menu_camera_position.x-d,t.scroll_target.x=pa.clamp(t.scroll_target.x,h-vi.max_scroll_to_sides,c+vi.max_scroll_to_sides);var m=e.step.level_seconds-t.seconds_before;d=pa.clamp(d,-vi.max_distance_for_speed,vi.max_distance_for_speed),t.current_speed=0<m?-d/m*vi.speed_coeff:0,t.current_speed=pa.clamp(t.current_speed,-vi.max_speed,vi.max_speed)}else{if(t.state==gi.InFreeScroll){if(t.animate_forward_button=!1,t.nearest_place.marker.name==vi.place_treasure?(0<t.chests.length&&(t.auto_scrolled_from_tresure_chests=!1),t.auto_scrolled_from_tresure_chests||0==t.chests.length&&0<=t.scroll_help_wait_time_stamp&&1.5<e.step.level_seconds-t.scroll_help_wait_time_stamp&&(Math.abs(t.nearest_place.marker.position.x-e.menu_camera_position.x)<25&&bi.moveInterLevelMenuCamera(t,1),t.scroll_help_wait_time_stamp=-1,t.auto_scrolled_from_tresure_chests=!0)):0==t.chests.length?0==e.game_save.chests&&(t.auto_scrolled_from_tresure_chests=!0):t.auto_scrolled_from_tresure_chests=!1,t.nearest_place.marker.name==vi.place_treasure&&0==t.chests.length&&bi.updateAnimateNextTrigger(t,e.step,1),t.nearest_place.marker.name==vi.place_achievements&&Math.abs(t.nearest_place.marker.position.x-t.scroll_target.x)<25){for(var f=!0,g=0,v=t.achievements;g<v.length;){var b=v[g];if(++g,null!=b.card){f=!1;break}if(null!=b.white_circle){f=!1;break}}f&&bi.updateAnimateNextTrigger(t,e.step,1)}t.nearest_place.marker.name==vi.place_upgrades&&(0==e.game_save.upgrade_points?bi.updateAnimateNextTrigger(t,e.step,1):bi.updateAnimateNextTrigger(t,e.step,5)),t.nearest_place.marker.name==vi.place_shop&&bi.updateAnimateNextTrigger(t,e.step,6)}if(t.scroll_target.x+=t.current_speed,t.current_speed*=vi.speed_decrease_coeff,Math.abs(t.current_speed)<1&&(t.current_speed=0),t.scroll_target.x=pa.clamp(t.scroll_target.x,h,c),Math.abs(t.current_speed)>=vi.speed_for_scroll_threshold&&null!=t.scroll_start_place){var y=t.places.indexOf(t.scroll_start_place);0<t.current_speed?++y:--y,y=pa.clampInt(y,0,t.places.length-1),t.scroll_target.x=t.places[y].marker.position.x,t.scroll_start_place=null,ks.playSound(Os.sound_swoosh,e.sounds_enabled)}}if(null!=t.scroll_target)if(e.menu_camera_position.x+=(t.scroll_target.x-e.menu_camera_position.x)*vi.scroll_speed_coeff,e.menu_camera_position.y+=(t.scroll_target.y-e.menu_camera_position.y)*vi.scroll_speed_coeff,t.state==gi.InMapScroll)t.map_zoom_wait_current_time-=e.step.step_size,t.map_zoom_wait_current_time<0&&(t.map_zoom_wait_current_time=0,e.camera.zoom_min=t.map_place.current_zoom,e.camera.zoom_max=t.map_place.current_zoom);else{var x=bi.findInterLevelMenuNearestPlace(t);Math.abs(t.scroll_target.x-x.marker.position.x)<=vi.snap_distance&&(t.scroll_target.x=x.marker.position.x);var z=e.menu_camera_position.x-x.marker.position.x,w=t.places.indexOf(x);z<0?--w:++w,w=pa.clampInt(w,0,t.places.length-1);var k=t.places[w],S=x.current_zoom,C=x.marker.position.y;if(k!=x){var N=ca.getT(k.marker.position.x,x.marker.position.x,e.menu_camera_position.x);S=ca.linear(k.current_zoom,x.current_zoom,N),C=ca.linear(k.marker.position.y,x.marker.position.y,N)}e.camera.zoom_min=S,e.camera.zoom_max=S,t.scroll_target.y=C}},bi.updatePointerInteractions=function(e,t,n){if(!t.dragging&&t.state==gi.InFreeScroll){null!=n?null==t.closest_down&&(t.closest_down=bi.getClosestObjectToPointer(t,n.current)):null!=t.closest_down&&(null!=t.closest_down.upgrade_unit&&t.closest_down.upgrade_unit.state==$n.Downed&&(t.closest_down.upgrade_unit.state=$n.None),t.closest_down=null);var i=Ha.getPointerClicked(e.pointer,vi.start_drag_distance);if(null!=i?null==t.closest_click&&(t.closest_click=bi.getClosestObjectToPointer(t,i.current)):t.closest_click=null,null!=t.closest_down&&null!=t.closest_down.upgrade_unit&&(t.closest_down.upgrade_unit.state=$n.Downed),null!=t.closest_click)if(ks.playSound(Os.sound_click,e.sounds_enabled),null!=t.closest_click.entity)t.closest_click.entity.name;else if(null!=t.closest_click.chest)t.closest_click.chest.state==Wn.Closed&&bi.clickChest(t,t.closest_click.chest);else if(null!=t.closest_click.achievement){for(var r=0,a=t.achievements;r<a.length;){var s=a[r];++r,s.state=Kn.Closed}t.closest_click.achievement.state=Kn.Opened,t.state=gi.InAchievementShow}else if(null!=t.closest_click.upgrade_unit)t.closest_click.upgrade_unit.state=$n.Clicked;else if(null!=t.closest_click.car_in_shop)-1==e.game_save.locked_cars.indexOf(t.closest_click.car_in_shop.car_name)&&(t.closest_click.car_in_shop.state=ai.Opened,t.state=gi.InCarBuyShow);else if(null!=t.closest_click.level_map_item){var l=null;if(0<=t.closest_click.level_map_item.level_save_index&&t.closest_click.level_map_item.level_save_index<e.game_save.level_saves.length&&(l=e.game_save.level_saves[t.closest_click.level_map_item.level_save_index]),null!=l){t.closest_click.level_map_item.state=pi.Opened,t.state=gi.InLevelMapItem;var o=t.closest_click.level_map_item.entity.display.sprite.toGlobal(new PIXI.Point(0,0)),_=t.stage_group.group.container.parent.toLocal(o);t.closest_click.level_map_item.click_position.x=_.x,t.closest_click.level_map_item.click_position.y=_.y}else null==l&&xl.trace("warning: level_save == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"updatePointerInteractions"})}else null!=t.closest_click.place?(t.scroll_target.x!=t.closest_click.place.marker.position.x&&ks.playSound(Os.sound_swoosh,e.sounds_enabled),t.scroll_target.x=t.closest_click.place.marker.position.x):null!=t.closest_click.forward_button?1==t.closest_click.forward_button.alpha&&(bi.moveInterLevelMenuCamera(t,1),t.nearest_place!=t.places[t.places.length-1]&&ks.playSound(Os.sound_swoosh,e.sounds_enabled)):null!=t.closest_click.backward_button&&1==t.closest_click.backward_button.alpha&&(bi.moveInterLevelMenuCamera(t,-1),t.nearest_place!=t.places[0]&&ks.playSound(Os.sound_swoosh,e.sounds_enabled))}},bi.updateChests=function(e,t){if(0<e.game_save.chests){var n=bi.findPlaceByName(t.places,"treasure").marker.position;if(99999<t.chests.length)return void xl.trace("warning: something went wrong with chest spwaning",{fileName:"InterLevelMenuDo.hx",lineNumber:2016,className:"bikas.game.InterLevelMenuDo",methodName:"updateChests"});if(t.chests.length<e.game_save.chests)for(var i=t.chests.length,r=e.game_save.chests;i<r;){i++;var a=new Xn;a.chest=Ra.createSprite(Xn.chest_closed_texture,.5,.5),a.chest.scale.x=Xn.scale,a.chest.scale.y=Xn.scale,a.current_time=pa.getRandomBetween(0,Xn.floating_time),t.chests.push(a)}for(var s=pa.minInt(t.chests.length,Xn.max_column_count),l=-(s-1)/2*Xn.x_distance,o=0,_=t.chests.length;o<_;){var p=o++,u=t.chests[p];u.additional_sprites_added||(u.chest_partition_object=bi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,null,-1,u.chest,!0),null!=u.chest_partition_object&&(u.additional_sprites_added=!0));var h=p%s,c=Math.floor(p/s);1==u.chest.alpha&&(u.current_time+=e.step.step_size,u.current_time>Xn.floating_time&&(u.current_time-=Xn.floating_time)),u.state==Wn.Closed?u.chest.texture!=Xn.chest_closed_texture&&(u.chest.setTexture(Xn.chest_closed_texture),u.chest.anchor.x=.5,u.chest.anchor.y=.5):u.state==Wn.Opened&&u.chest.texture!=Xn.chest_opened_texture&&(u.chest.setTexture(Xn.chest_opened_texture),u.chest.anchor.x=.5,u.chest.anchor.y=.6,ks.playSound(Os.sound_chest_open,e.sounds_enabled,.4));var d=pa.clamp(u.current_time/Xn.floating_time,0,1),m=ca.smoothForwardAndBackward(0,Xn.floating_distance,d),f=n.x+h*Xn.x_distance+l,g=n.y-c*Xn.y_distance-Xn.distance_from_ground-m;u.chest.position.x=f,u.chest.position.y=g}}},bi.updateAchievements=function(e,t){for(var n=0,i=t.achievements;n<i.length;){var r=i[n];++n;var a=!1;if(null!=r.white_circle&&null==r.white_circle_partition_object&&(r.white_circle_partition_object=bi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,null,-1,r.white_circle,!0)),-1!=e.game_save.achievements_completed.indexOf(r.desc.id))if(a=!0,-(r.entity.display.sprite.alpha=1)==e.game_save.achievements_claimed.indexOf(r.desc.id)){null==r.white_circle&&(r.white_circle=Ra.createSpriteByName("white_circle",.5,.5),r.white_circle.position.x=r.entity.position.x,r.white_circle.position.y=r.entity.position.y),r.white_circle_current_time+=e.step.step_size,r.white_circle_current_time>Qn.white_circle_animation_time&&(r.white_circle_current_time-=Qn.white_circle_animation_time);var s=r.white_circle_current_time/Qn.white_circle_animation_time,l=ca.smoothForwardAndBackward(Qn.white_circle_min_scale,Qn.white_circle_max_scale,s);r.white_circle.scale.x=l,r.white_circle.scale.y=l}else null!=r.white_circle_partition_object&&(Ea.destroyLiveObject(e.partition_top,r.white_circle_partition_object,!0),r.white_circle_partition_object=null,r.white_circle=null);else r.entity.display.sprite.alpha=Qn.locked_alpha,null!=r.white_circle_partition_object&&(Ea.destroyLiveObject(e.partition_top,r.white_circle_partition_object,!0),r.white_circle_partition_object=null,r.white_circle=null);if(r.state==Kn.Closed)null!=r.card&&(bi.destroyRequirementAndRewardCard(r.card),r.card=null);else if(r.state==Kn.Opened){if(null==r.card){var o=".";a&&(o=" (Achieved).");var _=r.card=bi.createRequirementAndRewardCard("achievement_card",r.desc.texture_name,null,null,new Yr(256.9,55),new Yr(256.9,140.4),new Yr(61,218),new Yr(61,328),null,r.desc.name,400,"Requirement",o,r.desc.requirement,"Reward",r.desc.item.description_text+".",400);e.menu_container.add(_.container)}var p=r.card;bi.clickAchievement(t,r,e.game_save,e.ongoing_powers_display,e.notifications,e.achievement_save,e.sounds_enabled),p.container.position.x=e.js_info.current_game_width/2-p.background.width/2,p.container.position.y=e.js_info.current_game_height/2-p.background.height/2;var u=bi.processCardClick(e.pointer,e.sounds_enabled,p.container,p.close_button,null);(u==di.DownedCloseButton||u==di.DownedOutside)&&(r.state=Kn.Closed,t.state=gi.InFreeScroll)}}},bi.updateUpgrades=function(e,t){if(null!=t.upgrade_display){var n=t.upgrade_display;n.additional_sprites_added||null!=bi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,n.points_background_entity.display.sprite,1,n.points_text,!1)&&(n.additional_sprites_added=!0);var i=e.game_save.upgrade_points+"p";if(n.points_text.text!=i&&(n.points_text.text=i),n.current_car_name!=e.game_save.current_car){n.current_car_name=e.game_save.current_car;var r=n.current_car_name+"_full";if(null==n.current_car){n.current_car=Ra.createSpriteByName(r,.5,1);var a=new PIXI.Rectangle(-500,-500,1500,1500);Ea.insertNewObjectToLiveTree(e.partition_top,e.entity_partition_container,n.current_car,!1,a,-1)}else n.current_car.setTexture(Zs.getTexture(r));n.current_car.position.x=n.car_location.position.x,n.current_car.position.y=n.car_location.position.y}for(var s=0,l=n.units;s<l.length;){var o=l[s];++s,o.additional_sprites_added||null!=bi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,o.plus_points_background_entity.display.sprite,1,o.plus_points_text,!1)&&(o.additional_sprites_added=!0);var _=!0,p=o.upgrade_point_costs.length,u=0;"top_speed"==o.name?u=e.game_save.car_upgrades.top_speed:"acceleration"==o.name?u=e.game_save.car_upgrades.acceleration:"handling"==o.name?u=e.game_save.car_upgrades.handling:"armor"==o.name&&(u=e.game_save.car_upgrades.armor);var h=!1;if(u<o.upgrade_point_costs.length){var c=o.upgrade_point_costs[u];_=!(p<=u)&&c<=e.game_save.upgrade_points}else h=!(_=!1);o.plus_points_background_entity.display.sprite.alpha=_?o.plus_entity.display.sprite.alpha=1:h?o.plus_entity.display.sprite.alpha=0:(o.plus_entity.display.sprite.alpha=.5,1),o.state==$n.Downed?_&&(o.plus_entity.position.x=o.plus_init_pos.x-5,o.plus_entity.position.y=o.plus_init_pos.y,he.refresh(o.plus_entity)):o.state==$n.Clicked&&(o.state=$n.None,_&&(bi.clickUpgrade(t,o.name,o.upgrade_point_costs[u],e.game_save,e.sounds_enabled),++u));var d;if(d=u<o.upgrade_point_costs.length?o.upgrade_point_costs[u]+"p":"",o.plus_points_text.text!=d&&(o.plus_points_text.text=d),o.state==$n.None&&(o.plus_entity.position.x=o.plus_init_pos.x,o.plus_entity.position.y=o.plus_init_pos.y,he.refresh(o.plus_entity)),o.filled.length<u){var m=Ra.createSpriteByName("car_upgrades_filled",0,0);m.position.x=o.unfilled_entity.position.x+o.fill_start_position.x+15*o.filled.length,m.position.y=o.unfilled_entity.position.y+o.fill_start_position.y;var f=bi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,o.unfilled_entity.display.sprite,1,m,!1);null!=f&&o.filled.push(f)}else if(o.filled.length>u){var g=o.filled.pop();Ea.destroyLiveObject(e.partition_top,g,!0)}}}},bi.updateCarShop=function(e,t){if(null!=t.car_shop){for(var n=0,i=0,r=e.game_save.level_saves;i<r.length;){var a=r[i];++i,a.description.type==vr.LevelRegular&&a.completed&&++n}10<=n&&-1!=e.game_save.locked_cars.indexOf("car_semioval")&&(s.remove(e.game_save.locked_cars,"car_semioval"),Gn.pushNotification(e.notifications,'Unlocked "Semioval" Car!',"")),20<=n&&-1!=e.game_save.locked_cars.indexOf("car_rider")&&(s.remove(e.game_save.locked_cars,"car_rider"),Gn.pushNotification(e.notifications,'Unlocked "Swordsman" Car!',""));for(var l=0,o=t.car_shop.cars;l<o.length;){var _=o[l];if(++l,_.additional_sprites_added||(null!=bi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,_.name_tag_entity.display.sprite,1,_.name_tag_text,!1)&&(_.additional_sprites_added=!0),bi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,_.name_tag_entity.display.sprite,2,_.name_tag_coin,!0)),-1!=e.game_save.car_own_list.indexOf(_.car_name)&&_.show_type!=si.Owned&&(_.name_tag_coin.visible=!1,_.name_tag_text.text=_.car_shop_name+": Own",_.show_type=si.Owned),-1!=e.game_save.car_own_list.indexOf(_.car_name)&&_.car_name==e.game_save.current_car&&_.show_type!=si.Selected&&(_.name_tag_coin.visible=!1,_.name_tag_text.text=_.car_shop_name+": Selected",_.show_type=si.Selected),-1==e.game_save.car_own_list.indexOf(_.car_name)&&_.show_type!=si.Priced){_.name_tag_coin.visible=!0;var p=_.car_setting.price+"";_.name_tag_text.text=_.car_shop_name+": "+p,_.name_tag_coin.position.x=_.name_tag_text.position.x+_.name_tag_text.width/2+_.name_tag_coin.width/2+5,_.show_type=si.Priced}if(-1!=e.game_save.locked_cars.indexOf(_.car_name)?(_.name_tag_coin.visible=!1,_.name_tag_text.text=_.car_shop_name+": Locked",_.show_type=si.Locked,null==_.locked_texture?xl.trace("warning: locked car does not have locked_texture "+_.car_name,{fileName:"InterLevelMenuDo.hx",lineNumber:2438,className:"bikas.game.InterLevelMenuDo",methodName:"updateCarShop"}):_.car_sprite.texture!=_.locked_texture&&_.car_sprite.setTexture(_.locked_texture)):_.car_sprite.texture!=_.regular_texture&&_.car_sprite.setTexture(_.regular_texture),_.show_type==si.Priced&&e.game_save.coins<_.car_setting.price||_.show_type==si.Locked?(_.name_tag_coin.alpha=.5,_.name_tag_text.alpha=.5,_.car_entity.display.sprite.alpha=.5):(_.name_tag_coin.alpha=1,_.name_tag_text.alpha=1,_.car_entity.display.sprite.alpha=1),_.state==ai.Opened){if(t.animate_forward_wait_time=0,null==_.card){var u=new ri,h=_.car_setting.price+"";u.container=Ra.createGroup(),u.background=Ra.createSpriteByName("shop_card",0,0),u.close_button=Ra.createSpriteByName("button_close"),u.main_button=Ra.createSpriteByName("button_buy",.5,.5),u.text=Ra.createBitmapText(cn.bell_gothic_std_black_dark_26,36,"left","TEXT",0,0),u.text_background=Ra.createSpriteByName("shop_card_name_background",.5,.5),u.coin=Ra.createSpriteByName("coin_pick",.5,.5);var c=function(e,t,n,i){var r=new ii;r.container=Ra.createGroup(),r.background_bar=Ra.createSpriteByName("color_bar_orange"),r.foreground_bar=Ra.createSpriteByName("color_bar_yellow"),r.text=Ra.createBitmapText(cn.bell_gothic_std_black_dark_26,26,"left","TEXT"),r.text.text=i;var a=wr.getCarSettingByName(e,t),s=wr.getCarSettingByName(e,n);if(null==a&&(xl.trace("warning: current_car_setting == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"updateCarShop"}),1))return null;if(null==s&&(xl.trace("warning: opened_car_setting == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.InterLevelMenuDo",methodName:"updateCarShop"}),1))return null;var l=0,o=0,_=0,p=0;"Acceleration"==i?(_=3.8,p=5.1,l=a.initial_config.drive_impulse,o=s.initial_config.drive_impulse):"Handling"==i?(_=0,p=2,l=a.initial_config.rotation_angular_impulse_coeff,o=s.initial_config.rotation_angular_impulse_coeff):"Armor"==i&&(_=-.2,p=1.2,l=a.initial_config.armor_coeff,o=s.initial_config.armor_coeff);var u=ca.getT(_,p,l),h=ca.getT(_,p,o);if(u<h?r.green_or_red_bar=Ra.createSpriteByName("color_bar_green"):h<u&&(r.green_or_red_bar=Ra.createSpriteByName("color_bar_red")),r.background_bar.anchor.x=0,r.background_bar.anchor.y=.5,r.foreground_bar.anchor.x=0,r.foreground_bar.anchor.y=.5,r.text.anchor.x=.5,r.text.anchor.y=.5,r.text.position.y=2,r.foreground_bar.x=-ri.metric_width/2,r.background_bar.x=-ri.metric_width/2,r.foreground_bar.width=h*ri.metric_width,r.foreground_bar.height=ri.metric_height,r.background_bar.width=ri.metric_width,r.background_bar.height=ri.metric_height,null!=r.green_or_red_bar){var c=h-u;r.green_or_red_bar.alpha=ri.metric_green_or_red_alpha,r.green_or_red_bar.width=ri.metric_width*Math.abs(c),r.green_or_red_bar.height=ri.metric_height,r.green_or_red_bar.anchor.x=0<c?1:0,r.green_or_red_bar.anchor.y=.5,r.green_or_red_bar.x=r.foreground_bar.x+r.foreground_bar.width}return r.container.add(r.background_bar),r.container.add(r.foreground_bar),null!=r.green_or_red_bar&&r.container.add(r.green_or_red_bar),r.container.add(r.text),r};u.metrics.push(c(e.car_settings,e.game_save.current_car,_.car_name,"Acceleration")),u.metrics.push(c(e.car_settings,e.game_save.current_car,_.car_name,"Handling")),u.metrics.push(c(e.car_settings,e.game_save.current_car,_.car_name,"Armor"));var d=0;_.show_type==si.Locked?(u.text.text=_.car_shop_name+" (Locked)",u.coin.visible=!1):_.show_type==si.Priced?(u.text.text=h+"",u.text.width,d=u.coin.width/2+5,u.text.text=_.car_shop_name+": "+h):_.show_type==si.Owned?(u.text.text=_.car_shop_name+" (Own)",u.coin.visible=!1):_.show_type==si.Selected&&(u.text.text=_.car_shop_name+" (Selected)",u.coin.visible=!1),u.close_button.anchor.x=vi.close_button_anchor_x,u.close_button.anchor.y=vi.close_button_anchor_y,u.close_button.position.x=u.background.width,u.close_button.position.y=0,u.main_button.position.x=u.background.width/2,u.main_button.position.y=u.background.height-75,u.text.anchor.x=.5,u.text.anchor.y=.5,u.text.position.x=.5*u.background.width,u.text.position.y=100,u.text_background.anchor.x=.5,u.text_background.anchor.y=.5,u.text_background.width=ri.metric_width,u.text_background.height=2*ri.metric_height,u.text_background.position.x=u.text.position.x,u.text_background.position.y=u.text.position.y,_.show_type==si.Priced?(u.coin.position.x=u.text.position.x+u.text.width/2+d,u.coin.position.y=u.text.position.y,u.coin.visible=!0):u.coin.visible=!1;for(var m=0,f=u.metrics.length;m<f;){var g=m++,v=u.metrics[g];v.container.x=u.background.width/2;var b=u.text_background.position.y+u.text_background.height/2+v.background_bar.height/2+ri.metric_offset;v.container.y=b+(v.background_bar.height+ri.metric_space)*g}u.container.add(u.background),u.container.add(u.close_button),u.container.add(u.main_button),u.container.add(u.text_background),u.container.add(u.text),u.container.add(u.coin);for(var y=0,x=u.metrics;y<x.length;){var z=x[y];++y,u.container.add(z.container)}e.menu_container.add(u.container),_.card=u}var w=_.card;_.show_type==si.Locked?(w.coin.visible=!1,w.main_button.visible=!1):_.show_type==si.Priced?(w.coin.visible=!0,w.main_button.visible=!0,w.main_button.texture!=ri.buy_texture&&w.main_button.setTexture(ri.buy_texture),_.car_setting.price<=e.game_save.coins?(w.main_button.alpha=1,w.state=ni.Buy):(w.main_button.alpha=vi.main_button_deactivated_alpha,w.state=ni.CantBuy)):_.show_type==si.Owned?(w.coin.visible=!1,w.main_button.visible=!0,w.main_button.texture!=ri.select_texture&&w.main_button.setTexture(ri.select_texture),w.state=ni.Select):_.show_type==si.Selected&&(w.coin.visible=!1,w.main_button.visible=!1,w.state=ni.AlreadySelected),w.container.position.x=e.js_info.current_game_width/2-w.container.width/2,w.container.position.y=e.js_info.current_game_height/2-w.container.height/2;var k=bi.processCardClick(e.pointer,e.sounds_enabled,w.container,w.close_button,w.main_button);k==di.DownedCloseButton?(_.state=ai.Closed,t.state=gi.InFreeScroll):k==di.DownedMainButton?(w.state!=ni.Select&&w.state!=ni.Buy||(w.container.parent.removeChild(w.container),_.state=ai.Closed,t.state=gi.InFreeScroll),w.state==ni.Buy?(e.game_save.coins-=_.car_setting.price,e.game_save.current_car=_.car_name,e.game_save.car_own_list.push(_.car_name),ks.playSound(Os.sound_buy_car,e.sounds_enabled),t.trigger_game_save=!0):w.state==ni.Select&&(e.game_save.current_car=_.car_name,t.trigger_game_save=!0)):k==di.DownedOutside&&(_.state=ai.Closed,t.state=gi.InFreeScroll)}else _.state==ai.Closed&&null!=_.card&&(bi.destroyCarCard(_.card),_.card=null)}}},bi.updateLevelMap=function(e,t){if(null!=t.level_map)for(var n=0,i=t.level_map.levels;n<i.length;){var r=i[n];if(++n,r.selected_circle_added_to_partition||null!=bi.tryToAddSpriteAfterThisDisplayObject(e.partition_top,e.entity_partition_container,null,-1,r.selected_circle,!0)&&(r.selected_circle_added_to_partition=!0),0<=r.level_save_index&&r.level_save_index<e.game_save.level_saves.length){var a=e.game_save.level_saves[r.level_save_index];if(r.could_be_next_level=!1,!a.completed)if(null==r.previous_level)r.could_be_next_level=!0;else{var s=null;0<=r.previous_level.level_save_index&&r.previous_level.level_save_index<e.game_save.level_saves.length&&(s=e.game_save.level_saves[r.previous_level.level_save_index]),null!=s&&s.completed&&(r.could_be_next_level=!0)}a.description.available_in_final_game||(r.could_be_next_level=!1),a.description.type==vr.LevelRegular?a.description.available_in_final_game?a.completed&&100==a.completion_percent?r.sprite.texture!=ui.map_item_finished100&&r.sprite.setTexture(ui.map_item_finished100):a.completed?r.sprite.texture!=ui.map_item_finished&&r.sprite.setTexture(ui.map_item_finished):r.could_be_next_level?r.sprite.texture!=ui.map_item_empty_big&&r.sprite.setTexture(ui.map_item_empty_big):r.sprite.texture!=ui.map_item_empty&&r.sprite.setTexture(ui.map_item_empty):r.sprite.texture!=ui.map_item_not_available&&r.sprite.setTexture(ui.map_item_not_available):a.description.type==vr.LevelChallenge&&(-1!=e.game_save.challenges_completed.indexOf(r.challenge_desc.id)?r.sprite.texture!=ui.map_item_challenge_completed&&r.sprite.setTexture(ui.map_item_challenge_completed):-1!=e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)?r.sprite.texture!=ui.map_item_challenge_unlocked&&r.sprite.setTexture(ui.map_item_challenge_unlocked):r.sprite.texture!=ui.map_item_challenge_locked&&r.sprite.setTexture(ui.map_item_challenge_locked));var l=1;if(r.state==pi.Opened)l=1,r.selected_circle.visible=!0;else if(r.state==pi.Closed){if(a.description.type==vr.LevelRegular)if(r.could_be_next_level){r.current_time+=e.step.step_size;var o=pa.clamp0to1(r.current_time/ui.scale_anim_time);l=ca.smoothForwardAndBackward(.9,1.1,o),1==o&&(r.current_time=0)}else l=1;else if(a.description.type==vr.LevelChallenge)if(-1!=e.game_save.challenges_completed.indexOf(r.challenge_desc.id)||-1==e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)||r.animate_in)r.animate_in||(l=1);else{r.current_time+=e.step.step_size;var _=pa.clamp0to1(r.current_time/ui.scale_anim_time);l=ca.smoothForwardAndBackward(1,1.1,_),1==_&&(r.current_time=0)}r.selected_circle.visible=!1}if(r.animate_in){r.current_time+=e.step.step_size;var p=pa.clamp0to1(r.current_time/ui.animate_in_time);l=ca.smoothForwardAndBackward(1,ui.animate_in_start_scale,p),1==p&&(r.animate_in=!1)}if(r.entity.transform.scale_x!=l&&(r.entity.transform.scale_x=l,r.entity.transform.scale_y=l,me.refresh(r.entity)),r.state==pi.Opened){if(null==r.level_card&&a.description.type==vr.LevelRegular){var u="Level "+a.description.level_number+"\n";u+=a.description.nice_name,a.completed&&(u+="\nScore: "+a.completion_percent+"%"),a.description.available_in_final_game||(u="Not available \nin Demo :)"),r.level_card=bi.createConfirmationCard("button_go",u),e.menu_container.add(r.level_card.container)}if(null!=r.level_card){var h=r.level_card;(a.completed||r.could_be_next_level)&&a.description.available_in_final_game?h.button_main.visible=!0:h.button_main.visible=!1,r.click_position.x<=e.js_info.current_game_width/2?h.container.position.x=r.click_position.x+40:h.container.position.x=r.click_position.x-40-h.background.width,h.container.position.y=r.click_position.y-h.container.height/2;var c=bi.processCardClick(e.pointer,e.sounds_enabled,h.container,h.button_close,h.button_main);c==di.DownedCloseButton?(r.state=pi.Closed,t.state=gi.InFreeScroll):c==di.DownedMainButton?(h.container.parent.removeChild(h.container),r.state=pi.Closed,t.state=gi.InFreeScroll,(a.completed||r.could_be_next_level)&&bi.clickLevel(t,a,e.sounds_enabled)):c==di.DownedOutside&&(r.state=pi.Closed,t.state=gi.InFreeScroll)}if(null==r.challenge_card&&a.description.type==vr.LevelChallenge){var d=r.challenge_desc.name;a.description.available_in_final_game?-1!=e.game_save.challenges_completed.indexOf(r.challenge_desc.id)?d+=" (Completed)":-1!=e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)?d+=" (Unlocked)":d+=" (Locked)":d+=" (Not Available in Demo)";var m=-1!=e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)&&a.description.available_in_final_game,f=r.challenge_desc.item.description_text+".";r.challenge_card=bi.createRequirementAndRewardCard("challenge_card",null,"button_go",m,null,new Yr(256.9,98.4),new Yr(58.4,219.6),new Yr(58.4,299.6),new Yr(256.6,449.1),d,380,"Unlock",".",r.challenge_desc.requirement,"Reward",f,400),e.menu_container.add(r.challenge_card.container)}if(null!=r.challenge_card){var g=r.challenge_card;g.container.position.x=e.js_info.current_game_width/2-g.background.width/2,g.container.position.y=e.js_info.current_game_height/2-g.background.height/2;var v=bi.processCardClick(e.pointer,e.sounds_enabled,g.container,g.close_button,g.main_button);v==di.DownedMainButton?-1!=e.game_save.challenges_unlocked.indexOf(r.challenge_desc.id)&&(g.container.parent.removeChild(g.container),r.state=pi.Closed,bi.clickLevel(t,a,e.sounds_enabled)):(v==di.DownedCloseButton||v==di.DownedOutside)&&(r.state=pi.Closed,t.state=gi.InFreeScroll)}}else r.state==pi.Closed&&(null!=r.level_card&&(bi.destroyConfirmationCard(r.level_card),r.level_card=null),null!=r.challenge_card&&(bi.destroyRequirementAndRewardCard(r.challenge_card),r.challenge_card=null))}}},bi.updateRewardCardSelection=function(e,t){if(t.state==gi.InRewardSelection){var n=t.reward_display,i=e.js_info.current_game_width/2,r=e.js_info.current_game_height/2;if(null==n.reward_selection&&(t.available_descs.length<Math.round(e.chest_reward_item_descs.length/2)&&(t.available_descs=e.chest_reward_item_descs.slice()),n.reward_selection=Fr.createRewardSelection(e.js_info,t.available_descs,0),e.menu_container.add(n.reward_selection.container),n.state=Hn.RewardAnimateIn,n.current_time=-Yn.wait_in_time,ks.playSound(Os.sound_reward_phase_in,e.sounds_enabled)),n.reward_selection.background.width!=e.js_info.current_game_width&&(n.reward_selection.background.width=e.js_info.current_game_width),n.reward_selection.background.height!=e.js_info.current_game_height&&(n.reward_selection.background.height=e.js_info.current_game_height),n.state==Hn.RewardAnimateIn){n.current_time+=e.step.step_size;var a=pa.clamp0to1(n.current_time/Yn.anim_in_time),s=ca.smoothStartEnd(0,1,a);n.reward_selection.container.alpha=s,n.reward_selection.middle_container.scale.x=s,n.reward_selection.middle_container.scale.y=s,n.chest.chest.alpha=ca.linear(1,.5,a);var l=ca.linear(n.chest_position.x,i,s),o=ca.linear(n.chest_position.y,r,s);n.reward_selection.middle_container.x=l,n.reward_selection.middle_container.y=o,1==a&&(n.state=Hn.RewardSelect)}if(n.state==Hn.RewardSelect){n.reward_selection.middle_container.x=i,n.reward_selection.middle_container.y=r;var _=Ha.getPointerClicked(e.pointer,vi.start_drag_distance);if(null!=_){for(var p=null,u=-1,h=0,c=n.reward_selection.cards;h<c.length;){var d=c[h];++h;var m,f=n.reward_selection.middle_container.x+d.container.x-d.container.width/2,g=n.reward_selection.middle_container.y+d.container.y-d.container.height/2,v=f+d.container.width,b=g+d.container.height;m=pa.pointInBoundedArea(_.current,f,g,v,b)?0:pa.distanceBetweenPointAndBoundedArea(_.current,f,g,v,b),(null==p||m<u)&&(u=m,p=d)}null!=p&&u<=vi.finger_radius&&(t.scroll_help_wait_time_stamp=e.step.level_seconds,bi.clickRewardCard(e.partition_top,t,n,p,e.game_save,e.ongoing_powers_display,e.notifications,e.sounds_enabled))}}if(n.state==Hn.RewardAnimateOut){n.current_time+=e.step.step_size;var y=pa.clamp0to1(n.current_time/Yn.anim_out_time);n.reward_selection.container.alpha=1-y;var x=ca.linear(n.selected_card_start_scale,1.2,y);n.selected_card.container.scale.x=x,n.selected_card.container.scale.y=x,1==y&&(bi.destroyRewardDisplay(n),t.reward_display=null,t.state=gi.InFreeScroll)}}},bi.updateRewardedAds=function(e,t,n,i,r,a){if(null==e.current_rewarded_ad_menu){var s=wr.getTotalRegularLevelsCompleted(r);if(2<=s){for(var l=-1,o=0,_=0,p=0,u=r.rewarded_ads;p<u.length;){var h=u[p];++p,h.levels_completed>l&&(l=h.levels_completed),0!=h.type&&(2==h.type?++o:1==h.type&&++_)}var c=!1;o<5&&3<=s-l&&1==e.initial_chest_count&&(c=!0);c||_<5&&3<=s-l&&null!=e.nearest_place&&e.nearest_place.marker.name==vi.place_shop&&!0}}if(null!=e.current_rewarded_ad_menu&&!e.current_rewarded_ad_menu.closed){var d=e.current_rewarded_ad_menu.confirm_card,m=(ka.getTimer()-e.current_rewarded_ad_menu.show_time_stamp)/1e3;m=pa.clamp(m,0,30),d.bitmap_text.text=e.current_rewarded_ad_menu.text+" ("+Math.round(30-m)+")",d.container.position.x=n.current_game_width/2-d.background.width/2,d.container.position.y=n.current_game_height/3-d.background.height/2;var f=bi.processCardClick(i,a,d.container,d.button_close,d.button_main,!1);30<=m&&(f=di.DownedCloseButton),f==di.DownedCloseButton?(e.current_rewarded_ad_menu.closed=!0,bi.destroyRewardedAdMenu(e.current_rewarded_ad_menu)):f==di.DownedMainButton?(e.current_rewarded_ad_menu.closed=!0,e.in_ad=!0,Ya.PokiSDK.rewardedBreak().then((function(t){e.in_ad=!1,e.current_rewarded_ad_menu.ad.type=e.current_rewarded_ad_menu.reward_ad_type,2==e.current_rewarded_ad_menu.ad.type?r.chests+=3:1==e.current_rewarded_ad_menu.ad.type?r.coins+=50:xl.trace("warning: unhandled ad.type "+e.current_rewarded_ad_menu.ad.type,{fileName:"InterLevelMenuDo.hx",lineNumber:3288,className:"bikas.game.InterLevelMenuDo",methodName:"updateRewardedAds"}),bi.destroyRewardedAdMenu(e.current_rewarded_ad_menu),e.trigger_game_save=!0}))):di.DownedOutside}};var yi=function(e,t,n,i,r,a){null==a&&(a=-1),null==r&&(r=1),null==i&&(i=-1),null==n&&(n=1),null==t&&(t=-1),null==e&&(e=1),(this.zpp_inner=null)==xi.zpp_pool?this.zpp_inner=new xi:(this.zpp_inner=xi.zpp_pool,xi.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.alloc(),(this.zpp_inner.outer=this).set_collisionGroup(e),this.set_collisionMask(t),this.set_sensorGroup(n),this.set_sensorMask(i),this.set_fluidGroup(r),this.set_fluidMask(a)};(n["nape.dynamics.InteractionFilter"]=yi).__name__=["nape","dynamics","InteractionFilter"],yi.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=rc.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},get_collisionGroup:function(){return this.zpp_inner.collisionGroup},set_collisionGroup:function(e){return this.get_collisionGroup()!=e&&(this.zpp_inner.collisionGroup=e,this.zpp_inner.invalidate()),this.get_collisionGroup()},get_collisionMask:function(){return this.zpp_inner.collisionMask},set_collisionMask:function(e){return this.get_collisionMask()!=e&&(this.zpp_inner.collisionMask=e,this.zpp_inner.invalidate()),this.get_collisionMask()},get_sensorGroup:function(){return this.zpp_inner.sensorGroup},set_sensorGroup:function(e){return this.get_sensorGroup()!=e&&(this.zpp_inner.sensorGroup=e,this.zpp_inner.invalidate()),this.get_sensorGroup()},get_sensorMask:function(){return this.zpp_inner.sensorMask},set_sensorMask:function(e){return this.get_sensorMask()!=e&&(this.zpp_inner.sensorMask=e,this.zpp_inner.invalidate()),this.get_sensorMask()},get_fluidGroup:function(){return this.zpp_inner.fluidGroup},set_fluidGroup:function(e){return this.get_fluidGroup()!=e&&(this.zpp_inner.fluidGroup=e,this.zpp_inner.invalidate()),this.get_fluidGroup()},get_fluidMask:function(){return this.zpp_inner.fluidMask},set_fluidMask:function(e){return this.get_fluidMask()!=e&&(this.zpp_inner.fluidMask=e,this.zpp_inner.invalidate()),this.get_fluidMask()},shouldCollide:function(e){return this.zpp_inner.shouldCollide(e.zpp_inner)},shouldSense:function(e){return this.zpp_inner.shouldSense(e.zpp_inner)},shouldFlow:function(e){return this.zpp_inner.shouldFlow(e.zpp_inner)},copy:function(){return new yi(this.get_collisionGroup(),this.get_collisionMask(),this.get_sensorGroup(),this.get_sensorMask(),this.get_fluidGroup(),this.get_fluidMask())},toString:function(){return"{ collision: "+h.hex(this.get_collisionGroup(),8)+"~"+h.hex(this.get_collisionMask(),8)+" sensor: "+h.hex(this.get_sensorGroup(),8)+"~"+h.hex(this.get_sensorMask(),8)+" fluid: "+h.hex(this.get_fluidGroup(),8)+"~"+h.hex(this.get_fluidMask(),8)+" }"},__class__:yi,__properties__:{set_fluidMask:"set_fluidMask",get_fluidMask:"get_fluidMask",set_fluidGroup:"set_fluidGroup",get_fluidGroup:"get_fluidGroup",set_sensorMask:"set_sensorMask",get_sensorMask:"get_sensorMask",set_sensorGroup:"set_sensorGroup",get_sensorGroup:"get_sensorGroup",set_collisionMask:"set_collisionMask",get_collisionMask:"get_collisionMask",set_collisionGroup:"set_collisionGroup",get_collisionGroup:"get_collisionGroup",get_shapes:"get_shapes",get_userData:"get_userData"}};var xi=function(){this.fluidMask=0,this.fluidGroup=0,this.sensorMask=0,this.sensorGroup=0,this.collisionMask=0,this.collisionGroup=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.feature_cons(),this.collisionGroup=this.sensorGroup=this.fluidGroup=1,this.collisionMask=this.sensorMask=this.fluidMask=-1};(n["zpp_nape.dynamics.ZPP_InteractionFilter"]=xi).__name__=["zpp_nape","dynamics","ZPP_InteractionFilter"],xi.prototype={next:null,userData:null,outer:null,wrapper:function(){if(null==this.outer){this.outer=new yi;var e=this.outer.zpp_inner;e.free(),e.next=xi.zpp_pool,xi.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},shapes:null,wrap_shapes:null,feature_cons:function(){this.shapes=new Fu},addShape:function(e){this.shapes.add(e)},remShape:function(e){this.shapes.remove(e)},copy:function(){var e;return null==xi.zpp_pool?e=new xi:(e=xi.zpp_pool,xi.zpp_pool=e.next,e.next=null),e.alloc(),e.collisionGroup=this.collisionGroup,e.collisionMask=this.collisionMask,e.sensorGroup=this.sensorGroup,e.sensorMask=this.sensorMask,e.fluidGroup=this.fluidGroup,e.fluidMask=this.fluidMask,e},collisionGroup:null,collisionMask:null,shouldCollide:function(e){return 0!=(this.collisionMask&e.collisionGroup)&&0!=(e.collisionMask&this.collisionGroup)},sensorGroup:null,sensorMask:null,shouldSense:function(e){return 0!=(this.sensorMask&e.sensorGroup)&&0!=(e.sensorMask&this.sensorGroup)},fluidGroup:null,fluidMask:null,shouldFlow:function(e){return 0!=(this.fluidMask&e.fluidGroup)&&0!=(e.fluidMask&this.fluidGroup)},invalidate:function(){for(var e=this.shapes.begin();null!=e;)e.elem().invalidate_filter(),e=e.next},__class__:xi};var zi=function(){};(n["bikas.game.InteractionFilters"]=zi).__name__=["bikas","game","InteractionFilters"],zi.create=function(e,t){var n=function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n,0==i?t.push(!1):t.push(!0)}return t},i=zi.getAsBinary(n(e),!1),r=zi.getAsBinary(n(t),!0);return new yi(i,r)},zi.setFromBinary=function(e,t){for(var n=0,i=e.length;n<i;){var r=n++;e[r]=0!=(1<<r&t)}},zi.getAsBinary=function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=e.length;i<r;){var a=i++;e[a]==!t&&(n|=Math.round(Math.pow(2,a)))}return t&&(n=~n),n};var wi=n["bikas.game.PickableItemType"]={__ename__:["bikas","game","PickableItemType"],__constructs__:["PowerQuestion","Coin","Nitro","TreasureChest","BotJumpIndicator","AttachmentBalloons","AttachmentAnchor"]};wi.PowerQuestion=["PowerQuestion",0],wi.PowerQuestion.toString=i,(wi.PowerQuestion.__enum__=wi).Coin=["Coin",1],wi.Coin.toString=i,(wi.Coin.__enum__=wi).Nitro=["Nitro",2],wi.Nitro.toString=i,(wi.Nitro.__enum__=wi).TreasureChest=["TreasureChest",3],wi.TreasureChest.toString=i,(wi.TreasureChest.__enum__=wi).BotJumpIndicator=["BotJumpIndicator",4],wi.BotJumpIndicator.toString=i,(wi.BotJumpIndicator.__enum__=wi).AttachmentBalloons=["AttachmentBalloons",5],wi.AttachmentBalloons.toString=i,(wi.AttachmentBalloons.__enum__=wi).AttachmentAnchor=["AttachmentAnchor",6],wi.AttachmentAnchor.toString=i,(wi.AttachmentAnchor.__enum__=wi).__empty_constructs__=[wi.PowerQuestion,wi.Coin,wi.Nitro,wi.TreasureChest,wi.BotJumpIndicator,wi.AttachmentBalloons,wi.AttachmentAnchor];var ki=n["bikas.game.PickableItemState"]={__ename__:["bikas","game","PickableItemState"],__constructs__:["Normal","TransitionOut","Picked"]};ki.Normal=["Normal",0],ki.Normal.toString=i,(ki.Normal.__enum__=ki).TransitionOut=["TransitionOut",1],ki.TransitionOut.toString=i,(ki.TransitionOut.__enum__=ki).Picked=["Picked",2],ki.Picked.toString=i,(ki.Picked.__enum__=ki).__empty_constructs__=[ki.Normal,ki.TransitionOut,ki.Picked];var Si=function(){this.transition_out_current_time=0,this.shine_effect_current_pause_time=0,this.pickup_scale_current_time=0,this.picked_by_cars=[],this.distance_from_the_ground=0,this.ray_casted=!1,this.ray_cache=null,this.light_is_added=!1,this.radius=0,this.height=0,this.width=0,this.is_bad_item=!1,this.pickable=!0,this.only_one_character_can_pickup=!1};(n["bikas.game.PickableItem"]=Si).__name__=["bikas","game","PickableItem"],Si.prototype={type:null,state:null,only_one_character_can_pickup:null,pickable:null,is_bad_item:null,entity:null,width:null,height:null,radius:null,anim:null,light:null,light_is_added:null,position:null,coin_entity_container:null,ray_cache:null,ray_casted:null,distance_from_the_ground:null,picked_by_cars:null,pickup_scale_current_time:null,shine_effect_current_pause_time:null,transition_out_current_time:null,__class__:Si};var Ci=function(){};(n["bikas.game.ItemDo"]=Ci).__name__=["bikas","game","ItemDo"],Ci.createPickableItem=function(e,t){var n=new Si;return n.type=t,n.entity=e,n.width=n.entity.display.sprite.width,n.height=n.entity.display.sprite.height,n.radius=pa.max(n.width,n.height)/2,n.position=d_.get(n.entity.position.x,n.entity.position.y),n.state=ki.Normal,n.ray_cache=new p_(d_.get(),d_.get()),n.ray_cache.get_direction().set_x(0),n.ray_cache.get_direction().set_y(1),n.ray_casted=!1,t==wi.PowerQuestion?(n.anim=T.createAnimationUsingSprite(Os.animation_power_question,e.display.sprite),n.light=Ra.createSprite(Os.animation_power_question_light.frames[0].texture,.5,.5,0,0),n.light.position.x=n.entity.position.x,n.light.position.y=n.entity.position.y):t==wi.Coin?n.anim=T.createAnimationUsingSprite(Os.animation_coin_pick,e.display.sprite):t==wi.Nitro?n.anim=T.createAnimationUsingSprite(Os.animation_nitro_pick,e.display.sprite):t!=wi.TreasureChest&&(t==wi.BotJumpIndicator?(e.display.sprite.visible=!1,n.anim=null):t==wi.AttachmentBalloons||t==wi.AttachmentAnchor?(n.only_one_character_can_pickup=!0,n.is_bad_item=!0):xl.trace("warning: unhandled type "+p.string(t),{fileName:"ItemDo.hx",lineNumber:75,className:"bikas.game.ItemDo",methodName:"createPickableItem"})),n},Ci.destroyPickableItem=function(e){null!=e.anim&&(T.destroyAnimation(e.anim,!1),e.anim=null),null!=e.light&&(e.light.destroy(!0),e.light=null),null!=e.position&&(e.position.dispose(),e.position=null),null!=e.ray_cache&&(e.ray_cache.get_origin().dispose(),e.ray_cache.get_direction().dispose(),e.ray_cache=null),null!=e.position&&(e.position.dispose(),e.position=null),e.coin_entity_container=null,e.entity=null,e.position=null,e.picked_by_cars=null},Ci.getRandomAbility=function(e,t,n){if(1==n.length)return e[pa.getRandomBetweenInt(0,e.length-1)].type;for(var i=(n.length-n.indexOf(t)-1)/(n.length-1),r=0,a=0;a<e.length;){var s=e[a];++a,r+=ca.linear(s.first_car_multiplier,s.last_car_multiplier,i)}for(var l=r*Math.random(),o=0,_=0;_<e.length;){var p=e[_];if(++_,l<=(o+=ca.linear(p.first_car_multiplier,p.last_car_multiplier,i)))return p.type}return xl.trace("warning: something went wrong with probabilities",{fileName:"ItemDo.hx",lineNumber:136,className:"bikas.game.ItemDo",methodName:"getRandomAbility"}),ge.Armor},Ci.updatePickableItem=function(e,t,n,i,r,a){var s=t.ability_item_container,l=t.all_cars,o=t.bots,_=t.player,u=t.player_bot;if(!e.ray_casted){e.ray_casted=!0,e.ray_cache.get_origin().set_x(e.position.get_x()),e.ray_cache.get_origin().set_y(e.position.get_y());var h=n.rayCast(e.ray_cache,!1,zi.ray_to_ground);null!=h&&(e.distance_from_the_ground=h.get_distance(),h.dispose())}if(e.state==ki.Normal&&null!=e.entity.display.sprite.parent&&e.entity.display.sprite.visible){if(null!=e.light){if(!e.light_is_added&&null!=t.partition_top&&null!=t.entity_partition_container){for(var c=-1,d=0,m=0,f=t.entity_partition_container.all;m<f.length;){var g=f[m];++m,g.display_object==e.entity.display.sprite&&(c=d),++d}c=0,Ea.insertNewObjectToLiveTree(t.partition_top,t.entity_partition_container,e.light,!1,null,c),e.light_is_added=!0}e.light.rotation+=Math.PI/180*i}null!=e.anim&&(e.shine_effect_current_pause_time+=i,e.shine_effect_current_pause_time>=Si.shine_effect_total_pause_time&&(T.nextFrameStep(e.anim,i),0==e.anim.current_frame&&(e.shine_effect_current_pause_time=0)))}for(var v=0;v<l.length;){var b=l[v];if(++v,e.pickable){var y=b.main_body_position_x-e.entity.position.x,x=b.main_body_position_y-e.entity.position.y;if(!(500<y||y<-500)&&!(500<x||x<-500)&&Tt.doesWorldCircleTouchCarBounds(b,e.position,75)&&-1==e.picked_by_cars.indexOf(b)){e.picked_by_cars.push(b);var z=r+(Pe.transition_time+Pe.shuffle_time)/60;if(b==_.car)if(e.state!=ki.Normal&&xl.trace("warning: item state should be normal, because item is not yet picked by the player's car",{fileName:"ItemDo.hx",lineNumber:238,className:"bikas.game.ItemDo",methodName:"updatePickableItem"}),e.state=ki.TransitionOut,e.only_one_character_can_pickup&&(e.pickable=!1),e.type==wi.Coin)t.collected_in_level.coins++,ks.playSound(Os.sound_coin,a,.2);else if(e.type==wi.Nitro)_.abilities.nitro_power_charge+=1,ks.playSound(Os.sound_nitro_pick,a);else if(e.type==wi.TreasureChest)t.collected_in_level.chests_collected_guids.push(e.entity.guid),ks.playSound(Os.sound_treasure,a);else if(e.type==wi.PowerQuestion){T.gotoFrame(e.anim,0);var w=new PIXI.Point(0,0),k=new PIXI.Point(1,1);Ra.toGlobal(e.anim.sprite,w,k),Ra.toLocal(s,w,k),be.pickItem(_.ability_button,w,k,s,!1),_.abilities.current_ability=ge.None,_.abilities.received_ability=Ci.getRandomAbility(t.ability_probabilities,t.player.car,l),null!=u&&(u.abilities.bot_ability_receive_time_stamp=z),ks.playSound(Os.sound_power_pick2,a)}else e.type!=wi.BotJumpIndicator&&(e.type==wi.AttachmentBalloons?(Gn.spawnAttachment(t,t.partition_top,t.entity_partition_container,t.player.car,De.AttachmentBalloon,Ee.balloon_time),ks.playSound(Os.sound_balloons,a,.6)):e.type==wi.AttachmentAnchor&&(Gn.spawnAttachment(t,t.partition_top,t.entity_partition_container,t.player.car,De.AttachmentAnchor,Ee.balloon_time),ks.playSound(Os.sound_anchor,a)));else{e.only_one_character_can_pickup?(e.state=ki.TransitionOut,e.pickable=!1):e.pickup_scale_current_time=Si.pickup_scale_time;for(var S=null,C=0;C<o.length;){var N=o[C];if(++C,N.car==b){S=N;break}}null==S?xl.trace("warning: couldn't find a bot to which the car belongs to",{fileName:"ItemDo.hx",lineNumber:319,className:"bikas.game.ItemDo",methodName:"updatePickableItem"}):e.type==wi.PowerQuestion?(S.abilities.current_ability=ge.None,S.abilities.received_ability=Ci.getRandomAbility(t.ability_probabilities,S.car,l),S.abilities.bot_ability_receive_time_stamp=z):e.type==wi.Nitro?S.abilities.nitro_power_charge+=1:e.type!=wi.BotJumpIndicator&&(e.type==wi.AttachmentBalloons?Gn.spawnAttachment(t,t.partition_top,t.entity_partition_container,S.car,De.AttachmentBalloon,Ee.balloon_time):e.type==wi.AttachmentAnchor&&Gn.spawnAttachment(t,t.partition_top,t.entity_partition_container,S.car,De.AttachmentAnchor,Ee.balloon_time))}}}}if(e.state==ki.TransitionOut){e.transition_out_current_time+=i;var P=0;1<(P=e.type==wi.TreasureChest?e.transition_out_current_time/Si.transition_out_treasure_chest_total_time:e.transition_out_current_time/Si.transition_out_total_time)&&(P=1);var M=ca.linear(1,4,P),I=ca.linear(1,.4,P),A=1-P;e.type==wi.PowerQuestion?(e.light.alpha=A,e.light.scale.x=M,e.light.scale.y=M,e.anim.sprite.alpha=I):e.type==wi.Coin||e.type==wi.Nitro?(e.anim.sprite.alpha=A,e.entity.display.sprite.scale.x=M,e.entity.display.sprite.scale.y=M):e.type==wi.TreasureChest?(e.entity.display.sprite.alpha=A,e.entity.display.sprite.scale.x=M,e.entity.display.sprite.scale.y=M):e.type!=wi.BotJumpIndicator&&(e.type==wi.AttachmentBalloons||e.type==wi.AttachmentAnchor?(e.entity.display.sprite.alpha=A,e.entity.display.sprite.scale.x=M,e.entity.display.sprite.scale.y=M):xl.trace("warning: unhandled type "+p.string(e.type),{fileName:"ItemDo.hx",lineNumber:390,className:"bikas.game.ItemDo",methodName:"updatePickableItem"})),1==P&&(e.state=ki.Picked,null!=e.entity&&e.type!=wi.PowerQuestion&&(e.entity.display.sprite.visible=!1),null!=e.light&&(e.light.visible=!1))}if(0<e.pickup_scale_current_time){e.pickup_scale_current_time-=i;var D=e.pickup_scale_current_time/Si.pickup_scale_time;D<0&&(D=0);var E=ca.linearForwardAndBackward(1,1.3,1-D);null!=e.anim&&(e.anim.sprite.scale.x=E,e.anim.sprite.scale.y=E)}};var Ni=function(){};(n["bikas.game.KeyboardDo"]=Ni).__name__=["bikas","game","KeyboardDo"],Ni.isPressed=function(e,t){return-1!=e.indexOf(t)},Ni.isReleased=function(e,t){return-1!=e.indexOf(t)},Ni.isAnyPressed=function(e,t){for(var n=0;n<t.length;){var i=t[n];if(++n,-1!=e.indexOf(i))return!0}return!1},Ni.isAnyReleased=function(e,t){for(var n=0;n<t.length;){var i=t[n];if(++n,-1!=e.indexOf(i))return!0}return!1},Ni.updateKeyboard=function(e,t,n){"keydown"==n.type?-1==e.indexOf(n.keyCode)&&e.push(n.keyCode):"keyup"==n.type&&(-1!=e.indexOf(n.keyCode)&&s.remove(e,n.keyCode),-1==t.indexOf(n.keyCode)&&t.push(n.keyCode))};var Pi=function(){};(n["bikas.game.Indicator"]=Pi).__name__=["bikas","game","Indicator"],Pi.prototype={threshold:null,sprite:null,__class__:Pi};var Mi=n["bikas.game.LevelStatsState"]={__ename__:["bikas","game","LevelStatsState"],__constructs__:["StatsPlace","StatsStunts","StatsFinished","StatsWaiting"]};Mi.StatsPlace=["StatsPlace",0],Mi.StatsPlace.toString=i,(Mi.StatsPlace.__enum__=Mi).StatsStunts=["StatsStunts",1],Mi.StatsStunts.toString=i,(Mi.StatsStunts.__enum__=Mi).StatsFinished=["StatsFinished",2],Mi.StatsFinished.toString=i,(Mi.StatsFinished.__enum__=Mi).StatsWaiting=["StatsWaiting",3],Mi.StatsWaiting.toString=i,(Mi.StatsWaiting.__enum__=Mi).__empty_constructs__=[Mi.StatsPlace,Mi.StatsStunts,Mi.StatsFinished,Mi.StatsWaiting];var Ii=n["bikas.game.LevelStatsClickAction"]={__ename__:["bikas","game","LevelStatsClickAction"],__constructs__:["None","StatsClickRestart","StatsClickContinue"]};Ii.None=["None",0],Ii.None.toString=i,(Ii.None.__enum__=Ii).StatsClickRestart=["StatsClickRestart",1],Ii.StatsClickRestart.toString=i,(Ii.StatsClickRestart.__enum__=Ii).StatsClickContinue=["StatsClickContinue",2],Ii.StatsClickContinue.toString=i,(Ii.StatsClickContinue.__enum__=Ii).__empty_constructs__=[Ii.None,Ii.StatsClickRestart,Ii.StatsClickContinue];var Ai=function(){this.actual_chests_rewarded=0,this.want_to_reward_chests=0,this.final_level_percent=0,this.text_alpha_current_time=0,this.text_alpha_start=0,this.text_alpha_end=1,this.button_anim_current_scale_time=0,this.button_anim_current_time=0,this.already_animated_indicators=[],this.indicator_anim_target=null,this.indicator_anim_current_time=0,this.menu_in_anim_current_time=0,this.pause_time=0,this.current_time=0,this.wait=!1,this.happy_shown=!1,this.indicators=[],this.continue_available=!1,this.click_action=Ii.None,this.state=Mi.StatsPlace};(n["bikas.game.LevelStats"]=Ai).__name__=["bikas","game","LevelStats"],Ai.prototype={state:null,click_action:null,continue_available:null,container:null,bar_container:null,chest_container:null,background:null,stat_background:null,chest:null,chest_text:null,continue_button:null,restart_button:null,empty_bar:null,full_bar:null,indicators:null,above_bar_text:null,inside_bar_text:null,bar_line:null,percentage_text:null,happy_shown:null,bar_x:null,bar_y:null,bar_width:null,bar_height:null,wait:null,current_time:null,pause_time:null,menu_in_anim_current_time:null,indicator_anim_current_time:null,indicator_anim_target:null,already_animated_indicators:null,button_anim_current_time:null,button_anim_current_scale_time:null,text_alpha_end:null,text_alpha_start:null,text_alpha_current_time:null,final_level_percent:null,want_to_reward_chests:null,actual_chests_rewarded:null,__class__:Ai};var Ti=function(){};(n["bikas.game.LevelStatsDo"]=Ti).__name__=["bikas","game","LevelStatsDo"],Ti.create=function(){var e=new Ai;Ai.full_bar_red_texture=Zs.retrieveAsset("stat_full_bar_red"),Ai.full_bar_green_texture=Zs.retrieveAsset("stat_full_bar_green"),Ai.stat_indicator_empty=Zs.retrieveAsset("stat_indicator_empty"),Ai.stat_indicator_full=Zs.retrieveAsset("stat_indicator_full"),e.container=Ra.createGroup(),e.bar_container=Ra.createGroup(),e.chest_container=Ra.createGroup(),e.background=Ra.createSprite(Os.menu_background,0,0),e.background.position.x=-1,e.background.position.y=-1,e.container.add(e.background),e.stat_background=Ra.createSpriteByName("stat_background",0,0),e.continue_button=Ra.createSprite(Os.button_play,.5,.5),e.restart_button=Ra.createSprite(Os.button_restart,.5,.5),e.chest_text=new ps(Xs.game,0,0,cn.toonish_36,"",64),e.chest_text.anchor.x=.5,e.chest_text.anchor.y=.5,e.chest_text.text="0 x",e.chest=Ra.createSpriteByName("treasure_chest_closed",.5,.5),e.chest.scale.x=2,e.chest.scale.y=2,e.chest.x=e.chest.width/2-35,e.chest_text.x=-e.chest.width/2+35,e.chest_container.add(e.chest_text),e.chest_container.add(e.chest),e.empty_bar=Ra.createSpriteByName("stat_empty_bar",0,0),e.full_bar=Ra.createSprite(Ai.full_bar_red_texture,0,0);var t=function(e,t,n,i,r){var a=new Pi;return a.sprite=Ra.createSprite(Ai.stat_indicator_empty,.5,0),a.threshold=r,a.sprite.position.x=e+n*a.threshold,a.sprite.position.y=t+i,a};e.above_bar_text=new ps(Xs.game,0,0,cn.bell_gothic_std_black_light_26,"",42),e.above_bar_text.alpha=0,e.inside_bar_text=new ps(Xs.game,0,0,cn.bell_gothic_std_black_dark_26,"",42),e.inside_bar_text.alpha=0,e.bar_line=Ra.createSpriteByName("stat_bar_line",0,0),e.bar_line.alpha=0,e.percentage_text=new ps(Xs.game,0,0,cn.avantgarde_lt_medium_light_26,"0%",42),e.percentage_text.alpha=0;var n=e.bar_width=e.empty_bar.width,i=e.bar_height=e.empty_bar.height,r=e.bar_x=-n/2,a=e.bar_y=-i/2;e.indicators.push(t(r,a,n,i,.6*Ai.place_coeff)),e.indicators.push(t(r,a,n,i,.9)),e.empty_bar.position.x=r,e.empty_bar.position.y=a,e.full_bar.position.x=r+5.5,e.full_bar.position.y=a+5.5,e.full_bar.scale.x=0,e.full_bar.scale.y=1,e.percentage_text.x=r+n+10,e.percentage_text.y=a+i/2-e.percentage_text.height/2,e.bar_container.add(e.empty_bar),e.bar_container.add(e.full_bar);for(var s=0,l=e.indicators;s<l.length;){var o=l[s];++s,e.bar_container.add(o.sprite)}return e.bar_container.add(e.above_bar_text),e.bar_container.add(e.inside_bar_text),e.bar_container.add(e.bar_line),e.bar_container.add(e.percentage_text),e.container.add(e.stat_background),e.container.add(e.chest_container),e.container.add(e.bar_container),e.container.add(e.continue_button),e.container.add(e.restart_button),e},Ti.clickContinue=function(e,t,n,i){e.chests_rewarded=t.actual_chests_rewarded,n.chests+=e.chests_collected_guids.length+e.chests_rewarded,t.want_to_reward_chests=0,t.actual_chests_rewarded=0,t.click_action=Ii.StatsClickContinue,ks.playSound(Os.sound_click,i),xl.trace("click continue",{fileName:"LevelStatsDo.hx",lineNumber:189,className:"bikas.game.LevelStatsDo",methodName:"clickContinue"})},Ti.clickRestart=function(e,t){e.click_action=Ii.StatsClickRestart,ks.playSound(Os.sound_click,t)},Ti.remove=function(e){null!=e.container.parent&&e.container.parent.removeChild(e.container),e.state=Mi.StatsPlace,e.click_action=Ii.None,e.current_time=0,e.menu_in_anim_current_time=0},Ti.update=function(e,t,n,i,r,a,s,l,o,_,p,u,h){t.container.parent!=o&&(null!=t.container.parent&&t.container.parent.removeChild(t.container),o.add(t.container),t.current_time=0,t.menu_in_anim_current_time=0),0<Ai.test_overwrite_place&&(i=Ai.test_overwrite_place),0<Ai.test_overwrite_stunts&&(r=Ai.test_overwrite_stunts);var c=_.current_game_width+2,d=_.current_game_height+2;if(t.background.width==c&&t.background.height==d||(t.background.width=c,t.background.height=d),t.background.alpha!=Ai.background_alpha&&(t.background.alpha=Ai.background_alpha),0==t.current_time&&0==t.menu_in_anim_current_time){t.state=Mi.StatsPlace,t.click_action=Ii.None,t.bar_container.alpha=0,t.chest_container.alpha=0,t.chest_text.text="0 x",t.full_bar.width=0,t.above_bar_text.alpha=0,t.inside_bar_text.alpha=0,t.percentage_text.alpha=0,t.bar_line.alpha=0,t.pause_time=0,t.already_animated_indicators=[],t.wait=!1,t.button_anim_current_time=0,t.button_anim_current_scale_time=0,t.continue_button.alpha=0,t.restart_button.alpha=0,t.restart_button.scale.x=1,t.restart_button.scale.y=1,t.continue_button.scale.x=1,t.continue_button.scale.y=1,t.text_alpha_start=0,t.text_alpha_end=1,t.text_alpha_current_time=0,t.final_level_percent=-1,t.want_to_reward_chests=0,t.actual_chests_rewarded=0,t.menu_in_anim_current_time=u.step_size,t.happy_shown=!1;for(var m=0,f=t.indicators;m<f.length;){var g=f[m];++m,g.sprite.setTexture(Ai.stat_indicator_empty)}ks.playSound(Os.sound_menu_phase_in,h)}else if(t.menu_in_anim_current_time<=Ai.menu_in_time){t.menu_in_anim_current_time+=u.step_size;var v=pa.clamp0to1(t.menu_in_anim_current_time/Ai.menu_in_time),b=ca.linear(0,1,v),y=ca.smoothStart(Ai.menu_initial_scale,Ai.chest_scale,v),x=ca.smoothStart(Ai.menu_initial_scale,Ai.bar_scale,v);t.chest_container.alpha=b,t.chest_container.scale.x=y,t.chest_container.scale.y=y,t.stat_background.alpha=b,t.stat_background.scale.x=x,t.stat_background.scale.y=x,t.bar_container.alpha=b,t.bar_container.scale.x=x,t.bar_container.scale.y=x,t.pause_time=-Ai.pause_time_in_seconds}else{t.text_alpha_current_time+=u.step_size;var z=ca.linearClamped(t.text_alpha_start,t.text_alpha_end,t.text_alpha_current_time/Ai.text_alpha_time);t.above_bar_text.alpha=z,t.inside_bar_text.alpha=z,t.bar_line.alpha=z,t.percentage_text.alpha=1,t.pause_time<0?t.pause_time+=u.step_size:t.current_time+=u.step_size;var w=ca.linear(1/l,1,1-(i-1)/(l-1))*Ai.place_coeff,k=r*Ai.stunt_coeff;t.final_level_percent=Math.floor(100*(w+k));var S=Ai.bar_time_in_seconds,C=pa.clamp(t.current_time/S,0,1),N="",P="";t.state==Mi.StatsPlace?(N="Place",P=Ai.place_names[i],w<=C&&(C=w,t.wait?0<=t.pause_time&&(t.state=Mi.StatsStunts,t.wait=!1):(t.pause_time=-Ai.pause_time_in_seconds,t.wait=!0))):(N="Stunts",P=Math.round(100*r)+"%",t.state==Mi.StatsStunts?w+k<=C&&(C=w+k,t.wait?0<=t.pause_time&&(t.state=Mi.StatsFinished,t.wait=!1):(t.pause_time=-Ai.pause_time_in_seconds,t.wait=!0)):t.state==Mi.StatsFinished?(C=w+k,t.text_alpha_start=1,t.text_alpha_end=0,t.text_alpha_current_time=0,t.state=Mi.StatsWaiting):t.state==Mi.StatsWaiting&&(C=w+k)),t.inside_bar_text.text!=P&&(t.inside_bar_text.text=P),t.above_bar_text.text!=N&&(t.above_bar_text.text=N),(t.state==Mi.StatsPlace||t.state==Mi.StatsStunts)&&!t.wait&&0<C?ks.isMusicPlaying(Os.sound_loop_score)||ks.fadeInMusic(Os.sound_loop_score,.1):ks.isMusicPlaying(Os.sound_loop_score)&&ks.fadeOutMusic(Os.sound_loop_score,.1),ks.updateMusic(Os.sound_loop_score,h);var M=ca.linear(t.bar_x,t.bar_x+t.bar_width,C),I=Math.round(100*C)+"%";t.percentage_text.text!=I&&(100!=Math.round(100*C)||1!=Xs.config.type||3!=Xs.config.release.sitelock_type||t.happy_shown||(t.happy_shown=!0,Ya.PokiSDK.happyTime(.1)),t.percentage_text.text=I),t.above_bar_text.x=M-t.above_bar_text.width-20,t.above_bar_text.y=t.bar_y-t.above_bar_text.height-10,t.inside_bar_text.x=M-t.inside_bar_text.width-20,t.inside_bar_text.y=t.bar_y+t.bar_height/2-t.inside_bar_text.height/2,t.bar_line.x=ca.linear(t.bar_x,t.bar_x+t.bar_width,C),t.bar_line.y=t.bar_y+t.bar_height-t.bar_line.height,t.full_bar.scale.x=C;for(var A=function(e,t,n,i,r){if(n<=C){var a=e.indicators[i];if(-1==e.already_animated_indicators.indexOf(a)){e.indicator_anim_target=a,e.indicator_anim_current_time=0,e.already_animated_indicators.push(a),a.sprite.setTexture(Ai.stat_indicator_full),e.want_to_reward_chests+=1;var s=e.actual_chests_rewarded;e.actual_chests_rewarded=e.want_to_reward_chests,e.actual_chests_rewarded>s&&ks.playSound(Os.sound_treasure,r),ks.playSound(Os.sound_stat_threshold_pass,r)}}},T=0,D=t.indicators.length;T<D;){var E=T++;A(t,0,t.indicators[E].threshold-.0095,E,h)}var O=a.chests_collected_guids.length+t.actual_chests_rewarded+" x";if(t.chest_text.text!=O&&(t.chest_text.text=O),null!=t.indicator_anim_target){t.indicator_anim_current_time+=u.step_size;var B=pa.clamp(t.indicator_anim_current_time/Ai.indicator_anim_time,0,1),L=ca.smoothForwardAndBackward(1,Ai.indicator_anim_scale,B),j=ca.smoothForwardAndBackward(1,Ai.chest_anim_scale,B);t.indicator_anim_target.sprite.scale.x=L,t.indicator_anim_target.sprite.scale.y=L,t.chest.scale.x=j*Ai.chest_default_scale,t.chest.scale.y=j*Ai.chest_default_scale,t.chest_text.scale.x=j,t.chest_text.scale.y=j,1==B&&(t.indicator_anim_target=null)}var F=1;if(C>=t.indicators[0].threshold-.0095?t.full_bar.texture!=Ai.full_bar_green_texture&&t.full_bar.setTexture(Ai.full_bar_green_texture):t.full_bar.texture!=Ai.full_bar_red_texture&&t.full_bar.setTexture(Ai.full_bar_red_texture),t.state==Mi.StatsWaiting&&(t.above_bar_text.alpha=1,t.above_bar_text.x=t.bar_x,t.above_bar_text.text="Place: "+Ai.place_names[i]+", Stunts: "+Math.round(100*r)+"%",t.button_anim_current_time+=u.step_size,C>=t.indicators[0].threshold-.0095?t.continue_available=!0:t.continue_available=!1,F=pa.clamp(t.button_anim_current_time/Ai.button_anim_time,0,1),t.continue_available?t.continue_button.alpha=ca.linear(0,1,F):t.continue_button.alpha=ca.linear(0,Ai.continue_button_inactive_alpha,F),t.restart_button.alpha=ca.smoothStartEnd(0,1,F),t.continue_button.scale.x=Ai.button_scale,t.continue_button.scale.y=Ai.button_scale,t.restart_button.scale.x=Ai.button_scale,t.restart_button.scale.y=Ai.button_scale,1==F)){t.button_anim_current_scale_time+=u.step_size,t.button_anim_current_scale_time>=Ai.button_scale_anim_time&&(t.button_anim_current_scale_time=0);var R=pa.clamp(t.button_anim_current_scale_time/Ai.button_scale_anim_time,0,1),G=ca.smoothForwardAndBackward(Ai.button_scale,Ai.button_anim_scale,R);if(t.continue_available){if(t.continue_button.scale.x=G,t.continue_button.scale.y=G,t.restart_button.scale.x=Ai.button_scale,t.restart_button.scale.y=Ai.button_scale,Ni.isReleased(e.keyboard_keys_released,32))return void Ti.clickContinue(a,t,s,h);if(Gn.isObjectDownedInRadius(t.continue_button,p,80))return void Ti.clickContinue(a,t,s,h)}else t.restart_button.scale.x=G,t.restart_button.scale.y=G,t.continue_button.scale.x=Ai.button_scale,t.continue_button.scale.y=Ai.button_scale;if(Gn.isObjectDownedInRadius(t.restart_button,p,80))return void Ti.clickRestart(t,h)}}t.bar_container.position.x=_.current_game_width/2;var Z=_.current_game_height*Ai.bar_placement_y_coeff;t.bar_container.position.y=ca.linear(Z+Ai.bar_offset_middle_y,Z+Ai.bar_offset_top_y,t.restart_button.alpha),t.stat_background.position.x=_.current_game_width/2-t.stat_background.width/2,t.stat_background.position.y=_.current_game_height*Ai.bar_placement_y_coeff-t.stat_background.height/2,t.chest_container.position.x=_.current_game_width/2,t.chest_container.position.y=_.current_game_height/2+Ai.chest_offset_y,t.continue_button.position.x=_.current_game_width/2+Ai.distance_between_buttons/2,t.continue_button.position.y=t.bar_container.position.y+Ai.buttons_offset_y,t.restart_button.position.x=_.current_game_width/2-Ai.distance_between_buttons/2,t.restart_button.position.y=t.continue_button.position.y};var Di=n["bikas.game.MainMenuState"]={__ename__:["bikas","game","MainMenuState"],__constructs__:["StartZoomIn","ZoomingIn","PhasingInMenu","Idle"]};Di.StartZoomIn=["StartZoomIn",0],Di.StartZoomIn.toString=i,(Di.StartZoomIn.__enum__=Di).ZoomingIn=["ZoomingIn",1],Di.ZoomingIn.toString=i,(Di.ZoomingIn.__enum__=Di).PhasingInMenu=["PhasingInMenu",2],Di.PhasingInMenu.toString=i,(Di.PhasingInMenu.__enum__=Di).Idle=["Idle",3],Di.Idle.toString=i,(Di.Idle.__enum__=Di).__empty_constructs__=[Di.StartZoomIn,Di.ZoomingIn,Di.PhasingInMenu,Di.Idle];var Ei=n["bikas.game.MainMenuClickAction"]={__ename__:["bikas","game","MainMenuClickAction"],__constructs__:["ContinueTheGame","StartNewGame","None"]};Ei.ContinueTheGame=["ContinueTheGame",0],Ei.ContinueTheGame.toString=i,(Ei.ContinueTheGame.__enum__=Ei).StartNewGame=["StartNewGame",1],Ei.StartNewGame.toString=i,(Ei.StartNewGame.__enum__=Ei).None=["None",2],Ei.None.toString=i,(Ei.None.__enum__=Ei).__empty_constructs__=[Ei.ContinueTheGame,Ei.StartNewGame,Ei.None];var Oi=n["bikas.game.CreditsState"]={__ename__:["bikas","game","CreditsState"],__constructs__:["Opened","Closed"]};Oi.Opened=["Opened",0],Oi.Opened.toString=i,(Oi.Opened.__enum__=Oi).Closed=["Closed",1],Oi.Closed.toString=i,(Oi.Closed.__enum__=Oi).__empty_constructs__=[Oi.Opened,Oi.Closed];var Bi=n["bikas.game.GameSaveType"]={__ename__:["bikas","game","GameSaveType"],__constructs__:["LoadedGameNoSave","LoadedGameWithSave","ContinueGame"]};Bi.LoadedGameNoSave=["LoadedGameNoSave",0],Bi.LoadedGameNoSave.toString=i,(Bi.LoadedGameNoSave.__enum__=Bi).LoadedGameWithSave=["LoadedGameWithSave",1],Bi.LoadedGameWithSave.toString=i,(Bi.LoadedGameWithSave.__enum__=Bi).ContinueGame=["ContinueGame",2],Bi.ContinueGame.toString=i,(Bi.ContinueGame.__enum__=Bi).__empty_constructs__=[Bi.LoadedGameNoSave,Bi.LoadedGameWithSave,Bi.ContinueGame];var Li=n["bikas.game.TriggerGameType"]={__ename__:["bikas","game","TriggerGameType"],__constructs__:["None","ResumeGame","ContinueToFirstLevel","LoadGame","StartNewGame"]};Li.None=["None",0],Li.None.toString=i,(Li.None.__enum__=Li).ResumeGame=["ResumeGame",1],Li.ResumeGame.toString=i,(Li.ResumeGame.__enum__=Li).ContinueToFirstLevel=["ContinueToFirstLevel",2],Li.ContinueToFirstLevel.toString=i,(Li.ContinueToFirstLevel.__enum__=Li).LoadGame=["LoadGame",3],Li.LoadGame.toString=i,(Li.LoadGame.__enum__=Li).StartNewGame=["StartNewGame",4],Li.StartNewGame.toString=i,(Li.StartNewGame.__enum__=Li).__empty_constructs__=[Li.None,Li.ResumeGame,Li.ContinueToFirstLevel,Li.LoadGame,Li.StartNewGame];var ji=function(e,t,n){null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.z=n};(n["bikas.global.Point3"]=ji).__name__=["bikas","global","Point3"],ji.prototype={x:null,y:null,z:null,__class__:ji};var Fi=function(){this.current_time=0,this.clouds=[],this.yachts=[],this.new_game_card=null,this.credits_card=null,this.credits_state=Oi.Closed,this.all_buttons=[],this.credits_button=null,this.start_new_game_button=null,this.continue_button=null,this.button_group=null,this.logo_camera_marker=null,this.menu_camera_marker=null,this.trigger_game_type=Li.None,this.game_save=null,this.game_save_type=Bi.LoadedGameNoSave,this.in_ad=!1,this.click_action=Ei.None,this.state=Di.StartZoomIn};(n["bikas.game.MainMenu"]=Fi).__name__=["bikas","game","MainMenu"],Fi.prototype={state:null,click_action:null,in_ad:null,game_save_type:null,game_save:null,trigger_game_type:null,menu_camera_marker:null,logo_camera_marker:null,button_group:null,continue_button:null,start_new_game_button:null,credits_button:null,all_buttons:null,credits_state:null,credits_card:null,new_game_card:null,yachts:null,clouds:null,current_time:null,__class__:Fi};var Ri=function(){};(n["bikas.game.MainMenuDo"]=Ri).__name__=["bikas","game","MainMenuDo"],Ri.create=function(e,t,n){var i=new Fi;i.game_save_type=t,i.game_save=n,i.menu_camera_marker=Gn.findMarker(e,"menu camera"),i.logo_camera_marker=Gn.findMarker(e,"logo camera"),i.button_group=Ra.createGroup(),i.continue_button=null!=n?Ra.createSpriteByName("button_continue",.5,0):null,i.start_new_game_button=Ra.createSpriteByName("button_new_game",.5,0),i.credits_button=Ra.createSpriteByName("button_credits",.5,0),null!=i.continue_button?(i.start_new_game_button.setTexture(Zs.getTexture("button_new_game")),i.all_buttons=[i.continue_button,i.start_new_game_button,i.credits_button]):(i.start_new_game_button.setTexture(Zs.getTexture("button_new_game_light")),i.all_buttons=[i.start_new_game_button,i.credits_button]);for(var r=0,a=i.all_buttons;r<a.length;){var s=a[r];++r,i.button_group.add(s)}return i.button_group.alpha=0,i},Ri.sortButtons=function(e){for(var t=0,n=e.all_buttons;t<n.length;){var i=n[t];++t,i.visible=!1}for(var r=-e.all_buttons.length/2*Fi.button_distance_y,a=0,s=e.all_buttons.length;a<s;){var l=a++,o=e.all_buttons[l];o.visible=!0,o.position.x=0,o.position.y=r+l*Fi.button_distance_y}},Ri.continueClick=function(e,t){e.game_save_type==Bi.LoadedGameNoSave?xl.trace("warning: continue button should not exist if menu.game_save_type == "+p.string(e.game_save_type),{fileName:"MainMenuDo.hx",lineNumber:120,className:"bikas.game.MainMenuDo",methodName:"continueClick"}):e.game_save_type==Bi.LoadedGameWithSave?null==e.game_save?xl.trace("warning: menu.game_save == null",{fileName:"MainMenuDo.hx",lineNumber:124,className:"bikas.game.MainMenuDo",methodName:"continueClick"}):(ks.playSound(Os.sound_level_select,t),e.trigger_game_type=Li.LoadGame):e.game_save_type==Bi.ContinueGame?e.trigger_game_type=Li.ResumeGame:xl.trace("warning: unhandled "+p.string(e.game_save_type),{fileName:"MainMenuDo.hx",lineNumber:134,className:"bikas.game.MainMenuDo",methodName:"continueClick"})},Ri.destroy=function(e){e.menu_camera_marker=null,e.logo_camera_marker=null;for(var t=0,n=e.all_buttons;t<n.length;){var i=n[t];++t,i.destroy(!0)}e.button_group.destroy(!0),e.button_group=null,e.continue_button=null,e.start_new_game_button=null,e.credits_button=null,(e.all_buttons=null)!=e.credits_card&&(bi.destroyRequirementAndRewardCard(e.credits_card),e.credits_card=null),null!=e.new_game_card&&(bi.destroyConfirmationCard(e.new_game_card),e.new_game_card=null),e.yachts=null,e.clouds=null},Ri.update=function(e,t,n,i,r,a,s,l,o,_,u,h,c,d,m){if((null!=e.menu_camera_marker||(xl.trace("warning: menu.menu_camera_marker == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.MainMenuDo",methodName:"update"}),0))&&!e.in_ad){var f=Os.music_beach_waves;null!=f&&(ks.isMusicPlaying(f)||ks.fadeInMusic(f),ks.updateMusic(f,m));var g=Os.music_avocado_easy_times_in_hawaii;if(null!=g&&(ks.isMusicPlaying(g)||ks.fadeInMusic(g),ks.updateMusic(g,m)),0==e.yachts.length&&0==e.clouds.length)for(var v=0,b=n.background_sprites;v<b.length;){var y=b[v];++v,y.sprite.texture==Os.sailing_yacht||y.sprite.texture==Os.sailing_yacht_scale_3?e.yachts.push(y):y.sprite.texture==Os.clouds&&e.clouds.push(y)}for(var x=0,z=e.yachts;x<z.length;){var w=z[x];++x,w.position.x+=Fi.yacht_speed*c.dc,rs.updateSpritePoints(w)}for(var k=0,S=e.clouds;k<S.length;){var C=S[k];++k,C.position.x+=Fi.cloud_speed*c.dc,rs.updateSpritePoints(C)}if(e.button_group.position.x=Fi.button_position_x_width_coeff*u.current_game_width,e.button_group.position.y=Fi.button_position_y_height_coeff*u.current_game_height,e.state==Di.StartZoomIn&&(e.current_time=0,e.game_save_type!=Bi.LoadedGameNoSave?(r.x=e.menu_camera_marker.position.x,r.y=e.menu_camera_marker.position.y,i.z=0,e.state=Di.PhasingInMenu):(a.current_pos.set_x(Fi.start_point.x),a.current_pos.set_y(Fi.start_point.y),e.state=Di.ZoomingIn),e.button_group.alpha=0),e.state==Di.ZoomingIn){e.current_time+=c.step_size;var N=pa.clamp0to1(e.current_time/Fi.zoom_time);N=ca.smoothEnd(0,1,N),r.x=ca.smoothStartEnd(Fi.start_point.x,e.menu_camera_marker.position.x,N),r.y=ca.smoothStartEnd(Fi.start_point.y,e.menu_camera_marker.position.y,N),i.z=ca.smoothStartEnd(Fi.start_point.z,0,N),Fi.camera_tied&&(a.current_pos.set_x(r.x),a.current_pos.set_y(r.y)),1==N&&(e.state=Di.PhasingInMenu,e.current_time=0)}if(e.state==Di.PhasingInMenu){null==e.button_group.parent&&_.addAt(e.button_group,0),0==e.current_time&&Ri.sortButtons(e),e.current_time+=c.step_size;var P=pa.clamp0to1(e.current_time/Fi.button_time);1==(e.button_group.alpha=P)&&(e.state=Di.Idle)}if(e.state,Di.Idle,e.state==Di.PhasingInMenu||e.state==Di.Idle){var M=Ha.getPointerDowned(h);null!=M&&(bi.isRectangularButtonDowned(M,e.button_group,e.continue_button,vi.finger_radius)?(M.cancel_upped_and_clicked=!0,ks.playSound(Os.sound_click,d),1==Xs.config.type&&3==Xs.config.release.sitelock_type?(e.in_ad=!0,Ya.PokiSDK.commercialBreak().then((function(){e.in_ad=!1,Ri.continueClick(e,d)}))):Ri.continueClick(e,d)):bi.isRectangularButtonDowned(M,e.button_group,e.start_new_game_button,vi.finger_radius)?(M.cancel_upped_and_clicked=!0,e.game_save_type==Bi.LoadedGameNoSave?(e.trigger_game_type=Li.ContinueToFirstLevel,ks.playSound(Os.sound_level_select,d)):e.game_save_type==Bi.LoadedGameWithSave||e.game_save_type==Bi.ContinueGame?(null!=e.new_game_card&&bi.destroyConfirmationCard(e.new_game_card),e.new_game_card=bi.createConfirmationCard("button_go","Delete Progress and\nStart New Game?"),_.add(e.new_game_card.container),e.credits_state=Oi.Closed):xl.trace("warning: unhandled "+p.string(e.game_save_type),{fileName:"MainMenuDo.hx",lineNumber:378,className:"bikas.game.MainMenuDo",methodName:"update"}),ks.playSound(Os.sound_click,d)):bi.isRectangularButtonDowned(M,e.button_group,e.credits_button,vi.finger_radius)&&(M.cancel_upped_and_clicked=!0,e.credits_state==Oi.Opened?e.credits_state=Oi.Closed:(e.credits_state=Oi.Opened,ba.trackCreditsClicked()),ks.playSound(Os.sound_click,d)))}if(null!=e.new_game_card){var I=e.new_game_card;I.container.position.x=u.current_game_width*Fi.credits_menu_x_coeff-I.background.width/2,I.container.position.y=u.current_game_height*Fi.credits_menu_y_coeff-I.background.height/2;var A=bi.processCardClick(h,d,I.container,I.button_close,I.button_main);A==di.DownedMainButton?(e.trigger_game_type=Li.StartNewGame,ks.playSound(Os.sound_level_select,d)):(A==di.DownedCloseButton||A==di.DownedOutside)&&(bi.destroyConfirmationCard(e.new_game_card),e.new_game_card=null)}if(e.credits_state==Oi.Closed&&null!=e.credits_card&&(bi.destroyRequirementAndRewardCard(e.credits_card),e.credits_card=null),e.credits_state==Oi.Opened){if(null!=e.new_game_card&&(bi.destroyConfirmationCard(e.new_game_card),e.new_game_card=null),null==e.credits_card){var T=new Yr(256.9,55),D=new Yr(256.9,140.4),E=new Yr(61,218),O=e.credits_card=bi.createRequirementAndRewardCard("achievement_card","achievement_balloons",null,null,T,D,E,new Yr(61,328),null,"Credits",400,"","","","","",400);e.credits_card.requirement_text.text="Code by Bikas.net (bikasflash@yahoo.com) \n\nArt by Gudo1 \n\nMusic by StereoSpice and Avocado",e.credits_card.reward_text.text="",e.credits_card.requirement_highlight.visible=!1,e.credits_card.reward_highlight.visible=!1,_.add(O.container)}var B=e.credits_card,L=bi.processCardClick(h,d,B.container,B.close_button,null);(L==di.DownedCloseButton||L==di.DownedOutside)&&(e.credits_state=Oi.Closed),B.container.position.x=u.current_game_width*Fi.credits_menu_x_coeff-B.background.width/2,B.container.position.y=u.current_game_height*Fi.credits_menu_y_coeff-B.background.height/2}}};var Gi=n["bikas.game.BoxState"]={__ename__:["bikas","game","BoxState"],__constructs__:["Normal","Broken","Passive","Removed"]};Gi.Normal=["Normal",0],Gi.Normal.toString=i,(Gi.Normal.__enum__=Gi).Broken=["Broken",1],Gi.Broken.toString=i,(Gi.Broken.__enum__=Gi).Passive=["Passive",2],Gi.Passive.toString=i,(Gi.Passive.__enum__=Gi).Removed=["Removed",3],Gi.Removed.toString=i,(Gi.Removed.__enum__=Gi).__empty_constructs__=[Gi.Normal,Gi.Broken,Gi.Passive,Gi.Removed];var Zi=function(){this.impulses=[],this.temp_impulse=0,this.current_alpha_out_time=0,this.velocity_before=0,this.pieces_interaction_time=30,this.pieces=[]};(n["bikas.game.Box"]=Zi).__name__=["bikas","game","Box"],Zi.prototype={state:null,group:null,main_entity:null,body:null,pieces:null,pieces_interaction_time:null,velocity_before:null,current_alpha_out_time:null,temp_impulse:null,impulses:null,__class__:Zi};var Ui=n["bikas.game.BoxPieceState"]={__ename__:["bikas","game","BoxPieceState"],__constructs__:["Hidden","Active","Passive"]};Ui.Hidden=["Hidden",0],Ui.Hidden.toString=i,(Ui.Hidden.__enum__=Ui).Active=["Active",1],Ui.Active.toString=i,(Ui.Active.__enum__=Ui).Passive=["Passive",2],Ui.Passive.toString=i,(Ui.Passive.__enum__=Ui).__empty_constructs__=[Ui.Hidden,Ui.Active,Ui.Passive];var Vi=function(){};(n["bikas.game.BoxPiece"]=Vi).__name__=["bikas","game","BoxPiece"],Vi.prototype={state:null,group:null,main_entity:null,body:null,relative_pos:null,relative_rot:null,init_pos:null,init_rot:null,__class__:Vi};var qi=n["bikas.game.TempInteractiveObjectType"]={__ename__:["bikas","game","TempInteractiveObjectType"],__constructs__:["Obstacle","Explosive"]};qi.Obstacle=["Obstacle",0],qi.Obstacle.toString=i,(qi.Obstacle.__enum__=qi).Explosive=["Explosive",1],qi.Explosive.toString=i,(qi.Explosive.__enum__=qi).__empty_constructs__=[qi.Obstacle,qi.Explosive];var Wi=function(){this.interaction_time_beyond_distance=15,this.interactive_distance=10,this.only_to_ground=!1,this.timeout=!1,this.explosion_radius=300};(n["bikas.game.TempInteractiveObject"]=Wi).__name__=["bikas","game","TempInteractiveObject"],Wi.prototype={type:null,main_entity:null,body:null,init_pos:null,explosive:null,explosion_radius:null,timeout:null,only_to_ground:null,interactive_distance:null,interaction_time_beyond_distance:null,__class__:Wi};var Xi=n["bikas.game.ForwardRampType"]={__ename__:["bikas","game","ForwardRampType"],__constructs__:["Ramp","Booster"]};Xi.Ramp=["Ramp",0],Xi.Ramp.toString=i,(Xi.Ramp.__enum__=Xi).Booster=["Booster",1],Xi.Booster.toString=i,(Xi.Booster.__enum__=Xi).__empty_constructs__=[Xi.Ramp,Xi.Booster];var Hi=function(){this.anim_current_wait=0,this.anim_total_wait=15,this.texture_index=0,this.textures=[],this.applied_impulses=[],this.max_velocity=1500,this.total_impulse=200};(n["bikas.game.ForwardRamp"]=Hi).__name__=["bikas","game","ForwardRamp"],Hi.prototype={total_impulse:null,max_velocity:null,type:null,group:null,main_entity:null,body:null,top_left_bound:null,bottom_right_bound:null,force_angle:null,impulse:null,applied_impulses:null,impulse_cache:null,sprite:null,textures:null,texture_index:null,anim_total_wait:null,anim_current_wait:null,__class__:Hi};var Yi=function(){this.count=0};(n["bikas.game.ImpulseAppliedCount"]=Yi).__name__=["bikas","game","ImpulseAppliedCount"],Yi.prototype={car:null,count:null,__class__:Yi};var Ji=function(){};(n["bikas.game.MapObjectDo"]=Ji).__name__=["bikas","game","MapObjectDo"],Ji.createBox=function(e){var t=new Zi;t.state=Gi.Normal;for(var n=0,i=(t.group=e).group.entities;n<i.length;){var r=i[n];if(++n,null!=r.prefab)if(1!=r.group.entities.length)xl.trace("something wrong with box piece",{fileName:"MapObjectDo.hx",lineNumber:51,className:"bikas.game.MapObjectDo",methodName:"createBox"});else if(null==r.group.entities[0].body)xl.trace("something wrong with box piece",{fileName:"MapObjectDo.hx",lineNumber:54,className:"bikas.game.MapObjectDo",methodName:"createBox"});else{var a=new Vi;a.group=r,a.main_entity=r.group.entities[0],a.body=a.main_entity.body,a.body.setShapeMaterials($i.box),t.pieces.push(a)}else null==r.body?xl.trace("warning: something wrong with box",{fileName:"MapObjectDo.hx",lineNumber:66,className:"bikas.game.MapObjectDo",methodName:"createBox"}):(t.main_entity=r,t.body=r.body,t.body.setShapeMaterials($i.box))}for(var s=0,l=t.pieces;s<l.length;){var o=l[s];++s,o.init_pos=d_.get(o.body.get_position().get_x(),o.body.get_position().get_y()),o.init_rot=o.body.get_rotation(),o.relative_pos=d_.get(),o.relative_pos.set_x(t.body.get_position().get_x()-o.body.get_position().get_x()),o.relative_pos.set_y(t.body.get_position().get_y()-o.body.get_position().get_y()),o.relative_rot=t.body.get_rotation()-o.body.get_rotation(),Ji.setPieceState(t,o,Ui.Hidden)}return null==t.main_entity&&xl.trace("warning: something wrong with box",{fileName:"MapObjectDo.hx",lineNumber:83,className:"bikas.game.MapObjectDo",methodName:"createBox"}),t},Ji.destroyBox=function(e){if(null!=e.pieces)for(var t=0,n=e.pieces;t<n.length;){var i=n[t];++t,null!=i.relative_pos&&(i.relative_pos.dispose(),i.relative_pos=null),null!=i.init_pos&&(i.init_pos.dispose(),i.init_pos=null)}e.pieces=null,e.main_entity=null,e.body=null},Ji.shouldBreakBox=function(e){var t=0;if(e.body.get_type()==w_.get_DYNAMIC()){t=Na.getHighestImpulseFromCollisionArbitersOfDynamicBody(e.body);var n=e.body.get_velocity().get_length(),i=Math.abs(e.velocity_before-n);if(e.velocity_before=n,300<i)return!0}else if(t=Na.getHighestImpulseFromCollisionArbitersOfStaticBody(e.body),null!=e.body.get_userData().just_applied_impulse_length){if(3e3<e.body.get_userData().just_applied_impulse_length)return!0;e.body.get_userData().just_applied_impulse_length=0}return 700<t},Ji.breakBox=function(e,t,n){for(var i=0,r=e.pieces;i<r.length;){var a=r[i];++i,Ji.setPieceState(e,a,Ui.Active),ce.refresh(a.main_entity)}Ji.destroyLiveEntity(e.main_entity,t,n),e.main_entity=null,e.body=null,e.state=Gi.Broken},Ji.destroyLiveEntity=function(e,t,n){s.remove(t,e);for(var i=0,r=n.all_objects;i<r.length;){var a=r[i];if(++i,a.display_object==e.display.sprite){Ea.destroyLiveObject(n,a,!1);break}}e.body.set_space(null),ie.destroyEntityIncludingChildren(e),e.body=null},Ji.setPieceState=function(e,t,n){var i=t.body;if(n==Ui.Hidden?(t.main_entity.display.sprite.visible=!1,i.set_allowMovement(!1),i.set_allowRotation(!1),i.set_disableCCD(!0),i.setShapeFilters(zi.no_interaction)):n==Ui.Active?(t.main_entity.display.sprite.visible=!0,i.set_allowMovement(!0),i.set_allowRotation(!0),i.set_disableCCD(!1),i.setShapeFilters(zi.normal)):i.setShapeFilters(zi.only_to_ground),t.state==Ui.Hidden&&(n==Ui.Active||n==Ui.Passive)){var r=e.body.get_rotation()-t.relative_rot,a=t.relative_pos.copy().rotate(r-t.init_rot),s=e.body.get_position().sub(a);if(i.get_position().set(s),a.dispose(),s.dispose(),i.set_rotation(r),i.get_velocity().set(e.body.get_velocity()),n==Ui.Active){i.applyAngularImpulse((Math.random()*Math.PI*2-Math.PI)*i.get_inertia()*2);var l=200;i.get_userData().just_exploded&&(l=500,i.get_userData().just_exploded=!1);var o=d_.get(l*i.get_mass(),0);o.rotate(Math.random()*Math.PI*2),i.applyImpulse(o),o.dispose()}}t.state=n},Ji.updateBox=function(e,t,n,i,r,a,s,l,o,_){var p=l.dc;if(e.state==Gi.Normal){if(Ji.shouldBreakBox(e)){var u=Os.sound_box_break;"crate"==e.group.name?u=Os.sound_board_break:"box1"==e.group.name?u=Os.sound_box_break:("barrel"==e.group.name||"fruit_stand"==e.group.name||"shack"==e.group.name)&&(u=Os.sound_barrel_break),0==o.type&&o.development.trace_obstacle_break_event&&xl.trace("box: "+e.group.name+" (x:"+Math.round(e.body.get_position().get_x())+", y:"+Math.round(e.body.get_position().get_y())+") broke at "+Math.round(l.level_seconds)+" level second",{fileName:"MapObjectDo.hx",lineNumber:310,className:"bikas.game.MapObjectDo",methodName:"updateBox"}),Un.playSoundInGameLevel(u,_,e.body.get_position(),r,1600,1),Gn.applyCameraShake(i,5,4,r,e.body.get_position()),Ji.breakBox(e,n,t)}}else if(e.state==Gi.Broken){if(e.pieces_interaction_time-=p,e.pieces_interaction_time<=0){for(var h=0,c=e.pieces;h<c.length;){var d=c[h];++h,Ji.setPieceState(e,d,Ui.Passive)}e.state=Gi.Passive}}else if(e.state==Gi.Passive){for(var m=r.main_body_position_x,f=!0,g=0,v=e.pieces;g<v.length;){var b=v[g];++g,null!=b.body&&(b.body.get_position().get_x()<m-Zi.pieces_destroy_distance?(Ji.destroyLiveEntity(b.main_entity,n,t),b.main_entity=null,b.body=null,b.group=null):f=!1)}f&&(e.state=Gi.Removed,e.pieces=null)}},Ji.createTempInteractiveObject=function(e,t){var n=new Wi;return n.type=t,n.main_entity=e,n.body=n.main_entity.body,n.init_pos=d_.get(n.body.get_position().get_x(),n.body.get_position().get_y()),n.explosion_radius=300,n},Ji.destroyTempInteractiveObject=function(e){null!=e.init_pos&&(e.init_pos.dispose(),e.init_pos=null),e.body=null,e.main_entity=null,e.explosive=null},Ji.updateTempInteractiveObject=function(e,t,n,i,r,a,s,l){var o=s.dc;if(e.type==qi.Obstacle)if(e.timeout)if(e.interaction_time_beyond_distance<=0)if(e.only_to_ground){if(null!=e.body){var _=r.main_body_position_x;e.body.get_position().get_x()<_-Zi.pieces_destroy_distance&&(Ji.destroyLiveEntity(e.main_entity,t,n),e.main_entity=null,e.body=null)}}else e.body.setShapeFilters(zi.only_to_ground),e.only_to_ground=!0;else e.interaction_time_beyond_distance-=o;else{var p=e.body.get_position().get_x()-e.init_pos.get_x(),u=e.body.get_position().get_y()-e.init_pos.get_y();Math.sqrt(p*p+u*u)>e.interactive_distance&&(e.timeout=!0)}else e.type==qi.Explosive&&500<Na.getHighestImpulseFromCollisionArbitersOfDynamicBody(e.body)&&null==e.explosive&&(0==l.type&&l.development.trace_explosive_barrel_event&&xl.trace("explosive barrel: "+e.main_entity.name+" (x:"+Math.round(e.body.get_position().get_x())+", y:"+Math.round(e.body.get_position().get_y())+") broke at "+Math.round(s.level_seconds)+" level second",{fileName:"MapObjectDo.hx",lineNumber:414,className:"bikas.game.MapObjectDo",methodName:"updateTempInteractiveObject"}),e.explosive=Me.createExplosive(n,i,e.explosion_radius,0,0,ke.Barrel,0,e.body,e.main_entity.display.sprite),a.push(e.explosive),Xt.updateContainerBody(e.explosive.cbody))},Ji.createForwardRamp=function(e,t){var n=new Hi;if(n.type=t,n.type==Xi.Ramp)n.total_impulse=200,n.max_velocity=1500,n.group=e,n.main_entity=n.group.group.entities[0],n.sprite=n.main_entity.display.sprite,n.body=n.main_entity.body,n.top_left_bound=d_.get(n.body.get_bounds().get_min().get_x(),n.body.get_bounds().get_min().get_y()),n.bottom_right_bound=d_.get(n.body.get_bounds().get_max().get_x(),n.body.get_bounds().get_max().get_y()),n.force_angle=.017453292519943*(-Hi.ramp_angle_in_degrees+n.main_entity.transform.rotation),n.impulse=d_.get(n.total_impulse,0).rotate(n.force_angle),n.textures.push(Zs.getTexture("ramp_accelerated_0001")),n.textures.push(Zs.getTexture("ramp_accelerated_0002"));else if(n.type==Xi.Booster){n.total_impulse=120,n.max_velocity=1200,null!=e.group?(n.group=e,n.main_entity=n.group.group.entities[0]):n.main_entity=e,n.sprite=n.main_entity.display.sprite,n.sprite.setTexture(Zs.retrieveAsset("booster"));var i=n.main_entity.position.x,r=n.main_entity.position.y;n.top_left_bound=d_.get(i-n.sprite.width/2,r-n.sprite.height/2),n.bottom_right_bound=d_.get(i+n.sprite.width/2,r+n.sprite.height/2);var a=n.main_entity.transform.rotation;n.main_entity.transform.scale_x<0&&(a+=180),n.force_angle=.017453292519943*a,n.impulse=d_.get(n.total_impulse,0).rotate(n.force_angle),n.textures.push(Zs.retrieveAsset("booster")),n.textures.push(Zs.retrieveAsset("booster_0002")),n.textures.push(Zs.retrieveAsset("booster_0003"))}else xl.trace("warning: unhandled type "+p.string(t),{fileName:"MapObjectDo.hx",lineNumber:478,className:"bikas.game.MapObjectDo",methodName:"createForwardRamp"});return n.impulse_cache=d_.get(0,0),n.anim_current_wait=0,n.texture_index=0,n},Ji.updateForwardRamp=function(e,t,n,i){null!=e.main_entity.display.sprite.parent&&(e.anim_current_wait+=t,e.anim_current_wait>=e.anim_total_wait&&(e.anim_current_wait=0,e.texture_index++,e.texture_index>=e.textures.length&&(e.texture_index=0),e.sprite.setTexture(e.textures[e.texture_index])));for(var r=!1,a=0;a<i.length;){var s=i[a];++a;var l=s.main_body_position_x-(e.top_left_bound.get_x()+e.bottom_right_bound.get_x())/2,o=s.main_body_position_y-(e.top_left_bound.get_y()+e.bottom_right_bound.get_y())/2;750<l||l<-750||750<o||o<-750||Tt.doesWorldBoundsTouchBounds(s,e.top_left_bound,e.bottom_right_bound)&&(s==n.car&&(r=!0),s.main_body.get_velocity().get_length()<=e.max_velocity&&(e.impulse_cache.set_x(e.impulse.get_x()*t),e.impulse_cache.set_y(e.impulse.get_y()*t),Tt.applyImpulseToMainBodiesPerMassUnit(s,e.impulse_cache)))}return r},Ji.destroyForwardRamp=function(e){e.group=null,e.main_entity=null,(e.body=null)!=e.top_left_bound&&(e.top_left_bound.dispose(),e.top_left_bound=null),null!=e.bottom_right_bound&&(e.bottom_right_bound.dispose(),e.bottom_right_bound=null),null!=e.impulse&&(e.impulse.dispose(),e.impulse=null),null!=e.impulse_cache&&(e.impulse_cache.dispose(),e.impulse_cache=null),e.applied_impulses=null,e.sprite=null,e.textures=null};var Ki=function(e,t,n,i,r){null==r&&(r=.001),null==i&&(i=1),null==n&&(n=2),null==t&&(t=1),null==e&&(e=0),(this.zpp_inner=null)==Qi.zpp_pool?this.zpp_inner=new Qi:(this.zpp_inner=Qi.zpp_pool,Qi.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.alloc(),(this.zpp_inner.outer=this).set_elasticity(e),this.set_dynamicFriction(t),this.set_staticFriction(n),this.set_density(i),this.set_rollingFriction(r)};(n["nape.phys.Material"]=Ki).__name__=["nape","phys","Material"],Ki.wood=function(){return new Ki(.4,.2,.38,.7,.005)},Ki.steel=function(){return new Ki(.2,.57,.74,7.8,.001)},Ki.ice=function(){return new Ki(.3,.03,.1,.9,1e-4)},Ki.rubber=function(){return new Ki(.8,1,1.4,1.5,.01)},Ki.glass=function(){return new Ki(.4,.4,.94,2.6,.002)},Ki.sand=function(){return new Ki(-1,.45,.6,1.6,16)},Ki.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=rc.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},copy:function(){var e=new Ki(this.get_elasticity(),this.get_dynamicFriction(),this.get_staticFriction(),this.get_density(),this.get_rollingFriction());return null!=this.zpp_inner.userData&&(e.zpp_inner.userData=_.copy(this.zpp_inner.userData)),e},get_elasticity:function(){return this.zpp_inner.elasticity},set_elasticity:function(e){return e!=this.get_elasticity()&&(this.zpp_inner.elasticity=e/1,this.zpp_inner.invalidate(Qi.WAKE|Qi.ARBITERS)),this.get_elasticity()},get_dynamicFriction:function(){return this.zpp_inner.dynamicFriction},set_dynamicFriction:function(e){return e!=this.get_dynamicFriction()&&(this.zpp_inner.dynamicFriction=e/1,this.zpp_inner.invalidate(Qi.WAKE|Qi.ANGDRAG|Qi.ARBITERS)),this.get_dynamicFriction()},get_staticFriction:function(){return this.zpp_inner.staticFriction},set_staticFriction:function(e){return e!=this.get_staticFriction()&&(this.zpp_inner.staticFriction=e/1,this.zpp_inner.invalidate(Qi.WAKE|Qi.ARBITERS)),this.get_staticFriction()},get_density:function(){return 1e3*this.zpp_inner.density},set_density:function(e){return e!=this.get_density()&&(this.zpp_inner.density=e/1e3,this.zpp_inner.invalidate(Qi.WAKE|Qi.PROPS)),this.get_density()},get_rollingFriction:function(){return this.zpp_inner.rollingFriction},set_rollingFriction:function(e){return e!=this.get_rollingFriction()&&(this.zpp_inner.rollingFriction=e/1,this.zpp_inner.invalidate(Qi.WAKE|Qi.ARBITERS)),this.get_rollingFriction()},toString:function(){return"{ elasticity: "+this.get_elasticity()+" dynamicFriction: "+this.get_dynamicFriction()+" staticFriction: "+this.get_staticFriction()+" density: "+this.get_density()+" rollingFriction: "+this.get_rollingFriction()+" }"},__class__:Ki,__properties__:{set_rollingFriction:"set_rollingFriction",get_rollingFriction:"get_rollingFriction",set_density:"set_density",get_density:"get_density",set_staticFriction:"set_staticFriction",get_staticFriction:"get_staticFriction",set_dynamicFriction:"set_dynamicFriction",get_dynamicFriction:"get_dynamicFriction",set_elasticity:"set_elasticity",get_elasticity:"get_elasticity",get_shapes:"get_shapes",get_userData:"get_userData"}};var Qi=function(){this.rollingFriction=0,this.elasticity=0,this.density=0,this.staticFriction=0,this.dynamicFriction=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.feature_cons(),this.elasticity=0,this.dynamicFriction=1,this.staticFriction=2,this.density=.001,this.rollingFriction=.01};(n["zpp_nape.phys.ZPP_Material"]=Qi).__name__=["zpp_nape","phys","ZPP_Material"],Qi.prototype={next:null,userData:null,outer:null,wrapper:function(){if(null==this.outer){this.outer=new Ki;var e=this.outer.zpp_inner;e.free(),e.next=Qi.zpp_pool,Qi.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},shapes:null,wrap_shapes:null,feature_cons:function(){this.shapes=new Fu},addShape:function(e){this.shapes.add(e)},remShape:function(e){this.shapes.remove(e)},dynamicFriction:null,staticFriction:null,density:null,elasticity:null,rollingFriction:null,copy:function(){var e=new Qi;return e.dynamicFriction=this.dynamicFriction,e.staticFriction=this.staticFriction,e.density=this.density,e.elasticity=this.elasticity,e.rollingFriction=this.rollingFriction,e},set:function(e){this.dynamicFriction=e.dynamicFriction,this.staticFriction=e.staticFriction,this.density=e.density,this.elasticity=e.elasticity,this.rollingFriction=e.rollingFriction},invalidate:function(e){for(var t=this.shapes.begin();null!=t;)t.elem().invalidate_material(e),t=t.next},__class__:Qi};var $i=function(){};(n["bikas.game.Materials"]=$i).__name__=["bikas","game","Materials"];var er=function(){};(n["bikas.game.MeshDo"]=er).__name__=["bikas","game","MeshDo"],er.createMesh=function(e,t){e.baseTexture.wrapMode=1;for(var n=Ka.pointsToVertices(t),i=e.baseTexture.width,r=e.baseTexture.height,a=(e.width,e.height,0),s=e.frame.x,l=e.frame.y,o=[];a<n.length;){var _=(s+n[a])/i,p=(l+n[a+1])/r;o.push(_),o.push(p),a+=2}var u=Xl.earcut(n),h=new Ac(n),c=new Ac(o),d=new Uint16Array(u);return new PIXI.mesh.Mesh(e,h,c,d,PIXI.mesh.Mesh.DRAW_MODES.TRIANGLES)},er.update=function(e){er.total_size+=1;for(var t=er.total_size,n=[new Yr(0,0),new Yr(t,0),new Yr(t+100,t/2),new Yr(t,t),new Yr(0,t),new Yr(-100,t/2)],i=(Math.random(),Ka.pointsToVertices(n)),r=e.texture,a=r.baseTexture.width,s=r.baseTexture.height,l=(r.width,r.height,0),o=r.frame.x,_=r.frame.y,p=[];l<i.length;){var u=(o+i[l])/a,h=(_+i[l+1])/s;p.push(u),p.push(h),l+=2}var c=Xl.earcut(i),d=new Ac(i),m=new Ac(p),f=new Int16Array(c);e.vertices=d,e.uvs=m,e.indices=f,e.dirty++,e.indexDirty++};var tr=function(){this.constant_drive=!0,this.finished_race=!1,this.behavior_activated=!0};(n["bikas.game.Player"]=tr).__name__=["bikas","game","Player"],tr.prototype={car:null,config:null,cache:null,abilities:null,ability_button:null,jump_button:null,nitro_button:null,engine_sound:null,behavior_activated:null,finished_race:null,constant_drive:null,__class__:tr};var nr=function(){};(n["bikas.game.KeyboardShortcutDisplay"]=nr).__name__=["bikas","game","KeyboardShortcutDisplay"],nr.prototype={container:null,background:null,text:null,__class__:nr};var ir=function(){this.downed=null};(n["bikas.game.JumpButton"]=ir).__name__=["bikas","game","JumpButton"],ir.prototype={container:null,button:null,keyboard_shortcut_display:null,downed:null,__class__:ir};var rr=n["bikas.game.NitroButtonState"]={__ename__:["bikas","game","NitroButtonState"],__constructs__:["Empty","TransitionIn","Normal","TransitionOut"]};rr.Empty=["Empty",0],rr.Empty.toString=i,(rr.Empty.__enum__=rr).TransitionIn=["TransitionIn",1],rr.TransitionIn.toString=i,(rr.TransitionIn.__enum__=rr).Normal=["Normal",2],rr.Normal.toString=i,(rr.Normal.__enum__=rr).TransitionOut=["TransitionOut",3],rr.TransitionOut.toString=i,(rr.TransitionOut.__enum__=rr).__empty_constructs__=[rr.Empty,rr.TransitionIn,rr.Normal,rr.TransitionOut];var ar=function(){this.pickup_current_time=0,this.transition_current_time=0,this.downed=null,this.nitro_points=[],this.container=null,this.state=rr.Empty};(n["bikas.game.NitroButton"]=ar).__name__=["bikas","game","NitroButton"],ar.prototype={state:null,container:null,button:null,keyboard_shortcut_display:null,nitro_points:null,downed:null,transition_current_time:null,pickup_current_time:null,__class__:ar};var sr=function(){};(n["bikas.game.EngineSound"]=sr).__name__=["bikas","game","EngineSound"],sr.prototype={slow_loop:null,__class__:sr};var lr=function(){};(n["bikas.game.PlayerDo"]=lr).__name__=["bikas","game","PlayerDo"],lr.createPlayer=function(e,t,n,i,r){var a=new tr;a.car=e,a.config=t,a.cache=n,a.abilities=i,a.ability_button=new ve,a.jump_button=new ir,a.jump_button.container=Ra.createGroup(),a.jump_button.button=T.createNewAnimation(Os.animation_jump_green_button,!1),a.jump_button.keyboard_shortcut_display=lr.createKeyboardShortcutDisplay("(SPACE)",2,24),a.jump_button.container.add(a.jump_button.button.sprite),a.jump_button.container.add(a.jump_button.keyboard_shortcut_display.container),r.add(a.jump_button.container),a.nitro_button=new ar,a.nitro_button.container=Ra.createGroup(),a.nitro_button.button=T.createNewAnimation(Os.animation_nitro_button,!1),a.nitro_button.keyboard_shortcut_display=lr.createKeyboardShortcutDisplay("(SHIFT)",2,24),a.nitro_button.container.add(a.nitro_button.button.sprite),a.nitro_button.container.add(a.nitro_button.keyboard_shortcut_display.container),r.add(a.nitro_button.container),a.nitro_button.container.alpha=0,a.nitro_button.state=rr.Empty,a.engine_sound=new sr;var s=function(e,t){e.slow_loop=Zs.retrieveAsset("sound_loop_"+t+"_slow")},l=e.name;return"car_rudolf"==l?s(a.engine_sound,"car_rudolf"):"car_bus"==l?s(a.engine_sound,"car_bus"):"car_farm_truck"==l?s(a.engine_sound,"car_farm_truck"):"car_semioval"==l?s(a.engine_sound,"car_semioval"):"car_tourcycle"==l?s(a.engine_sound,"car_tourcycle"):"car_ice_cream_truck"==l?s(a.engine_sound,"car_ice_cream_truck"):"car_bug"==l?s(a.engine_sound,"car_bug"):"car_coyote"==l||"car_cow"==l?s(a.engine_sound,"car_rudolf"):"car_rider"==l?s(a.engine_sound,"car_rider"):"car_taxi"==l&&s(a.engine_sound,"car_rudolf"),a},lr.createKeyboardShortcutDisplay=function(e,t,n){var i=new nr;return i.container=Ra.createGroup(),i.background=Ra.createSpriteByName("shortcut_background",.5,.5),i.background.scale.x=t,i.background.scale.y=t,i.background.alpha=.6,i.text=Ra.createBitmapText(cn.bell_gothic_std_black_dark_26,n,"center"),i.text.anchor.x=.5,i.text.anchor.y=.5,i.text.text=e,i.container.add(i.background),i.container.add(i.text),i.container.visible=!1,i},lr.destroy=function(e){if(null!=e.ability_button&&be.destroy(e.ability_button),null!=e.abilities&&(Me.destroyAbilities(e.abilities),e.abilities=null),null!=e.jump_button&&(null!=e.jump_button.button&&(T.destroyAnimation(e.jump_button.button),e.jump_button.button=null),null!=e.jump_button.container&&e.jump_button.container.destroy(),e.jump_button=null),null!=e.nitro_button){for(var t=0,n=e.nitro_button.nitro_points;t<n.length;){var i=n[t];++t,e.nitro_button.container.remove(i),i.destroy(!0)}(e.nitro_button.nitro_points=null)!=e.nitro_button.button&&(T.destroyAnimation(e.nitro_button.button),e.nitro_button.button=null),null!=e.nitro_button.container&&e.nitro_button.container.destroy(),e.nitro_button=null}null!=e.engine_sound&&null!=e.engine_sound.slow_loop&&(ks.stopMusic(e.engine_sound.slow_loop),e.engine_sound.slow_loop=null),Ct.destroy(e.car,e.config,e.cache),e.car=null,e.config=null,e.cache=null,e.abilities=null},lr.update=function(e,t,n,i,r,a,s,l,o){var _=n.dc,p=n.level_seconds;n.step_size,Ct.updateState(_,e.car,e.cache);var u=e.car,h=e.config,c=e.cache,d=e.jump_button;if(!e.finished_race&&s&&lr.updateEngineSound(u,h,c,e.engine_sound,o),e.behavior_activated){if(e.constant_drive&&!l&&Ct.drive(u,e.config,e.cache,_),i.desktop){e.constant_drive||(Ni.isAnyPressed(a,tr.keys_forward)?Ct.drive(u,h,c,_):Ni.isAnyPressed(a,tr.keys_backward)&&Ct.drive(u,h,c,-_)),Ni.isAnyPressed(a,tr.keys_left)?Ct.rotate(u,h,-_):Ni.isAnyPressed(a,tr.keys_right)&&Ct.rotate(u,h,_);var m=e.abilities;Ni.isAnyPressed(a,tr.keys_nitro)&&(m.nitro_power.activated||0<m.nitro_power_charge&&(m.nitro_power_charge--,Me.activateOrExtendConstantPower(m.nitro_power,u,Pe.nitro_time_per_1_pick),m.nitro_power_charge<=0&&null!=e.nitro_button&&(e.nitro_button.state=rr.TransitionOut))),Ni.isAnyPressed(a,tr.keys_power)&&null!=e.ability_button&&e.ability_button.state==fe.ButtonMode&&(e.ability_button.use_ability_click=!0),Ni.isAnyPressed(a,tr.keys_jump)&&Me.isAllowedToJump(e.abilities.jump_power,p)&&Me.tryJump(e.abilities.jump_power,u,h,c,p)&&ks.playSound(Os.sound_jump,o),Ha.isOver(d.container.x,d.container.y,r,ir.radius)?d.keyboard_shortcut_display.container.visible=!0:d.keyboard_shortcut_display.container.visible=!1,Ha.isOver(e.nitro_button.container.x,e.nitro_button.container.y,r,ar.radius)?e.nitro_button.keyboard_shortcut_display.container.visible=!0:e.nitro_button.keyboard_shortcut_display.container.visible=!1}null==d.downed&&(d.downed=Ha.getDowned(d.container.x,d.container.y,r,ir.radius),null!=d.downed&&(T.gotoFrame(d.button,1),Me.isAllowedToJump(e.abilities.jump_power,p)&&Me.tryJump(e.abilities.jump_power,u,h,c,p)&&ks.playSound(Os.sound_jump,o))),null!=d.downed&&d.downed.state==qa.IS_UP&&(d.downed=null,0!=d.button.current_frame&&T.gotoFrame(d.button,0)),lr.updateNitroButton(e.nitro_button,e.abilities,e.car,d,r,_)}},lr.updateNitroButton=function(e,t,n,i,r,a){if(e.container.x=i.container.x+105+60,e.container.y=i.container.y,0<t.nitro_power_charge&&e.state==rr.Empty&&(e.state=rr.TransitionIn,e.transition_current_time=0,T.gotoFrame(e.button,0)),e.state==rr.TransitionIn){e.transition_current_time+=a,e.transition_current_time>=ar.transtion_in_time&&(e.transition_current_time=ar.transtion_in_time,e.state=rr.Normal);var s=e.transition_current_time/ar.transtion_in_time;e.container.alpha=s;var l=ca.linearToABC(.5,1.4,1,.6,s);e.container.scale.x=l,e.container.scale.y=l}if(e.state==rr.Normal||e.state==rr.TransitionIn)if(null==e.downed&&(e.downed=Ha.getDowned(e.container.x,e.container.y,r,ar.radius)),null!=e.downed&&(e.downed.state==qa.DOWNED||e.downed.state==qa.IS_DOWN?(T.gotoFrame(e.button,1),t.nitro_power.activated||(t.nitro_power_charge-=1,Me.activateOrExtendConstantPower(t.nitro_power,n,Pe.nitro_time_per_1_pick),t.nitro_power_charge<=0&&(e.state=rr.TransitionOut))):e.downed.state==qa.IS_UP&&(e.downed=null,0!=e.button.current_frame&&T.gotoFrame(e.button,0))),t.nitro_power_charge<=0&&(e.state=rr.TransitionOut),e.nitro_points.length<t.nitro_power_charge-1){for(var o=0,_=Math.ceil(t.nitro_power_charge-1-e.nitro_points.length);o<_;){o++;var p=Ra.createSprite(Os.nitro_1_point);p.anchor.x=.5,p.anchor.y=.5,p.position.x=.39*e.button.sprite.width+12*e.nitro_points.length,e.container.addAt(p,0),e.nitro_points.push(p)}e.pickup_current_time=ar.pickup_time}else if(e.nitro_points.length>t.nitro_power_charge-1&&0<e.nitro_points.length){var u=e.nitro_points.pop();e.container.remove(u),u.destroy(!0)}if(0<=e.pickup_current_time){e.pickup_current_time-=a;var h=1-e.pickup_current_time/ar.pickup_time,c=pa.interpolateForwardAndBackward(1,1.1,h);1<h&&(h=1),e.container.scale.x=c,e.container.scale.y=c}lr.updateNitroTransitionOut(e,a)},lr.updateNitroTransitionOut=function(e,t){if(e.state==rr.TransitionOut){e.downed=null,e.transition_current_time-=t,e.transition_current_time<0&&(e.transition_current_time=0,e.state=rr.Empty);var n=e.transition_current_time/ar.transtion_in_time;e.container.alpha=n;var i=ca.linear(.5,1,n);e.container.scale.x=i,e.container.scale.y=i}},lr.updateEngineSound=function(e,t,n,i,r){var a=i.slow_loop;if(null!=a){t.drive_velocity_max,t.nitro_velocity_to_drive_velocity_max_coeff;var s=pa.max(Math.abs(e.back_wheel_body.get_angularVel()),Math.abs(e.front_wheel_body.get_angularVel())),l=ca.getTClamped(0,sr.max_angular_vel,s);ca.linear(1,0,l),ca.linear(0,1,l),a.max_volume=sr.slow_volume_coeff;var o=ca.linear(1,2,l);r&&a.howl.rate(o),ks.isMusicPlaying(a)||ks.fadeInMusic(a,.016666666666666666),ks.updateMusic(a,r)}};var or=function(){};(n["bikas.game.CarNames"]=or).__name__=["bikas","game","CarNames"];var _r=function(e,t){this.to_rank=0,this.from_rank=0,this.from_rank=e,this.to_rank=t};(n["bikas.game.CarReplace"]=_r).__name__=["bikas","game","CarReplace"],_r.prototype={from_rank:null,to_rank:null,__class__:_r};var pr=function(){this.price=10,this.bot_upgrades=[]};(n["bikas.game.CarSetting"]=pr).__name__=["bikas","game","CarSetting"],pr.prototype={name:null,initial_config:null,personality:null,bot_upgrades:null,price:null,__class__:pr};var ur=function(){this.nitro_velocity_coeff_coeffs=[],this.nitro_impulse_coeffs=[],this.armor_coeffs=[],this.grip_decrease_coeffs=[],this.grip_increase_coeffs=[],this.rotation_angular_velocity_max_coeffs=[],this.rotation_angular_impulse_coeff_coeffs=[],this.drive_velocity_max_coeffs=[],this.drive_impulse_coeffs=[]};(n["bikas.game.CarUpgradeData"]=ur).__name__=["bikas","game","CarUpgradeData"],ur.prototype={drive_impulse_coeffs:null,drive_velocity_max_coeffs:null,rotation_angular_impulse_coeff_coeffs:null,rotation_angular_velocity_max_coeffs:null,grip_increase_coeffs:null,grip_decrease_coeffs:null,armor_coeffs:null,nitro_impulse_coeffs:null,nitro_velocity_coeff_coeffs:null,__class__:ur};var hr=function(){this.armor=0,this.handling=0,this.acceleration=0,this.top_speed=0};(n["bikas.game.CarUpgradeValues"]=hr).__name__=["bikas","game","CarUpgradeValues"],hr.prototype={top_speed:null,acceleration:null,handling:null,armor:null,__class__:hr};var cr=function(e){this.costs=[],this.name="",this.name=e};(n["bikas.game.UpgradeCosts"]=cr).__name__=["bikas","game","UpgradeCosts"],cr.prototype={name:null,costs:null,__class__:cr};var dr=function(){this.upgrade_costs=[],this.points_per_level=[]};(n["bikas.game.Upgrades"]=dr).__name__=["bikas","game","Upgrades"],dr.prototype={points_per_level:null,upgrade_costs:null,__class__:dr};var mr=function(){this.level_items=[],this.permanent_items=[]};(n["bikas.game.OngoingPowers"]=mr).__name__=["bikas","game","OngoingPowers"],mr.prototype={permanent_items:null,level_items:null,__class__:mr};var fr=function(){this.levels_completed=0,this.type=0};(n["bikas.game.RewardedAd"]=fr).__name__=["bikas","game","RewardedAd"],fr.prototype={type:null,levels_completed:null,__class__:fr};var gr=function(){this.coins=0,this.chests_collected_guids=[],this.chests_rewarded=0};(n["bikas.game.ResourcesCollected"]=gr).__name__=["bikas","game","ResourcesCollected"],gr.prototype={chests_rewarded:null,chests_collected_guids:null,coins:null,__class__:gr};var vr=n["bikas.game.LevelDescriptionType"]={__ename__:["bikas","game","LevelDescriptionType"],__constructs__:["LevelRegular","LevelChallenge","LevelInterLevelMenu","LevelMainMenu"]};vr.LevelRegular=["LevelRegular",0],vr.LevelRegular.toString=i,(vr.LevelRegular.__enum__=vr).LevelChallenge=["LevelChallenge",1],vr.LevelChallenge.toString=i,(vr.LevelChallenge.__enum__=vr).LevelInterLevelMenu=["LevelInterLevelMenu",2],vr.LevelInterLevelMenu.toString=i,(vr.LevelInterLevelMenu.__enum__=vr).LevelMainMenu=["LevelMainMenu",3],vr.LevelMainMenu.toString=i,(vr.LevelMainMenu.__enum__=vr).__empty_constructs__=[vr.LevelRegular,vr.LevelChallenge,vr.LevelInterLevelMenu,vr.LevelMainMenu];var br=n["bikas.game.ChallengeType"]={__ename__:["bikas","game","ChallengeType"],__constructs__:["None","ChallengeEscapeFromWolf","ChallengeMountainRush","ChallengeBalancing","ChallengeSurvival","ChallengeBulletTaxi","ChallengeHuntThePrey","ChallengeAchievement","ChallengeCredits"]};br.None=["None",0],br.None.toString=i,(br.None.__enum__=br).ChallengeEscapeFromWolf=["ChallengeEscapeFromWolf",1],br.ChallengeEscapeFromWolf.toString=i,(br.ChallengeEscapeFromWolf.__enum__=br).ChallengeMountainRush=["ChallengeMountainRush",2],br.ChallengeMountainRush.toString=i,(br.ChallengeMountainRush.__enum__=br).ChallengeBalancing=["ChallengeBalancing",3],br.ChallengeBalancing.toString=i,(br.ChallengeBalancing.__enum__=br).ChallengeSurvival=["ChallengeSurvival",4],br.ChallengeSurvival.toString=i,(br.ChallengeSurvival.__enum__=br).ChallengeBulletTaxi=["ChallengeBulletTaxi",5],br.ChallengeBulletTaxi.toString=i,(br.ChallengeBulletTaxi.__enum__=br).ChallengeHuntThePrey=["ChallengeHuntThePrey",6],br.ChallengeHuntThePrey.toString=i,(br.ChallengeHuntThePrey.__enum__=br).ChallengeAchievement=["ChallengeAchievement",7],br.ChallengeAchievement.toString=i,(br.ChallengeAchievement.__enum__=br).ChallengeCredits=["ChallengeCredits",8],br.ChallengeCredits.toString=i,(br.ChallengeCredits.__enum__=br).__empty_constructs__=[br.None,br.ChallengeEscapeFromWolf,br.ChallengeMountainRush,br.ChallengeBalancing,br.ChallengeSurvival,br.ChallengeBulletTaxi,br.ChallengeHuntThePrey,br.ChallengeAchievement,br.ChallengeCredits];var yr=function(){this.level_data_save=null};(n["bikas.game.LevelDescription"]=yr).__name__=["bikas","game","LevelDescription"],yr.prototype={name:null,type:null,challenge_type:null,nice_name:null,level_number:null,max_stunt_score:null,available_in_final_game:null,level_data_save:null,__class__:yr};var xr=function(){this.chests_collected_guids=[],this.chests_rewarded=0,this.coins=0,this.stunt_stats=new Gr,this.completion_percent=0,this.place=-1,this.locked=!1,this.completed=!1,this.description=null,this.description_name=""};(n["bikas.game.LevelSave"]=xr).__name__=["bikas","game","LevelSave"],xr.prototype={description_name:null,description:null,completed:null,locked:null,place:null,completion_percent:null,stunt_stats:null,coins:null,chests_rewarded:null,chests_collected_guids:null,__class__:xr};var zr=function(){this.tutorial_shown_power=!1,this.tutorial_shown_nitro=!1,this.tutorial_shown_jump=!1,this.tutorial_shown_controls=!1,this.rewarded_ads=[],this.ongoing_powers=new mr,this.challenges_completed_claimed=[],this.challenges_completed=[],this.challenges_unlocked_shown_on_map=[],this.challenges_unlocked_shown=[],this.challenges_unlocked=[],this.achievements_claimed=[],this.achievements_shown=[],this.achievements_completed=[],this.bot_replaced_at_level_count=0,this.locked_cars=["car_rider","car_semioval","car_bug"],this.current_bot_car_lineup=["car_ice_cream_truck","car_farm_truck","car_tourcycle","car_cow"],this.car_own_list=["car_bus"],this.current_car="car_bus",this.car_upgrades=new hr,this.upgrade_points=0,this.coins=0,this.chests=0,this.credits_shown=!1,this.level_saves=[],this.previous_level_name="",this.current_level_name="level_1",this.save_date="",this.save_data_version=1};(n["bikas.game.GameSave"]=zr).__name__=["bikas","game","GameSave"],zr.prototype={save_data_version:null,save_date:null,current_level_name:null,previous_level_name:null,level_saves:null,credits_shown:null,chests:null,coins:null,upgrade_points:null,car_upgrades:null,current_car:null,car_own_list:null,current_bot_car_lineup:null,locked_cars:null,bot_replaced_at_level_count:null,achievements_completed:null,achievements_shown:null,achievements_claimed:null,challenges_unlocked:null,challenges_unlocked_shown:null,challenges_unlocked_shown_on_map:null,challenges_completed:null,challenges_completed_claimed:null,ongoing_powers:null,rewarded_ads:null,tutorial_shown_controls:null,tutorial_shown_jump:null,tutorial_shown_nitro:null,tutorial_shown_power:null,__class__:zr};var wr=function(){};(n["bikas.game.ProgressionDo"]=wr).__name__=["bikas","game","ProgressionDo"],wr.createCarSettings=function(){var e=function(e,t,n,i){for(var r=0;r<e.length;){var a=e[r];if(++r,a.name==t)return void xl.trace("warning: car with name "+t+" already exists in car_setting array",{fileName:"ProgressionDo.hx",lineNumber:41,className:"bikas.game.ProgressionDo",methodName:"createCarSettings"})}var s=new pr;s.name=t,s.initial_config=i,s.price=n,e.push(s)},t=function(e,t,n){for(var i=0;i<e.length;){var r=e[i];if(++i,r.name==t)return void(r.personality=n)}xl.trace("warning: couldn't find "+t,{fileName:"ProgressionDo.hx",lineNumber:59,className:"bikas.game.ProgressionDo",methodName:"createCarSettings"})},n=function(e,t,n,i,r,a,s,l,o,_){null==_&&(_=0),null==o&&(o=1),null==l&&(l=1),null==s&&(s=-723),null==a&&(a=1.6),null==r&&(r=35),null==i&&(i=6),null==n&&(n=1),null==t&&(t=700),null==e&&(e=5.5);var p=new Nt;return p.drive_impulse=e,p.drive_velocity_max=t,p.rotation_angular_impulse_coeff=n,p.rotation_angular_velocity_max=i,p.nitro_impulse=r,p.nitro_velocity_to_drive_velocity_max_coeff=a,p.jump_impulse=s,p.grip_increase_coeff=l,p.grip_decrease_coeff=o,p.armor_coeff=_,p.drive_wheel_angular_impulse=5*e/5.5,p.drive_wheel_angular_velocity_max=33*t/700,p.info_max_height_jump_time=.58,p.info_max_height_jump_distance=200,p},i=[];return e(i,"car_rider",600,n(5,700,1,7,35,1.6,-723,1.1,.9,.35)),e(i,"car_semioval",500,n(4.8,700,.9,5,35,1.6,-723,1,1,.2)),e(i,"car_bug",400,n(4.6,700,1.05,6,35,1.6,-750,1.1,.9,.1)),e(i,"car_rudolf",200,n(4.3,700,.85,5,35,1.6,-723,1,1,.1)),e(i,"car_bus",190,n(4.05,700,.8,4,35,1.6,-650,.9,1.1,.4)),e(i,"car_taxi",250,n(4.4,700,1,5,35,1.6,-700,1,1,.3)),e(i,"car_farm_truck",160,n(3.9,700,.85,5,35,1.6,-650,.8,1.2,.5)),e(i,"car_cow",130,n(4,700,.7,5,35,1.6,-650,.8,1.2,.15)),e(i,"car_ice_cream_truck",140,n(4,700,.6,4,35,1.6,-550,.8,1.2,.3)),e(i,"car_coyote",160,n(4.15,700,.85,5,35,1.6,-723,.95,1.15,.1)),e(i,"car_tourcycle",150,n(4,700,1.1,8,35,1.6,-800,1.2,.8,.05)),t(i,"car_rudolf",new tt(.8,.2,.4,.5)),t(i,"car_bus",new tt(.2,.2,.3,.1)),t(i,"car_farm_truck",new tt(.2,.7,.6,.1)),t(i,"car_semioval",new tt(.7,.5,.5,.3)),t(i,"car_tourcycle",new tt(.2,.2,.8,.8)),t(i,"car_ice_cream_truck",new tt(.2,.1,.5,.3)),t(i,"car_bug",new tt(.6,.2,.5,.3)),t(i,"car_coyote",new tt(.3,0,.1,.7)),t(i,"car_cow",new tt(.1,.1,.1,.5)),t(i,"car_rider",new tt(1,1,.1,.1)),t(i,"car_taxi",new tt(.8,.8,.1,.1)),i},wr.createCarUpgradeData=function(){var e=new ur,t=function(e,t,n){for(var i=[],r=0,a=n;r<a;){var s=r++;i.push(ca.linear(e,t,s/(n-1)))}return i};return e.drive_impulse_coeffs=t(1.2,1.6,10),e.drive_velocity_max_coeffs=t(1.2,1.6,10),e.rotation_angular_impulse_coeff_coeffs=t(1,1.54,10),e.rotation_angular_velocity_max_coeffs=t(1,1.54,10),e.grip_increase_coeffs=t(1,1.54,10),e.grip_decrease_coeffs=t(1,.75,10),e.nitro_impulse_coeffs=t(1,1.54,10),e.armor_coeffs=t(0,.5,10),e.nitro_velocity_coeff_coeffs=t(1,.75,10),e},wr.getCarSettingByName=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i}return xl.trace("warning: car setting with name "+t+" does not exist",{fileName:"ProgressionDo.hx",lineNumber:238,className:"bikas.game.ProgressionDo",methodName:"getCarSettingByName"}),null},wr.getBotPersonalityByName=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.name==t)return i.personality}return xl.trace("warning: couldn't find "+t+" personality",{fileName:"ProgressionDo.hx",lineNumber:248,className:"bikas.game.ProgressionDo",methodName:"getBotPersonalityByName"}),new tt(.5,.5,.5,.5)},wr.getUpgradedCarConfigCopy=function(e,t,n,i){for(var r=0;r<n.length;){var a=n[r];if(++r,a.name==i){var s=St.copyConfig(a.initial_config),l=function(e,t){return null==e&&(xl.trace("warning: float_array == null",{fileName:"GlobalMacro.hx",lineNumber:13,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),1)?1:0==e.length?(xl.trace("warning: float_array.length == 0",{fileName:"ProgressionDo.hx",lineNumber:265,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),1):t>=e.length?(xl.trace("warning: index >= float_array.length",{fileName:"ProgressionDo.hx",lineNumber:269,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),e[e.length-1]):t<0?(xl.trace("warning: index < 0",{fileName:"ProgressionDo.hx",lineNumber:273,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),e[0]):e[t]};return s.drive_impulse*=l(e.drive_impulse_coeffs,t.acceleration),s.drive_velocity_max*=l(e.drive_velocity_max_coeffs,t.top_speed),s.rotation_angular_impulse_coeff*=l(e.rotation_angular_impulse_coeff_coeffs,t.handling),s.rotation_angular_velocity_max*=l(e.rotation_angular_velocity_max_coeffs,t.handling),s.nitro_impulse*=l(e.nitro_impulse_coeffs,t.acceleration),s.nitro_velocity_to_drive_velocity_max_coeff*=l(e.nitro_velocity_coeff_coeffs,t.top_speed),s.grip_increase_coeff*=l(e.grip_increase_coeffs,t.handling),s.grip_decrease_coeff*=l(e.grip_decrease_coeffs,t.handling),s.armor_coeff+=l(e.armor_coeffs,t.armor),s.armor_coeff=pa.clamp0to1(s.armor_coeff),s.drive_wheel_angular_impulse=5*s.drive_impulse/5.5,s.drive_wheel_angular_velocity_max=33*s.drive_velocity_max/700,s}}return xl.trace("warning: couldn't find "+i+" car config",{fileName:"ProgressionDo.hx",lineNumber:303,className:"bikas.game.ProgressionDo",methodName:"getUpgradedCarConfigCopy"}),new Nt},wr.createUpgrades=function(){var e=new dr,t=[];t.push(new cr("top_speed")),t.push(new cr("acceleration")),t.push(new cr("handling")),t.push(new cr("armor"));for(var n=0;n<9;){var i=n++/8,r=ca.linear;t[0].costs.push(Math.round(r(4,20,i))),t[1].costs.push(Math.round(r(2,12,i))),t[2].costs.push(Math.round(r(1,5,i))),t[3].costs.push(Math.round(r(1,7,i)))}for(var a,s=0,l=0;l<t.length;){var o=t[l];++l,s+=(a=o,pa.sumIntArray(a.costs))}for(var _=function(e,t,n){null==n&&(n=.5),null==t&&(t=30);for(var i=e/t,r=Math.round(ca.linear(i,0,n)),a=[],s=0,l=0,o=t;l<o;){var _=l++/(t-1),p=Math.round(pa.interpolate(-r,r,_)),u=Math.round(i+p);s+=u,a.push(u)}if(0<a.length){var h=e-s;a[a.length-1]+=h}return a}(s,30,.2),p=[],u=0,h=0;h<_.length;){var c=_[h];++h,u+=c,p.push(u)}return t[0].costs[t[0].costs.length-1]-=2,e.upgrade_costs=t,e.points_per_level=_,e},wr.createGameSave=function(e){var t=new zr;t.level_saves=[];for(var n=0;n<e.length;){var i=e[n];++n;var r=new xr;r.description_name=i.name,r.description=i,t.level_saves.push(r)}return t},wr.createLevelDescriptions=function(e){for(var t=function(t,n,i,r,a,s,l,o,_){for(var p=0;p<t.length;){var u=t[p];if(++p,u.name==s)return void xl.trace("warning: description with exactly the same name already exists: "+s+" (can't have the same names because names are used as unique ID's for the levels)",{fileName:"ProgressionDo.hx",lineNumber:413,className:"bikas.game.ProgressionDo",methodName:"createLevelDescriptions"})}var h=new yr;h.type=r,h.challenge_type=a,h.name=s,h.nice_name=_;var c=1,d=(h.level_number=l)-1;0<=d&&d<n.length&&(c=n[d]),h.max_stunt_score=100*Math.ceil(o*c/100),0==e.type?h.available_in_final_game=!0:h.available_in_final_game=i,h.level_data_save=null;for(var m=0,f=Os.level_data_saves;m<f.length;){var g=f[m];if(++m,g.name==s){h.level_data_save=g;break}}i&&null==h.level_data_save&&xl.trace("warning: could not find level_save for "+s,{fileName:"ProgressionDo.hx",lineNumber:446,className:"bikas.game.ProgressionDo",methodName:"createLevelDescriptions"}),t.push(h)},n=[],i=[],r=0;r<30;){var a=r++,s=ca.getT(0,29,a);s=ca.linear(.25,1,s),i.push(Math.round(100*s)/100)}return t(n,i,!0,vr.LevelMainMenu,br.None,"main_menu",0,0,"Main Menu"),t(n,i,!0,vr.LevelInterLevelMenu,br.None,"inter_level_menu",0,0,"Inter Level Menu"),t(n,i,!0,vr.LevelChallenge,br.ChallengeEscapeFromWolf,"challenge_escape_from_wolf",0,0,"Escape From Wolf Challenge"),t(n,i,!0,vr.LevelChallenge,br.ChallengeMountainRush,"challenge_mountain_rush",0,0,"Mountain Rush Challenge"),t(n,i,!0,vr.LevelChallenge,br.ChallengeBalancing,"challenge_balancing",0,0,"Balancing Challenge"),t(n,i,!0,vr.LevelChallenge,br.ChallengeSurvival,"challenge_survival",0,0,"Survival Challenge"),t(n,i,!0,vr.LevelChallenge,br.ChallengeBulletTaxi,"challenge_bullet_taxi",0,0,"Bullet Taxi Challenge"),t(n,i,!0,vr.LevelChallenge,br.ChallengeHuntThePrey,"challenge_hunt_the_prey",0,0,"Hunt The Prey Challenge"),t(n,i,!0,vr.LevelChallenge,br.ChallengeAchievement,"challenge_achievement",0,0,"100%"),t(n,i,!0,vr.LevelChallenge,br.ChallengeCredits,"challenge_credits",0,0,"Credits"),t(n,i,!0,vr.LevelRegular,br.None,"level_1",1,6e3,"The Island"),t(n,i,!0,vr.LevelRegular,br.None,"level_2",2,7e3,"The Sailing Bay"),t(n,i,!0,vr.LevelRegular,br.None,"level_3",3,9e3,"The Failed Ship"),t(n,i,!0,vr.LevelRegular,br.None,"level_4",4,1e4,"The Narrow Passage"),t(n,i,!0,vr.LevelRegular,br.None,"level_5",5,15e3,"The Sea Village"),t(n,i,!0,vr.LevelRegular,br.None,"level_6_dip",6,13e3,"The Forgotten Caves"),t(n,i,!0,vr.LevelRegular,br.None,"level_7",7,9300,"The Pirate Bay"),t(n,i,!0,vr.LevelRegular,br.None,"level_8",8,11800,"The High Hills"),t(n,i,!0,vr.LevelRegular,br.None,"level_9_peak",9,11300,"The Peak"),t(n,i,!0,vr.LevelRegular,br.None,"level_10",10,7400,"The Beach Village"),t(n,i,!0,vr.LevelRegular,br.None,"level_11",11,11900,"The Valley"),t(n,i,!0,vr.LevelRegular,br.None,"level_12",12,6900,"The Flat Roads"),t(n,i,!0,vr.LevelRegular,br.None,"level_13",13,10800,"The Modest Caves"),t(n,i,!0,vr.LevelRegular,br.None,"level_14",14,14200,"The Sea Town"),t(n,i,!0,vr.LevelRegular,br.None,"level_15",15,6400,"The Empty Sea"),t(n,i,!0,vr.LevelRegular,br.None,"level_16",16,10100,"The Volcano Bay"),t(n,i,!0,vr.LevelRegular,br.None,"level_17",17,12100,"The Sea Lane"),t(n,i,!0,vr.LevelRegular,br.None,"level_18",18,8e3,"The Rigged Caves"),t(n,i,!0,vr.LevelRegular,br.None,"level_19",19,12100,"The Dip"),t(n,i,!0,vr.LevelRegular,br.None,"level_20",20,16500,"The Bumpy Road"),t(n,i,!0,vr.LevelRegular,br.None,"level_21",21,4500,"The Graveyard"),t(n,i,!0,vr.LevelRegular,br.None,"level_22",22,10200,"The Island"),t(n,i,!0,vr.LevelRegular,br.None,"level_23",23,11200,"The Mountain"),t(n,i,!0,vr.LevelRegular,br.None,"level_24",24,8300,"The Dangerous Heights"),t(n,i,!0,vr.LevelRegular,br.None,"level_25",25,11100,"The Hills And Caves"),t(n,i,!0,vr.LevelRegular,br.None,"level_26",26,5700,"The Top"),t(n,i,!0,vr.LevelRegular,br.None,"level_27",27,24e3,"The Smooth Slopes"),t(n,i,!0,vr.LevelRegular,br.None,"level_28",28,7e3,"The Rugged Lands"),t(n,i,!0,vr.LevelRegular,br.None,"level_29",29,100,"The Treasure"),t(n,i,!0,vr.LevelRegular,br.None,"level_30",30,15400,"The End"),t(n,i,!1,vr.LevelRegular,br.None,"test",50,1e3,"The Island"),t(n,i,!1,vr.LevelRegular,br.None,"test_empty",51,1e3,"The Island"),t(n,i,!1,vr.LevelRegular,br.None,"test_full",52,1e3,"The Island"),n},wr.getTotalRegularLevelsCompleted=function(e){for(var t=0,n=0,i=e.level_saves;n<i.length;){var r=i[n];++n,r.description.type==vr.LevelRegular&&r.completed&&++t}return t},wr.setBotCarLineup=function(e,t){for(var n=[],i=0;i<t.length;){var r=t[i];++i,r.completed&&r.description.type==vr.LevelRegular&&n.push(r)}var a=function(t){return t!=e.current_car&&-1==e.current_bot_car_lineup.indexOf(t)},s=function(t){return t!=e.current_car&&-1!=e.current_bot_car_lineup.indexOf(t)},l=or.rank_1_cars.slice().filter(a),o=or.rank_2_cars.slice().filter(a),_=or.rank_3_cars.slice().filter(a),p=or.rank_1_cars.slice().filter(s),u=or.rank_2_cars.slice().filter(s),h=or.rank_3_cars.slice().filter(s);if(-1!=e.current_bot_car_lineup.indexOf(e.current_car)){var c=e.current_bot_car_lineup.indexOf(e.current_car);-1!=or.rank_1_cars.indexOf(e.current_car)&&0<l.length?e.current_bot_car_lineup[c]=pa.getRandomArrayElement(l):-1!=or.rank_2_cars.indexOf(e.current_car)&&0<o.length?e.current_bot_car_lineup[c]=pa.getRandomArrayElement(o):-1!=or.rank_3_cars.indexOf(e.current_car)&&0<_.length||0<_.length?e.current_bot_car_lineup[c]=pa.getRandomArrayElement(_):0<o.length?e.current_bot_car_lineup[c]=pa.getRandomArrayElement(o):0<l.length?e.current_bot_car_lineup[c]=pa.getRandomArrayElement(l):xl.trace("warning: no cars to replace to? something went wrong here...",{fileName:"ProgressionDo.hx",lineNumber:623,className:"bikas.game.ProgressionDo",methodName:"setBotCarLineup"}),ha.shuffleArray(e.current_bot_car_lineup)}else if(0<n.length&&n.length!=e.bot_replaced_at_level_count){var d=n[n.length-1],m=!1;if(e.bot_replaced_at_level_count=n.length,1==d.place?0<h.length&&0<o.length?e.current_bot_car_lineup[pa.getRandomArrayIndex(h)]=pa.getRandomArrayElement(o):0<u.length&&0<l.length?e.current_bot_car_lineup[pa.getRandomArrayIndex(u)]=pa.getRandomArrayElement(l):0<h.length&&0<l.length?e.current_bot_car_lineup[pa.getRandomArrayIndex(h)]=pa.getRandomArrayElement(l):m=!0:2==d.place?m=!0:0<p.length&&0<o.length?e.current_bot_car_lineup[pa.getRandomArrayIndex(p)]=pa.getRandomArrayElement(o):0<u.length&&0<_.length?e.current_bot_car_lineup[pa.getRandomArrayIndex(u)]=pa.getRandomArrayElement(_):0<p.length&&0<_.length?e.current_bot_car_lineup[pa.getRandomArrayIndex(p)]=pa.getRandomArrayElement(_):m=!0,m){var f=[];if(0<p.length&&0<l.length&&f.push(1),0<u.length&&0<o.length&&f.push(2),0<h.length&&0<_.length&&f.push(3),0==f.length)xl.trace("warning: something went wrong, there should be available cars to replace to with same rank",{fileName:"ProgressionDo.hx",lineNumber:697,className:"bikas.game.ProgressionDo",methodName:"setBotCarLineup"});else{var g=pa.getRandomArrayElement(f);1==g?e.current_bot_car_lineup[pa.getRandomArrayIndex(p)]=pa.getRandomArrayElement(l):2==g?e.current_bot_car_lineup[pa.getRandomArrayIndex(u)]=pa.getRandomArrayElement(o):3==g?e.current_bot_car_lineup[pa.getRandomArrayIndex(h)]=pa.getRandomArrayElement(_):xl.trace("warning: invalid rank",{fileName:"ProgressionDo.hx",lineNumber:709,className:"bikas.game.ProgressionDo",methodName:"setBotCarLineup"})}}ha.shuffleArray(e.current_bot_car_lineup)}},wr.applyRewardItem=function(e,t,n,i){if(n.desc.type==kr.ReceiveCoins){var r=Math.round(n.generated_amounts[0]);e.coins+=r,Gn.pushNotification(i,"Received "+r+" Coins!', ")}else if(n.desc.type==kr.OneTimeUnlockBugCar)-1!=e.locked_cars.indexOf("car_bug")&&s.remove(e.locked_cars,"car_bug"),Gn.pushNotification(i,'Unlocked "Bug" Car!',"");else{n.desc.expiration_type==Nr.Permanent?e.ongoing_powers.permanent_items.push(n):n.desc.expiration_type==Nr.OneLevel||n.desc.expiration_type==Nr.OneTime?e.ongoing_powers.level_items.push(n):xl.trace("warning: unhandled item.desc.expiration_type: "+p.string(n.desc.expiration_type),{fileName:"ProgressionDo.hx",lineNumber:748,className:"bikas.game.ProgressionDo",methodName:"applyRewardItem"});var a=h.replace(n.desc.name,"(rare)","");Gn.pushNotification(i,"Added: "+a,""),t.current_items.push(n)}};var kr=n["bikas.game.RewardItemType"]={__ename__:["bikas","game","RewardItemType"],__constructs__:["ConstantAllExplosivesImmunity","ConstantExplosiveBarrelImmunity","ConstantBombAndDynamiteImmunity","ConstantFasterAcceleration","ConstantMoreBoost","ConstantBombAndDynamitePower","ConstantHandling","OneTimeAllExplosivesImmunity","OneTimeExplosiveBarrelImmunity","OneTimeBombAndDynamiteImmunity","OneTimeMoreBoost","OneTimeMoreBombs","OneTimeMoreDynamites","OneTimeAtomicBomb","OneTimePartyTime","OneTimeStartFirst","OneTimeUnlockBugCar","AchievementLevel","ReceiveCoins"]};kr.ConstantAllExplosivesImmunity=["ConstantAllExplosivesImmunity",0],kr.ConstantAllExplosivesImmunity.toString=i,(kr.ConstantAllExplosivesImmunity.__enum__=kr).ConstantExplosiveBarrelImmunity=["ConstantExplosiveBarrelImmunity",1],kr.ConstantExplosiveBarrelImmunity.toString=i,(kr.ConstantExplosiveBarrelImmunity.__enum__=kr).ConstantBombAndDynamiteImmunity=["ConstantBombAndDynamiteImmunity",2],kr.ConstantBombAndDynamiteImmunity.toString=i,(kr.ConstantBombAndDynamiteImmunity.__enum__=kr).ConstantFasterAcceleration=["ConstantFasterAcceleration",3],kr.ConstantFasterAcceleration.toString=i,(kr.ConstantFasterAcceleration.__enum__=kr).ConstantMoreBoost=["ConstantMoreBoost",4],kr.ConstantMoreBoost.toString=i,(kr.ConstantMoreBoost.__enum__=kr).ConstantBombAndDynamitePower=["ConstantBombAndDynamitePower",5],kr.ConstantBombAndDynamitePower.toString=i,(kr.ConstantBombAndDynamitePower.__enum__=kr).ConstantHandling=["ConstantHandling",6],kr.ConstantHandling.toString=i,(kr.ConstantHandling.__enum__=kr).OneTimeAllExplosivesImmunity=["OneTimeAllExplosivesImmunity",7],kr.OneTimeAllExplosivesImmunity.toString=i,(kr.OneTimeAllExplosivesImmunity.__enum__=kr).OneTimeExplosiveBarrelImmunity=["OneTimeExplosiveBarrelImmunity",8],kr.OneTimeExplosiveBarrelImmunity.toString=i,(kr.OneTimeExplosiveBarrelImmunity.__enum__=kr).OneTimeBombAndDynamiteImmunity=["OneTimeBombAndDynamiteImmunity",9],kr.OneTimeBombAndDynamiteImmunity.toString=i,(kr.OneTimeBombAndDynamiteImmunity.__enum__=kr).OneTimeMoreBoost=["OneTimeMoreBoost",10],kr.OneTimeMoreBoost.toString=i,(kr.OneTimeMoreBoost.__enum__=kr).OneTimeMoreBombs=["OneTimeMoreBombs",11],kr.OneTimeMoreBombs.toString=i,(kr.OneTimeMoreBombs.__enum__=kr).OneTimeMoreDynamites=["OneTimeMoreDynamites",12],kr.OneTimeMoreDynamites.toString=i,(kr.OneTimeMoreDynamites.__enum__=kr).OneTimeAtomicBomb=["OneTimeAtomicBomb",13],kr.OneTimeAtomicBomb.toString=i,(kr.OneTimeAtomicBomb.__enum__=kr).OneTimePartyTime=["OneTimePartyTime",14],kr.OneTimePartyTime.toString=i,(kr.OneTimePartyTime.__enum__=kr).OneTimeStartFirst=["OneTimeStartFirst",15],kr.OneTimeStartFirst.toString=i,(kr.OneTimeStartFirst.__enum__=kr).OneTimeUnlockBugCar=["OneTimeUnlockBugCar",16],kr.OneTimeUnlockBugCar.toString=i,(kr.OneTimeUnlockBugCar.__enum__=kr).AchievementLevel=["AchievementLevel",17],kr.AchievementLevel.toString=i,(kr.AchievementLevel.__enum__=kr).ReceiveCoins=["ReceiveCoins",18],kr.ReceiveCoins.toString=i,(kr.ReceiveCoins.__enum__=kr).__empty_constructs__=[kr.ConstantAllExplosivesImmunity,kr.ConstantExplosiveBarrelImmunity,kr.ConstantBombAndDynamiteImmunity,kr.ConstantFasterAcceleration,kr.ConstantMoreBoost,kr.ConstantBombAndDynamitePower,kr.ConstantHandling,kr.OneTimeAllExplosivesImmunity,kr.OneTimeExplosiveBarrelImmunity,kr.OneTimeBombAndDynamiteImmunity,kr.OneTimeMoreBoost,kr.OneTimeMoreBombs,kr.OneTimeMoreDynamites,kr.OneTimeAtomicBomb,kr.OneTimePartyTime,kr.OneTimeStartFirst,kr.OneTimeUnlockBugCar,kr.AchievementLevel,kr.ReceiveCoins];var Sr=function(){};(n["bikas.game.RewardItemRange"]=Sr).__name__=["bikas","game","RewardItemRange"],Sr.prototype={min:null,max:null,__class__:Sr};var Cr=function(){this.char_end_index=0,this.char_start_index=0,this.ranges=[]};(n["bikas.game.RewardItemRanges"]=Cr).__name__=["bikas","game","RewardItemRanges"],Cr.prototype={ranges:null,char_start_index:null,char_end_index:null,__class__:Cr};var Nr=n["bikas.game.RewardItemExpirationType"]={__ename__:["bikas","game","RewardItemExpirationType"],__constructs__:["OneTime","OneLevel","Permanent"]};Nr.OneTime=["OneTime",0],Nr.OneTime.toString=i,(Nr.OneTime.__enum__=Nr).OneLevel=["OneLevel",1],Nr.OneLevel.toString=i,(Nr.OneLevel.__enum__=Nr).Permanent=["Permanent",2],Nr.Permanent.toString=i,(Nr.Permanent.__enum__=Nr).__empty_constructs__=[Nr.OneTime,Nr.OneLevel,Nr.Permanent];var Pr=function(){this.ranges=[],this.probability=1};(n["bikas.game.RewardItemDesc"]=Pr).__name__=["bikas","game","RewardItemDesc"],Pr.prototype={id:null,name:null,type:null,expiration_type:null,reward_texture_name:null,ongoing_texture_name:null,description:null,probability:null,ranges:null,__class__:Pr};var Mr=function(){this.shown=!1,this.desc=null};(n["bikas.game.RewardItem"]=Mr).__name__=["bikas","game","RewardItem"],Mr.prototype={id:null,desc:null,generated_amounts:null,description_text:null,shown:null,__class__:Mr};var Ir=function(){};(n["bikas.game.RewardCard"]=Ir).__name__=["bikas","game","RewardCard"],Ir.prototype={item:null,container:null,background:null,item_sprite:null,name_text:null,description_text:null,__class__:Ir};var Ar=function(){this.cards=[]};(n["bikas.game.RewardSelection"]=Ar).__name__=["bikas","game","RewardSelection"],Ar.prototype={container:null,middle_container:null,background:null,title_text:null,or_text:null,cards:null,__class__:Ar};var Tr=n["bikas.game.AchievementType"]={__ename__:["bikas","game","AchievementType"],__constructs__:["Finish2Levels","Finish6Levels","Stunt3xFrontFlip","Stunt3xCombo","Finish10LevelsWith100Score","Stunt10BackFlipsInALevel","Stunt100Flips","Finish20Levels1st","Stunt10xCombo","Finish30LevelsWith100Score"]};Tr.Finish2Levels=["Finish2Levels",0],Tr.Finish2Levels.toString=i,(Tr.Finish2Levels.__enum__=Tr).Finish6Levels=["Finish6Levels",1],Tr.Finish6Levels.toString=i,(Tr.Finish6Levels.__enum__=Tr).Stunt3xFrontFlip=["Stunt3xFrontFlip",2],Tr.Stunt3xFrontFlip.toString=i,(Tr.Stunt3xFrontFlip.__enum__=Tr).Stunt3xCombo=["Stunt3xCombo",3],Tr.Stunt3xCombo.toString=i,(Tr.Stunt3xCombo.__enum__=Tr).Finish10LevelsWith100Score=["Finish10LevelsWith100Score",4],Tr.Finish10LevelsWith100Score.toString=i,(Tr.Finish10LevelsWith100Score.__enum__=Tr).Stunt10BackFlipsInALevel=["Stunt10BackFlipsInALevel",5],Tr.Stunt10BackFlipsInALevel.toString=i,(Tr.Stunt10BackFlipsInALevel.__enum__=Tr).Stunt100Flips=["Stunt100Flips",6],Tr.Stunt100Flips.toString=i,(Tr.Stunt100Flips.__enum__=Tr).Finish20Levels1st=["Finish20Levels1st",7],Tr.Finish20Levels1st.toString=i,(Tr.Finish20Levels1st.__enum__=Tr).Stunt10xCombo=["Stunt10xCombo",8],Tr.Stunt10xCombo.toString=i,(Tr.Stunt10xCombo.__enum__=Tr).Finish30LevelsWith100Score=["Finish30LevelsWith100Score",9],Tr.Finish30LevelsWith100Score.toString=i,(Tr.Finish30LevelsWith100Score.__enum__=Tr).__empty_constructs__=[Tr.Finish2Levels,Tr.Finish6Levels,Tr.Stunt3xFrontFlip,Tr.Stunt3xCombo,Tr.Finish10LevelsWith100Score,Tr.Stunt10BackFlipsInALevel,Tr.Stunt100Flips,Tr.Finish20Levels1st,Tr.Stunt10xCombo,Tr.Finish30LevelsWith100Score];var Dr=function(){};(n["bikas.game.AchievementDesc"]=Dr).__name__=["bikas","game","AchievementDesc"],Dr.prototype={id:null,name:null,type:null,requirement:null,item:null,texture_name:null,__class__:Dr};var Er=function(){};(n["bikas.game.ChallengeDesc"]=Er).__name__=["bikas","game","ChallengeDesc"],Er.prototype={id:null,name:null,type:null,requirement:null,item:null,__class__:Er};var Or=function(){};(n["bikas.game.OngoingPowerDisplayDescription"]=Or).__name__=["bikas","game","OngoingPowerDisplayDescription"],Or.prototype={container:null,background:null,icon:null,text:null,item:null,__class__:Or};var Br=n["bikas.game.OngoingPowerDisplayItemAnimType"]={__ename__:["bikas","game","OngoingPowerDisplayItemAnimType"],__constructs__:["ItemDefault","ItemPhaseIn","ItemPhaseOut","ItemWasJustUsed"]};Br.ItemDefault=["ItemDefault",0],Br.ItemDefault.toString=i,(Br.ItemDefault.__enum__=Br).ItemPhaseIn=["ItemPhaseIn",1],Br.ItemPhaseIn.toString=i,(Br.ItemPhaseIn.__enum__=Br).ItemPhaseOut=["ItemPhaseOut",2],Br.ItemPhaseOut.toString=i,(Br.ItemPhaseOut.__enum__=Br).ItemWasJustUsed=["ItemWasJustUsed",3],Br.ItemWasJustUsed.toString=i,(Br.ItemWasJustUsed.__enum__=Br).__empty_constructs__=[Br.ItemDefault,Br.ItemPhaseIn,Br.ItemPhaseOut,Br.ItemWasJustUsed];var Lr=function(){this.items=[]};(n["bikas.game.OngoingPowerDisplayItem"]=Lr).__name__=["bikas","game","OngoingPowerDisplayItem"],Lr.prototype={type:null,container:null,sprite:null,items:null,item_icon_texture_name:null,width:null,height:null,current_time:null,__class__:Lr};var jr=function(){this.remove_display_items=[],this.display_items=[],this.skip_expand_display_item=null,this.expand_display_item=null,this.just_used_items=[],this.current_items=[]};(n["bikas.game.OngoingPowersDisplay"]=jr).__name__=["bikas","game","OngoingPowersDisplay"],jr.prototype={current_items:null,just_used_items:null,expand_display_item:null,skip_expand_display_item:null,display_items:null,remove_display_items:null,__class__:jr};var Fr=function(){};(n["bikas.game.RewardDo"]=Fr).__name__=["bikas","game","RewardDo"],Fr.createRewardsForChests=function(){var e=[];return Fr.pushRewardItemDesc(e,"explosion_armor_id","Explosion Armor",kr.ConstantAllExplosivesImmunity,Nr.OneLevel,Fr.armor_texture,1,"+{5-10,11-15,16-25}% constant immunity against all explosives (expires after 1 level)"),Fr.pushRewardItemDesc(e,"explosion_defense_id","Explosion Defense",kr.OneTimeAllExplosivesImmunity,Nr.OneTime,Fr.armor_texture,1,"One time +{21-40,40-60,60-80}% immunity against any explosive"),Fr.pushRewardItemDesc(e,"barrel_barrier_id","Barrel Barrier",kr.ConstantExplosiveBarrelImmunity,Nr.OneLevel,Fr.armor_texture,1,"+{11-15,16-30,31-50}% constant immunity against explosive barrels (expires after 1 level)"),Fr.pushRewardItemDesc(e,"barrel_insurance_id","Barrel Insurance",kr.OneTimeExplosiveBarrelImmunity,Nr.OneTime,Fr.armor_texture,1,"One time +{41-60,61-80,81-100}% immunity against 1 explosive barrel"),Fr.pushRewardItemDesc(e,"defense_id","Defense",kr.ConstantBombAndDynamiteImmunity,Nr.OneLevel,Fr.armor_texture,1,"+{11-15,16-30,31-50}% constant immunity against bombs and dynamites (expires after 1 level)"),Fr.pushRewardItemDesc(e,"deflection_id","Deflection",kr.OneTimeBombAndDynamiteImmunity,Nr.OneTime,Fr.armor_texture,1,"One time +{41-60,61-80,81-100}% immunity against 1 bomb or 1 dynamite"),Fr.pushRewardItemDesc(e,"more_power_id","More Power",kr.ConstantBombAndDynamitePower,Nr.OneLevel,Fr.bomb_texture,1,"Increase power of your bombs and dynamites by +{11-15,16-30,31-50}% (expires after 1 level)"),Fr.pushRewardItemDesc(e,"aggressive_start_id","Agressive Start",kr.OneTimeMoreBombs,Nr.OneLevel,Fr.bomb_texture,1,"Start next level with 1 bomb"),Fr.pushRewardItemDesc(e,"split_the_drivers_id","Split The Drivers",kr.OneTimeMoreDynamites,Nr.OneLevel,Fr.dynamite_texture,1,"Start next level with 1 dynamite"),Fr.pushRewardItemDesc(e,"acceleration_id","Acceleration",kr.ConstantFasterAcceleration,Nr.OneLevel,Fr.acceleration_texture,1,"+{2-4,5-7,8-10}% faster acceleration (expires after 1 level)"),Fr.pushRewardItemDesc(e,"boosted_boost_id","Boosted Boost",kr.ConstantMoreBoost,Nr.OneLevel,Fr.boost_texture,1,"+{5-10,11-15,16-25}% faster boost (expires after 1 level)"),Fr.pushRewardItemDesc(e,"boosted_start_id","Boosted Start",kr.OneTimeMoreBoost,Nr.OneLevel,Fr.boost_texture,1,"Add +{1,2,3}x boost for the next level"),Fr.pushRewardItemDesc(e,"more_money_id","More Money",kr.ReceiveCoins,Nr.OneTime,Fr.coin_texture,1,"+{20-40} coins"),Fr.pushRewardItemDesc(e,"atomic_bomb_id","Atomic Bomb (rare)",kr.OneTimeAtomicBomb,Nr.OneLevel,Fr.bomb_texture,.1,"Start next level with a bomb which is {250}% more powerful than the regular one"),Fr.pushRewardItemDesc(e,"party_time_id","Party Time (rare)",kr.OneTimePartyTime,Nr.OneLevel,Fr.balloons_texture,.1,"Attach balloons to all other cars except yours in the next level"),Fr.pushRewardItemDesc(e,"start_first_id","Start First (rare)",kr.OneTimeStartFirst,Nr.OneLevel,Fr.first_texture,.1,"Start first in the next level"),Fr.pushRewardItemDesc(e,"pile_of_gold_id","Pile of Gold (rare)",kr.ReceiveCoins,Nr.OneTime,Fr.coin_texture,.02,"+{200-400} coins"),e},Fr.pushRewardItemDesc=function(e,t,n,i,r,a,s,l){var o=new Pr;o.id=t,o.name=n,o.type=i,o.expiration_type=r,o.reward_texture_name=Fr.reward_prefix+a,o.ongoing_texture_name=Fr.ongoing_prefix+a,o.probability=s,o.description=l,o.ranges=Fr.parseDescriptionIntoRanges(o.description),e.push(o)},Fr.createRewardsForAchievements=function(){var e=[];return Fr.pushAchievementDesc(e,"beginner_id","Beginner",Tr.Finish2Levels,"Finish 2 levels","More Money",kr.ReceiveCoins,Fr.coin_texture,"+{150} coins"),Fr.pushAchievementDesc(e,"adventurer_id","Adventurer",Tr.Finish6Levels,"Finish 6 levels",'Unlock "Bug" car',kr.OneTimeUnlockBugCar,Fr.unlock_car_texture,'Unlock "Bug" car'),Fr.pushAchievementDesc(e,"spinner_id","Spinner",Tr.Stunt3xFrontFlip,"Do a 3x front flip in one take","Permanent Defense",kr.ConstantBombAndDynamiteImmunity,Fr.armor_texture,"+{10}% immunity against bombs and dynamites (permanent)"),Fr.pushAchievementDesc(e,"combo_pro_id","Combo Pro",Tr.Stunt3xCombo,"Do a 3x stunt combo in one take","Permanent Barrel Barrier",kr.ConstantExplosiveBarrelImmunity,Fr.armor_texture,"+{10}% immunity against explosive barrels (permanent)"),Fr.pushAchievementDesc(e,"completionist_id","Completionist",Tr.Finish10LevelsWith100Score,"Complete 10 levels with 100% score","More Money",kr.ReceiveCoins,Fr.coin_texture,"+{600} coins"),Fr.pushAchievementDesc(e,"back_flip_expert_id","Back Flip Expert",Tr.Stunt10BackFlipsInALevel,"Do a total of 10 back flips in any level","Permanent +Handling",kr.ConstantHandling,Fr.handling_texture,"+{10}% handling (permanent)"),Fr.pushAchievementDesc(e,"flip_master_id","Flip Master",Tr.Stunt100Flips,"Do a total of 100 flips throughout all levels","Permanent Explosion Armor",kr.ConstantAllExplosivesImmunity,Fr.armor_texture,"+{20}% immunity against all explosives (permanent)"),Fr.pushAchievementDesc(e,"number_one_id","Number One",Tr.Finish20Levels1st,"Finish 20 levels in the 1st position","Permanent +Power",kr.ConstantBombAndDynamitePower,Fr.bomb_texture,"Increase power of your bombs and dynamites by +{40}% (permanent)"),Fr.pushAchievementDesc(e,"combo_expert_id","Combo Expert",Tr.Stunt10xCombo,"Do a 10x combo in one take","Permanent Barrel Barrier",kr.ConstantExplosiveBarrelImmunity,Fr.armor_texture,"+{40}% immunity against explosive barrels (permanent)"),Fr.pushAchievementDesc(e,"one_hundred_id","100%",Tr.Finish30LevelsWith100Score,"Complete 30 levels with 100% score","???",kr.AchievementLevel,Fr.coin_texture,"???"),e},Fr.pushAchievementDesc=function(e,t,n,i,r,a,s,l,o){var _=new Pr;_.id=t,_.name=a,_.type=s,_.reward_texture_name=Fr.reward_prefix+l,_.ongoing_texture_name=Fr.ongoing_prefix+l,_.description=o,_.probability=1,_.expiration_type=Nr.Permanent,_.ranges=Fr.parseDescriptionIntoRanges(_.description);var p=new Dr;p.id=t,p.name=n,p.type=i,p.item=Fr.generateRewardItem(_,0),p.requirement=r,p.texture_name=Fr.achievement_prefix+l,e.push(p)},Fr.createRewardsForChallenges=function(){var e=[];return Fr.pushChallengeDesc(e,"escape_from_wolf_challenge_id","Escape From Wolf Challenge",br.ChallengeEscapeFromWolf,"Finish 4 levels","Permanent Explosion Armor",kr.ConstantAllExplosivesImmunity,Fr.armor_texture,"+{10}% immunity against all explosives (permanent)"),Fr.pushChallengeDesc(e,"mountain_rush_challenge_id","Mountain Rush Challenge",br.ChallengeMountainRush,"Finish 8 levels","Permanent +Acceleration",kr.ConstantFasterAcceleration,Fr.acceleration_texture,"+{5}% faster acceleration (permanent)"),Fr.pushChallengeDesc(e,"balancing_challenge_id","Balancing Challenge",br.ChallengeBalancing,"Finish 12 levels","Permanent +Handling",kr.ConstantHandling,Fr.handling_texture,"+{10}% handling (permanent)"),Fr.pushChallengeDesc(e,"survival_challenge_id","Survival Challenge",br.ChallengeSurvival,"Finish 16 levels","Permanent Barrel Barrier",kr.ConstantExplosiveBarrelImmunity,Fr.armor_texture,"+{25}% immunity against explosive barrels (permanent)"),Fr.pushChallengeDesc(e,"bullet_taxi_challenge_id","Bullet Taxi Challenge",br.ChallengeBulletTaxi,"Finish 20 levels","Permanent Boosted Boost",kr.ConstantMoreBoost,Fr.boost_texture,"+{10}% faster boost (permanent)"),Fr.pushChallengeDesc(e,"hunt_the_prey_challenge_id","Hunt The Prey Challenge",br.ChallengeHuntThePrey,"Finish 24 levels","Permanent +Power",kr.ConstantBombAndDynamitePower,Fr.bomb_texture,"+{25}% power to bombs and dynamites (permanent)"),e},Fr.pushChallengeDesc=function(e,t,n,i,r,a,s,l,o){var _=new Pr;_.id=t,_.name=a,_.type=s,_.reward_texture_name=Fr.reward_prefix+l,_.ongoing_texture_name=Fr.ongoing_prefix+l,_.description=o,_.probability=1,_.expiration_type=Nr.Permanent,_.ranges=Fr.parseDescriptionIntoRanges(_.description);var p=new Er;p.id=t,p.name=n,p.type=i,p.item=Fr.generateRewardItem(_,0),p.requirement=r,e.push(p)},Fr.parseDescriptionIntoRanges=function(e){for(var t=[],n=0;n<e.length;){if("{"==e.charAt(n)){var i=new Cr;i.char_start_index=n;var r="";for(++n;n<e.length;){var a=e.charAt(n);if("}"==a){i.char_end_index=n+1;break}r+=a,++n}for(var s=r.split(","),l=0;l<s.length;){var o=s[l];++l;var _=o.split("-"),u=new Sr;1==_.length?u.max=u.min=p.parseFloat(h.trim(_[0])):2==_.length?(u.min=p.parseFloat(h.trim(_[0])),u.max=p.parseFloat(h.trim(_[1]))):xl.trace("warning: unsupported syntax in "+o,{fileName:"RewardDo.hx",lineNumber:700,className:"bikas.game.RewardDo",methodName:"parseDescriptionIntoRanges"}),i.ranges.push(u)}t.push(i)}++n}return t},Fr.generateItemByType=function(e,t,n){null==n&&(n=-1);for(var i=0;i<e.length;){var r=e[i];if(++i,r.type==t)return Fr.generateRewardItem(r,n)}return null},Fr.generateAnyItem=function(e,t){null==t&&(t=-1),0==e.length&&xl.trace("warning: descs.length == 0",{fileName:"RewardDo.hx",lineNumber:728,className:"bikas.game.RewardDo",methodName:"generateAnyItem"});for(var n=0,i=0;i<e.length;){var r=e[i];++i,n+=r.probability}for(var a=pa.getRandomBetween(0,n),s=0,l=null,o=0;o<e.length;){var _=e[o];if(++o,a<=(s+=_.probability)){l=_;break}}return null==l&&(xl.trace("warning: something went wrong while generating probability",{fileName:"RewardDo.hx",lineNumber:750,className:"bikas.game.RewardDo",methodName:"generateAnyItem"}),l=e[0]),-1==t&&(t=pa.getRandomBetweenInt(0,2)),Fr.generateRewardItem(l,t)},Fr.generateRewardItem=function(e,t){var n=new Mr;n.desc=e,n.id=e.id,n.generated_amounts=[];for(var i=0,r=[],a=0,s=e.ranges;a<s.length;){var l=s[a];++a;var o=pa.clampInt(t,0,l.ranges.length-1),_=l.ranges[o],p=Math.round(pa.getRandomBetween(_.min,_.max)),u=e.description.substring(i,l.char_start_index),h=null==p?"null":""+p;i=l.char_end_index,r.push(u),r.push(h),n.generated_amounts.push(p)}var c=e.description.substring(i,e.description.length);r.push(c),n.description_text="";for(var d=0;d<r.length;){var m=r[d];++d,n.description_text+=m}return n},Fr.createRewardSelection=function(e,t,n){null==n&&(n=-1);var i=new Ar;i.container=Ra.createGroup(),i.middle_container=Ra.createGroup(),i.background=Ra.createSprite(Os.menu_background),i.background.x=-1,i.background.y=-1,i.background.width=e.current_game_width+2,i.background.height=e.current_game_height+2,i.background.alpha=.75,i.title_text=new ps(Xs.game,0,0,cn.toonish_36,"",50,"center"),i.title_text.anchor.set(.5,.5),i.title_text.text="Pick Your Reward",i.title_text.x=0,i.title_text.y=Ir.title_text_y,i.or_text=new ps(Xs.game,0,0,cn.toonish_36,"",50,"center"),i.or_text.anchor.set(.5,.5),i.or_text.text="OR",i.or_text.x=0,i.or_text.y=0,i.container.add(i.background),i.container.add(i.middle_container);for(var r=0;r<2;){var a=r++,l=Fr.generateAnyItem(t,n);s.remove(t,l.desc);var o=Fr.createRewardCard(l);i.cards.push(o),o.container.scale.x=Ar.card_scale,o.container.scale.y=Ar.card_scale,(o.container.y=0)==a?o.container.x=-o.container.width/2-Ar.distance_between_cards/2:1==a&&(o.container.x=o.background.width/2+Ar.distance_between_cards/2),i.middle_container.add(o.container)}return i.middle_container.add(i.title_text),i.middle_container.add(i.or_text),i},Fr.createRewardCard=function(e){var t=new Ir;if(t.item=e,t.container=Ra.createGroup(),t.background=Ra.createSpriteByName("reward_card",.5,.5),t.background.scale.x=Ir.background_scale,t.background.scale.y=Ir.background_scale,""!=e.desc.reward_texture_name){var n=Zs.retrieveAsset(e.desc.reward_texture_name);null!=n&&(t.item_sprite=Ra.createSprite(n,.5,.5),t.item_sprite.scale.x=1,t.item_sprite.scale.y=1,t.item_sprite.position.x=0,t.item_sprite.position.y=Ir.icon_y)}return t.name_text=new ps(Xs.game,0,0,cn.bell_gothic_std_black_dark_26,"",Ir.name_text_font_size,"center"),t.name_text.anchor.set(.5,0),t.name_text.text=e.desc.name,t.name_text.position.x=0,t.name_text.position.y=Ir.name_text_y,t.description_text=new ps(Xs.game,0,0,cn.bell_gothic_std_bold_dark_26,"",Ir.description_text_font_size,"left"),t.description_text.text=e.description_text+".",t.description_text.anchor.set(.5,0),t.description_text.maxWidth=Ir.description_text_max_width,t.description_text.position.x=0,t.description_text.position.y=Ir.description_text_y,t.container.add(t.background),null!=t.item_sprite&&t.container.add(t.item_sprite),t.container.add(t.name_text),t.container.add(t.description_text),t},Fr.destroyRewardSelection=function(e){if(null!=e.container){for(var t=0,n=e.cards;t<n.length;){var i=n[t];++t,Fr.destroyRewardCard(i)}null!=e.container.parent&&e.container.parent.removeChild(e.container),e.middle_container.destroy(!0),e.background.destroy(!0),e.background=null,e.title_text.destroy(!0),e.title_text=null,e.or_text.destroy(!0),e.or_text=null,e.container.destroy(!0),e.cards=null}},Fr.destroyRewardCard=function(e){(e.item=null)!=e.container&&(null!=e.container.parent&&e.container.parent.removeChild(e.container),e.background.destroy(!0),(e.background=null)!=e.item_sprite&&(e.item_sprite.destroy(!0),e.item_sprite=null),e.name_text.destroy(!0),e.name_text=null,e.description_text.destroy(!0),e.description_text=null,e.container.destroy(!0),e.container=null)},Fr.clearOngoingPowersDisplay=function(e){for(var t=0,n=e.display_items;t<n.length;){var i=n[t];++t;for(var r=i.items.slice(),a=0;a<r.length;){var s=r[a];++a,Fr.removeItemFromDisplayItem(i,s)}i.sprite.destroy(!0),i.container.destroy(!0),i.container=null,i.sprite=null,i.items=null}e.display_items=[],e.just_used_items=[],e.remove_display_items=[]},Fr.animateDisplayItemAlphaAndScale=function(e,t,n,i,r,a){var s=e.current_time,l=ca.getTClamped(0,a,s);e.sprite.alpha=ca.linear(t,n,l);var o=ca.linear(i,r,l);return e.sprite.width=e.width*o,e.sprite.height=e.height*o,1==l},Fr.createOngoingPowerDisplayItem=function(e){var t=new Lr;return t.container=Ra.createGroup(),e.shown?t.type=Br.ItemDefault:t.type=Br.ItemPhaseIn,e.shown=!0,Fr.addItemToDisplayItem(t,e),t.item_icon_texture_name=e.desc.ongoing_texture_name,t.sprite=Ra.createSpriteByName(t.item_icon_texture_name,.5,.5),t.container.add(t.sprite),t.width=Lr.item_size,t.height=Lr.item_size,t.sprite.width=t.width,t.sprite.height=t.height,t.current_time=0,t},Fr.addItemToDisplayItem=function(e,t){var n=new Or;n.item=t,n.container=Ra.createGroup(),n.background=Ra.createSpriteByName("white_bar",1,.5,0,0),n.icon=Ra.createSpriteByName(t.desc.ongoing_texture_name,.5,.5),n.text=Ra.createBitmapText(cn.consolas_24,Or.text_size,"left",t.description_text,1,.5),n.icon.width=Lr.item_size,n.icon.height=Lr.item_size,n.icon.position.x=0,n.icon.position.y=0,n.text.position.x=Or.text_offset_x,n.text.position.y=0,n.background.width=n.text.width+n.icon.width,n.background.height=n.icon.height,n.background.alpha=.85,e.items.push(n);var i=e.items.indexOf(n);n.container.position.x=0,n.container.position.y=Or.offset_y+i*Or.spacing,n.container.add(n.background),n.container.add(n.icon),n.container.add(n.text)},Fr.removeItemFromDisplayItem=function(e,t){t.background.destroy(!0),t.icon.destroy(!0),t.text.destroy(!0),t.container.destroy(!0),s.remove(e.items,t);for(var n=0,i=0,r=e.items;i<r.length;){var a=r[i];++i,a.container.position.y=Or.offset_y+n*Or.spacing,++n}},Fr.updateOngoingPowersDisplay=function(e,t,n,i,r,a,l){for(var o=0,_=t.current_items;o<_.length;){var p=_[o];++o;for(var u=!1,h=0,c=t.display_items;h<c.length;){var d=c[h];if(++h,p.desc.ongoing_texture_name==d.item_icon_texture_name){for(var m=!(u=!0),f=0,g=d.items;f<g.length;){var v=g[f];if(++f,v.item==p){m=!0;break}}m||(Fr.addItemToDisplayItem(d,p),p.shown?d.type=Br.ItemDefault:d.type=Br.ItemPhaseIn,p.shown=!0,d.current_time=0)}}if(!u){var b=Fr.createOngoingPowerDisplayItem(p);e.add(b.container),t.display_items.push(b)}}for(var y=Lr.item_size/2+5,x=0,z=t.display_items;x<z.length;){var w=z[x];if(++x,w.type!=Br.ItemWasJustUsed){for(var k=!1,S=0,C=t.just_used_items;S<C.length;){var N=C[S];if(++S,N.desc.ongoing_texture_name==w.item_icon_texture_name){k=!0;break}}if(k){for(var P=0;P<t.just_used_items.length;){for(var M=0,I=w.items;M<I.length;){var A=I[M];if(++M,A.item==t.just_used_items[P]){t.just_used_items.splice(P,1),--P;break}}++P}w.type=Br.ItemWasJustUsed,w.current_time=0}}if(w.type!=Br.ItemPhaseOut){for(var T=null,D=0,E=w.items;D<E.length;){var O=E[D];++D,-1==t.current_items.indexOf(O.item)&&(null==T&&(T=[]),T.push(O))}if(null!=T)for(var B=0;B<T.length;){var L=T[B];++B,Fr.removeItemFromDisplayItem(w,L)}0==w.items.length&&(w.type=Br.ItemPhaseOut,w.current_time=0)}if(w.container.x=i.current_game_width-y,w.container.y=70,null!=Ha.getClicked(w.container.x,w.container.y,r,Lr.item_size/2))if(t.skip_expand_display_item==w)t.skip_expand_display_item=null,ks.playSound(Os.sound_click,l);else{if(null!=t.expand_display_item)for(var j=0,F=t.expand_display_item.items;j<F.length;){var R=F[j];++j,null!=R.container.parent&&R.container.parent.removeChild(R.container)}t.expand_display_item!=w&&(t.expand_display_item=w,ks.playSound(Os.sound_click,l))}if(y+=Lr.item_distance,w.current_time+=a.dc,w.type!=Br.ItemDefault)if(w.type==Br.ItemPhaseIn)Fr.animateDisplayItemAlphaAndScale(w,0,1,Lr.phase_in_scale,1,Lr.phase_in_time)&&(w.type=Br.ItemDefault,w.current_time=0,Gn.applyCameraShake(n,Lr.phase_in_camera_shake_amount,Lr.phase_in_camera_shake_time),ks.playSound(Os.sound_ongoing_power,l));else if(w.type==Br.ItemPhaseOut)Fr.animateDisplayItemAlphaAndScale(w,1,0,1,Lr.phase_out_scale,Lr.phase_out_time)&&(t.remove_display_items.push(w),w.current_time=0);else if(w.type==Br.ItemWasJustUsed){var G=ca.getTClamped(0,Lr.phase_use_time,w.current_time),Z=ca.linearForwardAndBackward(1,Lr.phase_use_scale,G);w.sprite.width=w.width*Z,w.sprite.height=w.height*Z,1==G&&(w.type=Br.ItemDefault,w.current_time=0)}}if(null!=t.expand_display_item){for(var U=0,V=t.expand_display_item.items;U<V.length;){var q=V[U];++U,null==q.container.parent&&t.expand_display_item.container.add(q.container)}if(null!=Ha.getPointerDowned(r)){Ha.isDowned(t.expand_display_item.container.x,t.expand_display_item.container.y,r,Lr.item_size/2)&&(t.skip_expand_display_item=t.expand_display_item);for(var W=0,X=t.expand_display_item.items;W<X.length;){var H=X[W];++W,null!=H.container.parent&&H.container.parent.removeChild(H.container)}t.expand_display_item=null}}if(0<t.remove_display_items.length){for(var Y=0,J=t.remove_display_items;Y<J.length;){var K=J[Y];++Y,K.sprite.destroy(!0),K.container.destroy(!0),K==t.expand_display_item&&(t.expand_display_item=null),K==t.skip_expand_display_item&&(t.skip_expand_display_item=null),K.items=null,K.sprite=null,s.remove(t.display_items,K)}t.remove_display_items=[]}};var Rr=function(){};(n["bikas.game.StuntObject"]=Rr).__name__=["bikas","game","StuntObject"],Rr.prototype={id:null,name:null,text:null,points:null,current_min_display_time:null,__class__:Rr};var Gr=function(){this.total_level_score=0,this.total_perfect_landings=0,this.total_combos=0,this.total_back_wheelies=0,this.total_front_wheelies=0,this.total_back_flips=0,this.total_front_flips=0,this.max_level_score=0,this.max_combos=0,this.max_back_wheelies=0,this.max_front_wheelies=0,this.max_back_flips=0,this.max_front_flips=0};(n["bikas.game.StuntStats"]=Gr).__name__=["bikas","game","StuntStats"],Gr.prototype={max_front_flips:null,max_back_flips:null,max_front_wheelies:null,max_back_wheelies:null,max_combos:null,max_level_score:null,total_front_flips:null,total_back_flips:null,total_front_wheelies:null,total_back_wheelies:null,total_combos:null,total_perfect_landings:null,total_level_score:null,__class__:Gr};var Zr=function(){this.score_container_visible=!0,this.phase_out=!1,this.current_interpolate_scale=1,this.current_interpolate_time_max=0,this.current_interpolate_time=0,this.previous_stunt_object_for_sounds=null,this.que=[],this.accumulated_front_wheelies=0,this.accumulated_back_wheelies=0,this.previous_stunt_time_stamp=0,this.last_front_wheelies=0,this.last_back_wheelies=0,this.stats=new Gr,this.combos=0,this.back_flips=0,this.front_flips=0,this.previous_stunt_flag=-1,this.flip_combo_can_happen=!1,this.current_score=0,this.front_wheel_collide_time=0,this.back_wheel_collide_time=0,this.last_air_time=0,this.air_time=0,this.accumulated_back_wheel_time=0,this.accumulated_front_wheel_time=0,this.accumulated_angle=0,this.previous_angle=0};(n["bikas.game.Stunt"]=Zr).__name__=["bikas","game","Stunt"],Zr.prototype={previous_angle:null,accumulated_angle:null,accumulated_front_wheel_time:null,accumulated_back_wheel_time:null,air_time:null,last_air_time:null,back_wheel_collide_time:null,front_wheel_collide_time:null,current_score:null,flip_combo_can_happen:null,previous_stunt_flag:null,front_flips:null,back_flips:null,combos:null,stats:null,last_back_wheelies:null,last_front_wheelies:null,previous_stunt_time_stamp:null,accumulated_back_wheelies:null,accumulated_front_wheelies:null,que:null,previous_stunt_object_for_sounds:null,current_interpolate_time:null,current_interpolate_time_max:null,current_interpolate_scale:null,phase_out:null,name_text:null,score_text:null,score_container_visible:null,score_container:null,score_background:null,score_foreground:null,score_percent_text:null,__class__:Zr};var Ur=function(){};(n["bikas.game.StuntDo"]=Ur).__name__=["bikas","game","StuntDo"],Ur.create=function(e,t){var n=new Zr;return n.name_text=new ps(Xs.game,0,0,"toonish_36","1x Front Flip",42,"center"),n.score_text=new ps(Xs.game,0,0,"toonish_36","1000",42,"center"),e.add(n.name_text),e.add(n.score_text),n.name_text.alpha=0,n.score_text.alpha=0,n.name_text.anchor.x=.5,n.name_text.anchor.y=.5,n.score_text.anchor.x=.5,n.score_text.anchor.y=.5,n.score_container=Ra.createGroup(),n.score_background=Ra.createSpriteByName("stunt_bar_empty",0,0),n.score_foreground=Ra.createSpriteByName("stunt_bar_full",0,0),n.score_background.scale.x=1,n.score_background.scale.y=1,n.score_foreground.scale.x=0,n.score_foreground.scale.y=1,n.score_background.x=-n.score_background.width,n.score_foreground.x=n.score_background.x,n.score_percent_text=new ps(Xs.game,0,0,cn.avantgarde_lt_medium_dark_26,"0%",22,"center"),n.score_percent_text.anchor.x=.5,n.score_percent_text.anchor.y=.5,n.score_percent_text.position.x=-n.score_background.width/2,n.score_percent_text.position.y=n.score_background.height/2+5,n.score_container.add(n.score_foreground),n.score_container.add(n.score_background),n.score_container.add(n.score_percent_text),e.add(n.score_container),n},Ur.getHighestStunts=function(e,t){var n=new Gr;return n.max_front_flips=pa.maxInt(e.max_front_flips,t.max_front_flips),n.max_back_flips=pa.maxInt(e.max_back_flips,t.max_back_flips),n.max_front_wheelies=pa.maxInt(e.max_front_wheelies,t.max_front_wheelies),n.max_back_wheelies=pa.maxInt(e.max_back_wheelies,t.max_back_wheelies),n.max_combos=pa.maxInt(e.max_combos,t.max_combos),n.max_level_score=pa.maxInt(e.max_level_score,t.max_level_score),n.total_front_flips=pa.maxInt(e.total_front_flips,t.total_front_flips),n.total_back_flips=pa.maxInt(e.total_back_flips,t.total_back_flips),n.total_front_wheelies=pa.maxInt(e.total_front_wheelies,t.total_front_wheelies),n.total_back_wheelies=pa.maxInt(e.total_back_wheelies,t.total_back_wheelies),n.total_combos=pa.maxInt(e.total_combos,t.total_combos),n.total_perfect_landings=pa.maxInt(e.total_perfect_landings,t.total_perfect_landings),n.total_level_score=pa.maxInt(e.total_level_score,t.total_level_score),n},Ur.setTextScale=function(e,t){e.score_text.scale.x=t,e.score_text.scale.y=t,e.name_text.scale.x=t,e.name_text.scale.y=t},Ur.pushStunt=function(e,t,n,i){var r=!1;0<e.que.length&&t==e.que[e.que.length-1].id&&(r=!0);var a=null;r?a=e.que[e.que.length-1]:((a=new Rr).id=t,a.name=Ur.getStuntNameByID(t),e.que.push(a)),a.current_min_display_time=Zr.score_name_min_display_time,a.points=n,0<a.points?a.text=a.points+"X "+a.name:a.text=a.name},Ur.getStuntNameByID=function(e){return e==Zr.stunt_front_wheelie?"Front Wheelie":e==Zr.stunt_back_wheelie?"Back Wheelie":e==Zr.stunt_front_flip?"Front Flip":e==Zr.stunt_back_flip?"Back Flip":e==Zr.stunt_wheelie_to_flip_combo?"Wheelie To Flip Combo":e==Zr.stunt_flip_to_wheelie_combo?"Flip To Wheelie Combo":e==Zr.stunt_wheelie_combo?"Wheelie Combo":e==Zr.stunt_flip_combo?"Flip Combo":e==Zr.stunt_perfect_landing?"Perfect Landing":(xl.trace("warning: id "+e+" does not have equivalent name",{fileName:"StuntDo.hx",lineNumber:145,className:"bikas.game.StuntDo",methodName:"getStuntNameByID"}),"")},Ur.destroy=function(e){e.name_text.destroy(!0),e.score_text.destroy(!0),null!=e.score_container&&(e.score_background.destroy(!0),e.score_foreground.destroy(!0),e.score_percent_text.destroy(!0),e.score_container.destroy(!0)),e.que=null,e.stats=null},Ur.update=function(e,t,n,i,r,a,s,l,o,_,p){var u=n.level_seconds,h=n.step_size,c=i.stats;if(0<l){!i.score_container.visible&&i.score_container_visible&&(i.score_container.visible=!0),i.score_container.x=e-(Zr.bar_offset+Zr.bar_offset_per_digit*_),i.score_container.y=6;var d=pa.clamp((c.total_level_score+i.current_score)/l,0,1),m="Stunts: "+(c.total_level_score+i.current_score)+"/"+l;i.score_percent_text.text!=m&&(i.score_percent_text.text=m,i.score_foreground.scale.x=ca.linear(0,i.score_background.scale.x,d))}else i.score_container.visible&&(i.score_container.visible=!1);var f=pa.normalizeAngle(r.main_body.get_rotation()),g=f-i.previous_angle;g>Math.PI?g-=Xr.PI2:g<-Math.PI&&(g+=Xr.PI2),i.accumulated_angle+=g,i.previous_angle=f;var v=i.previous_stunt_time_stamp+Zr.combo_expiration_time;if(n.level_seconds>=v-Zr.phase_out_time?i.phase_out=!0:i.phase_out=!1,v<u&&0!=i.current_score&&(c.total_level_score+=i.current_score,c.total_combos+=i.combos,i.current_score=0,i.combos=0,i.last_back_wheelies=0,i.last_front_wheelies=0,i.previous_stunt_flag=-1,i.accumulated_back_wheel_time=0,i.accumulated_front_wheel_time=0,i.accumulated_front_wheelies=0,i.accumulated_back_wheelies=0,i.current_interpolate_time=0,i.current_interpolate_scale=1,i.que=[],i.previous_stunt_object_for_sounds=null),!o){var b=!1,y=!1;if(r.main_body.get_velocity().get_length()>a.drive_velocity_max*Zr.min_speed_coeff&&(s.updates_since_back_wheel_collided<6&&(b=!0),s.updates_since_front_wheel_collided<6&&(y=!0)),s.updates_since_anything_collided<6&&(0<i.air_time&&(i.last_air_time=i.air_time),i.air_time=0),s.updates_since_anything_collided,0<s.updates_since_anything_collided&&(r.back_wheel_body.get_isSleeping()||(i.last_air_time=0,i.air_time+=h)),s.updates_since_back_wheel_collided<6?i.back_wheel_collide_time+=h:i.back_wheel_collide_time=0,s.updates_since_front_wheel_collided<6?i.front_wheel_collide_time+=h:i.front_wheel_collide_time=0,i.last_air_time>=Zr.perfect_landing_time&&0<i.back_wheel_collide_time&&0<i.front_wheel_collide_time&&(i.back_wheel_collide_time<=Zr.perfect_landing_wheel_time&&i.front_wheel_collide_time<=Zr.perfect_landing_wheel_time&&(i.last_air_time=0,c.total_perfect_landings++,i.previous_stunt_time_stamp=u,Ur.pushStunt(i,Zr.stunt_perfect_landing,0,h),i.current_score+=Zr.points_perfect_landing),i.back_wheel_collide_time>Zr.perfect_landing_wheel_time&&(i.last_air_time=0),i.front_wheel_collide_time>Zr.perfect_landing_wheel_time&&(i.last_air_time=0)),s.updates_since_anything_collided<6){if(i.accumulated_angle=0,i.flip_combo_can_happen=!1,i.front_flips=0,(i.back_flips=0)<i.air_time&&(i.last_air_time=i.air_time,i.air_time=0),y&&!b){if(i.accumulated_front_wheel_time+=h,i.accumulated_front_wheel_time>=Zr.wheelie_start_min_time){i.accumulated_back_wheel_time=0,i.last_back_wheelies=0,i.previous_stunt_flag==Zr.stunt_back_wheelie?(Ur.pushStunt(i,Zr.stunt_wheelie_combo,0,h),i.current_score+=Zr.points_wheelie_combo,i.combos++):i.previous_stunt_flag!=Zr.stunt_front_flip&&i.previous_stunt_flag!=Zr.stunt_back_flip||(Ur.pushStunt(i,Zr.stunt_flip_to_wheelie_combo,0,h),i.current_score+=Zr.points_flip_to_wheelie_combo,i.combos++),i.previous_stunt_flag=Zr.stunt_front_wheelie;var x=Math.floor((i.accumulated_front_wheel_time-Zr.wheelie_start_min_time)/Zr.wheelie_point_per_time_step);if(i.previous_stunt_time_stamp=u,x>i.last_front_wheelies){var z=x-i.last_front_wheelies;i.accumulated_front_wheelies+=z,c.total_front_wheelies+=z,i.current_score+=z*Zr.points_wheelie,Ur.pushStunt(i,Zr.stunt_front_wheelie,i.accumulated_front_wheelies,h),i.last_front_wheelies=x}}}else 0<i.que.length&&i.que[0].id,i.accumulated_front_wheelies=0,i.accumulated_front_wheel_time=0,i.last_front_wheelies=0;if(b&&!y){if(i.accumulated_back_wheel_time+=h,i.accumulated_back_wheel_time>=Zr.wheelie_start_min_time){i.accumulated_front_wheel_time=0,i.last_front_wheelies=0,i.previous_stunt_flag==Zr.stunt_front_wheelie?(i.current_score+=Zr.points_wheelie_combo,i.combos++,Ur.pushStunt(i,Zr.stunt_wheelie_combo,0,h)):i.previous_stunt_flag!=Zr.stunt_front_flip&&i.previous_stunt_flag!=Zr.stunt_back_flip||(i.current_score+=Zr.points_flip_to_wheelie_combo,i.combos++,Ur.pushStunt(i,Zr.stunt_flip_to_wheelie_combo,0,h)),i.previous_stunt_flag=Zr.stunt_back_wheelie;var w=Math.floor((i.accumulated_back_wheel_time-Zr.wheelie_start_min_time)/Zr.wheelie_point_per_time_step);if(i.previous_stunt_time_stamp=u,w>i.last_back_wheelies){var k=w-i.last_back_wheelies;i.accumulated_back_wheelies+=k,c.total_back_wheelies+=k,i.current_score+=k*Zr.points_wheelie,Ur.pushStunt(i,Zr.stunt_back_wheelie,i.accumulated_back_wheelies,h),i.last_back_wheelies=w}}}else 0<i.que.length&&i.que[0].id,i.accumulated_back_wheelies=0,i.accumulated_back_wheel_time=0,i.last_back_wheelies=0}else i.accumulated_angle>2*Math.PI*3/4?(i.accumulated_back_wheel_time=0,i.accumulated_front_wheel_time=0,i.last_front_wheelies=0,i.last_back_wheelies=0,i.accumulated_angle=0,i.previous_stunt_flag==Zr.stunt_front_wheelie||i.previous_stunt_flag==Zr.stunt_back_wheelie?(i.current_score+=Zr.points_wheelie_to_flip_combo,i.combos++,Ur.pushStunt(i,Zr.stunt_wheelie_to_flip_combo,0,h)):i.flip_combo_can_happen&&i.previous_stunt_flag==Zr.stunt_back_flip&&(i.current_score+=Zr.points_flip_combo,i.combos++,Ur.pushStunt(i,Zr.stunt_flip_combo,0,h)),i.previous_stunt_flag=Zr.stunt_front_flip,i.front_flips++,c.total_front_flips++,i.previous_stunt_time_stamp=u,i.flip_combo_can_happen=!0,Ur.pushStunt(i,Zr.stunt_front_flip,i.front_flips,h),i.current_score+=Zr.points_flip):i.accumulated_angle<2*-Math.PI*3/4&&(i.accumulated_back_wheel_time=0,i.accumulated_front_wheel_time=0,i.last_front_wheelies=0,i.last_back_wheelies=0,i.accumulated_angle=0,i.previous_stunt_flag==Zr.stunt_front_wheelie||i.previous_stunt_flag==Zr.stunt_back_wheelie?(i.current_score+=Zr.points_wheelie_to_flip_combo,i.combos++,Ur.pushStunt(i,Zr.stunt_wheelie_to_flip_combo,0,h)):i.flip_combo_can_happen&&i.previous_stunt_flag==Zr.stunt_front_flip&&(i.current_score+=Zr.points_flip_combo,i.combos++,Ur.pushStunt(i,Zr.stunt_flip_combo,0,h)),i.previous_stunt_flag=Zr.stunt_back_flip,i.back_flips++,c.total_back_flips++,i.previous_stunt_time_stamp=u,i.flip_combo_can_happen=!0,Ur.pushStunt(i,Zr.stunt_back_flip,i.back_flips,h),i.current_score+=Zr.points_flip)}if(c.max_front_flips<i.front_flips&&(c.max_front_flips=i.front_flips),c.max_back_flips<i.back_flips&&(c.max_back_flips=i.back_flips),c.max_front_wheelies<i.accumulated_front_wheelies&&(c.max_front_wheelies=i.accumulated_front_wheelies),c.max_back_wheelies<i.accumulated_back_wheelies&&(c.max_back_wheelies=i.accumulated_back_wheelies),c.max_combos<i.combos&&(c.max_combos=i.combos),c.max_level_score<i.current_score&&(c.max_level_score=i.current_score),i.phase_out&&0<i.score_text.alpha){var S=1/(Zr.phase_out_time/h);i.score_text.alpha-=S,i.name_text.alpha-=S,i.score_text.alpha<0&&(i.score_text.alpha=0,i.name_text.alpha=0);var C=ca.smoothStart(.5,1,i.score_text.alpha);Ur.setTextScale(i,C)}if(0<i.current_score){if(i.score_text.text!=i.current_score+""&&(i.score_text.text=i.current_score+"",ks.playSound(Os.sound_stunt_point,p,.6)),0<i.que.length){var N=i.que[0];null==i.previous_stunt_object_for_sounds?(i.previous_stunt_object_for_sounds=N,ks.playSound(Os.sound_stunt,p)):(N.id!=i.previous_stunt_object_for_sounds.id&&ks.playSound(Os.sound_stunt,p),i.previous_stunt_object_for_sounds=N),0<N.current_min_display_time&&(N.current_min_display_time-=h,N.current_min_display_time<=0&&(N.current_min_display_time=0)),2<=i.que.length&&0==N.current_min_display_time&&(i.current_interpolate_scale=1.2,i.current_interpolate_time_max=12*h,i.current_interpolate_time=i.current_interpolate_time_max,i.que.shift()),i.name_text.text!=N.text&&(i.name_text.text=N.text)}if(i.name_text.x=e/2,i.name_text.y=t/6-i.name_text.height/2-5,i.score_text.x=i.name_text.x,i.score_text.y=i.name_text.y+i.name_text.height+10,i.score_text.alpha<1){if(!i.phase_out){var P=1/(Zr.phase_out_time/h);i.score_text.alpha+=P,i.name_text.alpha+=P,1<i.score_text.alpha&&(i.score_text.alpha=1,i.name_text.alpha=1);var M=ca.smoothToABCWithSmoothB(.5,1.2,1,.6,i.score_text.alpha);Ur.setTextScale(i,M)}}else if(1<i.current_interpolate_scale){var I=i.current_interpolate_time/i.current_interpolate_time_max,A=ca.linearForwardAndBackward(1,i.current_interpolate_scale,I);i.current_interpolate_time-=h,i.current_interpolate_time<0&&(i.current_interpolate_time=0,i.current_interpolate_scale=1),Ur.setTextScale(i,A)}}};var Vr=function(){this.grip=0,this.swipe_steps=0,this.downed=null,this.total_angle_difference=0,this.car_angle_downed=0,this.finger_angle_downed=0,this.finger_angle=0,this.finger_last_angle=0};(n["bikas.game.Wheel"]=Vr).__name__=["bikas","game","Wheel"],Vr.prototype={sprite:null,min_distance:null,max_distance:null,finger_last_angle:null,finger_angle:null,finger_angle_downed:null,car_angle_downed:null,total_angle_difference:null,downed:null,swipe_steps:null,grip:null,__class__:Vr};var qr=function(){};(n["bikas.game.WheelDo"]=qr).__name__=["bikas","game","WheelDo"],qr.create=function(e){var t=new Vr;return t.sprite=e,t.min_distance=Math.max(t.sprite.width,t.sprite.height)/2*.1,t.max_distance=Math.max(t.sprite.width,t.sprite.height)/2*1.2,t},qr.update=function(e,t,n,i,r,a,s,l,o){var _=a.dc,p=t.current_game_width-e.sprite.width*Vr.corner_distance_coeff,u=t.current_game_height-e.sprite.height*Vr.corner_distance_coeff;if(e.sprite.x!=p&&(e.sprite.x=p),e.sprite.y!=u&&(e.sprite.y=u),!o&&l){if(null==e.downed)for(var h=0,c=r.pointer_objects;h<c.length;){var d=c[h];if(++h,d.state==qa.DOWNED){var m=d.current.x-e.sprite.x,f=d.current.y-e.sprite.y,g=Math.sqrt(m*m+f*f);if(g<=e.max_distance&&g>=e.min_distance){e.downed=d;break}}}if(null!=e.downed&&e.downed.state==qa.IS_UP&&(e.downed=null),(Ni.isAnyPressed(s,tr.keys_left)||Ni.isAnyPressed(s,tr.keys_right))&&(e.downed=null,e.swipe_steps=0),null!=e.downed){var v=e.downed.current.x-e.sprite.x,b=e.downed.current.y-e.sprite.y;if(e.finger_angle=Math.atan2(b,v),e.downed.state==qa.DOWNED)e.grip=.1,e.finger_angle_downed=e.finger_angle,e.car_angle_downed=n.main_body.get_rotation();else if(e.downed.state==qa.IS_DOWN){var y=pa.angleDifferenceRad(e.finger_angle,e.finger_last_angle);Math.abs(y)<Vr.grip_min_delta_angle?(e.grip-=Vr.grip_decrease*i.grip_decrease_coeff*a.dc,e.grip<0&&(e.grip=0)):(e.grip+=Vr.grip_increase*i.grip_increase_coeff*a.dc,1<e.grip&&(e.grip=1))}e.total_angle_difference=pa.angleDifferenceRad(e.finger_angle,e.finger_angle_downed),e.swipe_steps=2*Math.round(60*e.total_angle_difference/Xr.PI2),Vr.debug_swipe_steps=e.swipe_steps,e.finger_last_angle=e.finger_angle}else 0<e.swipe_steps?(e.swipe_steps-=a.dc,e.swipe_steps<0&&(e.swipe_steps=0),Ct.rotate(n,i,_)):e.swipe_steps<0&&(e.swipe_steps+=a.dc,0<e.swipe_steps&&(e.swipe_steps=0),Ct.rotate(n,i,-_)),e.grip=0;if(0<e.grip){var x=pa.normalizeAngle(e.car_angle_downed+e.total_angle_difference),z=pa.angleDifferenceRad(x,n.main_body.get_rotation()),w=pa.clamp(z/Vr.wheel_max_force_angle,-1,1),k=Math.atan(w*Vr.atan_smoothing_multiplier)/(Math.PI/2);Ct.rotate(n,i,k*e.grip*_);var S=ca.linear(Vr.max_friction,1,Math.abs(w)),C=n.main_body;C.set_angularVel(C.get_angularVel()*Math.pow(S,_)),Vr.debug_grip=e.grip,Vr.debug_angle_difference=e.total_angle_difference,e.finger_angle_downed=ca.angleShortestLinear(e.finger_angle_downed,e.finger_angle,1-e.grip),e.car_angle_downed=ca.angleShortestLinear(e.car_angle_downed,n.main_body.get_rotation(),1-e.grip)}else e.finger_angle_downed=e.finger_angle,e.car_angle_downed=n.main_body.get_rotation();e.sprite.rotation=n.main_body.get_rotation()}};var Wr=function(){};(n["bikas.global.ColorFunc"]=Wr).__name__=["bikas","global","ColorFunc"],Wr.rgbToHex=function(e,t,n){return(e<<16)+(t<<8)+n},Wr.hexToARGB=function(e){var t=new ia;return t.blue=255&e,t.green=e>>8&255,t.red=e>>16&255,t.alpha=e>>24&255,t},Wr.intToColor=function(e){var t=new ia;return t.red=Math.round(e/65536),t.green=Math.round(e/256%256),t.blue=e%256,t};var Xr=function(){};(n["bikas.global.MathConstants"]=Xr).__name__=["bikas","global","MathConstants"];var Hr=function(){};(n["bikas.global.GlobalFlags"]=Hr).__name__=["bikas","global","GlobalFlags"];var Yr=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};(n["bikas.global.Point"]=Yr).__name__=["bikas","global","Point"],Yr.createDefault=function(){if(0<Yr.destroyed_point_list.length){var e=Yr.destroyed_point_list.pop();return e.x=0,e.y=0,e}return new Yr(0,0)},Yr.create=function(e,t){if(null==t&&(t=0),null==e&&(e=0),0<Yr.destroyed_point_list.length){var n=Yr.destroyed_point_list.pop();return n.x=e,n.y=t,n}return new Yr(e,t)},Yr.destroy=function(e){Hr.validate_reusable_objects&&-1!=Yr.destroyed_point_list.indexOf(e)?xl.trace("warning: object is already added to destroyed list",{fileName:"GlobalData.hx",lineNumber:68,className:"bikas.global.Point",methodName:"destroy"}):Yr.destroyed_point_list.push(e)},Yr.prototype={x:null,y:null,toString:function(){return"{x:"+Math.round(1e3*this.x)/1e3+",y:"+Math.round(1e3*this.y)/1e3+"}"},__class__:Yr};var Jr=function(e,t){this.time=e,this.point=t};(n["bikas.global.PointTime"]=Jr).__name__=["bikas","global","PointTime"],Jr.prototype={time:null,point:null,__class__:Jr};var Kr=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.width=n,this.height=i};(n["bikas.global.Rectangle"]=Kr).__name__=["bikas","global","Rectangle"],Kr.prototype={x:null,y:null,width:null,height:null,toString:function(){return"{x:"+Math.round(1e3*this.x)/1e3+",y:"+Math.round(1e3*this.y)/1e3+",width:"+Math.round(1e3*this.width)/1e3+",height:"+Math.round(1e3*this.height)/1e3+"}"},__class__:Kr};var Qr=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.min_x=e,this.min_y=t,this.max_x=n,this.max_y=i};(n["bikas.global.Bounds"]=Qr).__name__=["bikas","global","Bounds"],Qr.create=function(e,t,n,i){if(null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),0<Qr.destroyed_bounds_list.length){var r=Qr.destroyed_bounds_list.pop();return r.min_x=e,r.min_y=t,r.max_x=n,r.max_y=i,r}return new Qr(e,t,n,i)},Qr.destroy=function(e){Hr.validate_reusable_objects&&-1!=Qr.destroyed_bounds_list.indexOf(e)?xl.trace("warning: object is already added to destroyed list",{fileName:"GlobalData.hx",lineNumber:153,className:"bikas.global.Bounds",methodName:"destroy"}):Qr.destroyed_bounds_list.push(e)},Qr.prototype={min_x:null,min_y:null,max_x:null,max_y:null,toString:function(){return"{min_x:"+Math.round(1e3*this.min_x)/1e3+",min_y:"+Math.round(1e3*this.min_y)/1e3+",max_x:"+Math.round(1e3*this.max_x)/1e3+",max_y:"+Math.round(1e3*this.max_y)/1e3+"}"},__class__:Qr};var $r=function(e,t,n,i,r,a,s,l){null==l&&(l=0),null==s&&(s=0),null==a&&(a=0),null==r&&(r=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.p1=new Yr(e,t),this.p2=new Yr(n,i),this.p3=new Yr(r,a),this.p4=new Yr(s,l)};(n["bikas.global.Quad"]=$r).__name__=["bikas","global","Quad"],$r.create=function(e,t,n,i,r,a,s,l){if(null==l&&(l=0),null==s&&(s=0),null==a&&(a=0),null==r&&(r=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),0<$r.destroyed_quad_list.length){var o=$r.destroyed_quad_list.pop();return o.p1.x=e,o.p1.y=t,o.p2.x=n,o.p2.y=i,o.p3.x=r,o.p3.y=a,o.p4.x=s,o.p4.y=l,o}return new $r(e,t,n,i,r,a,s,l)},$r.destroy=function(e){Hr.validate_reusable_objects&&-1!=$r.destroyed_quad_list.indexOf(e)?xl.trace("warning: object is already added to destroyed list",{fileName:"GlobalData.hx",lineNumber:216,className:"bikas.global.Quad",methodName:"destroy"}):$r.destroyed_quad_list.push(e)},$r.prototype={p1:null,p2:null,p3:null,p4:null,__class__:$r};var ea=function(e,t){null==t&&(t=0),null==e&&(e=0),this.width=e,this.height=t};(n["bikas.global.Size"]=ea).__name__=["bikas","global","Size"],ea.prototype={width:null,height:null,toString:function(){return"{width:"+Math.round(1e3*this.width)/1e3+",height:"+Math.round(1e3*this.height)/1e3+"}"},__class__:ea};var ta=function(){this.rotation=0,this.scale_y=1,this.scale_x=1};(n["bikas.global.Transform"]=ta).__name__=["bikas","global","Transform"],ta.prototype={scale_x:null,scale_y:null,rotation:null,toString:function(){return"{scale_x:"+Math.round(1e3*this.scale_x)/1e3+",scale_y:"+Math.round(1e3*this.scale_y)/1e3+",rotation:"+Math.round(1e3*this.rotation)/1e3+"}"},__class__:ta};var na=function(e,t,n,i,r,a){null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=1),this.a=e,this.b=t,this.c=n,this.d=i,this.tx=r,this.ty=a};(n["bikas.global.Matrix"]=na).__name__=["bikas","global","Matrix"],na.create=function(e,t,n,i,r,a){if(null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=1),0<na.destroyed_matrix_list.length){var s=na.destroyed_matrix_list.pop();return s.a=e,s.b=t,s.c=n,s.d=i,s.tx=r,s.ty=a,s}return new na(e,t,n,i,r,a)},na.destroy=function(e){Hr.validate_reusable_objects&&-1!=na.destroyed_matrix_list.indexOf(e)?xl.trace("warning: object is already added to destroyed list",{fileName:"GlobalData.hx",lineNumber:289,className:"bikas.global.Matrix",methodName:"destroy"}):na.destroyed_matrix_list.push(e)},na.prototype={a:null,b:null,c:null,d:null,tx:null,ty:null,__class__:na};var ia=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.red=e,this.green=t,this.blue=n,this.alpha=i};(n["bikas.global.Color"]=ia).__name__=["bikas","global","Color"],ia.prototype={red:null,green:null,blue:null,alpha:null,__class__:ia};var ra=function(e,t,n,i,r,a,s,l){null==l&&(l=0),null==s&&(s=0),null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=1),null==t&&(t=1),null==e&&(e=1),this.alpha_offset=0,this.blue_offset=0,this.green_offset=0,this.red_offset=0,this.alpha_multiplier=1,this.blue_multiplier=1,this.green_multiplier=1,this.red_multiplier=1,this.red_multiplier=e,this.green_multiplier=t,this.blue_multiplier=n,this.alpha_multiplier=i,this.red_offset=r,this.green_offset=a,this.blue_offset=s,this.alpha_offset=l};(n["bikas.global.ColorTransform"]=ra).__name__=["bikas","global","ColorTransform"],ra.prototype={red_multiplier:null,green_multiplier:null,blue_multiplier:null,alpha_multiplier:null,red_offset:null,green_offset:null,blue_offset:null,alpha_offset:null,__class__:ra};var aa=function(e,t){this.point=e,this.time=t};(n["bikas.global.Intersection"]=aa).__name__=["bikas","global","Intersection"],aa.prototype={point:null,time:null,__class__:aa};var sa=function(e,t){this.start=e,this.end=t};(n["bikas.global.Range"]=sa).__name__=["bikas","global","Range"],sa.prototype={start:null,end:null,__class__:sa};var la=function(e,t){this.min=e,this.max=t};(n["bikas.global.MinMax"]=la).__name__=["bikas","global","MinMax"],la.prototype={min:null,max:null,__class__:la};var oa=function(e,t,n){this.min=e,this.max=t,this.current=n};(n["bikas.global.MinMaxCurrent"]=oa).__name__=["bikas","global","MinMaxCurrent"],oa.prototype={min:null,max:null,current:null,__class__:oa};var _a=function(){};(n["bikas.global.PolygonIntersection"]=_a).__name__=["bikas","global","PolygonIntersection"],_a.prototype={intersection:null,distance:null,index:null,__class__:_a};var pa=function(){};(n["bikas.global.GlobalFunc"]=pa).__name__=["bikas","global","GlobalFunc"],pa.angleDifferenceRad=function(e,t){return Math.atan2(Math.sin(e-t),Math.cos(e-t))},pa.angleDifferenceDeg=function(e,t){var n=(e-t)*Math.PI/180;return Math.atan2(Math.sin(n),Math.cos(n))/Math.PI*180},pa.normalizeAngle=function(e){return(e=(e%Xr.PI2+Xr.PI2)%Xr.PI2)>Math.PI&&(e-=Xr.PI2),e},pa.findGreatestCommonDivisor=function(e,t){for(var n;0!=e;)e=t%(n=e),t=n;return t},pa.clamp=function(e,t,n){return e<t?t:n<e?n:e},pa.clamp0to1=function(e){return e<0?0:1<e?1:e},pa.clamp0toInfinityInt=function(e){return e<0?0:e},pa.clampInt=function(e,t,n){return e<t?t:n<e?n:e},pa.isValueBetween=function(e,t,n){return t<=e&&e<=n},pa.didValuePass=function(e,t,n){return e<=n&&n<=t||n<=e&&t<=n},pa.isInRange=function(e,t,n,i){return!(e<n&&t<n||i<e&&i<t)},pa.range=function(e,t,n){return(e-t)/(n-t)},pa.rangeCoeff=function(e,t,n){return(e-t)/(n-t)},pa.rangeCoeffClamped=function(e,t,n){return pa.clamp((e-t)/(n-t),0,1)},pa.distance=function(e,t,n,i){var r=n-e,a=i-t;return Math.sqrt(r*r+a*a)},pa.distanceBetweenPoints=function(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},pa.dot=function(e,t,n,i){return e*n+t*i},pa.direction=function(e,t,n,i){var r=pa.distance(e,t,n,i);return pa.dot(e,t,n,i)/(r*r)},pa.rectanglesIntersect=function(e,t){return!(e.x>t.x+t.width||e.x+e.width<t.x||e.y>t.y+t.height||e.y+e.height<t.y)},pa.boundsIntersectOrContain=function(e,t){return!(e.min_x>t.max_x||e.min_y>t.max_y||e.max_x<t.min_x||e.max_y<t.min_y)},pa.boundsMiddleX=function(e){return(e.min_x+e.max_x)/2},pa.boundsMiddleY=function(e){return(e.min_y+e.max_y)/2},pa.getTotalRectangle=function(e){if(0==e.length)return null;for(var t=e[0].x,n=e[0].y,i=e[0].x+e[0].width,r=e[0].y+e[0].height,a=0;a<e.length;){var s=e[a];++a,s.x<t&&(t=s.x),s.y<n&&(n=s.y),s.x+s.width>i&&(i=s.x+s.width),s.y+s.height>r&&(r=s.y+s.height)}return new Kr(t,n,i-t,r-n)},pa.distanceFloat=function(e,t){return Math.abs(e-t)},pa.getInvertedPoint=function(e){return new Yr(-e.x,-e.y)},pa.getTransformX=function(e,t,n,i,r){return e*n*Math.cos(r)-t*i*Math.sin(r)},pa.getTransformY=function(e,t,n,i,r){return e*n*Math.sin(r)+t*i*Math.cos(r)},pa.getInvertedTransform=function(e){var t=new ta;return t.scale_x=1/e.scale_x,t.scale_y=1/e.scale_y,t.rotation=-e.rotation,t},pa.isPointBetween=function(e,t,n){return!(n.x<e.x&&n.x<t.x||n.x>e.x&&n.x>t.x||n.y<e.y&&n.y<t.y||n.y>e.y&&n.y>t.y)},pa.isPointInLineRange=function(e,t,n){var i=t.x-e.x,r=t.y-e.y,a=(n.x-e.x)*i+(n.y-e.y)*r;return 0<=a&&a<=i*i+r*r},pa.distanceBetweenLineAndPoint=function(e,t,n){var i=n.x-e.x,r=n.y-e.y,a=t.x-e.x,s=t.y-e.y;return Math.abs(i*s-a*r)/Math.sqrt(a*a+s*s)},pa.distanceBetweenPointAndRectangle=function(e,t){var n=pa.clamp(e.x,t.x,t.x+t.width),i=pa.clamp(e.y,t.y,t.y+t.height);return pa.distance(e.x,e.y,n,i)},pa.distanceBetweenPointAndBoundedArea=function(e,t,n,i,r){var a=pa.clamp(e.x,t,i),s=pa.clamp(e.y,n,r);return pa.distance(e.x,e.y,a,s)},pa.getPointPerpendicularToLine=function(e,t,n){var i=n.x-e.x,r=n.y-e.y,a=t.x-e.x,s=t.y-e.y,l=a*a+s*s;if(0==l)return xl.trace("warning: (C * C + D * D) == 0",{fileName:"GlobalFunc.hx",lineNumber:341,className:"bikas.global.GlobalFunc",methodName:"getPointPerpendicularToLine"}),null;var o=(i*s-a*r)/l;return new Yr(n.x-o*s,n.y+o*a)},pa.pointInRectangle=function(e,t){return!(e.x<t.x||e.y<t.y||e.x>t.x+t.width||e.y>t.y+t.height)},pa.positionInRect=function(e,t,n,i,r,a){return!(e<n||t<i||n+r<e||i+a<t)},pa.pointInBounds=function(e,t){return!(e.x<t.min_x||e.y<t.min_y||e.x>t.max_x||e.y>t.max_y)},pa.pointInBoundedArea=function(e,t,n,i,r){return!(e.x<t||e.y<n||e.x>i||e.y>r)},pa.rectangleInRectangle=function(e,t){return!(e.x<t.x||e.y<t.y||e.x+e.width>t.x+t.width||e.y+e.height>t.y+t.height)},pa.expandRectangle=function(e,t){return new Kr(e.x-t,e.y-t,e.width+2*t,e.height+2*t)},pa.getRectangleMiddle=function(e){return new Yr(e.x+e.width/2,e.y+e.height/2)},pa.logX=function(e,t){return null==t&&(t=10),Math.round(Math.log(e)/Math.log(t))},pa.logFloat=function(e,t){return Math.log(e)/Math.log(t)},pa.near=function(e,t,n){return t-n<=e&&e<=t+n},pa.min=function(e,t){return e<t?e:t},pa.min4=function(e,t,n,i){var r=e;return t<r&&(r=t),n<r&&(r=n),i<r&&(r=i),r},pa.max3=function(e,t,n){var i=e;return i<t&&(i=t),i<n&&(i=n),i},pa.max4=function(e,t,n,i){var r=e;return r<t&&(r=t),r<n&&(r=n),r<i&&(r=i),r},pa.minInt=function(e,t){return e<t?e:t},pa.max=function(e,t){return t<e?e:t},pa.maxInt=function(e,t){return t<e?e:t},pa.rotatePoint=function(e,t,n){var i=Math.cos(n)*(t.x-e.x)-Math.sin(n)*(t.y-e.y)+e.x,r=Math.sin(n)*(t.x-e.x)+Math.cos(n)*(t.y-e.y)+e.y;return new Yr(i,r)},pa.round=function(e,t){return null==t&&(t=.01),Math.round(e/t)*t},pa.snap=function(e,t){return 0<t?Math.round(Math.round(e/t)*t):e},pa.getAngleBetweenPoints=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},pa.interpolateSmoothOutIn=function(e,t,n){var i=.5*(1-Math.cos(n*Math.PI));return e*(1-i)+t*i},pa.interpolateSmoothIn=function(e,t,n){return(1-(n=Math.sin(n*Math.PI*.5)))*e+n*t},pa.interpolateSmoothOut=function(e,t,n){return(n=Math.cos(n*Math.PI*.5))*e+(1-n)*t},pa.interpolate=function(e,t,n){return e+(t-e)*n},pa.interpolateClamped=function(e,t,n){return e+(t-e)*pa.clamp(n,0,1)},pa.interpolateForwardAndBackward=function(e,t,n){return n<.5?pa.interpolate(e,t,2*n):pa.interpolate(t,e,2*n-1)},pa.findIndexOfNearestValue=function(e,t){for(var n=t[0],i=Math.abs(n-e),r=0,a=0,s=t.length;a<s;){var l=a++;n=t[l],Math.abs(n-e)<i&&(i=Math.abs(n-e),r=l)}return r},pa.sumFloatArray=function(e){for(var t=0,n=0;n<e.length;){var i=e[n];++n,t+=i}return t},pa.sumIntArray=function(e){for(var t=0,n=0;n<e.length;){var i=e[n];++n,t+=i}return t},pa.copyPoint=function(e){return new Yr(e.x,e.y)},pa.copyRectangle=function(e){return new Kr(e.x,e.y,e.width,e.height)},pa.copyTransform=function(e){var t=new ta;return t.scale_x=e.scale_x,t.scale_y=e.scale_y,t.rotation=e.rotation,t},pa.copyBounds=function(e){return new Qr(e.min_x,e.min_y,e.max_x,e.max_y)},pa.copyPoints=function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n,t.push(pa.copyPoint(i))}return t},pa.spaceText=function(e,t){for(;e.length<t;)e+=" ";return e},pa.getRandomBetween=function(e,t){return e+Math.random()*(t-e)},pa.getSign=function(e){return 0<e?1:e<0?-1:0},pa.getRandomSign=function(){return.5<Math.random()?1:-1},pa.getRandomSignInt=function(){return.5<Math.random()?1:-1},pa.getRandomBetweenInt=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},pa.getRandomPointInRectangle=function(e){return new Yr(e.x+e.width*Math.random(),e.y+e.height*Math.random())},pa.getRandomArrayIndex=function(e){return 0==e.length?-1:pa.getRandomBetweenInt(0,e.length-1)},pa.getRandomArrayElement=function(e){return 0==e.length?null:e[pa.getRandomBetweenInt(0,e.length-1)]},pa.createRectangleFrom2Points=function(e,t){var n,i;return n=e.x<t.x?e.x:t.x,i=e.y<t.y?e.y:t.y,new Kr(n,i,Math.abs(e.x-t.x),Math.abs(e.y-t.y))},pa.boundsToRectangle=function(e){var t=e.min_x,n=e.min_y,i=e.max_x-e.min_x,r=e.max_y-e.min_y;return new Kr(t,n,i,r)},pa.rectangleToBounds=function(e){return new Qr(e.x,e.y,e.x+e.width,e.y+e.height)},pa.pointInPolygon=function(e,t){if(t.length<3)return!1;for(var n=e.x,i=e.y,r=t[t.length-1],a=!1,s=0;s<t.length;){var l=t[s];++s,(l.y<i&&r.y>=i||r.y<i&&l.y>=i)&&(l.x<=n||r.x<=n)&&l.x+(i-l.y)/(r.y-l.y)*(r.x-l.x)<n&&(a=!a),r=l}return a},pa.intersectPointX=function(e,t,n){return new Yr(e.x+(n-e.y)/(t.y-e.y)*(t.x-e.x),n)},pa.intersectPointY=function(e,t,n){return new Yr(n,e.y+(n-e.x)/(t.x-e.x)*(t.y-e.y))},pa.canInfiniteLinesIntersect=function(e,t,n,i){var r=e.x,a=e.y,s=t.x,l=t.y,o=n.x,_=n.y,p=i.x;return 0!=(i.y-_)*(s-r)-(p-o)*(l-a)},pa.getInfiniteLineIntersection=function(e,t,n,i){var r=e.x,a=e.y,s=t.x,l=t.y,o=n.x,_=n.y,p=i.x,u=i.y,h=(u-_)*(s-r)-(p-o)*(l-a);if(0==h)return null;var c=((p-o)*(a-_)-(u-_)*(r-o))/h;return new Yr(r+c*(s-r),a+c*(l-a))},pa.getLineSegmentIntersection=function(e,t,n,i){var r=e.x,a=e.y,s=t.x,l=t.y,o=n.x,_=n.y,p=i.x,u=i.y,h=(u-_)*(s-r)-(p-o)*(l-a);if(0==h)return null;var c=((p-o)*(a-_)-(u-_)*(r-o))/h,d=((s-r)*(a-_)-(l-a)*(r-o))/h;return 0<=c&&c<=1&&0<=d&&d<=1?new Yr(r+c*(s-r),a+c*(l-a)):null},pa.lineSegmentsIntersect=function(e,t,n,i){var r=e.x,a=e.y,s=t.x,l=t.y,o=n.x,_=n.y,p=i.x,u=i.y,h=(u-_)*(s-r)-(p-o)*(l-a);if(0==h)return!1;var c=((p-o)*(a-_)-(u-_)*(r-o))/h,d=((s-r)*(a-_)-(l-a)*(r-o))/h;return 0<=c&&c<=1&&0<=d&&d<=1},pa.pointsEqual=function(e,t){return e.x==t.x&&e.y==t.y},pa.sizesEqual=function(e,t){return e.width==t.width&&e.height==t.height},pa.boundsEqual=function(e,t){return e.min_x==t.min_x&&e.min_y==t.min_y&&e.max_x==t.max_x&&e.max_y==t.max_y},pa.rectanglesEqual=function(e,t){return e.x==t.x&&e.y==t.y&&e.width==t.width&&e.height==t.height},pa.sortByIncreasingValue=function(e,t){return t<e?1:e<t?-1:0},pa.gamma_lanczos=function(e){var t=Xr.GAMMA_LANCZOS_P;if(e<.5)return Math.PI/(Math.sin(Math.PI*e)*pa.gamma_lanczos(1-e));--e;for(var n=t[0],i=e+7+.5,r=1,a=t.length;r<a;){var s=r++;n+=t[s]/(e+s)}return Math.sqrt(2*Math.PI)*Math.pow(i,e+.5)*Math.exp(-i)*n};(n["bikas.global.GlobalMacro"]=function(){}).__name__=["bikas","global","GlobalMacro"];var ua=function(){};(n["bikas.global.GlobalParse"]=ua).__name__=["bikas","global","GlobalParse"],ua.stringToFloatArray=function(e){if("["!=e.charAt(0)||"]"!=e.charAt(e.length-1))return xl.trace("warning: invalid array",{fileName:"GlobalParse.hx",lineNumber:8,className:"bikas.global.GlobalParse",methodName:"stringToFloatArray"}),null;for(var t=s.substr(e,1,e.length-2).split(",").map(p.parseFloat),n=0,i=t.length;n<i;){var r=n++;isNaN(t[r])&&(t[r]=0)}return t},ua.stringToIntArray=function(e){if("["!=e.charAt(0)||"]"!=e.charAt(e.length-1))return xl.trace("warning: invalid array",{fileName:"GlobalParse.hx",lineNumber:25,className:"bikas.global.GlobalParse",methodName:"stringToIntArray"}),null;for(var t=s.substr(e,1,e.length-2).split(",").map(p.parseInt),n=0,i=t.length;n<i;){var r=n++;null==t[r]&&(t[r]=0)}return t},ua.floatArrayToString=function(e){for(var t="[",n=0,i=e.length-1;n<i;)t+=e[n++]+",";return t+=e[e.length-1]+"]"},ua.intArrayToString=function(e){for(var t="[",n=0,i=e.length-1;n<i;)t+=e[n++]+",";return t+=e[e.length-1]+"]"};var ha=function(){};(n["bikas.global.GlobalProc"]=ha).__name__=["bikas","global","GlobalProc"],ha.applyTransform=function(e,t,n,i){var r=pa.getTransformX(e.x,e.y,i.scale_x,i.scale_y,.017453292519943*i.rotation),a=pa.getTransformY(e.x,e.y,i.scale_x,i.scale_y,.017453292519943*i.rotation);e.x=n.x+r,e.y=n.y+a,t.scale_x*=i.scale_x,t.scale_y*=i.scale_y,t.rotation+=i.rotation},ha.transformPoint=function(e,t){var n=pa.getTransformX(e.x,e.y,t.scale_x,t.scale_y,.017453292519943*t.rotation),i=pa.getTransformY(e.x,e.y,t.scale_x,t.scale_y,.017453292519943*t.rotation);e.x=n,e.y=i},ha.applySeveralTransformsToPoint=function(e,t,n){if(t.length!=n.length)xl.trace("error: position and transform length mismatch",{fileName:"GlobalProc.hx",lineNumber:29,className:"bikas.global.GlobalProc",methodName:"applySeveralTransformsToPoint"});else for(var i=0,r=t.length;i<r;){var a=i++;ha.applyTransformToPoint(e,t[a],n[a])}},ha.applyTransformToPoint=function(e,t,n){var i=pa.getTransformX(e.x,e.y,n.scale_x,n.scale_y,.017453292519943*n.rotation),r=pa.getTransformY(e.x,e.y,n.scale_x,n.scale_y,.017453292519943*n.rotation);e.x=t.x+i,e.y=t.y+r},ha.expandRectangle=function(e,t){return e.x-=t,e.y-=t,e.width+=2*t,e.height+=2*t,e},ha.expandBounds=function(e,t){return e.min_x-=t,e.min_y-=t,e.max_x+=t,e.max_y+=t,e},ha.moveBounds=function(e,t,n){return e.min_x+=t,e.min_y+=n,e.max_x+=t,e.max_y+=n,e},ha.scaleRectangle=function(e,t){e.x*=t,e.y*=t,e.width*=t,e.height*=t},ha.setRectanglePosition=function(e,t){e.x=t.x,e.y=t.y},ha.setPoint=function(e,t){e.x=t.x,e.y=t.y},ha.combineBounds=function(e,t){e.min_x=pa.min(e.min_x,t.min_x),e.min_y=pa.min(e.min_y,t.min_y),e.max_x=pa.max(e.max_x,t.max_x),e.max_y=pa.max(e.max_y,t.max_y)},ha.setBounds=function(e,t){e.min_x=t.min_x,e.min_y=t.min_y,e.max_x=t.max_x,e.max_y=t.max_y},ha.roundBounds=function(e){e.min_x=Math.round(e.min_x),e.min_y=Math.round(e.min_y),e.max_x=Math.round(e.max_x),e.max_y=Math.round(e.max_y)},ha.setBoundsFromRotatedBounds=function(e,t,n,i,r,a){var s=Math.sin(a),l=Math.cos(a),o=t*l-n*s,_=t*s+n*l,p=i*l-n*s,u=i*s+n*l,h=i*l-r*s,c=i*s+r*l,d=t*l-r*s,m=t*s+r*l;return e.min_x=pa.min4(o,p,h,d),e.min_y=pa.min4(_,u,c,m),e.max_x=pa.max4(o,p,h,d),e.max_y=pa.max4(_,u,c,m),e},ha.setPointPerpendicularToLine=function(e,t,n,i){var r=n.x-e.x,a=n.y-e.y,s=t.x-e.x,l=t.y-e.y,o=s*s+l*l;if(0!=o){var _=(r*l-s*a)/o;i.x=n.x-_*l,i.y=n.y+_*s}else xl.trace("warning: (C * C + D * D) == 0",{fileName:"GlobalProc.hx",lineNumber:145,className:"bikas.global.GlobalProc",methodName:"setPointPerpendicularToLine"})},ha.randomizeMinMaxCurrent=function(e){e.current=pa.getRandomBetween(e.min,e.max)},ha.roundFloatArray=function(e){for(var t=0,n=e.length;t<n;){var i=t++;e[i]=Math.round(e[i])}return e},ha.shuffleArray=function(e){for(var t=0,n=e.length;t<n;){var i=t++,r=pa.getRandomBetweenInt(0,e.length-1),a=e[i],s=e[r];e[i]=s,e[r]=a}return e};var ca=function(){};(n["bikas.global.InterpolateFunc"]=ca).__name__=["bikas","global","InterpolateFunc"],ca.linear=function(e,t,n){return e+(t-e)*n},ca.smoothStart=function(e,t,n){return(n=Math.cos(n*Math.PI*.5))*e+(1-n)*t},ca.smoothEnd=function(e,t,n){return(1-(n=Math.sin(n*Math.PI*.5)))*e+n*t},ca.smoothStartEnd=function(e,t,n){var i=.5*(1-Math.cos(n*Math.PI));return e*(1-i)+t*i},ca.linearClamped=function(e,t,n){return e+(t-e)*ca.clamp(n,0,1)},ca.linearRounded=function(e,t,n){return Math.round(e+(t-e)*n)},ca.linearForwardAndBackward=function(e,t,n){return n<.5?ca.linear(e,t,2*n):ca.linear(t,e,2*n-1)},ca.smoothForwardAndBackward=function(e,t,n){return n<.5?ca.smoothStartEnd(e,t,2*n):ca.smoothStartEnd(t,e,2*n-1)},ca.linearToABC=function(e,t,n,i,r){return r<i?ca.linear(e,t,r/i):ca.linear(t,n,(r-i)/(1-i))},ca.smoothToABCWithSmoothB=function(e,t,n,i,r){return r<i?ca.smoothEnd(e,t,r/i):ca.smoothStart(t,n,(r-i)/(1-i))},ca.angleShortestLinear=function(e,t,n){return e+Math.atan2(Math.sin(t-e),Math.cos(t-e))*n},ca.getT=function(e,t,n){return(n-e)/(t-e)},ca.getTFromABC=function(e,t,n,i){return i<=t?.5*ca.getT(e,t,i):.5*ca.getT(t,n,i)+.5},ca.getTClamped=function(e,t,n){var i=(n-e)/(t-e);return i<0?0:1<i?1:i},ca.integrateSmoothEnd=function(e,t,n){null==n&&(n=60);for(var i=(t-e)/n,r=e+i/2,a=0,s=0,l=n;s<l;)s++,a+=Math.sin(.5*Math.PI*r)*i,r+=i;return a},ca.integrateLinear=function(e,t,n){null==n&&(n=60);for(var i=(t-e)/n,r=e+i/2,a=0,s=0,l=n;s<l;)s++,a+=r*i,r+=i;return a},ca.clamp=function(e,t,n){return e<t?t:n<e?n:e};var da=function(){};(n["bikas.global.StringFunc"]=da).__name__=["bikas","global","StringFunc"],da.intToBinaryString=function(e,t){null==t&&(t=8);for(var n="",i=Math.abs(e);0<i;)n=i%2==0?"0"+n:"1"+n,i=p.int(i/2);if(n.length<t)for(var r=n.length,a=t;r<a;)r++,n="0"+n;return e<0&&(n="-"+n),n},da.splitByLines=function(e){return h.replace(e,"\r\n","\n").split("\n")},da.prependZerosToNumber=function(e,t){for(null==t&&(t=4);e.length<t;)e="0"+e;return e},da.appendZerosToNumber=function(e,t){for(null==t&&(t=4);e.length<t;)e+="0";return e},da.removeSpacesAtStartAndEnd=function(e){return h.trim(e)},da.nameSort=function(e,t){return(e=e.toLowerCase())<(t=t.toLowerCase())?-1:t<e?1:0},da.reverse=function(e){for(var t=new u,n=1-e.length;n<1;){var i=n++;t.addChar(s.cca(e,-i))}return t.toString()};var ma=function(){};(n["bikas.global.Vec3Func"]=ma).__name__=["bikas","global","Vec3Func"],ma.getProjection=function(e,t){return new Yr(e.z*(t.x-e.x)/(e.z+t.z)+e.x,e.z*(t.y-e.y)/(e.z+t.z)+e.y)},ma.getProjectionWithCamera=function(e,t,n){return new Yr(e.z*(n.x+t.x-e.x)/(e.z+(n.z+t.z))+e.x,e.z*(n.y+t.y-e.y)/(e.z+(n.z+t.z))+e.y)},ma.getPointZUsingY=function(e,t,n,i){return t.z*(i+n.y-t.y)/(e.y-t.y)-n.z-t.z},ma.getPointXUsingZ=function(e,t,n,i){return(e.x-t.x)*(t.z+i+n.z)/t.z+t.x-n.x},ma.getPointYUsingZ=function(e,t,n,i){return(e.y-t.y)*(t.z+i+n.z)/t.z+t.y-n.y},ma.copy=function(e){return new ji(e.x,e.y,e.z)},ma.add=function(e,t){return new ji(e.x+t.x,e.y+t.y,e.z+t.z)},ma.rotateX=function(e,t){var n=e.y*Math.cos(t)-e.z*Math.sin(t),i=e.y*Math.sin(t)+e.z*Math.cos(t),r=e.x;return new ji(r,n,i)},ma.rotateY=function(e,t){var n=e.z*Math.cos(t)-e.x*Math.sin(t),i=e.z*Math.sin(t)+e.x*Math.cos(t),r=e.y;return new ji(i,r,n)},ma.rotateZ=function(e,t){var n=e.x*Math.cos(t)-e.y*Math.sin(t),i=e.x*Math.sin(t)+e.y*Math.cos(t),r=e.z;return new ji(n,i,r)};var fa=function(){};(n["bikas.global.Vec3Proc"]=fa).__name__=["bikas","global","Vec3Proc"],fa.set=function(e,t){return e.x=t.x,e.y=t.y,e.z=t.z,e},fa.setxyz=function(e,t,n,i){return e.x=t,e.y=n,e.z=i,e},fa.add=function(e,t){return e.x+=t.x,e.y+=t.y,e.z+=t.z,e},fa.applyProjection=function(e,t,n){return e.x=t.z*(n.x-t.x)/(t.z+n.z)+t.x,e.y=t.z*(n.y-t.y)/(t.z+n.z)+t.y,e},fa.applyProjectionWithCamera=function(e,t,n,i){return e.x=t.z*(i.x+n.x-t.x)/(t.z+(i.z+n.z))+t.x,e.y=t.z*(i.y+n.y-t.y)/(t.z+(i.z+n.z))+t.y,e},fa.rotateX=function(e,t){var n=e.y*Math.cos(t)-e.z*Math.sin(t),i=e.y*Math.sin(t)+e.z*Math.cos(t),r=e.x;return fa.setxyz(e,r,n,i),e},fa.rotateY=function(e,t){var n=e.z*Math.cos(t)-e.x*Math.sin(t),i=e.z*Math.sin(t)+e.x*Math.cos(t),r=e.y;return fa.setxyz(e,i,r,n),e},fa.rotateZ=function(e,t){var n=e.x*Math.cos(t)-e.y*Math.sin(t),i=e.x*Math.sin(t)+e.y*Math.cos(t),r=e.z;return fa.setxyz(e,n,i,r),e};var ga=function(){};(n["bikas.global.VecFunc"]=ga).__name__=["bikas","global","VecFunc"],ga.add=function(e,t){return new Yr(e.x+t.x,e.y+t.y)},ga.addxy=function(e,t,n){return new Yr(e.x+t,e.y+n)},ga.add2=function(e,t,n){return new Yr(e.x+t.x+n.x,e.y+t.y+n.y)},ga.subtract=function(e,t){return new Yr(e.x-t.x,e.y-t.y)},ga.multiply=function(e,t){return new Yr(e.x*t,e.y*t)},ga.$length=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},ga.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},ga.normalize=function(e){var t=new Yr,n=ga.$length(e);return 0!=n&&(t.x=e.x/n,t.y=e.y/n),t},ga.dot=function(e,t){return e.x*t.x+e.y*t.y},ga.dotUsingLengthsAndAngle=function(e,t,n){return e*t*Math.cos(n)},ga.angle=function(e){return Math.atan2(e.y,e.x)},ga.direction=function(e){return Math.atan2(e.y,e.x)},ga.rotation=function(e){return Math.atan2(e.y,e.x)},ga.rotate=function(e,t){var n=Math.cos(t),i=Math.sin(t);return new Yr(e.x*n-e.y*i,e.x*i+e.y*n)},ga.scalarProjection=function(e,t){return ga.dot(t,e)/ga.$length(e)},ga.vectorProjection=function(e,t){return ga.multiply(e,ga.dot(t,e)/(t.x*t.x+t.y*t.y))},ga.cross=function(e,t){return e.x*t.y-e.y*t.x},ga.interpolate=function(e,t,n){var i=e.x+(t.x-e.x)*n,r=e.y+(t.y-e.y)*n;return new Yr(i,r)},ga.middle=function(e,t){return ga.interpolate(e,t,.5)},ga.copy=function(e){return new Yr(e.x,e.y)},ga.isZero=function(e){return 0==e.x&&0==e.y};var va=function(){};(n["bikas.global.VecProc"]=va).__name__=["bikas","global","VecProc"],va.set=function(e,t){return e.x=t.x,e.y=t.y,e},va.setxy=function(e,t,n){return e.x=t,e.y=n,e},va.add=function(e,t){return e.x+=t.x,e.y+=t.y,e},va.addMultiplied=function(e,t,n){return e.x+=t.x*n,e.y+=t.y*n,e},va.addxy=function(e,t,n){return e.x+=t,e.y+=n,e},va.subtract=function(e,t){return e.x-=t.x,e.y-=t.y,e},va.multiply=function(e,t){return e.x*=t,e.y*=t,e},va.rotate=function(e,t){var n=Math.cos(t),i=Math.sin(t),r=n*e.x-i*e.y,a=i*e.x+n*e.y;return e.x=r,e.y=a,e},va.normalize=function(e){var t=ga.$length(e);if(0!=t){var n=e.x,i=e.y;e.x=n/t,e.y=i/t}return e};var ba=function(){};(n["bikas.google.GoogleAnalyticsWrapper"]=ba).__name__=["bikas","google","GoogleAnalyticsWrapper"],ba.init=function(e,t){rl.init(e,t),ba.exists=!0},ba.trackPage=function(e){ba.exists&&rl.trackPageview("/"+e)},ba.trackEvent=function(e,t,n){ba.exists&&rl.trackEvent(e,t,n)},ba.trackLevelStart=function(e){ba.trackPage("level start: "+e)},ba.trackLevelFinish=function(e){ba.trackPage("level finished: "+e)},ba.trackLevelFailed=function(e){ba.trackPage("level failed "+e)},ba.trackGameFinish=function(){ba.trackPage("game finished")},ba.trackCreditsClicked=function(){ba.trackEvent("click","credits","")},ba.trackMoreGamesClicked=function(){ba.trackEvent("click","more games","")},ba.trackBikasNetClicked=function(){ba.trackEvent("click","bikas.net","")};var ya=function(e,t,n,i){null==i&&(i=768),null==n&&(n=1382),null==t&&(t=768),null==e&&(e=1024),this.desktop=!1,this.windowsPhone=!1,this.windows=!1,this.macOS=!1,this.linux=!1,this.iOS=!1,this.chromeOS=!1,this.android=!1,this.kindle=!1,this.vita=!1,this.build_time=0,this.scale_listeners=[],this.scale_count=0,this.last_scale_date=null,this.fullscreened=!1,this.device_scale=1,this.window_scale=1,this.height_offset=0,this.game_position=new Yr(0,0),this.force_size=null,this.min_game_width=e,this.min_game_height=t,this.max_game_width=n,this.max_game_height=i,this.original_max_game_width=n,this.original_max_game_height=i,this.current_game_width=e,this.current_game_height=t,this.canvas_game_width=e,this.canvas_game_height=t};(n["bikas.javascript.JsGameInfo"]=ya).__name__=["bikas","javascript","JsGameInfo"],ya.prototype={gamecanvas:null,pointer_container:null,loader:null,min_game_width:null,min_game_height:null,max_game_width:null,max_game_height:null,original_max_game_width:null,original_max_game_height:null,force_size:null,game_position:null,height_offset:null,window_scale:null,device_scale:null,fullscreened:null,current_game_width:null,current_game_height:null,canvas_game_width:null,canvas_game_height:null,last_scale_date:null,scale_count:null,scale_listeners:null,build_time:null,vita:null,kindle:null,android:null,chromeOS:null,iOS:null,linux:null,macOS:null,windows:null,windowsPhone:null,desktop:null,__class__:ya};var xa=function(){this.position=new Yr(0,0)};(n["bikas.javascript.GameSize"]=xa).__name__=["bikas","javascript","GameSize"],xa.prototype={position:null,width:null,height:null,canvas_width:null,canvas_height:null,scale:null,__class__:xa};var za=n["bikas.javascript.CustomType"]={__ename__:["bikas","javascript","CustomType"],__constructs__:["FloatArray","IntArray"]};za.FloatArray=["FloatArray",0],za.FloatArray.toString=i,(za.FloatArray.__enum__=za).IntArray=["IntArray",1],za.IntArray.toString=i,(za.IntArray.__enum__=za).__empty_constructs__=[za.FloatArray,za.IntArray];var wa=function(){};(n["bikas.javascript.JsDebug"]=wa).__name__=["bikas","javascript","JsDebug"],wa.exportReflectStuff=function(){xl.trace(_.field,{fileName:"JsDebug.hx",lineNumber:22,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"}),xl.trace(_.fields,{fileName:"JsDebug.hx",lineNumber:23,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"}),xl.trace(_.setProperty,{fileName:"JsDebug.hx",lineNumber:24,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"}),xl.trace(_.getProperty,{fileName:"JsDebug.hx",lineNumber:25,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"}),xl.trace(_.setField,{fileName:"JsDebug.hx",lineNumber:26,className:"bikas.javascript.JsDebug",methodName:"exportReflectStuff"})},wa.addScrollBox=function(e,t,n){var i=to.get_document().createElement("div");return i.style.overflow="scroll",i.style.width=t+"px",i.style.height=n+"px",e.appendChild(i),i},wa.addButton=function(e,t,n){var i=to.get_document().createElement("button");return i.textContent=t,e.appendChild(i),i.onclick=function(e){n()},i.onkeydown=function(e){32!=e.keyCode&&13!=e.keyCode||e.preventDefault()},i},wa.addButtonCustom=function(e,t,n,i,r,a){var s=to.get_document().createElement("button");return s.style.alignSelf="center",s.style.alignContent="center",s.style.textAlign="center",null!=r&&(s.style.width=r+"px"),null!=a&&(s.style.height=a+"px"),s.textContent=t,e.appendChild(s),null!=n&&(s.onmousedown=function(e){n(e)}),null!=i&&(s.onmouseup=function(e){i(e)}),s},wa.addTextInputArea=function(e){var t=to.get_document().createElement("textarea");return e.appendChild(t),e.onkeydown=function(e){if(13!=e.keyCode)return!0;e.preventDefault();var n=t.value.substring(0,t.selectionStart),i=t.value.substring(t.selectionStart,t.value.length);return t.value=n+"\n"+i,t.setSelectionRange(n.length+1,n.length+1),!1},t},wa.addFieldWatch=function(e,t,n,i){null==i&&(i="");var r=to.get_document(),a=_.field(t,n),s=r.createElement("ul"),l=r.createElement("li"),o=r.createElement("div"),p=to.get_document().createTextNode("");o.className="textinnerbox",l.appendChild(o),o.appendChild(p);var u=null;return(new zl(Math.round(250)).run=function(){if((a=_.field(t,n))!=u){var e=d.typeof(u=a);if(2==d.enumIndex(e)){var r=eo.__cast(a,wc);r=Math.round(1e3*r)/1e3,a=r}p.textContent=""!=i?i+" = "+a:n+" = "+a}})(),s.appendChild(l),e.appendChild(s),s},wa.addText=function(e,t,n,i){null==i&&(i=!1),null==n&&(n=!1);var r=to.get_document(),a=r.createTextNode(t),s=r.createElement("div");return s.style.margin="0",s.style.padding="0",n&&(s.style.textAlign="center"),i&&(s.style.fontWeight="bold"),s.appendChild(a),e.appendChild(s),s},wa.addBoolEdit=function(e,t,n,i,r){null==i&&(i="");var a=to.get_document(),s=_.field(t,n),l=a.createElement("ul"),o=a.createElement("li"),p=a.createElement("div"),u=to.get_document().createTextNode("");p.className="textinnerbox",o.appendChild(p),p.appendChild(u),u.textContent=""!=i?i:n;var h=a.createElement("input");h.type="checkbox",h.checked=s,l.appendChild(o),l.appendChild(h),e.appendChild(l),h.onclick=function(e){var i=h.checked;_.setField(t,n,i),null!=r&&r(i)};return(new zl(Math.round(250)).run=function(){h.checked!=_.field(t,n)&&(h.checked=_.field(t,n))})(),l},wa.addEnumEdit=function(e,t,n,i,r,a){null==i&&(i="");var s=_.field(t,n);if(null==s)return xl.trace("warning: can't edit null enum value",{fileName:"JsDebug.hx",lineNumber:234,className:"bikas.javascript.JsDebug",methodName:"addEnumEdit"}),null;""==i&&(i=n),za.FloatArray;var l=d.getEnum(s),o=d.getEnumConstructs(l);return wa.addItemSelect(e,s,o,i,r,(function(e,i){var r=d.createEnum(l,eo.__cast(i,String));_.setField(t,n,r),null!=a&&a(r)}))},wa.addItemSelect=function(e,t,n,i,r,a){var s=to.get_document(),l=s.createElement("ul"),o=s.createElement("li"),_=s.createElement("div"),p=to.get_document().createTextNode("");_.className="textinnerbox",o.appendChild(_),_.appendChild(p),p.textContent=i;var u=s.createElement("li"),h=s.createElement("select");h.className="selectelement",h.id="mySelect",h.value=t;for(var c=0,d=n.length;c<d;){var m=c++,f=s.createElement("option");f.value=n[m],f.text=n[m],h.appendChild(f)}if(h.value=t,u.appendChild(h),l.appendChild(o),l.appendChild(u),r){var g=s.createElement("li"),v=s.createElement("button");g.className="applyvalue",v.textContent="Apply",g.appendChild(v),l.appendChild(g),v.onclick=function(e){if(null!=a){var t=h.selectedIndex,n=h.selectedOptions.item(0).value;a(t,n)}}}else h.onchange=function(e){var t=h.selectedIndex,n=h.selectedOptions.item(0).value;a(t,n)};return e.appendChild(l),l},wa.addFieldEdit=function(e,t,n,i,r,a){null==i&&(i="");var s=to.get_document(),l=_.field(t,n),o=s.createElement("ul"),u=s.createElement("li"),h=s.createElement("div"),c=to.get_document().createTextNode("");h.className="textinnerbox",u.appendChild(h),h.appendChild(c),c.textContent=""!=i?i:n;var m=s.createElement("li"),f=s.createElement("input");m.className="inputvalue",null!=r&&(r==za.FloatArray?f.value=ua.floatArrayToString(l):r==za.IntArray?f.value=ua.intArrayToString(l):xl.trace("unsupported custom_type: "+p.string(r),{fileName:"JsDebug.hx",lineNumber:359,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"})),f.value=p.string(l),m.appendChild(f);var g=s.createElement("li"),v=s.createElement("button");g.className="applyvalue",v.textContent="Apply",g.appendChild(v),o.appendChild(u),o.appendChild(m),o.appendChild(g),e.appendChild(o);var b=d.typeof(l);return v.onclick=function(e){var i=f.value;if(null!=r)if(r==za.FloatArray){var s=ua.stringToFloatArray(i);_.setField(t,n,s)}else if(r==za.IntArray){var o=ua.stringToIntArray(i);_.setField(t,n,o)}else xl.trace("unsupported custom_type: "+p.string(r),{fileName:"JsDebug.hx",lineNumber:388,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"});else switch(d.enumIndex(b)){case 1:case 2:var u=p.parseFloat(i);isNaN(u)?(f.value=p.string(l),xl.trace("invalid value: "+u,{fileName:"JsDebug.hx",lineNumber:407,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"})):_.setField(t,n,u);break;case 3:"true"==i?_.setField(t,n,!0):"false"==i?_.setField(t,n,!1):(xl.trace("invalid value: "+i,{fileName:"JsDebug.hx",lineNumber:399,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"}),f.value=p.string(l));break;case 7:b[2],xl.trace("enum: not yet implemented",{fileName:"JsDebug.hx",lineNumber:413,className:"bikas.javascript.JsDebug",methodName:"addFieldEdit"});break;default:"string"==typeof l&&_.setField(t,n,i)}null!=a&&a()},o};var ka=function(){};(n["bikas.javascript.JsDo"]=ka).__name__=["bikas","javascript","JsDo"],ka.getTimer=function(){return null!=to.get_window().performance?Math.round(to.get_window().performance.now()):(new Date).getTime()},ka.delay=function(e,t){zl.delay(t,Math.round(1e3*e))},ka.getWellFormattedDate=function(e){var t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),r=e.getHours(),a=e.getMinutes(),s=e.getSeconds();return ka.addZerosToNumber(t,4)+" "+ka.addZerosToNumber(n,2)+" "+ka.addZerosToNumber(i,2)+", "+ka.addZerosToNumber(r,2)+":"+ka.addZerosToNumber(a,2)+":"+ka.addZerosToNumber(s,2)},ka.getCurrentDateForFileSaving=function(e,t){null==t&&(t=", "),null==e&&(e=" ");var n=new Date,i=n.getFullYear(),r=n.getMonth()+1,a=n.getDate(),s=n.getHours(),l=n.getMinutes(),o=n.getSeconds();return ka.addZerosToNumber(i,4)+e+ka.addZerosToNumber(r,2)+e+ka.addZerosToNumber(a,2)+t+ka.addZerosToNumber(s,2)+e+ka.addZerosToNumber(l,2)+e+ka.addZerosToNumber(o,2)},ka.addZerosToNumber=function(e,t){for(var n=e+"",i=n.length,r=t;i<r;)i++,n="0"+n;return n},ka.copyTextToClipboard=function(e){var t=to.get_document().createElement("textarea");t.style.position="fixed",t.style.top="0",t.style.left="0",t.style.width="2em",t.style.height="2em",t.style.padding="0",t.style.border="none",t.style.outline="none",t.style.boxShadow="none",t.style.background="transparent",t.value=e,to.get_document().body.appendChild(t),t.select();try{to.get_document().execCommand("copy")}catch(e){xl.trace("unable to copy",{fileName:"JsDo.hx",lineNumber:86,className:"bikas.javascript.JsDo",methodName:"copyTextToClipboard"})}to.get_document().body.removeChild(t)},ka.copyPublicStaticVarsToClipboard=function(e,t,n){null==n&&(n=1);for(var i="",r="",a=0,s=n;a<s;)a++,r+="\t";for(var l=0,o=t.length;l<o;){var u=l++,h=t[u];i+=r+"public static var "+h+":Float = "+p.string(_.field(e,h))+";",u<t.length-1&&(i+="\n")}ka.copyTextToClipboard(i)};var Sa=function(e,t){this.submitted=!1,this.name="",this.name=e,this.achievement_type=t};(n["bikas.lagged.LaggedAward"]=Sa).__name__=["bikas","lagged","LaggedAward"],Sa.prototype={name:null,achievement_type:null,submitted:null,__class__:Sa};var Ca=function(){};(n["bikas.lagged.LaggedWrapperDo"]=Ca).__name__=["bikas","lagged","LaggedWrapperDo"],Ca.init=function(){"undefined"==typeof LaggedAPI?xl.trace("LaggedAPI is undefined",{fileName:"LaggedWrapperDo.hx",lineNumber:86,className:"bikas.lagged.LaggedWrapperDo",methodName:"init"}):(xl.trace("lagged init",{fileName:"LaggedWrapperDo.hx",lineNumber:88,className:"bikas.lagged.LaggedWrapperDo",methodName:"init"}),LaggedAPI.init("adventure_drivers_init","lagdevaF3001"))},Ca.updateAllAwards=function(e){for(var t=[],n=0,i=Ca.all_awards;n<i.length;){var r=i[n];++n;for(var a=0,s=e.achievement_descs;a<s.length;){var l=s[a];if(++a,l.type==r.achievement_type&&-1!=e.game_save.achievements_completed.indexOf(l.id)){Ca.pushSubmit(t,r);break}}}0<t.length&&Ca.submitAwards(t)},Ca.pushSubmit=function(e,t){t.submitted||(t.submitted=!0,e.push(t.name))},Ca.submitAwards=function(e){xl.trace("submit awards: "+p.string(e),{fileName:"LaggedWrapperDo.hx",lineNumber:122,className:"bikas.lagged.LaggedWrapperDo",methodName:"submitAwards"}),"undefined"==typeof LaggedAPI?xl.trace("LaggedAPI undefined",{fileName:"LaggedWrapperDo.hx",lineNumber:125,className:"bikas.lagged.LaggedWrapperDo",methodName:"submitAwards"}):LaggedAPI.Achievements.save(e,(function(e){e.success?xl.trace("achievement saved",{fileName:"LaggedWrapperDo.hx",lineNumber:129,className:"bikas.lagged.LaggedWrapperDo",methodName:"submitAwards"}):xl.trace(e.errormsg,{fileName:"LaggedWrapperDo.hx",lineNumber:131,className:"bikas.lagged.LaggedWrapperDo",methodName:"submitAwards"})}))},Ca.showAd=function(e){"undefined"==typeof prerollStart?(xl.trace("skip ad, prerollStart not found",{fileName:"LaggedWrapperDo.hx",lineNumber:140,className:"bikas.lagged.LaggedWrapperDo",methodName:"showAd"}),e()):(xl.trace("show ad",{fileName:"LaggedWrapperDo.hx",lineNumber:143,className:"bikas.lagged.LaggedWrapperDo",methodName:"showAd"}),LaggedAPI.APIAds.show("interstitial","adventure-drivers","adventure-drivers-game.jpg",(function(t){t.success?xl.trace("ad done",{fileName:"LaggedWrapperDo.hx",lineNumber:146,className:"bikas.lagged.LaggedWrapperDo",methodName:"showAd"}):xl.trace("ad error, continue",{fileName:"LaggedWrapperDo.hx",lineNumber:149,className:"bikas.lagged.LaggedWrapperDo",methodName:"showAd"}),e()})))};var Na=function(){};(n["bikas.nape.NapeDo"]=Na).__name__=["bikas","nape","NapeDo"],Na.hasCollisionArbiterDynamicBody=function(e){if(null==e.get_space())return!1;if(e.get_isSleeping())return!1;for(var t=e.get_arbiters().iterator();t.hasNext();)if(t.next().isCollisionArbiter())return!0;return!1},Na.getHighestImpulseFromCollisionArbitersOfDynamicBody=function(e){if(null==e.get_space())return 0;if(e.get_isSleeping())return 0;for(var t=0,n=e.get_arbiters().iterator();n.hasNext();){var i=n.next();if(i.isCollisionArbiter()){var r=i.totalImpulse().get_length();t<r&&(t=r)}}return t},Na.getHighestImpulseFromCollisionArbitersOfStaticBody=function(e){if(null==e.get_space())return 0;for(var t=0,n=e.get_arbiters().iterator();n.hasNext();){var i=n.next();if(i.isCollisionArbiter()){var r=i.totalImpulse().get_length();t<r&&(t=r)}}return t},Na.getHighestImpulseFromAllArbiters=function(e){if(null==e.get_space())return 0;if(e.get_isSleeping())return 0;for(var t=0,n=e.get_arbiters().iterator();n.hasNext();){var i=n.next().totalImpulse().get_length();t<i&&(t=i)}return t};var Pa=function(e,t,n){this.name="",this.display_object=e,this.is_dynamic=t,this.name=n};(n["bikas.partitiontree.PartitionObjectDescription"]=Pa).__name__=["bikas","partitiontree","PartitionObjectDescription"],Pa.create=function(e,t,n){if(null==n&&(n=""),0<Pa.destroyed_description_list.length){var i=Pa.destroyed_description_list.pop();return i.display_object=e,i.is_dynamic=t,i.name=n,i}return new Pa(e,t,n)},Pa.destroy=function(e){e.display_object=null,Hr.validate_reusable_objects&&-1!=Pa.destroyed_description_list.indexOf(e)?xl.trace("warning: object is already added to destroyed list",{fileName:"PartitionTreeData.hx",lineNumber:33,className:"bikas.partitiontree.PartitionObjectDescription",methodName:"destroy"}):Pa.destroyed_description_list.push(e)},Pa.prototype={display_object:null,is_dynamic:null,name:null,__class__:Pa};var Ma=function(){this.in_trees=[],this.name=""};(n["bikas.partitiontree.PartitionObject"]=Ma).__name__=["bikas","partitiontree","PartitionObject"],Ma.prototype={name:null,in_trees:null,container:null,added:null,display_object:null,index:null,bounds:null,rect:null,is_dynamic:null,__class__:Ma};var Ia=function(){this.added=[],this.all=[]};(n["bikas.partitiontree.PartitionContainer"]=Ia).__name__=["bikas","partitiontree","PartitionContainer"],Ia.prototype={container:null,all:null,added:null,__class__:Ia};var Aa=function(){this.objects=null,this.sub_trees=null};(n["bikas.partitiontree.PartitionTree"]=Aa).__name__=["bikas","partitiontree","PartitionTree"],Aa.prototype={bounds:null,sub_trees:null,objects:null,__class__:Aa};var Ta=n["bikas.partitiontree.PartitionType"]={__ename__:["bikas","partitiontree","PartitionType"],__constructs__:["QuadTree","HorizontalBinaryTree"]};Ta.QuadTree=["QuadTree",0],Ta.QuadTree.toString=i,(Ta.QuadTree.__enum__=Ta).HorizontalBinaryTree=["HorizontalBinaryTree",1],Ta.HorizontalBinaryTree.toString=i,(Ta.HorizontalBinaryTree.__enum__=Ta).__empty_constructs__=[Ta.QuadTree,Ta.HorizontalBinaryTree];var Da=function(){this.added=[],this.dynamic_objects=[],this.all_objects=[],this.all_containers=null};(n["bikas.partitiontree.PartitionTop"]=Da).__name__=["bikas","partitiontree","PartitionTop"],Da.prototype={type:null,all_containers:null,all_objects:null,dynamic_objects:null,added:null,tree:null,__class__:Da};var Ea=function(){};(n["bikas.partitiontree.PartitionTreeDo"]=Ea).__name__=["bikas","partitiontree","PartitionTreeDo"],Ea.createPartitionContainer=function(e,t){var n=0,i=new Ia;i.container=e;for(var r=0;r<t.length;){var a=t[r];++r,i.all.push(Ea.createPartitionObject(i,n,a,null)),++n}return i},Ea.createPartitionObject=function(e,t,n,i){var r,a=n.display_object;null==i&&((i=a.getLocalBounds()).x*=a.scale.x,i.y*=a.scale.y,i.width*=a.scale.x,i.height*=a.scale.y),0<Ea.destroyed_partition_objects.length?r=Ea.destroyed_partition_objects.pop():((r=new Ma).rect=new Kr,r.bounds=new Qr),r.name=n.name,r.in_trees=[],r.container=e,r.added=!1,r.display_object=a,r.index=t,r.is_dynamic=n.is_dynamic,r.rect.x=i.x,r.rect.y=i.y,r.rect.width=i.width,r.rect.height=i.height;var s=r.rect;if(n.is_dynamic){var l=pa.max(Math.abs(s.x),Math.abs(s.width)),o=pa.max(Math.abs(s.y),Math.abs(s.height)),_=Math.sqrt(l*l+o*o);s.x=-_,s.y=-_,s.width=2*_,s.height=2*_,r.bounds.min_x=a.x+s.x,r.bounds.min_y=a.y+s.y,r.bounds.max_x=r.bounds.min_x+s.width,r.bounds.max_y=r.bounds.min_y+s.height}else ha.setBoundsFromRotatedBounds(r.bounds,s.x,s.y,s.x+s.width,s.y+s.height,a.rotation),ha.moveBounds(r.bounds,a.x,a.y);return null!=a.parent&&xl.trace("warning: object is already added somewhere, width:"+a.width+",height:"+a.height,{fileName:"PartitionTreeDo.hx",lineNumber:119,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartitionObject"}),r},Ea.insertNewObjectToLiveTree=function(e,t,n,i,r,a){null==a&&(a=-1);var s=Pa.create(n,i),l=Ea.createPartitionObject(t,a,s,r);Pa.destroy(s),s=null;var o=!1;if(0<=a)for(var _=0,p=0,u=t.all;p<u.length;){var h=u[p];if(++p,a==h.index){t.all.splice(_,0,l),o=!0;for(var c=_+1,d=t.all.length;c<d;){var m=c++;t.all[m].index++}break}++_}return o||(l.index=t.all[t.all.length-1].index+1,t.all.push(l)),-1==e.all_objects.indexOf(l)&&e.all_objects.push(l),i&&e.dynamic_objects.push(l),Ea.addObjectToTree(e.tree,l),l},Ea.destroyLiveObject=function(e,t,n){for(var i=0,r=t.in_trees;i<r.length;){var a=r[i];++i,s.remove(a.objects,t)}-1!=e.added.indexOf(t)&&s.remove(e.added,t),t.is_dynamic&&-1!=e.dynamic_objects.indexOf(t)&&s.remove(e.dynamic_objects,t),-1!=e.all_objects.indexOf(t)&&s.remove(e.all_objects,t),s.remove(t.container.all,t),-1!=t.container.added.indexOf(t)&&s.remove(t.container.added,t),n&&t.display_object.destroy(!0),Ea.destroyPartitionObject(t)},Ea.createPartition=function(e,t,n,i,r){null==r&&(r=0),null==i&&(i=0),null==n&&(n=512);var a=new Da;a.type=t,a.all_containers=e;for(var s=new Qr,l=0;l<e.length;){var o=e[l];++l;for(var _=0,u=o.all;_<u.length;){var h=u[_];++_;var c=h.bounds;c.min_x<s.min_x&&(s.min_x=c.min_x),c.min_y<s.min_y&&(s.min_y=c.min_y),c.max_x>s.max_x&&(s.max_x=c.max_x),c.max_y>s.max_y&&(s.max_y=c.max_y),h.is_dynamic&&a.dynamic_objects.push(h),a.all_objects.push(h)}}s.min_x-=i,s.max_x+=i,s.min_y-=r,s.max_y+=r,s.min_x==s.max_x&&(xl.trace("warning: total_bounds.min_x == total_bounds.max_x == "+s.min_x,{fileName:"PartitionTreeDo.hx",lineNumber:267,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"}),s.min_x-=10),s.min_y==s.max_y&&(s.min_y-=10,xl.trace("warning: total_bounds.min_y == total_bounds.max_y == "+s.min_y,{fileName:"PartitionTreeDo.hx",lineNumber:272,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"}));var d=s.max_x-s.min_x,m=Math.ceil(pa.logFloat(d/n,2));if(!isFinite(s.max_x)||!isFinite(s.max_y))return xl.trace("warning: bounds are "+p.string(s),{fileName:"PartitionTreeDo.hx",lineNumber:280,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"}),null;a.type==Ta.QuadTree?a.tree=Ea.createQuadTree(n,m,s.min_x,s.min_y):a.type==Ta.HorizontalBinaryTree?a.tree=Ea.createHorizontalBinaryTree(n,m,s.min_x,s.min_y,s.max_y):xl.trace("warning: unhandled type "+p.string(a.type),{fileName:"PartitionTreeDo.hx",lineNumber:291,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"});for(var f=0;f<e.length;){var g=e[f];++f;for(var v=0,b=g.all;v<b.length;){var y=b[v];++v,Ea.addObjectToTree(a.tree,y)}}var x=0,z=0,w=0,k=1/0,S=0,C=null;return(C=function(e){if(w+=1,null!=e.sub_trees)for(var t=0,n=e.sub_trees;t<n.length;){var i=n[t];++t,C(i)}else{var r=e.objects.length;r<k&&(k=r),S<r&&(S=r),x+=r,z+=1}})(a.tree),xl.trace("trees:"+w+", objects(can be duplicate):"+x+" (min:"+k+",max:"+S+",avg:"+Math.round(x/z)+")",{fileName:"PartitionTreeDo.hx",lineNumber:333,className:"bikas.partitiontree.PartitionTreeDo",methodName:"createPartition"}),a},Ea.destroyPartitionObject=function(e){null!=e.display_object.parent&&e.display_object.parent.removeChild(e.display_object),e.in_trees=null,e.container=null,e.display_object=null,e.added=!1,Ea.destroyed_partition_objects.push(e)},Ea.destroy=function(e){for(var t=0,n=e.all_objects;t<n.length;){var i=n[t];++t,Ea.destroyPartitionObject(i)}Ea.destroyTree(e.tree);for(var r=0,a=e.all_containers;r<a.length;){var s=a[r];++r,s.container=null,s.added=null,s.all=null}e.all_containers=null,e.all_objects=null,e.dynamic_objects=null,e.added=null,e.tree=null},Ea.destroyTree=function(e){if(null!=e.sub_trees)for(var t=0,n=e.sub_trees;t<n.length;){var i=n[t];++t,Ea.destroyTree(i)}e.bounds=null,e.objects=null,e.sub_trees=null},Ea.createQuadTree=function(e,t,n,i){var r=new Aa,a=e*Math.pow(2,t);r.bounds=new Qr(n,i,n+a,i+a);for(var s=0,l=5-t;s<l;)s++;var o=t-1,_=e*Math.pow(2,o);return 0<=o?(r.sub_trees=[],r.sub_trees.push(Ea.createQuadTree(e,o,n,i)),r.sub_trees.push(Ea.createQuadTree(e,o,n+_,i)),r.sub_trees.push(Ea.createQuadTree(e,o,n,i+_)),r.sub_trees.push(Ea.createQuadTree(e,o,n+_,i+_))):r.objects=[],r},Ea.createHorizontalBinaryTree=function(e,t,n,i,r){var a=new Aa,s=e*Math.pow(2,t);a.bounds=new Qr(n,i,n+s,r);for(var l=0,o=5-t;l<o;)l++;var _=t-1,p=e*Math.pow(2,_);return 0<=_?(a.sub_trees=[],a.sub_trees.push(Ea.createHorizontalBinaryTree(e,_,n,i,r)),a.sub_trees.push(Ea.createHorizontalBinaryTree(e,_,n+p,i,r))):a.objects=[],a},Ea.addObjectToTree=function(e,t){if(Ea.boundsIntersectOrContain(t.bounds,e.bounds))if(Da.debug_dynamic_checks++,null!=e.sub_trees)for(var n=0,i=e.sub_trees;n<i.length;){var r=i[n];++n,Ea.addObjectToTree(r,t)}else-1==t.in_trees.indexOf(e)&&(e.objects.push(t),t.in_trees.push(e))},Ea.boundsIntersectOrContain=function(e,t){return!(e.min_x>t.max_x||e.max_x<t.min_x||e.min_y>t.max_y||e.max_y<t.min_y)},Ea.update=function(e,t){var n=0;Da.debug_on&&(n=ka.getTimer());for(var i=e.tree,r=Da.debug_dynamic_checks=0,a=e.dynamic_objects;r<a.length;){var l=a[r];++r,Da.debug_dynamic_checks++;var o=l.rect,_=l.display_object.x+o.x,p=l.display_object.y+o.y,u=_+o.width,h=p+o.height,c=l.bounds;if(c.min_x!=_||c.min_y!=p||c.max_x!=u||c.max_y!=h){c.min_x=_,c.min_y=p,c.max_x=u,c.max_y=h;for(var d=0;d<l.in_trees.length;){var m=l.in_trees[d];Ea.boundsIntersectOrContain(l.bounds,m.bounds)||(Da.debug_dynamic_checks++,s.remove(m.objects,l),s.remove(l.in_trees,m),--d),++d}Ea.addObjectToTree(i,l)}}for(var f=0,g=e.added.length;f<g;){var v=e.added[f];Ea.boundsIntersectOrContain(v.bounds,t)||(s.remove(v.container.added,v),v.container.container.remove(v.display_object),s.remove(e.added,v),v.added=!1,--f,--g),++f}Da.debug_add_checks=0,Da.debug_index_checks=0,Ea.updateTree(e,i,t),Da.debug_total_objects=e.added.length,Da.debug_on&&(Da.debug_tree_update_ms=ka.getTimer()-n)},Ea.updateTree=function(e,t,n){if(Ea.boundsIntersectOrContain(t.bounds,n))if(Da.debug_add_checks++,null!=t.sub_trees)for(var i=0,r=t.sub_trees;i<r.length;){var a=r[i];++i,Ea.updateTree(e,a,n)}else for(var s=0,l=t.objects;s<l.length;){var o=l[s];if(++s,Da.debug_add_checks++,!(o.bounds.min_x>n.max_x||o.bounds.max_x<n.min_x||o.bounds.min_y>n.max_y||o.bounds.max_y<n.min_y||o.added)){for(var _=o.container,p=o.container.container.children.length,u=_.added.length,h=0,c=_.added;h<c.length;){var d=c[h];if(++h,Da.debug_index_checks++,o.index<d.index){-1==_.container.children.indexOf(d.display_object)?xl.trace("warning: added.display_object is not added to container, but should be",{fileName:"PartitionTreeDo.hx",lineNumber:592,className:"bikas.partitiontree.PartitionTreeDo",methodName:"updateTree"}):(p=_.container.getChildIndex(d.display_object),u=_.added.indexOf(d));break}}_.container.addAt(o.display_object,p),_.added.splice(u,0,o),e.added.push(o),o.added=!0}}};var Oa=n["bikas.phaser.PolygonTextureType"]={__ename__:["bikas","phaser","PolygonTextureType"],__constructs__:["Tiles","SingleTile","PatternFill"]};Oa.Tiles=["Tiles",0],Oa.Tiles.toString=i,(Oa.Tiles.__enum__=Oa).SingleTile=["SingleTile",1],Oa.SingleTile.toString=i,(Oa.SingleTile.__enum__=Oa).PatternFill=["PatternFill",2],Oa.PatternFill.toString=i,(Oa.PatternFill.__enum__=Oa).__empty_constructs__=[Oa.Tiles,Oa.SingleTile,Oa.PatternFill];var Ba=function(){this.sol=null,this.draw_area_bounds_cache=new Qr,this.line_offset_y=0,this.line_max_placement_angle=2*Math.PI,this.real_time_graphics=null,this.line_group=null,this.line_texture=null,this.single_tile=null,this.tiles=null};(n["bikas.phaser.PolygonTextureData"]=Ba).__name__=["bikas","phaser","PolygonTextureData"],Ba.prototype={type:null,tiles:null,single_tile:null,single_tile_width:null,single_tile_height:null,line_texture:null,line_group:null,mask_graphics:null,real_time_graphics:null,is_background_ground:null,temp_sprite_for_pattern:null,pattern_hack:null,points:null,line_max_placement_angle:null,line_offset_y:null,polygon_bounds:null,draw_area_bounds_cache:null,sol:null,__class__:Ba};var La=function(){this.graphics=[],this.bounds=[],this.sprites=[]};(n["bikas.phaser.SpritesOnLines"]=La).__name__=["bikas","phaser","SpritesOnLines"],La.prototype={sprites:null,bounds:null,graphics:null,__class__:La};var ja=function(){};(n["bikas.phaser.PolygonTextureDrawDo"]=ja).__name__=["bikas","phaser","PolygonTextureDrawDo"],ja.createPolygonTextureDataUsingTiles=function(e,t,n){var i=new Ba;i.type=Oa.Tiles,i.mask_graphics=n,i.points=e,i.tiles=t,i.tiles.mask=i.mask_graphics,i.polygon_bounds=Ka.getPolygonBounds(e);var r=i.tiles.texture.width;n.x=e[0].x-e[0].x%r,n.y=e[0].y-e[0].y%r;var a=n.x,s=n.y;n.beginFill(5713423,1),n.moveTo(e[0].x-a,e[0].y-s);for(var l=0;l<e.length;){var o=e[l];++l,n.lineTo(o.x-a,o.y-s)}return n.endFill(),i.tiles.visible=!1,i},ja.createPolygonTextureDataUsingSingleTile=function(e,t,n,i,r){var a=new Ba;a.type=Oa.SingleTile,a.mask_graphics=r,a.points=e,a.single_tile=t,a.single_tile.mask=a.mask_graphics,a.single_tile_width=n,a.single_tile_height=i,a.polygon_bounds=Ka.getPolygonBounds(e);var s=512;null!=a.single_tile&&(s=a.single_tile.texture.width),r.x=e[0].x-e[0].x%s,r.y=e[0].y-e[0].y%s;var l=r.x,o=r.y;r.beginFill(5713423,1),r.moveTo(e[0].x-l,e[0].y-o);for(var _=0;_<e.length;){var p=e[_];++_,r.lineTo(p.x-l,p.y-o)}return r.endFill(),null!=a.single_tile&&(a.single_tile.visible=!1),a},ja.createPolygonTextureDataUsingPatternFill=function(e,t,n,i){var r=new Ba;r.type=Oa.PatternFill,r.real_time_graphics=e,r.is_background_ground=i,r.points=t,r.polygon_bounds=Ka.getPolygonBounds(t);var a=e;return r.pattern_hack=a.pattern_hack={},r.pattern_hack.points=[],r.pattern_hack.pattern=n,r},ja.drawPolygonToCanvasContext=function(e,t,n,i){t.beginPath(),t.moveTo(e[0].x+n,e[0].y+i);for(var r=0;r<e.length;){var a=e[r];++r,t.lineTo(a.x+n,a.y+i)}t.closePath(),t.fill()},ja.destroy=function(e){if(null!=e.sol)for(var t=0,n=e.sol.sprites;t<n.length;){var i=n[t];++t,e.line_group.remove(i),i.texture.destroy(!1),i.destroy(!0)}null!=e.line_group&&e.line_group.destroy(!0),null!=e.tiles&&(e.tiles.mask=null,e.tiles.destroy()),null!=e.single_tile&&(e.single_tile.mask=null,e.single_tile.destroy(!0)),null!=e.mask_graphics&&(e.mask_graphics.clear(),e.mask_graphics.destroy(!0)),null!=e.temp_sprite_for_pattern&&(null!=e.temp_sprite_for_pattern.parent&&e.temp_sprite_for_pattern.parent.removeChild(e.temp_sprite_for_pattern),e.temp_sprite_for_pattern.destroy(!0)),null!=e.real_time_graphics&&(null!=e.real_time_graphics.parent&&e.real_time_graphics.parent.removeChild(e.real_time_graphics),e.real_time_graphics.pattern_hack=null,e.real_time_graphics.destroy(!0),e.real_time_graphics=null),null!=e.pattern_hack&&(e.pattern_hack.points=null,e.pattern_hack.pattern=null,e.pattern_hack=null),e.sol=null,e.tiles=null,e.line_texture=null,e.points=null},ja.resetBoundsCache=function(e){e.draw_area_bounds_cache.min_x=0,e.draw_area_bounds_cache.min_y=0,e.draw_area_bounds_cache.max_x=0,e.draw_area_bounds_cache.max_y=0},ja.createAndPushSpritesOnSingleLine=function(e,t,n,i,r,a,s){null==s&&(s=0);for(var l=r.x-i.x,o=r.y-i.y,_=Math.round(Math.sqrt(l*l+o*o)),p=Math.atan2(o,l),u=p-Math.PI/2,h=0,c=0,d=n.width;h<_;){_<(c+=Math.round(n.width)-a)&&(c=_);var m=Math.cos(p)*h,f=Math.sin(p)*h;m+=Math.cos(u)*s,f+=Math.sin(u)*s;var g=new PIXI.Texture(t,new PIXI.Rectangle(n.x+a,n.y,c-h,n.height)),v=Ra.createSprite(g,0,0,i.x+m,i.y+f);d=c-h+a,a=0,v.rotation=p,e.push(v),h=c}return d},ja.createSpritesOnPolygon=function(e,t,n,i){null==i&&(i=0),null==n&&(n=1.047);for(var r=t.baseTexture,a=t.frame,s=0,l=[],o=0,_=e.length;o<_;){var p,u,h=o++;u=0==h?(p=e[e.length-1],e[0]):(p=e[h-1],e[h]),s=Math.abs(pa.getAngleBetweenPoints(p,u))<n?ja.createAndPushSpritesOnSingleLine(l,r,a,p,u,s,i):0}return l},ja.createSol=function(e){var t=ja.createSpritesOnPolygon(e.points,e.line_texture,e.line_max_placement_angle,e.line_offset_y),n=new La;n.sprites=t;for(var i=0,r=n.sprites;i<r.length;){var a=r[i];++i;var s=a.getLocalBounds(),l=new Qr;ha.setBoundsFromRotatedBounds(l,s.x,s.y,s.x+s.width,s.y+s.height,a.rotation),ha.moveBounds(l,a.x,a.y),n.bounds.push(l),e.line_group.add(a)}return n},ja.setVisibility=function(e,t){null!=e.tiles&&e.tiles.visible!=t&&(e.tiles.visible=t),null!=e.single_tile&&e.single_tile.visible!=t&&(e.single_tile.visible=t),null!=e.line_group&&e.line_group.visible!=t&&(e.line_group.visible=t)},ja.draw=function(e,t,n,i){var r=pa.copyBounds(t);if(ha.roundBounds(r),!pa.boundsEqual(r,e.draw_area_bounds_cache)){var a=e.points;if(e.mask_graphics,ha.setBounds(e.draw_area_bounds_cache,r),!(a.length<3))if(pa.boundsIntersectOrContain(r,e.polygon_bounds)){var s;if(ja.setVisibility(e,!0),e.type==Oa.PatternFill&&null!=e.pattern_hack.points)for(var l=e.pattern_hack.points,o=0;o<l.length;){var _=l[o];++o,Yr.destroy(_)}if(i){var p=$a.clip(a,Math.round(r.min_y-1),Math.round(r.max_x+1),Math.round(r.max_y+1),Math.round(r.min_x-1));if(null==p)return void ja.setVisibility(e,!1);s=[p]}else s=Ja.cutPolygonByRectangle(a,r.min_x-1,r.max_x+1,r.min_y-1,r.max_y+1,1,0,3,2);e.type!=Oa.PatternFill?(null!=e.tiles&&(e.tiles.position.x=r.min_x,e.tiles.position.y=r.min_y,e.tiles.tilePosition.x=-r.min_x,e.tiles.tilePosition.y=-r.min_y),null!=e.single_tile&&(e.single_tile.position.x=r.min_x,e.single_tile.position.y=r.min_y,e.single_tile.width=1024,e.single_tile.height=1024)):e.pattern_hack.points=s}else ja.setVisibility(e,!1)}};var Fa=function(){};(n["bikas.pixi.GraphicsDo"]=Fa).__name__=["bikas","pixi","GraphicsDo"],Fa.drawRectangle=function(e,t,n,i,r,a,s,l){return null==l&&(l=1),null==s&&(s=16777215),null==a&&(a=!1),null==r&&(r=1),null==i&&(i=16711680),null==n&&(n=1),a&&e.beginFill(s),e.lineStyle(n,i,r),e.moveTo(t.x,t.y),e.lineTo(t.x+t.width,t.y),e.lineTo(t.x+t.width,t.y+t.height),e.lineTo(t.x,t.y+t.height),e.lineTo(t.x,t.y),a&&e.endFill(),e},Fa.drawCircle=function(e,t,n,i,r,a,s,l){return null==l&&(l=1),null==s&&(s=16777215),null==a&&(a=!1),null==r&&(r=1),null==i&&(i=16711680),null==n&&(n=1),a&&e.beginFill(s),e.lineStyle(n,i,r),e.drawCircle(0,0,t),a&&e.endFill(),e},Fa.drawBounds=function(e,t,n,i,r,a,s,l){return null==l&&(l=1),null==s&&(s=16777215),null==a&&(a=!1),null==r&&(r=1),null==i&&(i=16711680),null==n&&(n=1),a&&e.beginFill(s),e.lineStyle(n,i,r),e.moveTo(t.min_x,t.min_y),e.lineTo(t.max_x,t.min_y),e.lineTo(t.max_x,t.max_y),e.lineTo(t.min_x,t.max_y),e.lineTo(t.min_x,t.min_y),a&&e.endFill(),e},Fa.drawMarker=function(e,t,n,i,r){null==r&&(r=10),null==i&&(i=16711680);var a=r/2;return e.lineStyle(1,i,1),e.moveTo(-a,-a),e.lineTo(a,a),e.moveTo(a,-a),e.lineTo(-a,a),e.position.set(t,n),e},Fa.drawCross=function(e,t,n,i,r){null==r&&(r=1),null==i&&(i=1),null==n&&(n=0),null==t&&(t=10),e.lineStyle(i,n,r),e.moveTo(0,-t/2),e.lineTo(0,t/2),e.moveTo(-t/2,0),e.lineTo(t/2,0)};var Ra=function(){};(n["bikas.pixi.PixiDo"]=Ra).__name__=["bikas","pixi","PixiDo"],Ra.pickSpriteFromPool=function(e,t,n,i,r){if(0<us.destroyed_sprite_list.length){var a=us.destroyed_sprite_list.pop();return null==e?a.texture=null:(a.texture,a.setTexture(e)),a.setTransform(i,r,1,1,0,0,0,0,0),a.mask=null,a.anchor.x=t,a.anchor.y=n,a.rotation=0,a.tint=16777215,a.renderable=!0,a.visible=!0,a.alpha=1,a}var s=new us(Xs.game,i,r,e,0);return s.anchor.x=t,s.anchor.y=n,s},Ra.createSpriteByName=function(e,t,n,i,r){null==r&&(r=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0);var a=Zs.retrieveAsset(e);return null==a&&(xl.trace("-------------------------",{fileName:"PixiDo.hx",lineNumber:115,className:"bikas.pixi.PixiDo",methodName:"createSpriteByName"}),xl.trace("warning: texture == null ("+e+")",{fileName:"PixiDo.hx",lineNumber:116,className:"bikas.pixi.PixiDo",methodName:"createSpriteByName"}),xl.trace("-------------------------",{fileName:"PixiDo.hx",lineNumber:117,className:"bikas.pixi.PixiDo",methodName:"createSpriteByName"})),Ra.pickSpriteFromPool(a,t,n,i,r)},Ra.createSprite=function(e,t,n,i,r){return null==r&&(r=0),null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(xl.trace("-------------------------",{fileName:"PixiDo.hx",lineNumber:127,className:"bikas.pixi.PixiDo",methodName:"createSprite"}),xl.trace("warning: texture == null",{fileName:"PixiDo.hx",lineNumber:128,className:"bikas.pixi.PixiDo",methodName:"createSprite"}),xl.trace("-------------------------",{fileName:"PixiDo.hx",lineNumber:129,className:"bikas.pixi.PixiDo",methodName:"createSprite"})),Ra.pickSpriteFromPool(e,t,n,i,r)},Ra.createEmptySprite=function(){return Ra.pickSpriteFromPool(null,0,0,0,0)},Ra.createGraphics=function(e,t){return null==t&&(t=0),null==e&&(e=0),new ls(Xs.game,e,t)},Ra.collectSpritesWithNoTexture=function(e,t){for(var n=0,i=e.children;n<i.length;){var r=i[n];if(++n,p.is(r,us)){var a=eo.__cast(r,us);null==a.texture&&t.push(a)}else if(p.is(r,PIXI.Container)){var s=Ra.collectSpritesWithNoTexture(r,t);t=t.concat(s)}}return t},Ra.createBitmapText=function(e,t,n,i,r,a,s,l){null==l&&(l=0),null==s&&(s=0),null==a&&(a=0),null==r&&(r=0),null==i&&(i=""),null==n&&(n="left");var o=new ps(Xs.game,0,0,e,i,t,n);return o.anchor.set(r,a),o.position.set(s,l),o},Ra.createAndAddButton=function(e,t,n,i,r,a,s,l){null==s&&(s=0),null==a&&(a=0),null==r&&(r=0);var o=new us(null,0,0,t);return o.interactive=!0,null!=l&&(o.pointerdown=function(e){l()}),o.anchor.set(n,i),o.position.set(r,a),o.rotation=s,e.add(o),o},Ra.pickGroupFromPool=function(){if(0<hs.destroyed_group_list.length){var e=hs.destroyed_group_list.pop();return e.mask=null,e.position.x=0,e.position.y=0,e.scale.x=1,e.scale.y=1,e.skew.x=0,e.skew.y=0,e.rotation=0,e.renderable=!0,e.visible=!0,e.alpha=1,e}return new hs(Xs.game)},Ra.createGroup=function(){return Ra.pickGroupFromPool()},Ra.convertRectangle=function(e){return new Kr(e.x,e.y,e.width,e.height)},Ra.convertRectangleTo=function(e){return new PIXI.Rectangle(e.x,e.y,e.width,e.height)},Ra.convertRectangleToPixi=function(e){return new PIXI.Rectangle(e.x,e.y,e.width,e.height)},Ra.convertPoint=function(e){return new Yr(e.x,e.y)},Ra.isSprite=function(e){return!!p.is(e,us)},Ra.castSprite=function(e){return eo.__cast(e,us)},Ra.isPointInsideContainer=function(e,t){return p.is(t,us),pa.pointInRectangle(e,Ra.getContainerBounds(t))},Ra.toGlobal=function(e,t,n){null!=e.parent&&e.parent!=Xs.game&&(null!=n&&(n.x*=e.scale.x,n.y*=e.scale.y),t.x=t.x*e.scale.x+e.x,t.y=t.y*e.scale.y+e.y,Ra.toGlobal(e.parent,t,n))},Ra.toLocal=function(e,t,n){for(var i=e,r=[];null!=i&&i!=Xs.game;)r.unshift(i),i=i.parent;for(var a=0;a<r.length;){var s=r[a];++a,null!=n&&(n.x/=s.scale.x,n.y/=s.scale.y),t.x=t.x/s.scale.x-s.x,t.y=t.y/s.scale.y-s.y}},Ra.getContainerBounds=function(e){var t=Ra.convertRectangle(e.getLocalBounds()),n=new PIXI.Point(t.x,t.y),i=new PIXI.Point(t.x+t.width,t.y+t.height);Ra.toGlobal(e,n),Ra.toGlobal(e,i);var r=n.x,a=n.y,s=i.x,l=i.y;return i.x<n.x&&(r=i.x,s=n.x),i.y<n.y&&(a=i.y,l=n.y),t=new Kr(r,a,s-r,l-a),Xs.container,t},Ra.getLocalContainerBounds=function(e){for(var t=Ra.convertRectangle(e.getLocalBounds()),n=e;null!=n.parent;)n=n.parent;return n!=e&&(t.x*=n.scale.x,t.y*=n.scale.y,t.width*=n.scale.x,t.height*=n.scale.y),t},Ra.createGraphicsRectangle=function(e,t,n,i){null==i&&(i=16777215),null==n&&(n=!1),null==t&&(t=16711680);var r=new ls(Xs.game);return r.position.set(e.x,e.y),n&&r.beginFill(i),r.lineStyle(2,t,1),r.moveTo(0,0),r.lineTo(e.width,0),r.lineTo(e.width,e.height),r.lineTo(0,e.height),r.lineTo(0,0),n&&r.endFill(),r.cacheAsBitmap=!0,r},Ra.findOrCreatePointerObject=function(e,t){for(var n=0,i=e.pointer_objects;n<i.length;){var r=i[n];if(++n,r.id==t)return r}var a=new Xa(t);return e.pointer_objects.push(a),e.main_pointer_object=e.pointer_objects[0],a},Ra.updatePointerPosition=function(e,t,n,i){isNaN(n)||isNaN(i)||(t.current.x=n/e.window_scale,t.current.y=i/e.window_scale)},Ra.pointerDown=function(e,t,n,i,r){var a=Ra.findOrCreatePointerObject(t,n);Ra.updatePointerPosition(e,a,i,r),ha.setPoint(a.downed,a.current),a.state=qa.DOWNED},Ra.pointerUp=function(e,t,n,i,r){var a=Ra.findOrCreatePointerObject(t,n);if(a.state==qa.IS_UP)return a.is_leave=!0,a.current.x=-9999,a.current.y=-9999,a.state=qa.IS_UP,void ha.setPoint(a.upped,a.current);Ra.updatePointerPosition(e,a,i,r),ha.setPoint(a.upped,a.current);var s=Math.abs(a.upped.x-a.downed.x),l=Math.abs(a.upped.y-a.downed.y);a.state==qa.DOWNED||a.state==qa.IS_DOWN&&s<=Wa.CLICK_EVENT_DISTANCE&&l<=Wa.CLICK_EVENT_DISTANCE?a.cancel_upped_and_clicked?a.state=qa.IS_UP:a.state=qa.CLICKED:a.cancel_upped_and_clicked?a.state=qa.IS_UP:a.state=qa.UPPED},Ra.addPointerEvents=function(e,t,n){e.pointermove=function(i){if(3!=i.data.originalEvent.which){var r=Ra.findOrCreatePointerObject(t,i.data.identifier),a=i.data.global.x,s=i.data.global.y;e.hitArea.contains(a/n.window_scale,s/n.window_scale)&&Ra.updatePointerPosition(n,r,a,s)}},e.pointerdown=function(i){if(3!=i.data.originalEvent.which){to.get_window().focus();var r=i.data.global.x,a=i.data.global.y;e.hitArea.contains(r/n.window_scale,a/n.window_scale)&&(i.data.originalEvent.preventDefault(),Ra.pointerDown(n,t,i.data.identifier,r,a))}else Xs.right_mouse_button_down=!0},e.pointerup=function(e){if(3!=e.data.originalEvent.which){var i=e.data.global.x,r=e.data.global.y;Ra.pointerUp(n,t,e.data.identifier,i,r)}else Xs.right_mouse_button_down=!1},e.pointerout=yc(e,e.pointerup),e.pointerupoutside=yc(e,e.pointerup)},Ra.updatePointer=function(e){for(var t=0,n=e.pointer_objects;t<n.length;){var i=n[t];++t,i.state==qa.DOWNED?i.state=qa.IS_DOWN:i.state==qa.CLICKED?i.cancel_upped_and_clicked?i.state=qa.IS_UP:i.state=qa.UPPED:i.state==qa.UPPED?i.state=qa.IS_UP:i.state==qa.IS_UP&&(i.cancel_upped_and_clicked=!1),i.is_leave&&(i.is_leave=!1)}};var Ga=n["bikas.pixi.InterpolationType"]={__ename__:["bikas","pixi","InterpolationType"],__constructs__:["Linear","SmoothStart","SmoothEnd","SmoothStartEnd","Random","RandomNearStartEnd"]};Ga.Linear=["Linear",0],Ga.Linear.toString=i,(Ga.Linear.__enum__=Ga).SmoothStart=["SmoothStart",1],Ga.SmoothStart.toString=i,(Ga.SmoothStart.__enum__=Ga).SmoothEnd=["SmoothEnd",2],Ga.SmoothEnd.toString=i,(Ga.SmoothEnd.__enum__=Ga).SmoothStartEnd=["SmoothStartEnd",3],Ga.SmoothStartEnd.toString=i,(Ga.SmoothStartEnd.__enum__=Ga).Random=["Random",4],Ga.Random.toString=i,(Ga.Random.__enum__=Ga).RandomNearStartEnd=["RandomNearStartEnd",5],Ga.RandomNearStartEnd.toString=i,(Ga.RandomNearStartEnd.__enum__=Ga).__empty_constructs__=[Ga.Linear,Ga.SmoothStart,Ga.SmoothEnd,Ga.SmoothStartEnd,Ga.Random,Ga.RandomNearStartEnd];var Za=function(){this.alpha=null,this.rotation=null,this.scale=null,this.position=null,this.time=0,this.type=null};(n["bikas.pixi.TransitionState"]=Za).__name__=["bikas","pixi","TransitionState"],Za.prototype={type:null,time:null,position:null,scale:null,rotation:null,alpha:null,__class__:Za};var Ua=n["bikas.pixi.TransitionCategoryType"]={__ename__:["bikas","pixi","TransitionCategoryType"],__constructs__:["InGame","Menu"]};Ua.InGame=["InGame",0],Ua.InGame.toString=i,(Ua.InGame.__enum__=Ua).Menu=["Menu",1],Ua.Menu.toString=i,(Ua.Menu.__enum__=Ua).__empty_constructs__=[Ua.InGame,Ua.Menu];var Va=function(){this.on_finish=null,this.finished=!1,this.remove_from_container=!0,this.states=[]};(n["bikas.pixi.Transition"]=Va).__name__=["bikas","pixi","Transition"],Va.prototype={category:null,container:null,states:null,remove_from_container:null,current_time:null,finished:null,on_finish:null,__class__:Va};var qa=n["bikas.pointer.PointerStateType"]={__ename__:["bikas","pointer","PointerStateType"],__constructs__:["DOWNED","IS_DOWN","CLICKED","UPPED","IS_UP"]};qa.DOWNED=["DOWNED",0],qa.DOWNED.toString=i,(qa.DOWNED.__enum__=qa).IS_DOWN=["IS_DOWN",1],qa.IS_DOWN.toString=i,(qa.IS_DOWN.__enum__=qa).CLICKED=["CLICKED",2],qa.CLICKED.toString=i,(qa.CLICKED.__enum__=qa).UPPED=["UPPED",3],qa.UPPED.toString=i,(qa.UPPED.__enum__=qa).IS_UP=["IS_UP",4],qa.IS_UP.toString=i,(qa.IS_UP.__enum__=qa).__empty_constructs__=[qa.DOWNED,qa.IS_DOWN,qa.CLICKED,qa.UPPED,qa.IS_UP];var Wa=function(){this.main_pointer_object=new Xa(""),this.pointer_objects=[]};(n["bikas.pointer.Pointer"]=Wa).__name__=["bikas","pointer","Pointer"],Wa.prototype={pointer_objects:null,main_pointer_object:null,__class__:Wa};var Xa=function(e){this.cancel_upped_and_clicked=!1,this.upped=new Yr(0,0),this.downed=new Yr(0,0),this.current=new Yr(0,0),this.is_leave=!1,this.state=qa.IS_UP,this.id="",this.id=e};(n["bikas.pointer.PointerObject"]=Xa).__name__=["bikas","pointer","PointerObject"],Xa.prototype={id:null,state:null,is_leave:null,current:null,downed:null,upped:null,cancel_upped_and_clicked:null,__class__:Xa};var Ha=function(){};(n["bikas.pointer.PointerDo"]=Ha).__name__=["bikas","pointer","PointerDo"],Ha.isClicked=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,s.state==qa.UPPED){var l=s.downed,o=s.upped,_=pa.distance(l.x,l.y,e,t),p=pa.distance(o.x,o.y,e,t);if(_<=i&&p<=i)return!0}}return!1},Ha.isOver=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];++r;var l=s.current;if(pa.distance(l.x,l.y,e,t)<=i)return!0}return!1},Ha.getClicked=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,s.state==qa.UPPED){var l=s.downed,o=s.upped,_=pa.distance(l.x,l.y,e,t),p=pa.distance(o.x,o.y,e,t);if(_<=i&&p<=i)return s}}return null},Ha.isDowned=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,s.state==qa.DOWNED&&pa.distance(s.current.x,s.current.y,e,t)<=i)return!0}return!1},Ha.isAnyDowned=function(e){for(var t=0,n=e.pointer_objects;t<n.length;){var i=n[t];if(++t,i.state==qa.DOWNED)return!0}return!1},Ha.isDownedInBounds=function(e,t,n,i,r,a,s){for(var l=0,o=n.pointer_objects;l<o.length;){var _=o[l];if(++l,_.state==qa.DOWNED&&pa.pointInBoundedArea(_.current,i,r,a,s))return!0}return!1},Ha.getDowned=function(e,t,n,i){for(var r=0,a=n.pointer_objects;r<a.length;){var s=a[r];if(++r,s.state==qa.DOWNED&&pa.distance(s.current.x,s.current.y,e,t)<=i)return s}return null},Ha.isPointerObjectDowned=function(e,t,n,i){return pa.distance(n.current.x,n.current.y,e,t)<=i},Ha.isPointerObjectDownedRect=function(e,t,n,i,r){return!!pa.positionInRect(e.current.x,e.current.y,t,n,i,r)},Ha.getPointerDowned=function(e){for(var t=0,n=e.pointer_objects;t<n.length;){var i=n[t];if(++t,i.state==qa.DOWNED)return i}return null},Ha.getPointerDown=function(e){for(var t=0,n=e.pointer_objects;t<n.length;){var i=n[t];if(++t,i.state==qa.DOWNED||i.state==qa.IS_DOWN)return i}return null},Ha.getPointerClicked=function(e,t){for(var n=0,i=e.pointer_objects;n<i.length;){var r=i[n];if(++n,r.state==qa.UPPED){var a=r.downed,s=r.upped;if(pa.distanceBetweenPoints(a,s)<=t)return r}}return null};var Ya=e.bikas.poki.PokiWrapperDo=function(){};(n["bikas.poki.PokiWrapperDo"]=Ya).__name__=["bikas","poki","PokiWrapperDo"],Ya.enableAdblockWarning=function(){Ya.show_adblock_warning=!0},Ya.updateAdblockWarning=function(e,t){},Ya.pokiSitelock=function(){},Ya.init=function(e){return"undefined"==typeof PokiSDK?(xl.trace("PokiSDK is undefined",{fileName:"PokiWrapperDo.hx",lineNumber:95,className:"bikas.poki.PokiWrapperDo",methodName:"init"}),!1):(Ya.PokiSDK=PokiSDK,PokiSDK.init().then((function(){})).catch((function(){bikas.poki.PokiWrapperDo.enableAdblockWarning()})),e.release.sitelock_poki_debug_enabled,PokiSDK.setDebug(!1),!0)};var Ja=function(){};(n["bikas.polygon.PolygonCutterByRectangle"]=Ja).__name__=["bikas","polygon","PolygonCutterByRectangle"],Ja.intersectPointX=function(e,t,n){return new Yr(e.x+(n-e.y)/(t.y-e.y)*(t.x-e.x),n)},Ja.intersectPointY=function(e,t,n){return new Yr(n,e.y+(n-e.x)/(t.x-e.x)*(t.y-e.y))},Ja.copyPoint=function(e){return new Yr(e.x,e.y)},Ja.checkIfOutOfBounds=function(e,t,n,i,r){for(var a=1/0,s=-1/0,l=1/0,o=-1/0,_=0,p=e.length;_<p;){var u=_++;e[u].x<a?a=e[u].x:e[u].x>s&&(s=e[u].x),e[u].y<l?l=e[u].y:e[u].y>o&&(o=e[u].y)}return n<a||s<t||i<l||o<r},Ja.transferPoints=function(e,t){for(var n=0,i=e.length;n<i;){var r=n++;t.push(e[r])}},Ja.transferVectorPoints=function(e,t){for(var n=0,i=e.length;n<i;){var r=n++;t.push(e[r])}},Ja.cutPolygonsByLeftX=function(e,t){for(var n,i=[],r=0,a=e.length;r<a;){var s=r++;null!=(n=Ja.cutByLeftX(e[s],t))&&Ja.transferVectorPoints(n,i)}return i},Ja.cutPolygonsByRightX=function(e,t){for(var n,i=[],r=0,a=e.length;r<a;){var s=r++;null!=(n=Ja.cutByRightX(e[s],t))&&Ja.transferVectorPoints(n,i)}return i},Ja.cutPolygonsByTopY=function(e,t){for(var n,i=[],r=0,a=e.length;r<a;){var s=r++;null!=(n=Ja.cutByTopY(e[s],t))&&Ja.transferVectorPoints(n,i)}return i},Ja.cutPolygonsByBottomY=function(e,t){for(var n,i=[],r=0,a=e.length;r<a;){var s=r++;null!=(n=Ja.cutByBottomY(e[s],t))&&Ja.transferVectorPoints(n,i)}return i},Ja.cutByLeftX=function(e,t){if(null==e)return null;if(e.length<3)return null;for(var n,i,r,a,s,l,o,_,p,u,h,c=[],d=e.length,m=null,f=0,g=0,v=d;g<v;){var b=g++;if(r=e[b],a=b<d-1?e[b+1]:e[0],r.x<=t&&a.x>t){(i=[]).push(Ja.intersectPointY(r,a,t)),c.push(i),m=i,f=b;break}}if(null==m){if(e[0].x>t){i=[];for(var y=0,x=d;y<x;){var z=y++;i.push(Ja.copyPoint(e[z]))}return c.push(i),c}return null}for(d<=(n=f+1)&&(n=0);n!=f;)r=e[n],a=n<d-1?e[n+1]:e[0],r.x<=t&&a.x>t?((i=[]).push(Ja.intersectPointY(r,a,t)),c.push(i),m=i):r.x>t&&a.x>t?m.push(r):a.x<=t&&r.x>t&&(m.push(r),m.push(Ja.intersectPointY(r,a,t))),d<=++n&&(n=0);if(1==(d=c.length))return c;for(n=0;n<d;){if((o=(s=c[n])[0].y)<(_=s[s.length-1].y))for((h=n-1)<0&&(h=d-1);h!=n;){if(p=(l=c[h])[0].y,(u=l[l.length-1].y)<=p){if(o<=u&&p<=_){Ja.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(o<=u&&p<=_)break;--h<0&&(h=d-1)}else for((h=n-1)<0&&(h=d-1);h!=n;){if((p=(l=c[h])[0].y)<(u=l[l.length-1].y)){if(p<_&&o<u){Ja.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(p<_&&o<u)break;--h<0&&(h=d-1)}++n}return c},Ja.cutByRightX=function(e,t){if(null==e)return null;if(e.length<3)return null;for(var n,i,r,a,s,l,o,_,p,u,h,c=[],d=e.length,m=null,f=0,g=0,v=d;g<v;){var b=g++;if(r=e[b],a=b<d-1?e[b+1]:e[0],r.x>=t&&a.x<t){(i=[]).push(Ja.intersectPointY(r,a,t)),c.push(i),m=i,f=b;break}}if(null==m){if(e[0].x<t){i=[];for(var y=0,x=d;y<x;){var z=y++;i.push(Ja.copyPoint(e[z]))}return c.push(i),c}return null}for(d<=(n=f+1)&&(n=0);n!=f;)r=e[n],a=n<d-1?e[n+1]:e[0],r.x>=t&&a.x<t?((i=[]).push(Ja.intersectPointY(r,a,t)),c.push(i),m=i):r.x<t&&a.x<t?m.push(r):a.x>=t&&r.x<t&&(m.push(r),m.push(Ja.intersectPointY(r,a,t))),d<=++n&&(n=0);if(1==(d=c.length))return c;for(n=0;n<d;){if((o=(s=c[n])[0].y)<=(_=s[s.length-1].y))for((h=n-1)<0&&(h=d-1);h!=n;){if(p=(l=c[h])[0].y,(u=l[l.length-1].y)<p){if(u<=o&&_<=p){Ja.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(u<=o&&_<=p)break;--h<0&&(h=d-1)}else if(_<o)for((h=n-1)<0&&(h=d-1);h!=n;){if((p=(l=c[h])[0].y)<=(u=l[l.length-1].y)){if(_<=p&&u<=o){Ja.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(_<=p&&u<=o)break;--h<0&&(h=d-1)}++n}return c},Ja.cutByBottomY=function(e,t){if(null==e)return null;if(e.length<3)return null;for(var n,i,r,a,s,l,o,_,p,u,h,c=[],d=e.length,m=null,f=0,g=0,v=d;g<v;){var b=g++;if(r=e[b],a=b<d-1?e[b+1]:e[0],r.y>=t&&a.y<t){(i=[]).push(Ja.intersectPointX(r,a,t)),c.push(i),m=i,f=b;break}}if(null==m){if(e[0].y<t){i=[];for(var y=0,x=d;y<x;){var z=y++;i.push(Ja.copyPoint(e[z]))}return c.push(i),c}return null}for(d<=(n=f+1)&&(n=0);n!=f;)r=e[n],a=n<d-1?e[n+1]:e[0],r.y>=t&&a.y<t?((i=[]).push(Ja.intersectPointX(r,a,t)),c.push(i),m=i):r.y<t&&a.y<t?m.push(r):a.y>=t&&r.y<t&&(m.push(r),m.push(Ja.intersectPointX(r,a,t))),d<=++n&&(n=0);if(1==(d=c.length))return c;for(n=0;n<d;){if((o=(s=c[n])[0].x)<(_=s[s.length-1].x))for((h=n-1)<0&&(h=d-1);h!=n;){if(p=(l=c[h])[0].x,(u=l[l.length-1].x)<=p){if(o<=u&&p<=_){Ja.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(o<=u&&p<=_)break;--h<0&&(h=d-1)}else for((h=n-1)<0&&(h=d-1);h!=n;){if((p=(l=c[h])[0].x)<(u=l[l.length-1].x)){if(p<=_&&o<=u){Ja.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(p<=_&&o<=u)break;--h<0&&(h=d-1)}++n}return c},Ja.cutByTopY=function(e,t){if(null==e)return null;if(e.length<3)return null;for(var n,i,r,a,s,l,o,_,p,u,h,c=[],d=e.length,m=null,f=0,g=0,v=d;g<v;){var b=g++;if(r=e[b],a=b<d-1?e[b+1]:e[0],r.y<=t&&a.y>t){(i=[]).push(Ja.intersectPointX(r,a,t)),c.push(i),m=i,f=b;break}}if(null==m){if(e[0].y>t){i=[];for(var y=0,x=d;y<x;){var z=y++;i.push(Ja.copyPoint(e[z]))}return c.push(i),c}return null}for(d<=(n=f+1)&&(n=0);n!=f;)r=e[n],a=n<d-1?e[n+1]:e[0],r.y<=t&&a.y>t?((i=[]).push(Ja.intersectPointX(r,a,t)),c.push(i),m=i):r.y>t&&a.y>t?m.push(r):a.y<=t&&r.y>t&&(m.push(r),m.push(Ja.intersectPointX(r,a,t))),d<=++n&&(n=0);if(1==(d=c.length))return c;for(n=0;n<d;){if(o=(s=c[n])[0].x,(_=s[s.length-1].x)<o)for((h=n-1)<0&&(h=d-1);h!=n;){if((p=(l=c[h])[0].x)<=(u=l[l.length-1].x)){if(u<=o&&_<p){Ja.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(u<=o&&_<p)break;--h<0&&(h=d-1)}else for((h=n-1)<0&&(h=d-1);h!=n;){if(p=(l=c[h])[0].x,(u=l[l.length-1].x)<p){if(_<=p&&u<=o){Ja.transferPoints(s,l),c.splice(n,1),--n,--d;break}}else if(_<=p&&u<=o)break;--h<0&&(h=d-1)}++n}return c},Ja.cutPolygonByRectangle=function(e,t,n,i,r,a,s,l,o){null==o&&(o=3),null==l&&(l=2),null==s&&(s=1),null==a&&(a=0);var _=[a,s,l,o],p=[];p.push(e);for(var u=0;u<4;)switch(_[u++]){case 0:p=Ja.cutPolygonsByLeftX(p,t);break;case 1:p=Ja.cutPolygonsByRightX(p,n);break;case 2:p=Ja.cutPolygonsByTopY(p,i);break;case 3:p=Ja.cutPolygonsByBottomY(p,r);break;default:xl.trace("warning: unknown cut side",{fileName:"PolygonCutterByRectangle.hx",lineNumber:864,className:"bikas.polygon.PolygonCutterByRectangle",methodName:"cutPolygonByRectangle"})}return p};var Ka=function(){};(n["bikas.polygon.PolygonFunc"]=Ka).__name__=["bikas","polygon","PolygonFunc"],Ka.pointsToVertices=function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n,t.push(i.x),t.push(i.y)}return t},Ka.createSymetricalPolygon=function(e,t,n){for(var i=[],r=0,a=e;r<a;){var s=r++;i.push(new Yr(Math.cos(2*Math.PI*s/e+.017453292519943*n)*t,Math.sin(2*Math.PI*s/e+.017453292519943*n)*t))}return i},Ka.getPolygonBounds=function(e){for(var t=1/0,n=-1/0,i=1/0,r=-1/0,a=0;a<e.length;){var s=e[a];++a,s.x<t&&(t=s.x),s.x>n&&(n=s.x),s.y<i&&(i=s.y),s.y>r&&(r=s.y)}return new Qr(t,i,n,r)},Ka.copyPolygonWithOffset=function(e,t){for(var n=[],i=0;i<e.length;){var r=e[i];++i,n.push(new Yr(r.x+t.x,r.y+t.y))}return n},Ka.copyPolygonWithTransform=function(e,t,n){for(var i=[],r=0;r<e.length;){var a=e[r];++r;var s=new Yr(a.x,a.y);ha.applyTransformToPoint(s,t,n),i.push(s)}return i},Ka.getPolygonArea=function(e){for(var t=0,n=0,i=e.length;n<i;){var r=n++,a=(r+1)%e.length;t+=e[r].x*e[a].y,t-=e[a].x*e[r].y}return t/2},Ka.isPolygonClockwise=function(e){return 0<Ka.getPolygonArea(e)},Ka.getBoundsFromSeveralPolygons=function(e){for(var t=1/0,n=-1/0,i=1/0,r=-1/0,a=0;a<e.length;){var s=e[a];++a;for(var l=0;l<s.length;){var o=s[l];++l,o.x<t&&(t=o.x),o.x>n&&(n=o.x),o.y<i&&(i=o.y),o.y>r&&(r=o.y)}}return new Qr(t,i,n,r)},Ka.pointInPolygon=function(e,t){if(t.length<3)return!1;for(var n=e.x,i=e.y,r=t[t.length-1],a=!1,s=0;s<t.length;){var l=t[s];++s,(l.y<i&&r.y>=i||r.y<i&&l.y>=i)&&(l.x<=n||r.x<=n)&&l.x+(i-l.y)/(r.y-l.y)*(r.x-l.x)<n&&(a=!a),r=l}return a},Ka.boundsIntersectWithPolygon=function(e,t){for(var n=new Yr(e.min_x,e.min_y),i=new Yr(e.max_x,e.min_y),r=new Yr(e.max_x,e.max_y),a=new Yr(e.min_x,e.max_y),s=0,l=t.length;s<l;){var o,_=s++;o=0==_?t[t.length-1]:t[_-1];var p=t[_];if(!(o.x<n.x&&p.x<n.x||o.x>i.x&&p.x>i.x||o.y<n.y&&p.y<n.y||o.y>a.y&&p.y>a.y)){if(pa.lineSegmentsIntersect(n,i,o,p))return!0;if(pa.lineSegmentsIntersect(i,r,o,p))return!0;if(pa.lineSegmentsIntersect(r,a,o,p))return!0;if(pa.lineSegmentsIntersect(a,n,o,p))return!0}}return!1},Ka.getClosestPointToSpecifiedBound=function(e,t,n){var i=Ka.getPolygonBounds(e),r=new Yr;r.y=t?i.min_y:i.max_y,r.x=n?i.min_x:i.max_x;for(var a=1/0,s=null,l=0;l<e.length;){var o=e[l];++l;var _=pa.distanceBetweenPoints(o,r);(null==s||_<a)&&(a=_,s=o)}return s},Ka.merge2Polygons=function(e,t){for(var n=-1,i=0,r=e.length;i<r;){var a=i++;if(!Ka.pointInPolygon(e[a],t)){n=a;break}}if(-1==n)return pa.copyPoints(t);for(var s=[],l=e,o=t,_=n,p=l[_],u=null,h=e.length*t.length,c=!1;;){if(0==h--)return xl.trace("warning: merge2Polygons algorithm broke",{fileName:"PolygonFunc.hx",lineNumber:236,className:"bikas.polygon.PolygonFunc",methodName:"merge2Polygons"}),null;if(s.push(p),(u=_+1==l.length?l[0]:l[_+1])==e[n])break;for(var d=null,m=0,f=o.length;m<f;){var g,v=m++;g=v+1==o.length?0:v+1;var b=o[v],y=o[g],x=pa.getLineSegmentIntersection(p,u,b,y);if(null!=x)if(pa.pointsEqual(p,x))x=null;else{c=!0;var z=pa.distanceBetweenPoints(b,x);(null==d||d.distance>z)&&((d=new _a).intersection=x,d.index=v,d.distance=z)}}if(null!=d){var w=l;l=o,o=w,p=d.intersection,_=d.index}else++_>=l.length&&(_=0),p=l[_]}return c?s.length<3?null:s:null};var Qa=function(){this.leftEdge=0,this.bottomEdge=0,this.rightEdge=0,this.topEdge=0};(n["bikas.polygon.Edges"]=Qa).__name__=["bikas","polygon","Edges"],Qa.prototype={topEdge:null,rightEdge:null,bottomEdge:null,leftEdge:null,__class__:Qa};var $a=function(){};(n["bikas.polygon.SutherlandHodgmanPolygonCutter"]=$a).__name__=["bikas","polygon","SutherlandHodgmanPolygonCutter"],$a.clip=function(e,t,n,i,r){var a=new Qa;if(a.topEdge=t,a.rightEdge=n,a.bottomEdge=i,a.leftEdge=r,e.length<3)return xl.trace("warning: polygon.length < 3",{fileName:"SutherlandHodgmanPolygonCutter.hx",lineNumber:29,className:"bikas.polygon.SutherlandHodgmanPolygonCutter",methodName:"clip"}),null;if(e[0].x==e[e.length-1].x&&e[0].y==e[e.length-1].y)return xl.trace("warning: is closed polygon",{fileName:"SutherlandHodgmanPolygonCutter.hx",lineNumber:33,className:"bikas.polygon.SutherlandHodgmanPolygonCutter",methodName:"clip"}),null;var s,l,o=[],_=e.slice();_.push(e[0]);for(var p=0;p<4;){var u=p++;o=[];for(var h=0,c=_.length-1;h<c;){var d=h++;s=_[d],l=_[d+1],$a.isInsideClipWindow(a,s,u)?$a.isInsideClipWindow(a,l,u)?o.push(new Yr(l.x,l.y)):o.push($a.intersectionPoint(a,u,s,l)):$a.isInsideClipWindow(a,l,u)&&(o.push($a.intersectionPoint(a,u,s,l)),o.push(new Yr(l.x,l.y)))}if(!(1<o.length))return null;o[0].x==o[o.length-1].x&&o[0].y==o[o.length-1].y||o.push(o[0]),_=o}return _.length<4?null:(_.pop(),_)},$a.isInsideClipWindow=function(e,t,n){switch(n){case 0:return t.x<=e.rightEdge;case 1:return t.x>=e.leftEdge;case 2:return t.y<=e.bottomEdge;case 3:return t.y>=e.topEdge;default:return xl.trace("warning: something went wrong with SutherlandHodgmanPolygonCutter",{fileName:"SutherlandHodgmanPolygonCutter.hx",lineNumber:107,className:"bikas.polygon.SutherlandHodgmanPolygonCutter",methodName:"isInsideClipWindow"}),!1}},$a.intersectionPoint=function(e,t,n,i){switch(t){case 0:return Yr.create(e.rightEdge,n.y+(e.rightEdge-n.x)*(i.y-n.y)/(i.x-n.x));case 1:return Yr.create(e.leftEdge,n.y+(e.leftEdge-n.x)*(i.y-n.y)/(i.x-n.x));case 2:return Yr.create(n.x+(e.bottomEdge-n.y)*(i.x-n.x)/(i.y-n.y),e.bottomEdge);case 3:return Yr.create(n.x+(e.topEdge-n.y)*(i.x-n.x)/(i.y-n.y),e.topEdge);default:return null}};var es=function(){this.local=null};(n["bikas.projection.Position3D"]=es).__name__=["bikas","projection","Position3D"],es.prototype={local:null,global:null,projection:null,__class__:es};var ts=function(){};(n["bikas.projection.Point3D"]=ts).__name__=["bikas","projection","Point3D"],ts.prototype={sprite:null,position:null,__class__:ts};var ns=function(){};(n["bikas.projection.Rectangle3D"]=ns).__name__=["bikas","projection","Rectangle3D"],ns.prototype={points:null,position:null,rectangle:null,__class__:ns};var is=function(){this.height_cache=0,this.width_cache=0};(n["bikas.projection.Sprite3D"]=is).__name__=["bikas","projection","Sprite3D"],is.prototype={sprite:null,init_position:null,position:null,anchor:null,points:null,width_cache:null,height_cache:null,__class__:is};var rs=function(){};(n["bikas.projection.ProjectionDo"]=rs).__name__=["bikas","projection","ProjectionDo"],rs.createPoint=function(e){null==e&&(e=6);var t=new ls(Xs.game);return Fa.drawCircle(t,e),t},rs.createRectangle3DPoints=function(e){var t=e.x,n=e.x+e.width,i=e.y,r=e.y+e.height;return[new ji(t,i,0),new ji(n,i,0),new ji(n,r,0),new ji(t,r,0)]},rs.createRectangle3D=function(e,t,n){var i=new ns,r=rs.createRectangle3DPoints(t);i.points=[];for(var a=0;a<r.length;){var s=r[a];++a;var l=s,o=ma.add(e,s);i.points.push(rs.createPoint3D(rs.createPoint(n),o,l))}return i.position=e,i.rectangle=t,i},rs.setRectangle3DRotation=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0);for(var r=0,a=e.points;r<a.length;){var s=a[r];++r;var l=ma.rotateX(s.position.local,t);fa.rotateY(l,n),fa.rotateZ(l,i),s.position.global=l,fa.add(s.position.global,e.position)}},rs.setSprite3DRotation=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0);for(var r=0,a=e.points;r<a.length;){var s=a[r];++r;var l=ma.rotateX(s.local,t);fa.rotateY(l,n),fa.rotateZ(l,i),s.global=l,fa.add(s.global,e.position)}},rs.drawRectangle3DLines=function(e,t){var n=t.points[0].position.projection;e.clear(),e.lineStyle(1,0,1),e.moveTo(n.x,n.y);for(var i=1,r=t.points.length;i<r;){var a=i++;n=t.points[a].position.projection,e.lineTo(n.x,n.y)}n=t.points[0].position.projection,e.lineTo(n.x,n.y)},rs.drawSprite3D=function(e,t){var n=t.points[0].projection;e.lineStyle(1,0,1),e.moveTo(n.x,n.y);for(var i=1,r=t.points.length;i<r;){var a=i++;n=t.points[a].projection,e.lineTo(n.x,n.y)}n=t.points[0].projection,e.lineTo(n.x,n.y);for(var s=0,l=t.points;s<l.length;)l[s],++s},rs.createPoint3D=function(e,t,n){var i=new ts;return i.sprite=e,i.position=rs.createPosition3D(t,n),i},rs.createPosition3D=function(e,t){var n=new es;return n.global=e,n.local=t,n.projection=new Yr,n},rs.createSprite3D=function(e,t,n,i){null==i&&(i=800),null==n&&(n=0);var r=e.getLocalBounds(),a=new is;return a.sprite=e,a.position=t,a.init_position=ma.copy(t),a.points=rs.get3DPointsFromSpriteBounds(e,r,n,i),rs.updateSpritePoints(a),a.anchor=new Yr(-r.x/r.width,-r.y/r.height),a},rs.replaceSprite=function(e,t,n,i){null==i&&(i=800),null==n&&(n=0),e.sprite.setTexture(t);var r=e.sprite.getLocalBounds();e.points=rs.get3DPointsFromSpriteBounds(e.sprite,r,n,i),rs.updateSpritePoints(e),e.anchor=new Yr(-r.x/r.width,-r.y/r.height)},rs.get3DPointsFromSpriteBounds=function(e,t,n,i){var r=t.x,a=t.y,s=t.width,l=t.height,o=new Yr(r,a),_=new Yr(r+s,a),p=new Yr(r,a+l),u=function(e,t,n){var i=e.x*(n+t)/n,r=e.y*(n+t)/n,a=new es;return a.local=new ji(i,r,0),a.global=ma.copy(a.local),a.projection=ga.copy(e),a},h=n,c=i;return[u(o,h,c),u(_,h,c),u(p,h,c)]},rs.updateSpritePoints=function(e){for(var t=0,n=e.points;t<n.length;){var i=n[t];++t,i.global.x=i.local.x+e.position.x,i.global.y=i.local.y+e.position.y,i.global.z=i.local.z+e.position.z}},rs.applyProjectionAndUpdatePoint3DPosition=function(e,t,n){fa.applyProjectionWithCamera(e.position.projection,t,n,e.position.global),e.sprite.x=e.position.projection.x,e.sprite.y=e.position.projection.y},rs.applyProjectionAndUpdateSprite3DPosition=function(e,t,n){for(var i=0,r=e.points;i<r.length;){var a=r[i];++i,fa.applyProjectionWithCamera(a.projection,t,n,a.global)}var s=e.points[0].projection,l=e.sprite,o=e.points[1].projection.x-s.x,_=e.points[2].projection.y-s.y;l.width=o,l.height=_,l.x=s.x+o*e.anchor.x,l.y=s.y+_*e.anchor.y},rs.getSprite3DWidth=function(e){return Math.abs(e.points[1].global.x-e.points[0].global.x)},rs.sortSpritesByZ=function(e,t){return e.position.z<t.position.z?1:e.position.z>t.position.z?-1:0},rs.updatePositions=function(e,t,n){for(var i=0;i<n.length;){var r=n[i];++i,fa.applyProjectionWithCamera(r.projection,e,t,r.global)}},rs.updatePoints=function(e,t,n){for(var i=0;i<n.length;){var r=n[i];++i,rs.applyProjectionAndUpdatePoint3DPosition(r,e,t)}},rs.updateSprites=function(e,t,n){for(var i=0;i<n.length;){var r=n[i];++i,rs.applyProjectionAndUpdateSprite3DPosition(r,e,t)}};var as=function(){};(n["bikas.projection.ProjectionExamples"]=as).__name__=["bikas","projection","ProjectionExamples"],as.createBasic=function(e,t,n){var i=new ss;i.eye=rs.createPoint3D(rs.createPoint(6),new ji(t/2,n/2,800)),i.camera=new ji(0,0,0),i.single_point=rs.createPoint3D(rs.createPoint(10),new ji(100,100,1e3)),i.rect3d=rs.createRectangle3D(new ji(t/2,n/2,1e3),new Kr(-250,-250,500,500),6),i.all_points.push(i.single_point),i.all_points.push(i.eye),i.all_points=i.all_points.concat(i.rect3d.points),i.rect_line_graphics=Ra.createGraphics(),i.sprite_line_graphics=Ra.createGraphics();var r=Fa.drawBounds(Ra.createGraphics(),new Qr(0,0,t,n),10,16711680,1,!0,16777215,1);e.add(r);for(var a=0,s=i.all_points;a<s.length;){var l=s[a];++a,e.add(l.sprite)}return e.add(i.rect_line_graphics),e.add(i.sprite_line_graphics),i},as.updateBasic=function(e){if(e.rotation+=Math.PI/60,rs.setRectangle3DRotation(e.rect3d,e.rotation,0,0),rs.updatePoints(e.eye.position.global,e.camera,e.all_points),rs.updateSprites(e.eye.position.global,e.camera,e.all_sprites),rs.drawRectangle3DLines(e.rect_line_graphics,e.rect3d),0<e.all_sprites.length){e.sprite_line_graphics.clear();for(var t=0,n=e.all_sprites;t<n.length;){var i=n[t];++t,rs.drawSprite3D(e.sprite_line_graphics,i)}}};var ss=function(){this.rotation=0,this.all_sprites=[],this.all_points=[]};(n["bikas.projection.BasicScene"]=ss).__name__=["bikas","projection","BasicScene"],ss.prototype={eye:null,camera:null,single_point:null,rect3d:null,all_points:null,all_sprites:null,rect_line_graphics:null,sprite_line_graphics:null,rotation:null,__class__:ss};var ls=function(e,t,n){null==n&&(n=0),null==t&&(t=0),PIXI.Graphics.call(this),this.x=t,this.y=n};(n["bikas.render.Graphics"]=ls).__name__=["bikas","render","Graphics"],ls.__super__=PIXI.Graphics,ls.prototype=r(PIXI.Graphics.prototype,{__class__:ls});var os=function(e,t,n,i,r,a,s){PIXI.extras.TilingSprite.call(this,a,i,r),this.x=t,this.y=n};(n["bikas.render.TileSprite"]=os).__name__=["bikas","render","TileSprite"],os.__super__=PIXI.extras.TilingSprite,os.prototype=r(PIXI.extras.TilingSprite.prototype,{__class__:os});var _s=function(e,t,n,i){PIXI.Rectangle.call(this,e,t,n,i)};(n["bikas.render.Rectangle"]=_s).__name__=["bikas","render","Rectangle"],_s.__super__=PIXI.Rectangle,_s.prototype=r(PIXI.Rectangle.prototype,{__class__:_s});var ps=function(e,t,n,i,r,a,s){null==s&&(s="left");var l=a+"px "+i;PIXI.extras.BitmapText.call(this,r,{font:l,align:s}),this.x=t,this.y=n};(n["bikas.render.BitmapText"]=ps).__name__=["bikas","render","BitmapText"],ps.__super__=PIXI.extras.BitmapText,ps.prototype=r(PIXI.extras.BitmapText.prototype,{destroy:function(e){null==e&&(e=!0),null!=this.parent&&this.parent.removeChild(this),PIXI.extras.BitmapText.prototype.destroy.call(this)},__class__:ps});var us=function(e,t,n,i,r){null==r&&(r=0),PIXI.Sprite.call(this,i),this.x=t,this.y=n};(n["bikas.render.Sprite"]=us).__name__=["bikas","render","Sprite"],us.__super__=PIXI.Sprite,us.prototype=r(PIXI.Sprite.prototype,{setTexture:function(e){var t=this.scale.x,n=this.scale.y;this.position.x,null!=this.texture&&null!=this.texture.orig&&(this.width=0,this.height=0),this.texture=e,this.scale.x=t,this.scale.y=n},destroy:function(e){if(null==e&&(e=!0),e)for(var t=this.children.slice(),n=0;n<t.length;){var i=t[n];++n,i.destroy(e)}null!=this.parent&&this.parent.removeChild(this),Hr.validate_reusable_objects&&-1!=us.destroyed_sprite_list.indexOf(this)?xl.trace("warning: object is already added to destroyed list",{fileName:"RenderWrapper.hx",lineNumber:169,className:"bikas.render.Sprite",methodName:"destroy"}):us.destroyed_sprite_list.push(this)},__class__:us});var hs=function(e){PIXI.Container.call(this)};(n["bikas.render.Group"]=hs).__name__=["bikas","render","Group"],hs.__super__=PIXI.Container,hs.prototype=r(PIXI.Container.prototype,{add:function(e){this.addChild(e)},addAt:function(e,t){this.addChildAt(e,t)},getAt:function(e){return this.getChildAt(e)},remove:function(e){this.removeChild(e)},destroy:function(e){if(null==e&&(e=!0),e)for(var t=this.children.slice(),n=0;n<t.length;){var i=t[n];++n,i.destroy(e)}null!=this.parent&&this.parent.removeChild(this),Hr.validate_reusable_objects&&-1!=hs.destroyed_group_list.indexOf(this)?xl.trace("warning: object is already added to destroyed list",{fileName:"RenderWrapper.hx",lineNumber:228,className:"bikas.render.Group",methodName:"destroy"}):hs.destroyed_group_list.push(this)},__class__:hs});var cs=function(){};(n["bikas.serialization.Bef"]=cs).__name__=["bikas","serialization","Bef"];var ds=function(){};(n["bikas.serialization.ByteCursor"]=ds).__name__=["bikas","serialization","ByteCursor"],ds.prototype={alloc_size:null,bytes:null,pos:null,__class__:ds};var ms=function(){};(n["bikas.serialization.EnumValueCache"]=ms).__name__=["bikas","serialization","EnumValueCache"],ms.prototype={name:null,value:null,__class__:ms};var fs=function(){};(n["bikas.serialization.EnumTypeCache"]=fs).__name__=["bikas","serialization","EnumTypeCache"],fs.prototype={name:null,type:null,values:null,__class__:fs};var gs=function(){this.type_table=null};(n["bikas.serialization.SerialData"]=gs).__name__=["bikas","serialization","SerialData"],gs.prototype={classes:null,enum_cache:null,type_table:null,__class__:gs};var vs=function(){this.serial_field=null};(n["bikas.serialization.UnserialField"]=vs).__name__=["bikas","serialization","UnserialField"],vs.prototype={field_name:null,value_type_flags:null,serial_field:null,__class__:vs};var bs=function(){this.serial_class=null,this.fields=null};(n["bikas.serialization.UnserialClass"]=bs).__name__=["bikas","serialization","UnserialClass"],bs.prototype={full_class_name:null,fields:null,serial_class:null,__class__:bs};var ys=function(){};(n["bikas.serialization.UnserialData"]=ys).__name__=["bikas","serialization","UnserialData"],ys.prototype={classes:null,enum_cache:null,__class__:ys};var xs=n["bikas.sound.MusicState"]={__ename__:["bikas","sound","MusicState"],__constructs__:["FadeIn","FadeOut","Playing","Paused"]};xs.FadeIn=["FadeIn",0],xs.FadeIn.toString=i,(xs.FadeIn.__enum__=xs).FadeOut=["FadeOut",1],xs.FadeOut.toString=i,(xs.FadeOut.__enum__=xs).Playing=["Playing",2],xs.Playing.toString=i,(xs.Playing.__enum__=xs).Paused=["Paused",3],xs.Paused.toString=i,(xs.Paused.__enum__=xs).__empty_constructs__=[xs.FadeIn,xs.FadeOut,xs.Playing,xs.Paused];var zs=function(e,t,n){this.marked_as_updated=!1,this.played_once=!1,this.have_id=!1,this.state=xs.Paused,this.name=e,this.howl=t,this.max_volume=n,this.current_volume=n};(n["bikas.sound.Music"]=zs).__name__=["bikas","sound","Music"],zs.prototype={state:null,name:null,howl:null,current_volume:null,max_volume:null,fade_step:null,id:null,have_id:null,played_once:null,marked_as_updated:null,__class__:zs};var ws=function(e,t,n,i){this.cursor=0,this.max_simultaneous=3,this.current_ids=[],this.name=e,this.howl=t,this.max_simultaneous=n,this.max_volume=i};(n["bikas.sound.Sound"]=ws).__name__=["bikas","sound","Sound"],ws.prototype={name:null,howl:null,current_ids:null,max_simultaneous:null,max_volume:null,cursor:null,__class__:ws};var ks=function(){};(n["bikas.sound.SoundDo"]=ks).__name__=["bikas","sound","SoundDo"],ks.createSound=function(e,t,n,i){var r=new ws(e,t,i,n);r.current_ids=[];for(var a=0,s=i;a<s;)a++,r.current_ids.push(-1);return r.howl.volume(n),r},ks.createMusic=function(e,t,n){var i=new zs(e,t,n);return i.howl.volume(n),i},ks.isSoundPlaying=function(e){return null!=e&&!!e.howl.playing()},ks.playSound=function(e,t,n,i){if(null==i&&(i=-2),null==n&&(n=-1),t&&null!=e){-1!=n?e.howl.volume(n):e.howl.volume(e.max_volume);for(var r=e.howl,a=-1,s=0,l=0,o=e.current_ids;l<o.length;){var _=o[l];if(++l,-1==_){a=s;break}if(!e.howl.playing(_)){a=s;break}++s}if(-1!=a)e.current_ids[a]=r.play(),e.cursor=0;else{var p=e.current_ids[e.cursor];r.stop(p),r.play(p),e.cursor++,e.cursor>=e.current_ids.length&&(e.cursor=0)}null!=wt.capture_control_for_sounds&&kt.captureSound(wt.capture_control_for_sounds,e.name,-1!=n?n:e.howl.volume())}},ks.stopSound=function(e){if(null!=e)for(var t=0,n=e.current_ids;t<n.length;){var i=n[t];++t,-1!=i&&e.howl.playing(i)&&e.howl.stop(i)}},ks.playMusic=function(e){null!=e&&(e.state=xs.Playing,e.played_once=!0)},ks.isMusicPlaying=function(e){return null!=e&&(e.state==xs.Playing||e.state==xs.FadeIn)},ks.replayMusic=function(e){null!=e&&(e.state=xs.Playing)},ks.stopMusic=function(e){null!=e&&(e.state=xs.Paused,e.howl.playing()&&e.howl.stop())},ks.pauseMusic=function(e){null!=e&&(e.state=xs.Paused)},ks.fadeInMusic=function(e,t){null==t&&(t=.016666666666666666),null!=e&&(e.state=xs.FadeIn,e.fade_step=t)},ks.fadeOutMusic=function(e,t){null==t&&(t=.016666666666666666),null!=e&&(e.state=xs.FadeOut,e.fade_step=t)},ks.setVolume=function(e,t){null==t&&(t=1),null!=e&&(e.current_volume=t,e.howl.volume(e.current_volume,e.id))},ks.updateMusic=function(e,t){if(null!=e)if(e.marked_as_updated=!0,t){var n=e.state;switch(d.enumIndex(n)){case 0:e.have_id?e.howl.playing(e.id)||e.howl.play(e.id):(e.have_id=!0,e.id=e.howl.play()),e.current_volume<e.max_volume&&(e.current_volume+=e.fade_step),e.current_volume>=e.max_volume&&(e.current_volume=e.max_volume,e.state=xs.Playing),e.howl.volume(e.current_volume,e.id);break;case 1:e.have_id&&e.howl.playing(e.id)?(0<e.current_volume&&(e.current_volume-=e.fade_step),e.current_volume<=0&&(e.current_volume=0,e.howl.pause(e.id),e.state=xs.Paused),e.howl.volume(e.current_volume,e.id)):(e.state=xs.Paused,e.current_volume=0);break;case 2:e.have_id?e.howl.playing(e.id)||e.howl.play(e.id):(e.have_id=!0,e.id=e.howl.play()),e.current_volume!=e.max_volume&&(e.current_volume=e.max_volume,e.howl.volume(e.current_volume,e.id));break;case 3:e.have_id&&e.howl.playing(e.id)&&e.howl.pause(e.id)}}else{e.have_id&&e.howl.playing(e.id)&&e.howl.pause(e.id);var i=e.state;switch(d.enumIndex(i)){case 0:e.state=xs.Playing;break;case 1:e.state=xs.Paused}}},ks.updateMusicPause=function(e){null!=e&&(e.marked_as_updated||(null!=e.howl?e.howl.playing()&&e.howl.pause():xl.trace("warning: music.howl == null",{fileName:"SoundDo.hx",lineNumber:304,className:"bikas.sound.SoundDo",methodName:"updateMusicPause"})),e.marked_as_updated=!1)};var Ss=function(){this.finished=!1,this.current_drawn_rect_count=0,this.bitmap_offset_y=0,this.bitmap_offset_x=0,this.canvas_ctx=null,this.canvas_tile=null,this.ctx=null,this.canvas=null,this.pattern=null};(n["bikas.terrain.Terrain"]=Ss).__name__=["bikas","terrain","Terrain"],Ss.prototype={bounds:null,all_terrain_rects:null,tile_texture_width:null,tile_texture_height:null,terrain_bitmap_width:null,terrain_bitmap_height:null,sub_cuts_x:null,sub_cuts_y:null,spacing:null,last_width:null,last_height:null,pattern:null,canvas:null,ctx:null,canvas_tile:null,canvas_ctx:null,bitmap_offset_x:null,bitmap_offset_y:null,current_drawn_rect_count:null,finished:null,base_texture:null,__class__:Ss};var Cs=function(){};(n["bikas.terrain.SpriteObject"]=Cs).__name__=["bikas","terrain","SpriteObject"],Cs.prototype={texture:null,x:null,y:null,global_x:null,global_y:null,width:null,height:null,global_bounds:null,__class__:Cs};var Ns=function(){this.texture=null,this.base_texture_rect=null,this.original_rect=null,this.cuts=null};(n["bikas.terrain.TerrainRect"]=Ns).__name__=["bikas","terrain","TerrainRect"],Ns.prototype={fully_in:null,rect:null,texture_rect:null,cuts:null,original_rect:null,base_texture_rect:null,texture:null,__class__:Ns};var Ps=function(){this.height=512,this.width=512,this.index_y=0,this.index_x=0,this.index_x_y=0};(n["bikas.terrain.TextureRect"]=Ps).__name__=["bikas","terrain","TextureRect"],Ps.prototype={index_x_y:null,index_x:null,index_y:null,width:null,height:null,__class__:Ps};var Ms=function(){};(n["bikas.terrain.TerrainDo"]=Ms).__name__=["bikas","terrain","TerrainDo"],Ms.create=function(e,t,n){var i=new Ss,r=0;Ms.debug_print_time_and_texture_size&&(r=ka.getTimer()),i.bounds=Ka.getBoundsFromSeveralPolygons(e);var a=i.bounds.max_x-i.bounds.min_x,s=i.bounds.max_y-i.bounds.min_y;i.tile_texture_width=Math.round(n.width),i.tile_texture_height=Math.round(n.height);for(var l=Math.floor(i.bounds.min_x),o=Math.floor(i.bounds.min_y),_=Math.ceil(a/i.tile_texture_width),u=Math.ceil(s/i.tile_texture_height),h=Ms.cutAreaIntoRectangles(e,l,o,i.tile_texture_width,i.tile_texture_height,_,u,t),c=0;c<h.length;){var d=h[c];++c,d.texture_rect.index_x_y=0,d.texture_rect.index_x=0,d.texture_rect.index_y=0,d.texture_rect.width=i.tile_texture_width,d.texture_rect.height=i.tile_texture_height,d.original_rect=d}Ms.debug_print_stats&&(xl.trace("----------------------",{fileName:"TerrainDo.hx",lineNumber:75,className:"bikas.terrain.TerrainDo",methodName:"create"}),xl.trace("total bounds: "+p.string(pa.boundsToRectangle(i.bounds)),{fileName:"TerrainDo.hx",lineNumber:76,className:"bikas.terrain.TerrainDo",methodName:"create"}),xl.trace("cut_bottom_y: "+t,{fileName:"TerrainDo.hx",lineNumber:77,className:"bikas.terrain.TerrainDo",methodName:"create"}),xl.trace("",{fileName:"TerrainDo.hx",lineNumber:78,className:"bikas.terrain.TerrainDo",methodName:"create"}),xl.trace("first cut",{fileName:"TerrainDo.hx",lineNumber:79,className:"bikas.terrain.TerrainDo",methodName:"create"}),Ms.printStats(h));var m=i.sub_cuts_x=[256,128,64,32],f=i.sub_cuts_y=m.slice();i.all_terrain_rects=[],i.all_terrain_rects.push(h);for(var g=0,v=m.length;g<v;){var b=g++,y=m[b],x=f[b],z=512,w=512;0<b&&(z=m[b-1],w=f[b-1]);var k=Ms.cutIntoSubAreas(i.all_terrain_rects[b],z,w,y,x,t);i.all_terrain_rects.push(k),Ms.debug_print_stats&&(xl.trace("",{fileName:"TerrainDo.hx",lineNumber:108,className:"bikas.terrain.TerrainDo",methodName:"create"}),xl.trace("index: "+b,{fileName:"TerrainDo.hx",lineNumber:109,className:"bikas.terrain.TerrainDo",methodName:"create"}),Ms.printStats(k))}var S=function(e,t){for(var n=0,i=0;i<e.length;){var r=e[i];++i,r.fully_in==t&&++n}return n};if(Ms.debug_print_stats){for(var C=0,N=0,P=i.all_terrain_rects.length;N<P;){var M=N++;C+=S(i.all_terrain_rects[M],!0),M==i.all_terrain_rects.length-1&&(C+=S(i.all_terrain_rects[M],!1))}xl.trace("",{fileName:"TerrainDo.hx",lineNumber:132,className:"bikas.terrain.TerrainDo",methodName:"create"}),xl.trace("total_image_count: "+C,{fileName:"TerrainDo.hx",lineNumber:133,className:"bikas.terrain.TerrainDo",methodName:"create"}),xl.trace("total_image_count for 5 minutes: "+60*C*5/15,{fileName:"TerrainDo.hx",lineNumber:134,className:"bikas.terrain.TerrainDo",methodName:"create"})}var I=0;if(Ms.debug_print_time_and_texture_size&&(I=ka.getTimer()-r),0<i.all_terrain_rects.length){var A=i.all_terrain_rects[i.all_terrain_rects.length-1];0<A.length?(i.last_width=A[0].texture_rect.width,i.last_height=A[0].texture_rect.height):(i.last_width=0,i.last_height=0);var T=i.last_width,D=i.last_height,E=i.spacing=4,O=S(A,!1)*(T+E)*(D+E)+(Math.ceil((i.tile_texture_width+E+Ms.bleeding_fix)/(T+E+Ms.bleeding_fix))*(T+E+Ms.bleeding_fix)+E+Ms.bleeding_fix)*(Math.ceil((i.tile_texture_height+E+Ms.bleeding_fix)/(D+E+Ms.bleeding_fix))*(D+E+Ms.bleeding_fix)+E+Ms.bleeding_fix),B=function(e,t){for(var n=0;n<t.length;){var i=t[n];if(++n,e<i.width*i.height)return i}return null}(O,[new ea(512,512),new ea(1024,512),new ea(1024,1024),new ea(2048,1024),new ea(2048,2048),new ea(4096,2048),new ea(4096,4096)]);if(null==B){var L=Math.round(Math.sqrt(O));return xl.trace("warning: too many cuts, cut_area = "+O+" (~"+L+"x"+L+")",{fileName:"TerrainDo.hx",lineNumber:195,className:"bikas.terrain.TerrainDo",methodName:"create"}),null}i.terrain_bitmap_width=Math.round(B.width),i.terrain_bitmap_height=Math.round(B.height),Ms.debug_print_stats&&xl.trace("width and height: "+i.terrain_bitmap_width+"x"+i.terrain_bitmap_height,{fileName:"TerrainDo.hx",lineNumber:203,className:"bikas.terrain.TerrainDo",methodName:"create"}),i.canvas=to.get_document().createElement("canvas"),i.canvas.width=i.terrain_bitmap_width,i.canvas.height=i.terrain_bitmap_height,i.ctx=i.canvas.getContext("2d");var j=Math.round(n.width),F=Math.round(n.height),R=Ms.bleeding_fix,G=i.ctx,Z=to.get_document().createElement("canvas");Z.width=Math.round(n.width+Ms.bleeding_fix),Z.height=Math.round(n.height+Ms.bleeding_fix);var U=Z.getContext("2d",null),V=n.width+Ms.bleeding_fix,q=n.height+Ms.bleeding_fix;U.drawImage(n.baseTexture.source,n.frame.x,n.frame.y,n.frame.width,n.frame.height,0,0,V,q),xl.trace("temp_b_canvas.width: "+Z.width,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"create"}),xl.trace("temp_b_canvas.height: "+Z.height,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"create"}),G.drawImage(Z,0,F-R,j,R,R,0,j,R),G.drawImage(Z,j-R,0,R,F,0,R,R,F),G.drawImage(Z,0,0,j,F,R,R,j,F),G.drawImage(Z,0,0,R,F,j+R,R,R,F),G.drawImage(Z,0,0,j,R,R,F+R,j,R),G.drawImage(Z,j-R,F-R,R,R,0,0,R,R),G.drawImage(Z,0,F-R,R,R,j+R,0,R,R),G.drawImage(Z,0,0,R,R,j+R,F+R,R,R),G.drawImage(Z,j-R,0,R,R,0,F+R,R,R);var W=j+2*R,X=F+2*R;return i.canvas_tile=to.get_document().createElement("canvas"),i.canvas_tile.width=W,i.canvas_tile.height=X,i.canvas_ctx=i.canvas_tile.getContext("2d"),i.canvas_ctx.drawImage(i.canvas,0,0,W,X,0,0,W,X),i.pattern=G.createPattern(i.canvas_tile,"no-repeat"),i.ctx.fillStyle=i.pattern,i.current_drawn_rect_count=0,i.finished=!1,i.bitmap_offset_x=0,i.bitmap_offset_y=0,Ms.debug_print_time_and_texture_size&&xl.trace("calculation time:"+I+"ms, terrain size:"+i.terrain_bitmap_width+"x"+i.terrain_bitmap_height,{fileName:"TerrainDo.hx",lineNumber:311,className:"bikas.terrain.TerrainDo",methodName:"create"}),i}return null},Ms.getCutCount=function(e){return e.all_terrain_rects[e.all_terrain_rects.length-1].length},Ms.drawPortionOfTerrainRects=function(e,t){var n=e.all_terrain_rects[e.all_terrain_rects.length-1],i=(e.canvas,e.ctx),r=(e.pattern,e.spacing),a=e.last_width,s=e.last_height,l=e.current_drawn_rect_count,o=l+t;o>n.length&&(o=n.length);for(var _=e.bitmap_offset_x,p=e.bitmap_offset_y,u=l,h=o;u<h;){var c=n[u++];if(!c.fully_in){if(p<e.tile_texture_height&&_<e.tile_texture_width&&(_=e.tile_texture_width+r+Ms.bleeding_fix),p+s>e.terrain_bitmap_height){xl.trace("(bitmap_offset_y + height): "+(p+s),{fileName:"TerrainDo.hx",lineNumber:357,className:"bikas.terrain.TerrainDo",methodName:"drawPortionOfTerrainRects"}),xl.trace("warning: something went wrong with terrain drawing",{fileName:"TerrainDo.hx",lineNumber:358,className:"bikas.terrain.TerrainDo",methodName:"drawPortionOfTerrainRects"});break}for(var d=c.texture_rect.index_x,m=c.texture_rect.index_y,f=Math.round(d*a)+Ms.bleeding_fix,g=Math.round(m*s)+Ms.bleeding_fix,v=0,b=c.cuts;v<b.length;){var y=b[v];++v;var x=y[0].x-c.rect.x,z=y[0].y-c.rect.y;if(x<-Ms.bleeding_fix||x>a+Ms.bleeding_fix||z<-Ms.bleeding_fix||z>s+Ms.bleeding_fix){xl.trace("warning: first_point_x: "+x+", first_point_y: "+z+" is outside of rect",{fileName:"TerrainDo.hx",lineNumber:377,className:"bikas.terrain.TerrainDo",methodName:"drawPortionOfTerrainRects"});break}i.beginPath(),i.moveTo(x+_,z+p);for(var w=1,k=y.length;w<k;){var S=w++,C=y[S].x-c.rect.x,N=y[S].y-c.rect.y;(C<-Ms.bleeding_fix||C>a+Ms.bleeding_fix||N<-Ms.bleeding_fix||N>s+Ms.bleeding_fix)&&xl.trace("warning: x: "+C+", y:"+N+" is outside of rect",{fileName:"TerrainDo.hx",lineNumber:389,className:"bikas.terrain.TerrainDo",methodName:"drawPortionOfTerrainRects"}),i.lineTo(C+_,N+p)}i.save(),i.translate(_-f,p-g),i.closePath(),i.fill(),i.restore()}c.base_texture_rect=new PIXI.Rectangle(_,p,a,s),(_+=a+r)+a>=e.terrain_bitmap_width&&(p+=s+(_=r))}}return e.bitmap_offset_x=_,e.bitmap_offset_y=p,e.current_drawn_rect_count=o,n.length==o?e.finished=!0:e.finished=!1},Ms.finish=function(e,t){t>Ms.bleeding_fix&&xl.trace("warning: adding more texture_offset_add: "+t+" than bleeding_fix can support: "+Ms.bleeding_fix,{fileName:"TerrainDo.hx",lineNumber:437,className:"bikas.terrain.TerrainDo",methodName:"finish"}),e.base_texture=PIXI.BaseTexture.fromCanvas(e.canvas),e.canvas=null,e.ctx=null,e.canvas_tile=null,e.canvas_ctx=null,e.pattern=null;for(var n=e.base_texture.width,i=e.base_texture.height,r=e.all_terrain_rects[e.all_terrain_rects.length-1],a=0;a<r.length;){var s=r[a];if(++a,!s.fully_in){var l=s.base_texture_rect.x-t,o=s.base_texture_rect.y-t,_=s.base_texture_rect.width+2*t,p=s.base_texture_rect.height+2*t;l<0&&(l=0,_-=t),o<0&&(o=0,p-=t),n<l+_&&(_=n-l),i<o+p&&(p=i-o),s.texture=new PIXI.Texture(e.base_texture,new PIXI.Rectangle(l,o,_,p))}}for(var u=e.sub_cuts_x,h=e.sub_cuts_y,c=[],d=0,m=u.length;d<m;){for(var f=d++,g=u[f],v=h[f],b=Math.round(e.tile_texture_width/v),y=Math.round(e.tile_texture_height/v),x=[],z=0,w=b;z<w;)for(var k=z++,S=0,C=y;S<C;){var N=S++,P=k*v+Ms.bleeding_fix-t,M=N*v+Ms.bleeding_fix-t,I=g+2*t,A=v+2*t;P<0&&(P=0,I-=t),M<0&&(M=0,A-=t),n<P+I&&(I=n-P),i<M+A&&(A=i-M);var T=new PIXI.Texture(e.base_texture,new PIXI.Rectangle(P,M,I,A));x.push(T)}c.push(x)}Ms.bleeding_fix,Ms.bleeding_fix;var D=e.tile_texture_width+2*t,E=e.tile_texture_height+2*t;xl.trace("terrain.base_texture.width: "+e.base_texture.width,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"finish"}),xl.trace("terrain.base_texture.height: "+e.base_texture.height,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"finish"}),xl.trace("texture_width: "+D,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"finish"}),xl.trace("texture_height: "+E,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.terrain.TerrainDo",methodName:"finish"}),xl.trace("TODO: full original texture might be wrong!",{fileName:"TerrainDo.hx",lineNumber:542,className:"bikas.terrain.TerrainDo",methodName:"finish"});for(var O=new PIXI.Texture(e.base_texture,new PIXI.Rectangle(0,0,D,E)),B=0,L=e.all_terrain_rects[0];B<L.length;){var j=L[B];++B,j.texture=O}for(var F=0,R=u.length;F<R;)for(var G=F++,Z=c[G],U=0,V=e.all_terrain_rects[G+1];U<V.length;){var q=V[U];if(++U,q.fully_in)if(null==q.texture_rect)xl.trace("warning: no texture_rect",{fileName:"TerrainDo.hx",lineNumber:555,className:"bikas.terrain.TerrainDo",methodName:"finish"});else if(Z.length<=q.texture_rect.index_x_y)xl.trace("warning: not enough textures, index_x_y: "+q.texture_rect.index_x_y+", textures.length: "+Z.length,{fileName:"TerrainDo.hx",lineNumber:558,className:"bikas.terrain.TerrainDo",methodName:"finish"});else{var W=Z[q.texture_rect.index_x_y];q.texture=W}}if(Ms.debug_print_stats,Ms.debug_add_base_texture_to_stage){var X=new PIXI.Texture(e.base_texture),H=Ra.createSprite(X);H.anchor.x=0,H.anchor.y=0,H.scale.x=.25,H.scale.y=.25,H.x=60,H.y=10,Xs.game.addChild(H)}},Ms.createTerrainRect=function(){if(0<Ms.destroyed_terrain_rect_list.length)return Ms.destroyed_terrain_rect_list.pop();var e=new Ns;return e.rect=new Kr,e.texture_rect=new Ps,e},Ms.destroy=function(e){for(var t=0,n=e.all_terrain_rects;t<n.length;){var i=n[t];++t;for(var r=0;r<i.length;){var a=i[r];if(++r,(a.base_texture_rect=null)!=a.cuts)for(var s=0,l=a.cuts;s<l.length;){var o=l[s];++s;for(var _=0;_<o.length;){var p=o[_];++_,Yr.destroy(p)}}a.cuts=null,(a.original_rect=null)!=a.texture&&(a.texture.destroy(!1),a.texture=null),Hr.validate_reusable_objects&&-1!=Ms.destroyed_terrain_rect_list.indexOf(a)?xl.trace("warning: object is already added to destroyed list",{fileName:"TerrainDo.hx",lineNumber:636,className:"bikas.terrain.TerrainDo",methodName:"destroy"}):Ms.destroyed_terrain_rect_list.push(a)}}(e.all_terrain_rects=null)!=e.base_texture&&(e.base_texture.destroy(),e.base_texture=null)},Ms.createSpriteObject=function(){if(0<Ms.destroyed_sprite_object_list.length)return Ms.destroyed_sprite_object_list.pop();var e=new Cs;return e.global_bounds=new Qr,e},Ms.destroySpriteObject=function(e){e.texture=null,Hr.validate_reusable_objects&&-1!=Ms.destroyed_sprite_object_list.indexOf(e)?xl.trace("warning: object is already added to destroyed list",{fileName:"TerrainDo.hx",lineNumber:675,className:"bikas.terrain.TerrainDo",methodName:"destroySpriteObject"}):Ms.destroyed_sprite_object_list.push(e)},Ms.createSpriteObjects=function(e,t,n,i){for(var r=[],a=0;a<e.length;){var s=e[a];++a;for(var l=0;l<s.length;){var o=s[l];if(++l,o.fully_in)if(null==o.texture)xl.trace("warning: rect with no texture (width:"+o.texture_rect.width+", index_x_y:"+o.texture_rect.width+")",{fileName:"TerrainDo.hx",lineNumber:692,className:"bikas.terrain.TerrainDo",methodName:"createSpriteObjects"});else{var _=o.rect.x-i,p=o.rect.y-i,u=Ms.createSpriteObject();u.x=_,u.y=p,u.texture=o.texture,u.global_x=_+t,u.global_y=p+n,u.width=u.texture.width,u.height=u.texture.height,u.global_bounds.min_x=u.global_x,u.global_bounds.min_y=u.global_y,u.global_bounds.max_x=u.global_x+u.width,u.global_bounds.max_y=u.global_y+u.height,r.push(u)}}}if(0<e.length)for(var h=e[e.length-1],c=0;c<h.length;){var d=h[c];if(++c,null==d.texture)xl.trace("warning: rect with no texture (width:"+d.texture_rect.width+", index_x_y:"+d.texture_rect.width+")",{fileName:"TerrainDo.hx",lineNumber:731,className:"bikas.terrain.TerrainDo",methodName:"createSpriteObjects"});else if(!d.fully_in){var m=d.rect.x-i,f=d.rect.y-i,g=Ms.createSpriteObject();g.x=m,g.y=f,g.texture=d.texture,g.global_x=m+t,g.global_y=f+n,g.width=g.texture.width,g.height=g.texture.height,g.global_bounds.min_x=g.global_x,g.global_bounds.min_y=g.global_y,g.global_bounds.max_x=g.global_x+g.width,g.global_bounds.max_y=g.global_y+g.height,r.push(g)}}return r},Ms.createSprites=function(e){for(var t=[],n=0;n<e.length;){var i=e[n];++n;var r=Ra.createSprite(i.texture,0,0,i.global_x,i.global_y);t.push(r)}return t},Ms.printStats=function(e){for(var t=0,n=0,i=0,r=0,a=0;a<e.length;){var s=e[a];++a,++t,s.fully_in?++n:(++i,r+=s.rect.width*s.rect.height)}0<e.length&&xl.trace("\ttexture: "+e[0].texture_rect.width+"x"+e[0].texture_rect.height,{fileName:"TerrainDo.hx",lineNumber:795,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),xl.trace("\ttotal count: "+t,{fileName:"TerrainDo.hx",lineNumber:797,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),xl.trace("\tfilled count: "+n,{fileName:"TerrainDo.hx",lineNumber:798,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),xl.trace("\tcut count: "+i,{fileName:"TerrainDo.hx",lineNumber:799,className:"bikas.terrain.TerrainDo",methodName:"printStats"});var l=Math.round(r/4194304*100*10)/10;xl.trace("\ttotal area of cuts: "+l+"% of 2048x2048",{fileName:"TerrainDo.hx",lineNumber:801,className:"bikas.terrain.TerrainDo",methodName:"printStats"});var o=Math.round(r/16777216*100*10)/10;xl.trace("\ttotal area of cuts: "+o+"% of 4096x4096",{fileName:"TerrainDo.hx",lineNumber:803,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),xl.trace("\tapprox for 5 minutes: "+Math.round(300*l/15)+"% of 2048x2048",{fileName:"TerrainDo.hx",lineNumber:804,className:"bikas.terrain.TerrainDo",methodName:"printStats"}),xl.trace("\tapprox for 5 minutes: "+Math.round(300*o/15)+"% of 4096x4096",{fileName:"TerrainDo.hx",lineNumber:805,className:"bikas.terrain.TerrainDo",methodName:"printStats"})},Ms.cutIntoSubAreas=function(e,t,n,i,r,a){for(var s=Math.round(t/i),l=Math.round(n/r),o=[],_=0;_<e.length;){var p=e[_];if(++_,!p.fully_in)for(var u=Ms.cutAreaIntoRectangles(p.cuts,p.rect.x,p.rect.y,i,r,s,l,a),h=0;h<u.length;){var c=u[h];++h,c.original_rect=p.original_rect;var d=Math.round((c.rect.x-c.original_rect.rect.x)/i),m=Math.round((c.rect.y-c.original_rect.rect.y)/r),f=d*Math.round(c.original_rect.texture_rect.height/r)+m,g=i,v=r;c.texture_rect.index_x_y=f,c.texture_rect.index_x=d,c.texture_rect.index_y=m,c.texture_rect.width=g,c.texture_rect.height=v,o.push(c)}}return o},Ms.cutAreaIntoRectangles=function(e,t,n,i,r,a,s,l){for(var o=[],_=0,p=a;_<p;)for(var u=_++,h=0,c=s;h<c;){for(var d=h++,m=u*i+Math.floor(t),f=m+i,g=d*r+Math.floor(n),v=g+r,b=new Kr(m-Ms.bleeding_fix,g-Ms.bleeding_fix,i+2*Ms.bleeding_fix,r+2*Ms.bleeding_fix),y=[],x=0;x<e.length;){var z=e[x];++x;var w=$a.clip(z,Math.round(g)-Ms.bleeding_fix,Math.round(f)+Ms.bleeding_fix,Math.round(v)+Ms.bleeding_fix,Math.round(m)-Ms.bleeding_fix);null!=w&&y.push(w)}if(0<y.length){var k=!1;if(1==y.length&&4==y[0].length){for(var S=y[0][0],C=y[0][0],N=0,P=y[0];N<P.length;){var M=P[N];++N,M.x<=S.x&&M.y<=S.y&&(S=M),M.x>=C.x&&M.y>=C.y&&(C=M)}var I=pa.createRectangleFrom2Points(S,C);pa.rectanglesEqual(b,I)&&(k=!0)}var A=Ms.createTerrainRect();if(A.rect.x=m,A.rect.y=g,A.rect.width=i,A.rect.height=r,!(A.fully_in=k))if(Ka.getBoundsFromSeveralPolygons(y).min_y>l){A.fully_in=!0;for(var T=0;T<y.length;){var D=y[T];++T;for(var E=0;E<D.length;){var O=D[E];++E,Yr.destroy(O)}}}else A.cuts=y;o.push(A)}}return o};var Is=function(){};(n["bikas.top.SitelockType"]=Is).__name__=["bikas","top","SitelockType"];var As=function(){this.show_performance_information=!1,this.show_build_information=!1,this.add_clear_rewarded_ads_in_pause_menu=!1,this.add_race_finish_button_in_pause_menu=!1,this.add_gameplay_bot_button_in_pause_menu=!1,this.google_analytics_enabled=!0,this.music_enabled=!0,this.sounds_enabled=!0,this.game_exit=!0,this.sitelock_poki_debug_enabled=!1,this.sitelock_type=3};(n["bikas.top.GameReleaseConfig"]=As).__name__=["bikas","top","GameReleaseConfig"],As.prototype={sitelock_type:null,sitelock_poki_debug_enabled:null,game_exit:null,sounds_enabled:null,music_enabled:null,google_analytics_enabled:null,add_gameplay_bot_button_in_pause_menu:null,add_race_finish_button_in_pause_menu:null,add_clear_rewarded_ads_in_pause_menu:null,show_build_information:null,show_performance_information:null,__class__:As};var Ts=function(){this.force_fixed_timestep=!1,this.force_canvas=!1,this.force_size=new ea(720,405),this.force_running_game_while_unfocused=!0,this.reduce_visible_bounds_by_100_pixels=!1,this.render_markers=!1,this.fixed_camera_zoom=-1,this.manual_camera_control=!1,this.trace_explosive_barrel_event=!1,this.trace_obstacle_break_event=!1,this.filter_out_interactive_objects=!1,this.filter_out_bots=!1,this.bot_decisions_enabled=!0,this.bots_enabled=!0,this.use_editor_cars=!1,this.race_countdown_enabled=!1,this.transitions_enabled=!1,this.loader_enabled=!1,this.game_preloader_enabled=!1,this.show_editor_first=!0,this.editor_enabled=!0,this.show_performance_information=!0,this.show_build_information=!0,this.show_update_times=!0,this.capture_mode=!1,this.music_enabled=!1,this.sounds_enabled=!1};(n["bikas.top.GameDevelopmentConfig"]=Ts).__name__=["bikas","top","GameDevelopmentConfig"],Ts.prototype={sounds_enabled:null,music_enabled:null,capture_mode:null,show_update_times:null,show_build_information:null,show_performance_information:null,editor_enabled:null,show_editor_first:null,game_preloader_enabled:null,loader_enabled:null,transitions_enabled:null,race_countdown_enabled:null,use_editor_cars:null,bots_enabled:null,bot_decisions_enabled:null,filter_out_bots:null,filter_out_interactive_objects:null,trace_obstacle_break_event:null,trace_explosive_barrel_event:null,manual_camera_control:null,fixed_camera_zoom:null,render_markers:null,reduce_visible_bounds_by_100_pixels:null,force_running_game_while_unfocused:null,force_size:null,force_canvas:null,force_fixed_timestep:null,__class__:Ts};var Ds=function(){};(n["bikas.top.ConfigType"]=Ds).__name__=["bikas","top","ConfigType"];var Es=function(){this.development=new Ts,this.release=new As,this.type=0};(n["bikas.top.GameConfig"]=Es).__name__=["bikas","top","GameConfig"],Es.prototype={type:null,release:null,development:null,__class__:Es};var Os=function(){};(n["bikas.top.GameAssets"]=Os).__name__=["bikas","top","GameAssets"];var Bs=function(){};(n["bikas.top.LevelDataSave"]=Bs).__name__=["bikas","top","LevelDataSave"],Bs.prototype={name:null,data:null,__class__:Bs};var Ls=function(){};(n["bikas.top.PreloaderGraphics"]=Ls).__name__=["bikas","top","PreloaderGraphics"],Ls.prototype={container:null,background:null,middle_container:null,title:null,loader_background:null,loader_foreground:null,play_button:null,play_button_click_callback:null,__class__:Ls};var js=function(e,t,n,i){this.type=e,this.file_path=t,this.file_name=n,this.file_extension=i};(n["bikas.top.LoaderPackFile"]=js).__name__=["bikas","top","LoaderPackFile"],js.prototype={type:null,file_path:null,file_name:null,file_extension:null,__class__:js};var Fs=n["bikas.top.LoaderPackType"]={__ename__:["bikas","top","LoaderPackType"],__constructs__:["Text","Image","Binary","BitmapFont","AtlasJSONArray","Sound","SoundLoop"]};Fs.Text=["Text",0],Fs.Text.toString=i,(Fs.Text.__enum__=Fs).Image=["Image",1],Fs.Image.toString=i,(Fs.Image.__enum__=Fs).Binary=["Binary",2],Fs.Binary.toString=i,(Fs.Binary.__enum__=Fs).BitmapFont=["BitmapFont",3],Fs.BitmapFont.toString=i,(Fs.BitmapFont.__enum__=Fs).AtlasJSONArray=["AtlasJSONArray",4],Fs.AtlasJSONArray.toString=i,(Fs.AtlasJSONArray.__enum__=Fs).Sound=["Sound",5],Fs.Sound.toString=i,(Fs.Sound.__enum__=Fs).SoundLoop=["SoundLoop",6],Fs.SoundLoop.toString=i,(Fs.SoundLoop.__enum__=Fs).__empty_constructs__=[Fs.Text,Fs.Image,Fs.Binary,Fs.BitmapFont,Fs.AtlasJSONArray,Fs.Sound,Fs.SoundLoop];var Rs=function(){this.next_pack=null,this.name_to_howl_map=new Al,this.loaded_howls=[],this.preload_howls=[],this.pixi_loader_finished=!1,this.finished=!1,this.on_finish=null,this.names=[]};(n["bikas.top.LoaderPack"]=Rs).__name__=["bikas","top","LoaderPack"],Rs.prototype={names:null,size_coeff:null,on_finish:null,finished:null,loader:null,pixi_loader_finished:null,preload_howls:null,loaded_howls:null,name_to_howl_map:null,next_pack:null,__class__:Rs};var Gs=function(){this.finished=!1,this.transition_current_time=0};(n["bikas.top.GameLoader"]=Gs).__name__=["bikas","top","GameLoader"],Gs.prototype={transition_current_time:null,on_transition_out_finished:null,finished:null,preloader_graphics:null,loader_pack_list:null,load_callback:null,play_callback:null,__class__:Gs};var Zs=function(){};(n["bikas.top.GameAssetsDo"]=Zs).__name__=["bikas","top","GameAssetsDo"],Zs.init=function(e,t,n,i,r,a,l){var o=Zs.createGameLoader(a,l);e.loader=o;var u=function(){o.preloader_graphics.container.position.x=0,o.preloader_graphics.container.position.y=0,o.preloader_graphics.background.position.x=-5,o.preloader_graphics.background.position.y=-5,o.preloader_graphics.background.width=e.current_game_width+10,o.preloader_graphics.background.height=e.current_game_height+10,o.preloader_graphics.middle_container.position.x=e.current_game_width/2,o.preloader_graphics.middle_container.position.y=e.current_game_height/2},h=function(e,t){var n=t.type,i=t.file_path,r=t.file_name,a=t.file_extension;e.names.push(r);var s=i+r+"."+a;if(n==Fs.Text)e.loader.add(r,s);else if(n==Fs.Image)e.loader.add(r,s);else if(n==Fs.Binary)e.loader.add(r,s);else if(n==Fs.BitmapFont){var l=i+r+".fnt";e.loader.add(r,l)}else if(n==Fs.AtlasJSONArray){var o=i+r+".json";e.loader.add(r,o,null)}else if(n==Fs.Sound||n==Fs.SoundLoop){var _=[i+r+".ogg",i+r+".m4a"],u=!1;n==Fs.SoundLoop&&(u=!0);var h=new Howl({preload:!1,loop:u,volume:1,src:_});e.name_to_howl_map.set(r,h),e.preload_howls.push(h)}else xl.trace("warning: unhandled type "+p.string(n),{fileName:"GameAssetsDo.hx",lineNumber:145,className:"bikas.top.GameAssetsDo",methodName:"init"});return r},c=function(e,t,n,i){var r=new Rs;r.loader=new PIXI.loaders.Loader,r.size_coeff=t,r.on_finish=i,r.finished=!1,0<e.length&&(e[e.length-1].next_pack=r),e.push(r);for(var a=0;a<n.length;){var s=n[a];++a,h(r,s)}return r},d=[],m=c(d,.1,[new js(Fs.Image,"assets/preloader/","preloader_game_loader_background","png"),new js(Fs.Image,"assets/preloader/","preloader_game_loader_foreground","png"),new js(Fs.Image,"assets/preloader/","preloader_logo_big","png"),new js(Fs.Image,"assets/preloader/","preloader_play_button_normal","png"),new js(Fs.Image,"assets/preloader/","preloader_play_button_pressed","png"),new js(Fs.Image,"assets/preloader/","preloader_title_background","png"),new js(Fs.Image,"assets/preloader/","tile_separate","png"),new js(Fs.Image,"assets/preloader/","tile_dark_separate","png"),new js(Fs.Image,"assets/preloader/","red_border_100x100_separate","png")]),f=c(d,.1,[new js(Fs.Text,"assets/saves/","library","befgl"),new js(Fs.Text,"assets/saves/","main_menu","befgs"),new js(Fs.Text,"assets/saves/","inter_level_menu","befgs"),new js(Fs.Text,"assets/saves/","challenge_escape_from_wolf","befgs"),new js(Fs.Text,"assets/saves/","challenge_mountain_rush","befgs"),new js(Fs.Text,"assets/saves/","challenge_balancing","befgs"),new js(Fs.Text,"assets/saves/","challenge_survival","befgs"),new js(Fs.Text,"assets/saves/","challenge_bullet_taxi","befgs"),new js(Fs.Text,"assets/saves/","challenge_hunt_the_prey","befgs"),new js(Fs.Text,"assets/saves/","challenge_achievement","befgs"),new js(Fs.Text,"assets/saves/","challenge_credits","befgs"),new js(Fs.Text,"assets/saves/","level_1","befgs"),new js(Fs.Text,"assets/saves/","level_2","befgs"),new js(Fs.Text,"assets/saves/","level_3","befgs"),new js(Fs.Text,"assets/saves/","level_4","befgs"),new js(Fs.Text,"assets/saves/","level_5","befgs"),new js(Fs.Text,"assets/saves/","level_6_dip","befgs"),new js(Fs.Text,"assets/saves/","level_7","befgs"),new js(Fs.Text,"assets/saves/","level_8","befgs"),new js(Fs.Text,"assets/saves/","level_9_peak","befgs"),new js(Fs.Text,"assets/saves/","level_10","befgs"),new js(Fs.Text,"assets/saves/","level_11","befgs"),new js(Fs.Text,"assets/saves/","level_12","befgs"),new js(Fs.Text,"assets/saves/","level_13","befgs"),new js(Fs.Text,"assets/saves/","level_14","befgs"),new js(Fs.Text,"assets/saves/","level_15","befgs"),new js(Fs.Text,"assets/saves/","level_16","befgs"),new js(Fs.Text,"assets/saves/","level_17","befgs"),new js(Fs.Text,"assets/saves/","level_18","befgs"),new js(Fs.Text,"assets/saves/","level_19","befgs"),new js(Fs.Text,"assets/saves/","level_20","befgs"),new js(Fs.Text,"assets/saves/","level_21","befgs"),new js(Fs.Text,"assets/saves/","level_22","befgs"),new js(Fs.Text,"assets/saves/","level_23","befgs"),new js(Fs.Text,"assets/saves/","level_24","befgs"),new js(Fs.Text,"assets/saves/","level_25","befgs"),new js(Fs.Text,"assets/saves/","level_26","befgs"),new js(Fs.Text,"assets/saves/","level_27","befgs"),new js(Fs.Text,"assets/saves/","level_28","befgs"),new js(Fs.Text,"assets/saves/","level_29","befgs"),new js(Fs.Text,"assets/saves/","level_30","befgs")]),g=c(d,.01,[new js(Fs.Text,"assets/saves/","current_working_files","txt")]),v=c(d,.1,[new js(Fs.Text,"assets/saves/","background_objects","txt"),new js(Fs.Text,"assets/animations/","bfanimations","xml")]),b=c(d,1,[new js(Fs.AtlasJSONArray,"assets/spritesheets/","graphics","json"),new js(Fs.AtlasJSONArray,"assets/spritesheets/","graphics2","json")]),y=c(d,.1,[new js(Fs.BitmapFont,"assets/spritesheets/","toonish_36","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","consolas_24","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","avantgarde_lt_medium_dark_26","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","avantgarde_lt_medium_light_26","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","bell_gothic_std_black_dark_26","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","bell_gothic_std_black_light_26","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","bell_gothic_std_black_very_light_26","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","bell_gothic_std_bold_dark_26","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","bell_gothic_std_bold_light_26","fnt"),new js(Fs.BitmapFont,"assets/spritesheets/","tw_cen_mt_condensed_extra_bold_dark_29","fnt")]);(0==n.type&&n.development.sounds_enabled||1==n.type&&n.release.sounds_enabled)&&(c(d,1,[new js(Fs.SoundLoop,"assets/sounds/","car_bug_slow",""),new js(Fs.SoundLoop,"assets/sounds/","car_bus_slow",""),new js(Fs.SoundLoop,"assets/sounds/","car_coyote_slow",""),new js(Fs.SoundLoop,"assets/sounds/","car_farm_truck_slow",""),new js(Fs.SoundLoop,"assets/sounds/","car_ice_cream_truck_slow",""),new js(Fs.SoundLoop,"assets/sounds/","car_rider_slow",""),new js(Fs.SoundLoop,"assets/sounds/","car_rudolf_slow",""),new js(Fs.SoundLoop,"assets/sounds/","car_semioval_slow",""),new js(Fs.SoundLoop,"assets/sounds/","car_tourcycle_slow",""),new js(Fs.Sound,"assets/sounds/","acceleration_boost",""),new js(Fs.Sound,"assets/sounds/","anchor",""),new js(Fs.Sound,"assets/sounds/","armor",""),new js(Fs.Sound,"assets/sounds/","balloons",""),new js(Fs.Sound,"assets/sounds/","barrel_break",""),new js(Fs.Sound,"assets/sounds/","board_break",""),new js(Fs.Sound,"assets/sounds/","box_break",""),new js(Fs.Sound,"assets/sounds/","coin",""),new js(Fs.Sound,"assets/sounds/","countdown_number",""),new js(Fs.Sound,"assets/sounds/","countdown_go",""),new js(Fs.Sound,"assets/sounds/","explosion",""),new js(Fs.Sound,"assets/sounds/","jump",""),new js(Fs.Sound,"assets/sounds/","nitro_pick",""),new js(Fs.Sound,"assets/sounds/","nitro_use",""),new js(Fs.Sound,"assets/sounds/","power_pick",""),new js(Fs.Sound,"assets/sounds/","power_pick2",""),new js(Fs.Sound,"assets/sounds/","power_roll",""),new js(Fs.Sound,"assets/sounds/","power_roll_end",""),new js(Fs.Sound,"assets/sounds/","power_use",""),new js(Fs.Sound,"assets/sounds/","stunt",""),new js(Fs.Sound,"assets/sounds/","stunt_point",""),new js(Fs.Sound,"assets/sounds/","swoosh",""),new js(Fs.Sound,"assets/sounds/","throw",""),new js(Fs.Sound,"assets/sounds/","treasure",""),new js(Fs.Sound,"assets/sounds/","achievement_claimed",""),new js(Fs.Sound,"assets/sounds/","across_the_line",""),new js(Fs.Sound,"assets/sounds/","bang",""),new js(Fs.Sound,"assets/sounds/","buy_car",""),new js(Fs.Sound,"assets/sounds/","button_click",""),new js(Fs.Sound,"assets/sounds/","chest_open",""),new js(Fs.Sound,"assets/sounds/","click",""),new js(Fs.Sound,"assets/sounds/","level_select",""),new js(Fs.Sound,"assets/sounds/","menu_phase_in",""),new js(Fs.Sound,"assets/sounds/","menu_phase_out",""),new js(Fs.Sound,"assets/sounds/","notification",""),new js(Fs.Sound,"assets/sounds/","ongoing_power",""),new js(Fs.Sound,"assets/sounds/","reward_phase_in",""),new js(Fs.Sound,"assets/sounds/","reward_select",""),new js(Fs.Sound,"assets/sounds/","score",""),new js(Fs.Sound,"assets/sounds/","stat_threshold_pass",""),new js(Fs.Sound,"assets/sounds/","upgrade","")]).on_finish=function(e){for(var t=0,n=e.names;t<n.length;){var i=n[t];++t;var r=1,a=e.name_to_howl_map.get(i);if(null!=a)if("car_"==s.substr(i,0,4)){r=.6;var l=ks.createMusic(i,a,r);_.setField(Os,"sound_loop_"+i,l),Os.all_sound_loops.push(l)}else if("acceleration_boost"==i||"nitro_use"==i||"score"==i){"score"==i?r=.3:"beach_waves"==i&&(r=.2);var o=ks.createMusic(i,a,r);_.setField(Os,"sound_loop_"+i,o),Os.all_sound_loops.push(o)}else{"swoosh"==i&&(r=.5);var p=ks.createSound(i,a,r,3);_.setField(Os,"sound_"+i,p),Os.all_sounds.push(p)}else xl.trace("warning: "+i+" sound does not have howl",{fileName:"GameAssetsDo.hx",lineNumber:387,className:"bikas.top.GameAssetsDo",methodName:"init"})}}),(0==n.type&&n.development.music_enabled||1==n.type&&n.release.music_enabled)&&(c(d,1,[new js(Fs.SoundLoop,"assets/sounds/","music_beach_waves",""),new js(Fs.SoundLoop,"assets/sounds/","music_stereospice_fun_surf_rock_142_sec",""),new js(Fs.SoundLoop,"assets/sounds/","music_stereospice_fun_surf_rock_92_sec",""),new js(Fs.SoundLoop,"assets/sounds/","music_avocado_easy_times_in_hawaii","")]).on_finish=function(e){for(var t=0,n=e.names;t<n.length;){var i=n[t];++t;var r=e.name_to_howl_map.get(i);if(null!=r){var a=1;"21831136_driving_indie_beach_rock_guitar_by_skinnyatlasmusic_preview"==i||"music_stereospice_fun_surf_rock_142_sec"==i||"music_stereospice_fun_surf_rock_92_sec"==i||"music_avocado_easy_times_in_hawaii"==i?a=.2:"music_beach_waves"==i&&(a=.35);var s=ks.createMusic(i,r,a);_.setField(Os,i,s),Os.all_music_loops.push(s)}else xl.trace("warning: "+i+" sound does not have howl",{fileName:"GameAssetsDo.hx",lineNumber:461,className:"bikas.top.GameAssetsDo",methodName:"init"})}}),m.on_finish=function(e){Zs.assignTexturesToVars(e.loader.resources,e.names)},f.on_finish=function(e){for(var t=0,n=e.names;t<n.length;){var i=n[t];++t;var r=new Bs;r.name=i,r.data=e.loader.resources[i].data,Os.level_data_saves.push(r)}};var x="",z="";g.on_finish=function(e){for(var t=e.loader.resources[e.names[0]].data.split(","),n=0;n<t.length;){var i=t[n];++n;var r=i.split("."),a=r[0],s=r[1];if("befgs"==s){for(var l=null,o=0,_=Os.level_data_saves;o<_.length;){var p=_[o];if(++o,p.name==a){l=p;break}}null==l?x=h(v,new js(Fs.Text,"assets/saves/",a,s)):(x="",Os.working_stage=l.data)}else if("befgl"==s){for(var u=null,c=0,d=Os.level_data_saves;c<d.length;){var m=d[c];if(++c,m.name==a){u=m;break}}null==u?z=h(v,new js(Fs.Text,"assets/saves/",a,s)):(z="",Os.working_library=u.data)}}},v.on_finish=function(e){""!=x?Os.working_stage=e.loader.resources[x].data:""==Os.working_stage&&xl.trace("warning: working_stage is empty",{fileName:"GameAssetsDo.hx",lineNumber:560,className:"bikas.top.GameAssetsDo",methodName:"init"}),""!=z?Os.working_library=e.loader.resources[z].data:""==Os.working_library&&xl.trace("warning: working_library is empty",{fileName:"GameAssetsDo.hx",lineNumber:567,className:"bikas.top.GameAssetsDo",methodName:"init"}),Os.background_objects_source=e.loader.resources.background_objects.data,Os.background_objects_obj=Ve.parseBackgroundObjects(Os.background_objects_source)},b.on_finish=function(e){for(var t=0,n=e.names;t<n.length;){var i=n[t];++t;for(var a=b.loader.resources[i],s=(a.spritesheet.baseTexture,a.spritesheet.textures),l=0,p=_.fields(s);l<p.length;){var u=p[l];++l;var h=s[u],c=u,d=c.split("/");0<d.length&&(c=d[d.length-1]),null!=_.field(Os,c)?xl.trace("warning: asset "+c+" is already set",{fileName:"GameAssetsDo.hx",lineNumber:595,className:"bikas.top.GameAssetsDo",methodName:"init"}):_.setField(Os,c,h);var m=P.createBitmapDataSource(h);r.set(c,m)}}var f=Ra.createSprite(Os.marker);f.alpha=.001,o.preloader_graphics.container.add(f),Xs.renderer.type==Ws.CANVAS&&(Os.tile_pattern=Zs.createPattern(Os.tile),Os.tile_dark_pattern=Zs.createPattern(Os.tile_dark));var g=v.loader.resources.bfanimations.data,y=(new XMLSerializer).serializeToString(g.documentElement);if(null==y)xl.trace("warning: couldn't load bfanimations",{fileName:"GameAssetsDo.hx",lineNumber:619,className:"bikas.top.GameAssetsDo",methodName:"init"});else for(var x=T.createAnimationDatasFromXml(eo.__cast(y,String),Zs.retrieveAsset),z=0;z<x.length;){var w=x[z];++z;var k="animation_"+w.name;_.setField(Os,k,w)}},y.on_finish=function(e){for(var t=e.loader.resources,n=0,i=e.names;n<i.length;){var r=i[n];++n;for(var a=t[r],s=_.fields(a.bitmapFont.chars),l=_.field(Os,r),o=l.frame.x,p=l.frame.y,u=0;u<s.length;){var h=s[u];++u;var c=_.field(a.bitmapFont.chars,h),d=_.field(c,"texture");_.setField(c,"texture",new PIXI.Texture(l.baseTexture,new PIXI.Rectangle(d.frame.x+o,d.frame.y+p,d.frame.width,d.frame.height)))}}};for(var w={},k=function(e,t,n,i,r,a){for(var s=0,l=0,o=!0,_=0,p=e.loader_pack_list;_<p.length;){var h=p[_];if(++_,s+=h.size_coeff,h.finished)l+=h.size_coeff;else{var c=h.preload_howls.length+h.loaded_howls.length,d=1;0<c&&(d=h.loaded_howls.length/c),l+=d*h.loader.progress/100*h.size_coeff,o=!1}}var m=l/s;1==a.type&&3==a.release.sitelock_type&&(w.percentageDone=m,Ya.PokiSDK.gameLoadingProgress(w)),i.finished&&(null==e.preloader_graphics&&(e.preloader_graphics=Zs.createPreloaderGraphics(),n.add(e.preloader_graphics.container),u(),Hs.scaleAndCenter(n,t),t.scale_listeners.push(u)),u(),e.preloader_graphics.loader_foreground.scale.x=m),o&&(1==a.type&&3==a.release.sitelock_type&&Ya.PokiSDK.gameLoadingFinished(),e.finished=!0,e.preloader_graphics.play_button.visible=!0,e.preloader_graphics.loader_foreground.visible=!1,e.preloader_graphics.loader_background.visible=!1,0!=a.type||a.development.game_preloader_enabled?(e.load_callback(),e.preloader_graphics.play_button_click_callback=function(){t.scale_listeners.splice(t.scale_listeners.indexOf(u),1),e.play_callback(e)}):(t.scale_listeners.splice(t.scale_listeners.indexOf(u),1),e.load_callback(),e.play_callback(e)))},S=null,C=S=function(i){i.loader.load();for(var r=0,a=i.preload_howls;r<a.length;){var l=[a[r]];++r;var _=function(r){return function(){s.remove(i.preload_howls,r[0]),i.loaded_howls.push(r[0]),0==i.preload_howls.length&&i.pixi_loader_finished&&!i.finished&&(i.finished=!0,i.on_finish(i),null!=i.next_pack&&S(i.next_pack)),k(o,e,t,m,0,n)}}(l);l[0].once("load",_),l[0].load()}},N=0,M=(o.loader_pack_list=d).length;N<M;){var I=[d[N++]];I[0].loader.on("progress",(function(i){k(o,e,t,m,0,n)})),I[0].loader.on("complete",function(i){return function(r){i[0].pixi_loader_finished=!0,0==i[0].preload_howls.length&&i[0].pixi_loader_finished&&!i[0].finished&&(i[0].finished=!0,i[0].on_finish(i[0]),null!=i[0].next_pack&&C(i[0].next_pack)),k(o,e,t,m,0,n)}}(I))}1==n.type&&3==n.release.sitelock_type&&Ya.PokiSDK.gameLoadingStart(),0<d.length&&C(d[0])},Zs.createGameLoader=function(e,t){var n=new Gs;return n.preloader_graphics=null,n.load_callback=e,n.play_callback=t,n},Zs.createPreloaderGraphics=function(){var e=new Ls;return e.container=Ra.createGroup(),e.background=Ra.createSprite(Os.preloader_title_background,0,0,0,0),e.container.add(e.background),e.middle_container=Ra.createGroup(),e.container.add(e.middle_container),e.title=Ra.createSprite(Os.preloader_logo_big,.5,.5,0,-60),e.middle_container.add(e.title),e.loader_background=Ra.createSprite(Os.preloader_game_loader_background,0,.5,-Os.preloader_game_loader_background.width/2,146),e.loader_foreground=Ra.createSprite(Os.preloader_game_loader_foreground,0,.5,-Os.preloader_game_loader_foreground.width/2,146),e.middle_container.add(e.loader_background),e.middle_container.add(e.loader_foreground),e.play_button=Ra.createAndAddButton(e.middle_container,Os.preloader_play_button_normal,.5,.5,0,166,0,(function(){Xs.js_info.desktop||Hs.requestFullScreen(),e.play_button.texture=Os.preloader_play_button_pressed,null!=e.play_button_click_callback&&(e.play_button_click_callback(),e.play_button_click_callback=null,e.play_button.buttonMode=!1,e.play_button.interactive=!1,e.play_button.pointerdown=null)})),e.play_button.visible=!1,e},Zs.updateTransitionOut=function(e){e.transition_current_time++;var t=ca.linearClamped(1,0,e.transition_current_time/Gs.transition_out_time);e.preloader_graphics.middle_container.alpha=t,e.transition_current_time>Gs.transition_out_time&&(e.transition_current_time=Gs.transition_out_time,e.preloader_graphics.middle_container.alpha=0,null==e.on_transition_out_finished?xl.trace("warning: on_transition_out_finished == null",{fileName:"GameAssetsDo.hx",lineNumber:886,className:"bikas.top.GameAssetsDo",methodName:"updateTransitionOut"}):e.on_transition_out_finished())},Zs.removeLoader=function(e){1==Xs.config.type&&3==Xs.config.release.sitelock_type&&null!=Ya.adblock_confirm_card&&(bi.destroyConfirmationCard(Ya.adblock_confirm_card),Ya.adblock_confirm_card=null),null!=e.preloader_graphics&&(e.preloader_graphics.play_button.destroy(!0),null!=e.preloader_graphics.container.parent&&e.preloader_graphics.container.parent.removeChild(e.preloader_graphics.container),e.preloader_graphics.container.destroy(!0),e.preloader_graphics=null,e.play_callback=null,e.preloader_graphics=null)},Zs.createPattern=function(e){var t=to.get_document().createElement("canvas");t.width=Math.round(e.frame.width),t.height=Math.round(e.frame.height);var n=t.getContext("2d",null);n.drawImage(e.baseTexture.source,e.frame.x,e.frame.y,e.frame.width,e.frame.height,0,0,e.frame.width,e.frame.height);var i=n.createPattern(t,"repeat");return xl.trace("ctx.canvas.width: "+n.canvas.width,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.top.GameAssetsDo",methodName:"createPattern"}),xl.trace("ctx.canvas.height: "+n.canvas.height,{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.top.GameAssetsDo",methodName:"createPattern"}),i},Zs.assignTexturesToVars=function(e,t){for(var n=0;n<t.length;){var i=t[n];++n;var r=e[i];_.setField(Os,i,r.texture)}},Zs.getSourcesBySoundFormat=function(e,t,n){for(var i=[],r=0;r<n.length;){var a=n[r];++r;var s=e;i.push(s+t+"."+a)}return i},Zs.retrieveAsset=function(e){return _.field(Os,e)},Zs.doesTextureExist=function(e){var t=_.field(Os,e);return null!=t&&!!p.is(t,PIXI.Texture)},Zs.getTexture=function(e){var t=_.field(Os,e);return null==t?(xl.trace("warning: could not find "+e+" texture",{fileName:"GameAssetsDo.hx",lineNumber:1057,className:"bikas.top.GameAssetsDo",methodName:"getTexture"}),null):p.is(t,PIXI.Texture)?eo.__cast(t,PIXI.Texture):(xl.trace("warning: "+e+" is not a texture",{fileName:"GameAssetsDo.hx",lineNumber:1061,className:"bikas.top.GameAssetsDo",methodName:"getTexture"}),null)};var Us=function(e,t,n){this.element=e,this.type=t,this.func=n};(n["bikas.top.ListenerSave"]=Us).__name__=["bikas","top","ListenerSave"],Us.prototype={element:null,type:null,func:null,__class__:Us};var Vs=function(){this.debug_dc_switch_time=0,this.force_delta=null};(n["bikas.top.Step"]=Vs).__name__=["bikas","top","Step"],Vs.prototype={min_fps:null,max_fps:null,min_delta:null,max_delta:null,time_now:null,time_last:null,delta:null,original_dc:null,dc:null,ui_dc:null,step_size:null,level_seconds:null,game_seconds:null,force_delta:null,debug_dc_switch_time:null,game_update_time:null,__class__:Vs};var qs=function(){this.top_scripts=null,this.game_loader=null,this.game=null,this.step=null,this.config=null};(n["bikas.top.GameUpdateData"]=qs).__name__=["bikas","top","GameUpdateData"],qs.prototype={config:null,step:null,game:null,game_loader:null,top_scripts:null,__class__:qs};var Ws=function(){};(n["bikas.top.RendererType"]=Ws).__name__=["bikas","top","RendererType"];var Xs=function(){};(n["bikas.top.TopObjects"]=Xs).__name__=["bikas","top","TopObjects"];var Hs=function(){};(n["bikas.top.TopDo"]=Hs).__name__=["bikas","top","TopDo"],Hs.renderGraphicsHack=function(e){if(null!=e.pattern_hack){if(null!=e.pattern_hack.points){var t=Xs.renderer,n=t.context,i=(e.worldAlpha,e.transform.worldTransform),r=t.resolution;n.setTransform(i.a*r,i.b*r,i.c*r,i.d*r,i.tx*r,i.ty*r),t.setBlendMode(e.blendMode);var a=n,s=e.worldAlpha,l=e.pattern_hack.points;if(null!=e.pattern_hack.pattern){a.save(),a.fillStyle=e.pattern_hack.pattern;for(var o=0;o<l.length;){var _=l[o];++o,a.beginPath(),a.moveTo(_[0].x,_[0].y);for(var p=1,u=_.length;p<u;){var h=p++;a.lineTo(_[h].x,_[h].y)}a.closePath(),a.globalAlpha=s,a.fill()}a.restore()}}}else Hs.PIXI_CanvasGraphics.original_non_hacked_renderGraphics(e)},Hs.emptyPostUpdate=function(){},Hs.initializeAndStart=function(e){Hs.PIXI_CanvasGraphics=PIXI.CanvasGraphicsRenderer.prototype,Hs.PIXI_CanvasGraphics.original_non_hacked_renderGraphics=Hs.PIXI_CanvasGraphics.render,Hs.PIXI_CanvasGraphics.render=Hs.renderGraphicsHack;var t=new Es;(Xs.config=t).type=1,t.type,0==t.type&&xl.trace("NOTE: press (i) near address bar and set Flash to Allow if editor is not visible",{fileName:"TopDo.hx",lineNumber:165,className:"bikas.top.TopDo",methodName:"initializeAndStart"});var n=new ya(960,720,1800,720);n.build_time=e,Hs.setOS(n),Xs.js_info=n;var i=function(e){var t="";return t=(t=-1<e.indexOf("://")?e.split("/")[2]:e.split("/")[0]).split(":")[0],t=h.replace(t,"www.","")},r=function(e){try{if(null!=window.location.ancestorOrigins)for(var t=window.location.ancestorOrigins,n=0;n<t.length;){var r=t[n],a=i(r);if(-1==e.indexOf(a))return!1;++n}}catch(e){}if(to.get_window().top!=to.get_window().self){var s=i(to.get_document().referrer);if(-1==e.indexOf(s))return!1}var l=i(to.get_window().location.hostname);return-1!=e.indexOf(l)};if(1!=t.type||3!=t.release.sitelock_type){if(1==t.type&&1==t.release.sitelock_type&&!r(["bikas.net"])&&t.release.game_exit)return;if(1==t.type&&2==t.release.sitelock_type&&!r(["lagged.com"])&&t.release.game_exit)return}if(1==t.type&&2==t.release.sitelock_type)Ca.init();else if(1==t.type&&3==t.release.sitelock_type&&!Ya.init(t))return;xl.trace("config type: "+t.type,{fileName:"TopDo.hx",lineNumber:285,className:"bikas.top.TopDo",methodName:"initializeAndStart"}),xl.trace("build date: "+p.string(new Date(e)),{fileName:"TopDo.hx",lineNumber:286,className:"bikas.top.TopDo",methodName:"initializeAndStart"}),xl.trace("run date: "+p.string(new Date),{fileName:"TopDo.hx",lineNumber:287,className:"bikas.top.TopDo",methodName:"initializeAndStart"});var a=ka.getTimer();Howler.init(),1==t.type&&t.release.google_analytics_enabled&&ba.init("UA-49556966-15","adventuredrivers.bikas.net");var s=Ws.WEBGL;0==t.type&&t.development.capture_mode?(s=Ws.CANVAS,t.development.force_fixed_timestep=!0,t.development.force_size=new ea(1280,720)):(n.android||n.desktop,s=Ws.WEBGL),0==t.type&&t.development.force_canvas&&(s=Ws.CANVAS),0==t.type&&(to.get_document().oncontextmenu=function(){return!1});var l=new hs,o={autoResize:!(l.interactive=!0),antialias:!0,transparent:!1,backgroundColor:8572624,resolution:1},_=to.get_document().getElementById("gamecanvas");_.draggable=!1,o.view=_,PIXI.glCore.VertexArrayObject.FORCE_NATIVE=!0,n.iOS&&(PIXI.settings.PRECISION_FRAGMENT="highp");var u=!1;s==Ws.CANVAS&&(u=!0);var c=PIXI.autoDetectRenderer(o,1024,768,u);Xs.renderer=c,Xs.canvas=_,Xs.game=l,Xs.container=l,n.desktop?Rn.terrain_draw_count=512:n.iOS?Rn.terrain_draw_count=20:Rn.terrain_draw_count=128,c.type==PIXI.RENDERER_TYPE.CANVAS&&(Rn.texture_offset_add=1),Xs.game_update_data=Hs.createGameUpdateData(t,30,120),Hs.create(t,a,n,l),Hs.updateEverything(.016666666666666666)},Hs.updateEverything=function(e){Hs.update(Xs.game_update_data,e),to.get_window().requestAnimationFrame(Hs.updateEverything)},Hs.create=function(e,t,n,i){0==e.type&&(i.mousedown=function(e){3==e.data.originalEvent.which&&(Xs.right_mouse_button_down=!0,xl.trace("TopObjects.right_mouse_button_down: "+p.string(Xs.right_mouse_button_down),{fileName:"GlobalMacro.hx",lineNumber:26,className:"bikas.top.TopDo",methodName:"create"}))},i.mouseup=function(e){3==e.data.originalEvent.which&&(Xs.right_mouse_button_down=!1)}),n.gamecanvas=Xs.canvas;var r=new Wa;if(Xs.pointer=r,Ra.addPointerEvents(i,r,n),Hs.scaleAndCenter(i,n),0==e.type&&(n.force_size=e.development.force_size),Hs.addEvent(to.get_window(),"load",(function(){Hs.scaleAndCenter(i,n)})),Hs.addEvent(to.get_window(),"resize",(function(){Hs.scaleAndCenter(i,n)})),Hs.addEvent(to.get_window(),"scroll",(function(){Hs.scaleAndCenter(i,n)})),null!=to.get_window()){var a=function(e){e.preventDefault()},s=function(e){e.preventDefault()};to.get_window().addEventListener("gesturestart",a,!1),to.get_window().addEventListener("gestureend",a,!1),to.get_window().addEventListener("gesturechange",s,!1),Xs.top_listeners.push(new Us(to.get_window(),"gesturestart",a)),Xs.top_listeners.push(new Us(to.get_window(),"gestureend",a)),Xs.top_listeners.push(new Us(to.get_window(),"gesturechange",s))}0==e.type&&new o;var l=new Al;Zs.init(n,i,e,r,l,(function(){xl.trace("total load time: "+(ka.getTimer()-t)+"ms",{fileName:"TopDo.hx",lineNumber:528,className:"bikas.top.TopDo",methodName:"create"})}),(function(t){P.init();var a=function(){Zs.removeLoader(t),function(){var t=ie.createEngine(),a=ka.getTimer();if(Xs.game_update_data.game=Gn.createGame(e,n,Xs.game_update_data.step,r,i,t,l),null!=Xs.game_update_data.game){xl.trace("game created in "+(ka.getTimer()-a)+"ms",{fileName:"TopDo.hx",lineNumber:504,className:"bikas.top.TopDo",methodName:"create"}),0!=e.type||e.development.transitions_enabled?(Xs.game_update_data.game.previous_state=jn.InGameLoad,Xs.game_update_data.game.state=jn.InTransitionToLevelLoad):Xs.game_update_data.game.state=jn.InLevel;var s=new Vs;s.dc=1,s.level_seconds=0,s.step_size=.016666666666666666,s.delta=16.666666666666668,Gn.update(Xs.game_update_data.game,s)}}()};0!=e.type||e.development.transitions_enabled?(Xs.game_update_data.game_loader=t).on_transition_out_finished=a:a(),Hs.scaleAndCenter(i,n)})),xl.trace("init time: "+(ka.getTimer()-t)+"ms",{fileName:"TopDo.hx",lineNumber:558,className:"bikas.top.TopDo",methodName:"create"})},Hs.createGameUpdateData=function(e,t,n){null==n&&(n=120),null==t&&(t=30);var i=new qs;i.top_scripts=[],i.config=e;var r=i.step=new Vs;return r.min_fps=t,r.max_fps=n,r.min_delta=1e3/r.max_fps,r.max_delta=1e3/r.min_fps,null!=to.get_window().performance?(xl.trace("use performance",{fileName:"TopDo.hx",lineNumber:578,className:"bikas.top.TopDo",methodName:"createGameUpdateData"}),r.time_last=to.get_window().performance.now()):r.time_last=(new Date).getTime(),0==e.type&&e.development.force_fixed_timestep&&(r.force_delta=16.666666666666668),r.delta=r.min_delta,r.step_size=1/r.max_fps,r.dc=1,r.level_seconds=0,r.game_update_time=0,i},Hs.addEvent=function(e,t,n){null!=e&&(null!=e.addEventListener?(e.addEventListener(t,n,!1),Xs.top_listeners.push(new Us(e,t,n))):null!=e.attachEvent?e.attachEvent("on"+t,n):_.setProperty(e,"on"+t,n))},Hs.setOS=function(e){var t=to.get_navigator().userAgent,n=e;new a("Playstation Vita","").match(t)?n.vita=!0:new a("Kindle","").match(t)||new a("\\bKF[A-Z][A-Z]+","").match(t)||new a("Silk.*Mobile Safari","").match(t)?n.kindle=!0:new a("Android","").match(t)?n.android=!0:new a("CrOS","").match(t)?n.chromeOS=!0:new a("iP[ao]d|iPhone","i").match(t)?n.iOS=!0:new a("Linux","").match(t)?n.linux=!0:new a("Mac OS","").match(t)?n.macOS=!0:new a("Windows","").match(t)&&(n.windows=!0),(new a("Windows Phone","i").match(t)||new a("IEMobile","i").match(t))&&(n.android=!1,n.iOS=!1,n.macOS=!1,n.windows=!0,n.windowsPhone=!0);var i=new a("Silk","").match(t);(n.windows||n.macOS||n.linux&&!i||n.chromeOS)&&(n.desktop=!0),(n.windowsPhone||new a("Windows NT","i").match(t)&&new a("Touch","i").match(t))&&(n.desktop=!1)},Hs.scaleAndCenter=function(e,t){var n=to.get_window().devicePixelRatio,i=to.get_window().innerWidth,r=to.get_window().innerHeight,a=t.max_game_width,s=t.max_game_height;null!=t.force_size&&(i=t.force_size.width,r=t.force_size.height,a=Math.round(i/r*s),n=1);var l=i*n,o=r*n,_=Hs.getGameWindowSize(l,o,t.min_game_width,t.min_game_height,a,s);t.current_game_width=Math.round(_.width),t.current_game_height=Math.round(_.height),t.canvas_game_width=Math.round(_.canvas_width),t.canvas_game_height=Math.round(_.canvas_height),t.device_scale=n,t.window_scale=_.scale,t.game_position=_.position,t.height_offset=t.game_position.y/t.window_scale,e.scale.x=t.window_scale,e.scale.y=t.window_scale,e.hitArea=new _s(-e.position.x/t.window_scale,-e.position.y/t.window_scale,t.current_game_width,t.current_game_height),Xs.renderer.resize(t.canvas_game_width,t.canvas_game_height),Xs.renderer.render(Xs.game);for(var p=0,u=t.scale_listeners;p<u.length;){var h=u[p];++p,h()}t.gamecanvas.style.width=Math.round(t.canvas_game_width/n)+"px",t.gamecanvas.style.height=Math.round(t.canvas_game_height/n)+"px",t.last_scale_date=new Date,t.scale_count++,xl.trace("window_width:"+l+", window_height:"+o+", scale:"+t.window_scale+" (current_game_width:"+t.current_game_width+", current_game_height:"+t.current_game_height+")",{fileName:"TopDo.hx",lineNumber:725,className:"bikas.top.TopDo",methodName:"scaleAndCenter"})},Hs.getGameWindowSize=function(e,t,n,i,r,a){var s=e/t,l=n/a,o=r/a,_=pa.clamp(s,l,o),p=new xa;p.width=t*_,p.height=p.width/_;var u=a/p.height;p.width*=u,p.height*=u;var h=e/p.width,c=t/p.height;return p.scale=pa.min(h,c),s<n/i&&(p.height=1.3333333333333333*p.height/s),p.canvas_width=p.width*p.scale,p.canvas_height=p.height*p.scale,p},Hs.isInFullScreen=function(){var e=to.get_window().document;return null!=e&&!!(e.fullscreenElement||e.mozFullScreenElement||e.webkitFullscreenElement||e.msFullscreenElement)},Hs.requestFullScreen=function(){if(!Hs.isInFullScreen()&&null!=to.get_window().document&&null!=to.get_window().document.documentElement){var e=to.get_window().document.documentElement,t=null;null!=e.requestFullscreen?t=e.requestFullscreen:null!=e.mozRequestFullScreen?t=e.mozRequestFullScreen:null!=e.webkitRequestFullScreen?t=e.webkitRequestFullScreen:null!=e.msRequestFullscreen&&(t=e.msRequestFullscreen),null!=t&&t.call(e)}},Hs.update=function(e,t){var n=e.config,i=e.step,r=e.game;if(null!=i&&null!=n){if(null!=to.get_window().performance?i.time_now=to.get_window().performance.now():i.time_now=(new Date).getTime(),i.delta=i.time_now-i.time_last,null!=i.force_delta&&(i.delta=i.force_delta),i.delta>i.max_delta&&(i.delta=i.max_delta),i.delta>i.min_delta){if((0!=n.type||n.development.transitions_enabled)&&(null!=e.game_loader&&null!=e.game_loader.preloader_graphics&&Zs.updateTransitionOut(e.game_loader),null!=Xs.js_info&&null!=Xs.js_info.loader&&null!=Xs.js_info.loader.preloader_graphics&&Xs.js_info.loader.finished&&null!=Xs.pointer&&1==n.type&&3==n.release.sitelock_type&&Ya.updateAdblockWarning(Xs.js_info.loader.preloader_graphics,Xs.pointer)),null!=r){Gn.update(r,i),Ra.updatePointer(r.pointer),0<r.keyboard_keys_released.length&&r.keyboard_keys_released.splice(0,r.keyboard_keys_released.length);for(var a=0,s=Os.all_sound_loops;a<s.length;){var l=s[a];++a,ks.updateMusicPause(l)}for(var o=0,_=Os.all_music_loops;o<_.length;){var p=_[o];++o,ks.updateMusicPause(p)}}Xs.renderer.render(Xs.container),i.time_last=i.time_now}if(null!=e.top_scripts)for(var u=0,h=e.top_scripts;u<h.length;){var c=h[u];++u,c()}null!=to.get_window().performance?(i.game_update_time=to.get_window().performance.now()-i.time_now,i.game_update_time=Math.round(10*i.game_update_time)/10):i.game_update_time=(new Date).getTime()-i.time_now}},Hs.detectSpriteWithNoTexture=function(e){for(var t=0,n=e.children;t<n.length;){var i=n[t];if(++t,p.is(i,us)){var r=i;null==r.texture&&xl.trace("sprite with no texture: "+p.string(hn.getNameOfDisplayObjectWithParentNames(r)),{fileName:"TopDo.hx",lineNumber:923,className:"bikas.top.TopDo",methodName:"detectSpriteWithNoTexture"})}else p.is(i,ls)||p.is(i,hs)&&Hs.detectSpriteWithNoTexture(i)}};var Ys=function(e){switch(this.responseCount=0,"direct"!=e&&"organic"!=e&&"referral"!=e&&sl._raiseError("Campaign type has to be one of the Campaign::TYPE_* constant values.","Campaign.new"),this.type=e){case"direct":this.name="(direct)",this.source="(direct)",this.medium="(none)";break;case"organic":this.name="(organic)",this.medium="organic";break;case"referral":this.name="(referral)",this.medium="referral"}this.creationTime=new Qs};(n["googleAnalytics.Campaign"]=Ys).__name__=["googleAnalytics","Campaign"],Ys.createFromReferrer=function(e){var t=new Ys("referral"),n=new ol(e);return t.source=n.host,t.content=n.path,t},Ys.prototype={type:null,creationTime:null,responseCount:null,id:null,source:null,gClickId:null,dClickId:null,name:null,medium:null,term:null,content:null,validate:function(){null==this.source&&sl._raiseError('Campaigns need to have at least the "source" attribute defined.',"Campaign.validate")},setType:function(e){this.type=e},getType:function(){return this.type},setCreationTime:function(e){this.creationTime=e},getCreationTime:function(){return this.creationTime},setResponseCount:function(e){this.responseCount=e},getResponseCount:function(){return this.responseCount},increaseResponseCount:function(e){null==e&&(e=1),this.responseCount+=e},setId:function(e){this.id=e},getId:function(){return this.id},setSource:function(e){this.source=e},getSource:function(){return this.source},setGClickId:function(e){this.gClickId=e},getGClickId:function(){return this.gClickId},setDClickId:function(e){this.dClickId=e},getDClickId:function(){return this.dClickId},setName:function(e){this.name=e},getName:function(){return this.name},setMedium:function(e){this.medium=e},getMedium:function(){return this.medium},setTerm:function(e){this.term=e},getTerm:function(){return this.term},setContent:function(e){this.content=e},getContent:function(){return this.content},__class__:Ys};var Js=function(e){null==e&&(e=!1),this.sitespeedSampleRate=1,this.endPointPath="/__utm.gif",this.endPointHost="www.google-analytics.com",this.urlScheme="http",this.requestTimeout=1,this.fireAndForget=!1,this.sendOnShutdown=!1,this.errorSeverity=2,this.setUrlScheme("http"+(e?"s":""))};(n["googleAnalytics.Config"]=Js).__name__=["googleAnalytics","Config"],Js.prototype={errorSeverity:null,sendOnShutdown:null,fireAndForget:null,loggingCallback:null,requestTimeout:null,urlScheme:null,endPointHost:null,endPointPath:null,sitespeedSampleRate:null,getErrorSeverity:function(){return this.errorSeverity},setErrorSeverity:function(e){this.errorSeverity=e},getSendOnShutdown:function(){return this.sendOnShutdown},setSendOnShutdown:function(e){this.sendOnShutdown=e},getFireAndForget:function(){return this.fireAndForget},setFireAndForget:function(e){this.fireAndForget=e},getLoggingCallback:function(){return this.loggingCallback},setLoggingCallback:function(e){this.loggingCallback=e},getRequestTimeout:function(){return this.requestTimeout},setRequestTimeout:function(e){this.requestTimeout=e},getUrlScheme:function(){return this.urlScheme},setUrlScheme:function(e){return this.urlScheme=e},getEndPointHost:function(){return this.endPointHost},setEndPointHost:function(e){this.endPointHost=e},getEndPointPath:function(){return this.endPointPath},setEndPointPath:function(e){this.endPointPath=e},getSitespeedSampleRate:function(){return this.sitespeedSampleRate},setSitespeedSampleRate:function(e){e<0||100<e?sl._raiseError("For consistency with ga.js, sample rates must be specified as a number between 0 and 100.","config.setSitespeedSampleRate"):this.sitespeedSampleRate=e},__class__:Js};var Ks=function(e,t,n,i){null==i&&(i=0),null==e&&(e=0),this.scope=3,0!=e&&this.setIndex(e),null!=t&&this.setName(t),null!=n&&this.setValue(n),0!=i&&this.setScope(i)};(n["googleAnalytics.CustomVariable"]=Ks).__name__=["googleAnalytics","CustomVariable"],Ks.prototype={index:null,name:null,value:null,scope:null,validate:function(){128<(this.name+p.string(this.value)).length&&sl._raiseError("Custom Variable combined name and value length must not be larger than 128 bytes.","CustomVariable.validate")},getIndex:function(){return this.index},setIndex:function(e){(e<1||5<e)&&sl._raiseError("Custom Variable index has to be between 1 and 5.","CustomVariable.setIndex"),this.index=e},getName:function(){return this.name},setName:function(e){this.name=e},getValue:function(){return this.value},setValue:function(e){this.value=e},getScope:function(){return this.scope},setScope:function(e){3!=e&&2!=e&&1!=e&&sl._raiseError("Custom Variable scope has to be one of the CustomVariable::SCOPE_* constant values.","CustomVariable.setScope"),this.scope=e},__class__:Ks};var Qs=function(e){this.date=null==e?Math.round((new Date).getTime())+"":e};(n["googleAnalytics.DateTime"]=Qs).__name__=["googleAnalytics","DateTime"],Qs.prototype={date:null,toString:function(){return this.date},__class__:Qs};var $s=function(e,t,n,i,r){null==r&&(r=!1),null==i&&(i=0),this.noninteraction=!1,null!=e&&this.setCategory(e),null!=t&&this.setAction(t),null!=n&&this.setLabel(n),this.setValue(i),this.setNoninteraction(r)};(n["googleAnalytics.Event"]=$s).__name__=["googleAnalytics","Event"],$s.prototype={category:null,action:null,label:null,value:null,noninteraction:null,validate:function(){null!=this.category&&null!=this.action||sl._raiseError("Events need at least to have a category and action defined.","Event.validate")},getCategory:function(){return this.category},setCategory:function(e){this.category=e},getAction:function(){return this.action},setAction:function(e){this.action=e},getLabel:function(){return this.label},setLabel:function(e){this.label=e},getValue:function(){return this.value},setValue:function(e){this.value=e},getNoninteraction:function(){return this.noninteraction},setNoninteraction:function(e){this.noninteraction=e},__class__:$s};var el=function(){this.quantity=1};(n["googleAnalytics.Item"]=el).__name__=["googleAnalytics","Item"],el.prototype={orderId:null,sku:null,name:null,variation:null,price:null,quantity:null,validate:function(){null==this.sku&&sl._raiseError("Items need to have a sku/product code defined.","Item.validate")},getOrderId:function(){return this.orderId},setOrderId:function(e){this.orderId=e},getSku:function(){return this.sku},setSku:function(e){this.sku=e},getName:function(){return this.name},setName:function(e){this.name=e},getVariation:function(){return this.variation},setVariation:function(e){this.variation=e},getPrice:function(){return this.price},setPrice:function(e){this.price=e},getQuantity:function(){return this.quantity},setQuantity:function(e){this.quantity=e},__class__:el};var tl=function(e){this.setPath(e)};(n["googleAnalytics.Page"]=tl).__name__=["googleAnalytics","Page"],tl.prototype={path:null,title:null,charset:null,referrer:null,loadTime:null,setPath:function(e){null!=e&&"/"!=e.charAt(0)&&sl._raiseError('The page path should always start with a slash ("/").',"Page.setPath"),this.path=e},getPath:function(){return this.path},setTitle:function(e){this.title=e},getTitle:function(){return this.title},setCharset:function(e){this.charset=e},getCharset:function(){return this.charset},setReferrer:function(e){this.referrer=e},getReferrer:function(){return this.referrer},setLoadTime:function(e){this.loadTime=e},getLoadTime:function(){return this.loadTime},__class__:tl};var nl=function(){this.setSessionId(this.generateSessionId()),this.setTrackCount(0),this.setStartTime(new Qs)};(n["googleAnalytics.Session"]=nl).__name__=["googleAnalytics","Session"],nl.prototype={sessionId:null,trackCount:null,startTime:null,fromUtmb:function(e){var t=e.split(".");return 4!=t.length?sl._raiseError('The given "__utmb" cookie value is invalid.',"Session.fromUtmb"):(this.setTrackCount(ul.parseInt(t[1],0)),this.setStartTime(new Qs(t[3]))),this},generateSessionId:function(){return ul.generate32bitRandom()},getSessionId:function(){return this.sessionId},setSessionId:function(e){this.sessionId=e},getTrackCount:function(){return this.trackCount},setTrackCount:function(e){this.trackCount=e},increaseTrackCount:function(e){null==e&&(e=1),this.trackCount+=e},getStartTime:function(){return this.startTime},setStartTime:function(e){this.startTime=e},__class__:nl};var il=function(e,t,n){null!=e&&this.setNetwork(e),null!=t&&this.setAction(t),null!=n&&this.setTarget(n)};(n["googleAnalytics.SocialInteraction"]=il).__name__=["googleAnalytics","SocialInteraction"],il.prototype={network:null,action:null,target:null,validate:function(){null!=this.network&&null!=this.action||sl._raiseError('Social interactions need to have at least the "network" and "action" attributes defined.',"SocialInteraction.validate")},setNetwork:function(e){this.network=e},getNetwork:function(){return this.network},setAction:function(e){this.action=e},getAction:function(){return this.action},setTarget:function(e){this.target=e},getTarget:function(){return this.target},__class__:il};var rl=function(){};(n["googleAnalytics.Stats"]=rl).__name__=["googleAnalytics","Stats"],rl.init=function(e,t,n){null==n&&(n=!1),null==rl.accountId&&(rl.accountId=e,rl.domainName=t,rl.tracker=new sl(e,t,new Js(n)),rl.cache=new Al,rl.session=new nl,rl.loadVisitor())},rl.trackPageview=function(e,t){var n="page:"+e;if(!rl.cache.exists(n)){var i=new tl(e);null!=t&&i.setTitle(t),rl.cache.set(n,new al(i,null))}rl.track(n)},rl.trackEvent=function(e,t,n,i){null==i&&(i=0);var r="event:"+e+"/"+t+"/"+n+":"+i;rl.cache.exists(r)||rl.cache.set(r,new al(null,new $s(e,t,n,i))),rl.track(r)},rl.track=function(e){rl.paused||(rl.cache.get(e).track(rl.tracker,rl.visitor,rl.session),rl.persistVisitor())},rl.pause=function(){rl.paused=!0},rl.resume=function(){rl.paused=!1},rl.loadVisitor=function(){rl.visitor=new _l,rl.visitor.setUserAgent("-not-set- [haxe]"),rl.visitor.setScreenResolution("1024x768"),rl.visitor.setLocale("en_US"),rl.visitor.getUniqueId(),rl.visitor.addSession(rl.session),rl.persistVisitor()},rl.persistVisitor=function(){};var al=function(e,t){this.page=e,this.event=t};(n["googleAnalytics._Stats.GATrackObject"]=al).__name__=["googleAnalytics","_Stats","GATrackObject"],al.prototype={event:null,page:null,track:function(e,t,n){null!=this.page&&e.trackPageview(this.page,n,t),null!=this.event&&e.trackEvent(this.event,n,t)},__class__:al};var sl=function(e,t,n){this.allowHash=!0,this.customVariables=[],sl.setConfig(null!=n?n:new Js),this.setAccountId(e),this.setDomainName(t)};(n["googleAnalytics.Tracker"]=sl).__name__=["googleAnalytics","Tracker"],sl.getConfig=function(){return sl.config},sl.setConfig=function(e){sl.config=e},sl._raiseError=function(e,t){switch(e=t+"(): "+e,null!=sl.config?sl.config.getErrorSeverity():0){case 0:break;case 1:xl.trace(e,{fileName:"Tracker.hx",lineNumber:253,className:"googleAnalytics.Tracker",methodName:"_raiseError"});break;case 2:throw new $l(e)}},sl.prototype={accountId:null,domainName:null,allowHash:null,customVariables:null,campaign:null,setAccountId:function(e){new a("^(UA|MO)-[0-9]*-[0-9]*$","").match(e)||sl._raiseError('"'+e+'" is not a valid Google Analytics account ID.',"Tracker.setAccountId"),this.accountId=e},getAccountId:function(){return this.accountId},setDomainName:function(e){this.domainName=e},getDomainName:function(){return this.domainName},setAllowHash:function(e){this.allowHash=e},getAllowHash:function(){return this.allowHash},addCustomVariable:function(e){e.validate(),this.customVariables[e.getIndex()]=e},getCustomVariables:function(){return this.customVariables},removeCustomVariable:function(e){s.remove(this.customVariables,this.customVariables[e])},setCampaign:function(e){null!=e&&e.validate(),this.campaign=e},getCampaign:function(){return this.campaign},trackPageview:function(e,t,n){var i=new fl(sl.config);i.setPage(e),i.setSession(t),i.setVisitor(n),i.setTracker(this),i.send()},trackEvent:function(e,t,n){e.validate();var i=new dl(sl.config);i.setEvent(e),i.setSession(t),i.setVisitor(n),i.setTracker(this),i.send()},trackTransaction:function(e,t,n){e.validate();var i=new vl(sl.config);i.setTransaction(e),i.setSession(t),i.setVisitor(n),i.setTracker(this),i.send();for(var r=e.getItems().iterator();r.hasNext();){var a=r.next();a.validate();var s=new ml(sl.config);s.setItem(a),s.setSession(t),s.setVisitor(n),s.setTracker(this),s.send()}},trackSocial:function(e,t,n,i){var r=new gl(sl.config);r.setSocialInteraction(e),r.setPage(t),r.setSession(n),r.setVisitor(i),r.setTracker(this),r.send()},__class__:sl};var ll=function(){this.items=new Al};(n["googleAnalytics.Transaction"]=ll).__name__=["googleAnalytics","Transaction"],ll.prototype={orderId:null,affiliation:null,total:null,tax:null,shipping:null,city:null,region:null,country:null,items:null,validate:function(){null==this.items&&sl._raiseError("Transactions need to consist of at least one item.","Transaction.validate")},addItem:function(e){e.setOrderId(this.orderId),this.items.set(e.getSku(),e)},getItems:function(){return this.items},getOrderId:function(){return this.orderId},setOrderId:function(e){this.orderId=e;for(var t=this.items.iterator();t.hasNext();)t.next().setOrderId(e)},getAffiliation:function(){return this.affiliation},setAffiliation:function(e){this.affiliation=e},getTotal:function(){return this.total},setTotal:function(e){this.total=e},getTax:function(){return this.tax},setTax:function(e){this.tax=e},getShipping:function(){return this.shipping},setShipping:function(e){this.shipping=e},getCity:function(){return this.city},setCity:function(e){this.city=e},getRegion:function(){return this.region},setRegion:function(e){this.region=e},getCountry:function(){return this.country},setCountry:function(e){this.country=e},__class__:ll};var ol=function(e){this.url=e;var t=new a("^(?:(?![^:@]+:[^:@/]*@)([^:/?#.]+):)?(?://)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:/?#]*)(?::(\\d*))?)(((/(?:[^?#](?![^?#/]*\\.[^?#/.]+(?:[?#]|$)))*/?)?([^?#/]*))(?:\\?([^#]*))?(?:#(.*))?)","");t.match(e);for(var n=0,i=ol.parts.length;n<i;){var r=n++;_.setField(this,ol.parts[r],t.matched(r))}};(n["googleAnalytics.URLParser"]=ol).__name__=["googleAnalytics","URLParser"],ol.parse=function(e){return new ol(e)},ol.prototype={url:null,source:null,protocol:null,authority:null,userInfo:null,user:null,password:null,host:null,port:null,relative:null,path:null,directory:null,file:null,query:null,anchor:null,toString:function(){for(var e="For Url -> "+this.url+"\n",t=0,n=ol.parts.length;t<n;){var i=t++;e+=ol.parts[i]+": "+p.string(_.field(this,ol.parts[i]))+(i==ol.parts.length-1?"":"\n")}return e},__class__:ol};var _l=function(){var e=new Qs;this.uniqueId=0,this.setFirstVisitTime(e),this.setPreviousVisitTime(e),this.setCurrentVisitTime(e),this.setVisitCount(1)};(n["googleAnalytics.Visitor"]=_l).__name__=["googleAnalytics","Visitor"],_l.prototype={uniqueId:null,firstVisitTime:null,previousVisitTime:null,currentVisitTime:null,visitCount:null,ipAddress:null,userAgent:null,locale:null,flashVersion:null,javaEnabled:null,screenColorDepth:null,screenResolution:null,fromUtma:function(e){var t=e.split(".");return 6!=t.length?sl._raiseError('The given "__utma" cookie value is invalid.',"Visitor.fromUtma"):(this.setUniqueId(ul.parseInt(t[1],0)),this.setFirstVisitTime(new Qs(t[2])),this.setPreviousVisitTime(new Qs(t[3])),this.setCurrentVisitTime(new Qs(t[4])),this.setVisitCount(ul.parseInt(t[5],0))),this},generateHash:function(){return ul.generateHash(this.userAgent+this.screenResolution+this.screenColorDepth)},generateUniqueId:function(){return 2147483647&(ul.generate32bitRandom()^this.generateHash())},setUniqueId:function(e){(e<0||2147483647<e)&&sl._raiseError("Visitor unique ID has to be a 32-bit integer between 0 and 2147483647.","Visitor.setUniqueId"),this.uniqueId=e},getUniqueId:function(){return 0==this.uniqueId&&(this.uniqueId=this.generateUniqueId()),this.uniqueId},addSession:function(e){var t=e.getStartTime();t!=this.currentVisitTime&&(this.previousVisitTime=this.currentVisitTime,this.currentVisitTime=t,++this.visitCount)},setFirstVisitTime:function(e){this.firstVisitTime=e},getFirstVisitTime:function(){return this.firstVisitTime},setPreviousVisitTime:function(e){this.previousVisitTime=e},getPreviousVisitTime:function(){return this.previousVisitTime},setCurrentVisitTime:function(e){this.currentVisitTime=e},getCurrentVisitTime:function(){return this.currentVisitTime},setVisitCount:function(e){this.visitCount=e},getVisitCount:function(){return this.visitCount},setIpAddress:function(e){this.ipAddress=e},getIpAddress:function(){return this.ipAddress},setUserAgent:function(e){this.userAgent=e},getUserAgent:function(){return this.userAgent},setLocale:function(e){this.locale=e},getLocale:function(){return this.locale},setFlashVersion:function(e){this.flashVersion=e},getFlashVersion:function(){return this.flashVersion},setJavaEnabled:function(e){this.javaEnabled=e},getJavaEnabled:function(){return this.javaEnabled},setScreenColorDepth:function(e){this.screenColorDepth=e},getScreenColorDepth:function(){return this.screenColorDepth},setScreenResolution:function(e){this.screenResolution=e},getScreenResolution:function(){return this.screenResolution},__class__:_l};var pl=function(){this.utmwv="5.2.5",this.utmr=this.utmcs=this.utmfl=this.utmje="0"};(n["googleAnalytics.internals.ParameterHolder"]=pl).__name__=["googleAnalytics","internals","ParameterHolder"],pl.prototype={utmwv:null,utmac:null,utmhn:null,utmvid:null,utmt:null,utms:null,utmn:null,utmcc:null,utme:null,utmni:null,utmu:null,utmp:null,utmdt:null,utmcs:null,utmr:null,utmip:null,utmul:null,utmfl:null,utmje:null,utmsc:null,utmsr:null,__utma:null,utmhid:null,__utmb:null,__utmc:null,utmipc:null,utmipn:null,utmipr:null,utmiqt:null,utmiva:null,utmtid:null,utmtst:null,utmtto:null,utmttx:null,utmtsp:null,utmtci:null,utmtrg:null,utmtco:null,utmcn:null,utmcr:null,utmcid:null,utmcsr:null,utmgclid:null,utmdclid:null,utmccn:null,utmcmd:null,utmctr:null,utmcct:null,utmcvr:null,__utmz:null,utmsn:null,utmsa:null,utmsid:null,__utmx:null,__utmv:null,toHashTable:function(){for(var e=new Al,t=0,n=d.getInstanceFields(pl);t<n.length;){var i=n[t];++t,"_"==i.charAt(0)||_.isFunction(_.field(this,i))||e.set(i,_.field(this,i))}return e},toQueryString:function(){for(var e="",t=0,n=d.getInstanceFields(pl);t<n.length;){var i=n[t];++t,"_"==i.charAt(0)||_.isFunction(_.field(this,i))||null==_.field(this,i)||"null"==_.field(this,i)||(e+=i+"="+h.replace(p.string(_.field(this,i))+"","&","%26")+"&")}return e},__class__:pl};var ul=function(){};(n["googleAnalytics.internals.Util"]=ul).__name__=["googleAnalytics","internals","Util"],ul.encodeUriComponent=function(e){return ul.convertToUriComponentEncoding(h.urlEncode(e))},ul.stringReplaceArray=function(e,t,n){for(var i=0,r=t.length;i<r;){var a=i++;null!=t[a]&&(e=h.replace(e+" ",t[a],n[a]))}return h.trim(e)},ul.parseInt=function(e,t){return null==e?t:p.parseInt(e)},ul.convertToUriComponentEncoding=function(e){return ul.stringReplaceArray(e,["!","*","'","(",")"," ","+"],["%21","%2A","%27","%28","%29","%20","%20"])},ul.generate32bitRandom=function(){return Math.round(2147483647*Math.random())},ul.generateHash=function(e){var t,n,i=1;if(null!=e&&""!=e){i=0;for(var r=e.length-1;0<=r;)0!=(n=266338304&(i=(i<<6&268435455)+(t=s.cca(e,r))+(t<<14)))&&(i^=n>>21),--r}return i};var hl=function(){this.projectData=new Al,this.KEY="k",this.VALUE="v",this.SET=["k","v"],this.DELIM_BEGIN="(",this.DELIM_END=")",this.DELIM_SET="*",this.DELIM_NUM_VALUE="!",this.MINIMUM=1,this.ESCAPE_CHAR_MAP=new Al,this.ESCAPE_CHAR_MAP.set("'","'0"),this.ESCAPE_CHAR_MAP.set(")","'1"),this.ESCAPE_CHAR_MAP.set("*","'2"),this.ESCAPE_CHAR_MAP.set("!","'3")};(n["googleAnalytics.internals.X10"]=hl).__name__=["googleAnalytics","internals","X10"],hl.prototype={projectData:null,KEY:null,VALUE:null,SET:null,DELIM_BEGIN:null,DELIM_END:null,DELIM_SET:null,DELIM_NUM_VALUE:null,ESCAPE_CHAR_MAP:null,MINIMUM:null,hasProject:function(e){return this.projectData.exists(e)},setKey:function(e,t,n){this.setInternal(e,this.KEY,t,n)},getKey:function(e,t){return this.getInternal(e,this.KEY,t)},clearKey:function(e){this.clearInternal(e,this.KEY)},setValue:function(e,t,n){this.setInternal(e,this.VALUE,t,n)},getValue:function(e,t){return this.getInternal(e,this.VALUE,t)},clearValue:function(e){this.clearInternal(e,this.VALUE)},setInternal:function(e,t,n,i){this.projectData.exists(e)||this.projectData.set(e,new Al);var r=this.projectData.get(e);r.exists(t)||r.set(t,[]),r.get(t)[n]=i},getInternal:function(e,t,n){if(!this.projectData.exists(e))return null;var i=this.projectData.get(e);if(!i.exists(t))return null;var r=i.get(t);return null==r[n]?null:r[n]},clearInternal:function(e,t){this.projectData.exists(e)&&this.projectData.get(e).exists(t)&&this.projectData.get(e).remove(t)},escapeExtensibleValue:function(e){for(var t="",n=0,i=e.length;n<i;){var r=n++,a=e.charAt(r);this.ESCAPE_CHAR_MAP.exists(a)?t+=this.ESCAPE_CHAR_MAP.get(a):t+=a}return t},SORT_NUMERIC:function(e,t){return e==t?0:t<e?1:-1},renderDataType:function(e){for(var t=[],n=0,i=0,r=e.length;i<r;){var a=i++,s=e[a];if(null!=s){var l="";a!=this.MINIMUM&&a-1!=n&&(l+=a,l+=this.DELIM_NUM_VALUE),l+=this.escapeExtensibleValue(s),t.push(l)}n=a}return this.DELIM_BEGIN+t.join(this.DELIM_SET)+this.DELIM_END},renderProject:function(e){for(var t="",n=!1,i=0,r=this.SET.length;i<r;){var a=i++;n=!e.exists(this.SET[a])||(n&&(t+=this.SET[a]),t+=this.renderDataType(e.get(this.SET[a])),!1)}return t},renderUrlString:function(){for(var e="",t=this.projectData.keys();t.hasNext();){var n=t.next();e+=n+this.renderProject(this.projectData.get(n))}return e},__class__:hl};var cl=function(e){this.setConfig(null!=e?e:new Js)};(n["googleAnalytics.internals.request.Request"]=cl).__name__=["googleAnalytics","internals","request","Request"],cl.onError=function(e){},cl.prototype={type:null,config:null,userAgent:null,tracker:null,visitor:null,session:null,getConfig:function(){return this.config},setConfig:function(e){this.config=e},setUserAgent:function(e){this.userAgent=e},getTracker:function(){return this.tracker},setTracker:function(e){this.tracker=e},getVisitor:function(){return this.visitor},setVisitor:function(e){this.visitor=e},getSession:function(){return this.session},setSession:function(e){this.session=e},increaseTrackCount:function(){this.session.increaseTrackCount(),500<this.session.getTrackCount()&&sl._raiseError("Google Analytics does not guarantee to process more than 500 requests per session.","Request.buildHttpRequest"),null!=this.tracker.getCampaign()&&this.tracker.getCampaign().increaseResponseCount()},send:function(){if(null!=this.config.getEndPointHost()){var e=this.buildParameters();null!=this.visitor&&(this.setUserAgent(this.visitor.getUserAgent()),e.utmvid=this.visitor.getUniqueId());var t=ul.convertToUriComponentEncoding(e.toQueryString()),n=this.config.getUrlScheme()+"://"+this.config.getEndPointHost()+this.config.getEndPointPath()+"?"+t;this.increaseTrackCount(),(new Image).src=n}},getType:function(){return null},buildParameters:function(){var e=new pl;return e.utmac=this.tracker.getAccountId(),e.utmhn=this.tracker.getDomainName(),e.utmt=""+this.getType(),e.utmn=ul.generate32bitRandom(),e.utmip=this.visitor.getIpAddress(),e.utmhid=this.session.getSessionId(),e.utms=this.session.getTrackCount(),e=this.buildVisitorParameters(e),e=this.buildCustomVariablesParameter(e),e=this.buildCampaignParameters(e),e=this.buildCookieParameters(e)},buildVisitorParameters:function(e){return null!=this.visitor.getLocale()&&(e.utmul=h.replace(this.visitor.getLocale(),"_","-").toLowerCase()),null!=this.visitor.getFlashVersion()&&(e.utmfl=this.visitor.getFlashVersion()),e.utmje=this.visitor.getJavaEnabled()?"1":"0",null!=this.visitor.getScreenColorDepth()&&(e.utmsc=this.visitor.getScreenColorDepth()+"-bit"),e.utmsr=this.visitor.getScreenResolution(),e},buildCustomVariablesParameter:function(e){var t=this.tracker.getCustomVariables();if(null==t)return e;5<t.length&&sl._raiseError("The sum of all custom variables cannot exceed 5 in any given request.","Request.buildCustomVariablesParameter");var n,i,r=new hl;r.clearKey("8"),r.clearKey("9"),r.clearKey("11");for(var a=0;a<t.length;){var s=t[a];++a,n=ul.encodeUriComponent(s.getName()),i=ul.encodeUriComponent(s.getValue()),r.setKey("8",s.getIndex(),n),r.setKey("9",s.getIndex(),i),3!=s.getScope()&&r.setKey("11",s.getIndex(),s.getScope())}var l=r.renderUrlString();return null!=l&&(null==e.utme?e.utme=l:e.utme+=l),e},buildCookieParameters:function(e){var t=this.generateDomainHash();e.__utma=t+".",e.__utma+=this.visitor.getUniqueId()+".",e.__utma+=this.visitor.getFirstVisitTime().toString()+".",e.__utma+=this.visitor.getPreviousVisitTime().toString()+".",e.__utma+=this.visitor.getCurrentVisitTime().toString()+".",e.__utma+=this.visitor.getVisitCount(),e.__utmb=t+".",e.__utmb+=this.session.getTrackCount()+".",e.__utmb+="10.",e.__utmb+=this.session.getStartTime().toString(),e.__utmc=t;var n="__utma="+e.__utma+";";return null!=e.__utmz&&(n+="+__utmz="+e.__utmz+";"),null!=e.__utmv&&(n+="+__utmv="+e.__utmv+";"),e.utmcc=n,e},buildCampaignParameters:function(e){var t=this.tracker.getCampaign();if(null==t)return e;e.__utmz=this.generateDomainHash()+".",e.__utmz+=t.getCreationTime().toString()+".",e.__utmz+=this.visitor.getVisitCount()+".",e.__utmz+=t.getResponseCount()+".";var n="utmcid="+t.getId()+"|utmcsr="+t.getSource()+"|utmgclid="+t.getGClickId()+"|utmdclid="+t.getDClickId()+"|utmccn="+t.getName()+"|utmcmd="+t.getMedium()+"|utmctr="+t.getTerm()+"|utmcct="+t.getContent();return e.__utmz+=h.replace(h.replace(n,"+","%20")," ","%20"),e},generateDomainHash:function(){var e=1;return this.tracker.getAllowHash()&&(e=ul.generateHash(this.tracker.getDomainName())),e},__class__:cl};var dl=function(e){cl.call(this,e)};(n["googleAnalytics.internals.request.EventRequest"]=dl).__name__=["googleAnalytics","internals","request","EventRequest"],dl.__super__=cl,dl.prototype=r(cl.prototype,{event:null,getType:function(){return"event"},buildParameters:function(){var e=cl.prototype.buildParameters.call(this),t=new hl;t.clearKey("5"),t.clearValue("5"),t.setKey("5",1,this.event.getCategory()),t.setKey("5",2,this.event.getAction()),null!=this.event.getLabel()&&t.setKey("5",3,this.event.getLabel()),0!=this.event.getValue()&&t.setValue("5",1,this.event.getValue());var n=t.renderUrlString();return null!=n&&(null==e.utme?e.utme=n:e.utme+=n),this.event.getNoninteraction()&&(e.utmni=1),e},getEvent:function(){return this.event},setEvent:function(e){this.event=e},__class__:dl});var ml=function(e){cl.call(this,e)};(n["googleAnalytics.internals.request.ItemRequest"]=ml).__name__=["googleAnalytics","internals","request","ItemRequest"],ml.__super__=cl,ml.prototype=r(cl.prototype,{item:null,getType:function(){return"item"},buildParameters:function(){var e=cl.prototype.buildParameters.call(this);return e.utmtid=this.item.getOrderId(),e.utmipc=this.item.getSku(),e.utmipn=this.item.getName(),e.utmiva=this.item.getVariation(),e.utmipr=this.item.getPrice(),e.utmiqt=this.item.getQuantity(),e},buildVisitorParameters:function(e){return e},buildCustomVariablesParameter:function(e){return e},getItem:function(){return this.item},setItem:function(e){this.item=e},__class__:ml});var fl=function(e){cl.call(this,e)};(n["googleAnalytics.internals.request.PageviewRequest"]=fl).__name__=["googleAnalytics","internals","request","PageviewRequest"],fl.__super__=cl,fl.prototype=r(cl.prototype,{page:null,getType:function(){return null},buildParameters:function(){var e=cl.prototype.buildParameters.call(this);return e.utmp=this.page.getPath(),e.utmdt=this.page.getTitle(),null!=this.page.getCharset()&&(e.utmcs=this.page.getCharset()),null!=this.page.getReferrer()&&(e.utmr=this.page.getReferrer()),0!=this.page.getLoadTime()&&e.utmn%100<this.config.getSitespeedSampleRate()&&(null==e.utme?e.utme="0":e.utme+=0),e},getPage:function(){return this.page},setPage:function(e){this.page=e},__class__:fl});var gl=function(e){fl.call(this,e)};(n["googleAnalytics.internals.request.SocialInteractionRequest"]=gl).__name__=["googleAnalytics","internals","request","SocialInteractionRequest"],gl.__super__=fl,gl.prototype=r(fl.prototype,{socialInteraction:null,getType:function(){return"social"},buildParameters:function(){var e=fl.prototype.buildParameters.call(this);return e.utmsn=this.socialInteraction.getNetwork(),e.utmsa=this.socialInteraction.getAction(),e.utmsid=this.socialInteraction.getTarget(),null==e.utmsid&&(e.utmsid=this.page.getPath()),e},getSocialInteraction:function(){return this.socialInteraction},setSocialInteraction:function(e){this.socialInteraction=e},__class__:gl});var vl=function(e){cl.call(this,e)};(n["googleAnalytics.internals.request.TransactionRequest"]=vl).__name__=["googleAnalytics","internals","request","TransactionRequest"],vl.__super__=cl,vl.prototype=r(cl.prototype,{transaction:null,getType:function(){return"tran"},buildParameters:function(){var e=cl.prototype.buildParameters.call(this);return e.utmtid=this.transaction.getOrderId(),e.utmtst=this.transaction.getAffiliation(),e.utmtto=this.transaction.getTotal(),e.utmttx=this.transaction.getTax(),e.utmtsp=this.transaction.getShipping(),e.utmtci=this.transaction.getCity(),e.utmtrg=this.transaction.getRegion(),e.utmtco=this.transaction.getCountry(),e},buildVisitorParameters:function(e){return e},buildCustomVariablesParameter:function(e){return e},getTransaction:function(){return this.transaction},setTransaction:function(e){this.transaction=e},__class__:vl});var bl=function(){};(n["haxe.IMap"]=bl).__name__=["haxe","IMap"];var yl=function(e,t){this.high=e,this.low=t};(n["haxe._Int64.___Int64"]=yl).__name__=["haxe","_Int64","___Int64"],yl.prototype={high:null,low:null,__class__:yl};var xl=function(){};(n["haxe.Log"]=xl).__name__=["haxe","Log"],xl.trace=function(e,t){eo.__trace(e,t)};var zl=function(e){var t=this;this.id=setInterval((function(){t.run()}),e)};(n["haxe.Timer"]=zl).__name__=["haxe","Timer"],zl.delay=function(e,t){var n=new zl(t);return n.run=function(){n.stop(),e()},n},zl.prototype={id:null,stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:zl};var wl=function(){this.a1=1,this.a2=0};(n["haxe.crypto.Adler32"]=wl).__name__=["haxe","crypto","Adler32"],wl.read=function(e){var t=new wl,n=e.readByte(),i=e.readByte(),r=e.readByte(),a=e.readByte();return t.a1=r<<8|a,t.a2=n<<8|i,t},wl.prototype={a1:null,a2:null,update:function(e,t,n){for(var i=this.a1,r=this.a2,a=t,s=t+n;a<s;){var l=a++;r=(r+(i=(i+e.get(l))%65521))%65521}this.a1=i,this.a2=r},equals:function(e){return e.a1==this.a1&&e.a2==this.a2},__class__:wl};var kl=function(e){this.length=e.byteLength,this.b=new Tc(e),(this.b.bufferValue=e).hxBytes=this,e.bytes=this.b};(n["haxe.io.Bytes"]=kl).__name__=["haxe","io","Bytes"],kl.alloc=function(e){return new kl(new Pc(e))},kl.ofString=function(e){for(var t=[],n=0;n<e.length;){var i=h.fastCodeAt(e,n++);55296<=i&&i<=56319&&(i=i-55232<<10|1023&h.fastCodeAt(e,n++)),i<=127?t.push(i):(i<=2047?t.push(192|i>>6):(i<=65535?t.push(224|i>>12):(t.push(240|i>>18),t.push(128|i>>12&63)),t.push(128|i>>6&63)),t.push(128|63&i))}return new kl(new Tc(t).buffer)},kl.ofData=function(e){var t=e.hxBytes;return null!=t?t:new kl(e)},kl.fastGet=function(e,t){return e.bytes[t]},kl.prototype={length:null,b:null,data:null,get:function(e){return this.b[e]},set:function(e,t){this.b[e]=255&t},blit:function(e,t,n,i){if(e<0||n<0||i<0||e+i>this.length||n+i>t.length)throw new $l(Bl.OutsideBounds);0==n&&i==t.b.byteLength?this.b.set(t.b,e):this.b.set(t.b.subarray(n,n+i),e)},initData:function(){null==this.data&&(this.data=new Ic(this.b.buffer,this.b.byteOffset,this.b.byteLength))},getDouble:function(e){return this.initData(),this.data.getFloat64(e,!0)},setDouble:function(e,t){this.initData(),this.data.setFloat64(e,t,!0)},getUInt16:function(e){return this.initData(),this.data.getUint16(e,!0)},setUInt16:function(e,t){this.initData(),this.data.setUint16(e,t,!0)},getString:function(e,t){if(e<0||t<0||e+t>this.length)throw new $l(Bl.OutsideBounds);for(var n="",i=this.b,r=String.fromCharCode,a=e,s=e+t;a<s;){var l=i[a++];if(l<128){if(0==l)break;n+=r(l)}else if(l<224)n+=r((63&l)<<6|127&i[a++]);else if(l<240)n+=r((31&l)<<12|(127&i[a++])<<6|127&i[a++]);else{var o=(15&l)<<18|(127&i[a++])<<12|(127&i[a++])<<6|127&i[a++];n+=r(55232+(o>>10)),n+=r(1023&o|56320)}}return n},toString:function(){return this.getString(0,this.length)},__class__:kl};var Sl=function(){};(n["haxe.crypto.Base64"]=Sl).__name__=["haxe","crypto","Base64"],Sl.encode=function(e,t){null==t&&(t=!0);var n=new Cl(Sl.BYTES).encodeBytes(e).toString();if(t)switch(e.length%3){case 1:n+="==";break;case 2:n+="="}return n},Sl.decode=function(e,t){if(null==t&&(t=!0),t)for(;61==s.cca(e,e.length-1);)e=s.substr(e,0,-1);return new Cl(Sl.BYTES).decodeBytes(kl.ofString(e))};var Cl=function(e){for(var t=e.length,n=1;1<<n<t;)++n;if(8<n||t!=1<<n)throw new $l("BaseCode : base length must be a power of two.");this.base=e,this.nbits=n};(n["haxe.crypto.BaseCode"]=Cl).__name__=["haxe","crypto","BaseCode"],Cl.prototype={base:null,nbits:null,tbl:null,encodeBytes:function(e){for(var t=this.nbits,n=this.base,i=p.int(8*e.length/t),r=kl.alloc(i+(8*e.length%t==0?0:1)),a=0,s=0,l=(1<<t)-1,o=0,_=0;_<i;){for(;s<t;)s+=8,a<<=8,a|=e.get(o++);s-=t,r.set(_++,n.get(a>>s&l))}return 0<s&&r.set(_++,n.get(a<<t-s&l)),r},initTable:function(){for(var e=[],t=0;t<256;)e[t++]=-1;for(var n=0,i=this.base.length;n<i;){var r=n++;e[this.base.get(r)]=r}this.tbl=e},decodeBytes:function(e){var t=this.nbits;this.base,null==this.tbl&&this.initTable();for(var n=this.tbl,i=e.length*t>>3,r=kl.alloc(i),a=0,s=0,l=0,o=0;o<i;){for(;s<8;){s+=t,a<<=t;var _=n[e.get(l++)];if(-1==_)throw new $l("BaseCode : invalid encoded char");a|=_}s-=8,r.set(o++,a>>s&255)}return r},__class__:Cl};var Nl=function(){};(n["haxe.ds.ArraySort"]=Nl).__name__=["haxe","ds","ArraySort"],Nl.sort=function(e,t){Nl.rec(e,t,0,e.length)},Nl.rec=function(e,t,n,i){var r=n+i>>1;if(i-n<12){if(i<=n)return;for(var a=n+1,s=i;a<s;)for(var l=a++;n<l&&Nl.compare(e,t,l,l-1)<0;)Nl.swap(e,l-1,l),--l}else Nl.rec(e,t,n,r),Nl.rec(e,t,r,i),Nl.doMerge(e,t,n,r,i,r-n,i-r)},Nl.doMerge=function(e,t,n,i,r,a,s){var l,o,_,p,u;0!=a&&0!=s&&(a+s!=2?(s<a?p=(o=Nl.lower(e,t,i,r,l=n+(_=a>>1)))-i:_=(l=Nl.upper(e,t,n,i,o=i+(p=s>>1)))-n,Nl.rotate(e,t,l,i,o),Nl.doMerge(e,t,n,l,u=l+p,_,p),Nl.doMerge(e,t,u,o,r,a-_,s-p)):Nl.compare(e,t,i,n)<0&&Nl.swap(e,i,n))},Nl.rotate=function(e,t,n,i,r){var a;if(n!=i&&i!=r)for(a=Nl.gcd(r-n,i-n);0!=a--;){for(var s=e[n+a],l=i-n,o=n+a,_=n+a+l;_!=n+a;)e[o]=e[_],l<r-(o=_)?_+=l:_=n+(l-(r-_));e[o]=s}},Nl.gcd=function(e,t){for(;0!=t;){var n=e%t;e=t,t=n}return e},Nl.upper=function(e,t,n,i,r){for(var a,s,l=i-n;0<l;)l=Nl.compare(e,t,r,s=n+(a=l>>1))<0?a:(n=s+1,l-a-1);return n},Nl.lower=function(e,t,n,i,r){for(var a,s,l=i-n;0<l;)l=Nl.compare(e,t,s=n+(a=l>>1),r)<0?(n=s+1,l-a-1):a;return n},Nl.swap=function(e,t,n){var i=e[t];e[t]=e[n],e[n]=i},Nl.compare=function(e,t,n,i){return t(e[n],e[i])};var Pl=function(){this.h={}};(n["haxe.ds.IntMap"]=Pl).__name__=["haxe","ds","IntMap"],Pl.__interfaces__=[bl],Pl.prototype={h:null,set:function(e,t){this.h[e]=t},get:function(e){return this.h[e]},exists:function(e){return this.h.hasOwnProperty(e)},__class__:Pl};var Ml=function(){this.h={__keys__:{}}};(n["haxe.ds.ObjectMap"]=Ml).__name__=["haxe","ds","ObjectMap"],Ml.__interfaces__=[bl],Ml.assignId=function(e){return e.__id__=++Ml.count},Ml.getId=function(e){return e.__id__},Ml.prototype={h:null,set:function(e,t){var n=Ml.getId(e)||Ml.assignId(e);this.h[n]=t,this.h.__keys__[n]=e},get:function(e){return this.h[Ml.getId(e)]},remove:function(e){var t=Ml.getId(e);return null!=this.h.__keys__[t]&&(delete this.h[t],delete this.h.__keys__[t],!0)},keys:function(){var e=[];for(var t in this.h.__keys__)this.h.hasOwnProperty(t)&&e.push(this.h.__keys__[t]);return s.iter(e)},__class__:Ml};var Il=function(e,t){this.map=e,this.keys=t,this.index=0,this.count=t.length};(n["haxe.ds._StringMap.StringMapIterator"]=Il).__name__=["haxe","ds","_StringMap","StringMapIterator"],Il.prototype={map:null,keys:null,index:null,count:null,hasNext:function(){return this.index<this.count},next:function(){return this.map.get(this.keys[this.index++])},__class__:Il};var Al=function(){this.h={}};(n["haxe.ds.StringMap"]=Al).__name__=["haxe","ds","StringMap"],Al.__interfaces__=[bl],Al.prototype={h:null,rh:null,isReserved:function(e){return null!=Nc[e]},set:function(e,t){this.isReserved(e)?this.setReserved(e,t):this.h[e]=t},get:function(e){return this.isReserved(e)?this.getReserved(e):this.h[e]},exists:function(e){return this.isReserved(e)?this.existsReserved(e):this.h.hasOwnProperty(e)},setReserved:function(e,t){null==this.rh&&(this.rh={}),this.rh["$"+e]=t},getReserved:function(e){return null==this.rh?null:this.rh["$"+e]},existsReserved:function(e){return null!=this.rh&&this.rh.hasOwnProperty("$"+e)},remove:function(e){return this.isReserved(e)?(e="$"+e,!(null==this.rh||!this.rh.hasOwnProperty(e)||(delete this.rh[e],0))):!!this.h.hasOwnProperty(e)&&(delete this.h[e],!0)},keys:function(){return s.iter(this.arrayKeys())},arrayKeys:function(){var e=[];for(var t in this.h)this.h.hasOwnProperty(t)&&e.push(t);if(null!=this.rh)for(var t in this.rh)36==t.charCodeAt(0)&&e.push(t.substr(1));return e},iterator:function(){return new Il(this,this.arrayKeys())},__class__:Al};var Tl=function(){this.b=[]};(n["haxe.io.BytesBuffer"]=Tl).__name__=["haxe","io","BytesBuffer"],Tl.prototype={b:null,addBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new $l(Bl.OutsideBounds);this.b;for(var i=e.b,r=t,a=t+n;r<a;){var s=r++;this.b.push(i[s])}},getBytes:function(){var e=new kl(new Tc(this.b).buffer);return this.b=null,e},__class__:Tl};var Dl=function(){};(n["haxe.io.Input"]=Dl).__name__=["haxe","io","Input"],Dl.prototype={bigEndian:null,readByte:function(){throw new $l("Not implemented")},readBytes:function(e,t,n){var i=n,r=e.b;if(t<0||n<0||t+n>e.length)throw new $l(Bl.OutsideBounds);try{for(;0<i;)r[t]=this.readByte(),++t,--i}catch(e){if(e instanceof $l&&(e=e.val),!eo.__instanceof(e,Ol))throw e}return n-i},read:function(e){for(var t=kl.alloc(e),n=0;0<e;){var i=this.readBytes(t,n,e);if(0==i)throw new $l(Bl.Blocked);n+=i,e-=i}return t},readUInt16:function(){var e=this.readByte(),t=this.readByte();return this.bigEndian?t|e<<8:e|t<<8},__class__:Dl};var El=function(e,t,n){if(null==t&&(t=0),null==n&&(n=e.length-t),t<0||n<0||t+n>e.length)throw new $l(Bl.OutsideBounds);this.b=e.b,this.pos=t,this.len=n,this.totlen=n};(n["haxe.io.BytesInput"]=El).__name__=["haxe","io","BytesInput"],El.__super__=Dl,El.prototype=r(Dl.prototype,{b:null,pos:null,len:null,totlen:null,readByte:function(){if(0==this.len)throw new $l(new Ol);return this.len--,this.b[this.pos++]},readBytes:function(e,t,n){if(t<0||n<0||t+n>e.length)throw new $l(Bl.OutsideBounds);if(0==this.len&&0<n)throw new $l(new Ol);this.len<n&&(n=this.len);for(var i=this.b,r=e.b,a=0,s=n;a<s;){var l=a++;r[t+l]=i[this.pos+l]}return this.pos+=n,this.len-=n,n},__class__:El});var Ol=function(){};(n["haxe.io.Eof"]=Ol).__name__=["haxe","io","Eof"],Ol.prototype={toString:function(){return"Eof"},__class__:Ol};var Bl=n["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]};Bl.Blocked=["Blocked",0],Bl.Blocked.toString=i,(Bl.Blocked.__enum__=Bl).Overflow=["Overflow",1],Bl.Overflow.toString=i,(Bl.Overflow.__enum__=Bl).OutsideBounds=["OutsideBounds",2],Bl.OutsideBounds.toString=i,(Bl.OutsideBounds.__enum__=Bl).Custom=function(e){var t=["Custom",3,e];return t.__enum__=Bl,t.toString=i,t},Bl.__empty_constructs__=[Bl.Blocked,Bl.Overflow,Bl.OutsideBounds];var Ll=function(){};(n["haxe.io.FPHelper"]=Ll).__name__=["haxe","io","FPHelper"],Ll.i32ToFloat=function(e){var t=e>>>23&255,n=8388607&e;return 0==n&&0==t?0:(1-(e>>>31<<1))*(1+Math.pow(2,-23)*n)*Math.pow(2,t-127)},Ll.floatToI32=function(e){if(0==e)return 0;var t=e<0?-e:e,n=Math.floor(Math.log(t)/.6931471805599453);n<-127?n=-127:128<n&&(n=128);var i=Math.round(8388608*(t/Math.pow(2,n)-1));return 8388608==i&&n<128&&(i=0,++n),(e<0?-2147483648:0)|n+127<<23|i},Ll.i64ToDouble=function(e,t){var n=(t>>20&2047)-1023,i=4294967296*(1048575&t)+2147483648*(e>>>31)+(2147483647&e);return 0==i&&-1023==n?0:(1-(t>>>31<<1))*(1+Math.pow(2,-52)*i)*Math.pow(2,n)},Ll.doubleToI64=function(e){var t=Ll.i64tmp;if(0==e)t.low=0,t.high=0;else if(isFinite(e)){var n=e<0?-e:e,i=Math.floor(Math.log(n)/.6931471805599453),r=Math.round(4503599627370496*(n/Math.pow(2,i)-1)),a=p.int(r),s=p.int(r/4294967296);t.low=a,t.high=(e<0?-2147483648:0)|i+1023<<20|s}else t.high=0<e?(t.low=0,2146435072):(t.low=0,-1048576);return t};var jl=function(e,t,n){this.xml=t,this.message=e,this.position=n,this.lineNumber=1;for(var i=this.positionAtLine=0,r=n;i<r;){var a=i++,s=h.fastCodeAt(t,a);10==s?(this.lineNumber++,this.positionAtLine=0):13!=s&&this.positionAtLine++}};(n["haxe.xml.XmlParserException"]=jl).__name__=["haxe","xml","XmlParserException"],jl.prototype={message:null,lineNumber:null,positionAtLine:null,position:null,xml:null,toString:function(){return d.getClassName(d.getClass(this))+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:jl};var Fl=function(){};(n["haxe.xml.Parser"]=Fl).__name__=["haxe","xml","Parser"],Fl.parse=function(e,t){null==t&&(t=!1);var n=m.createDocument();return Fl.doParse(e,t,0,n),n},Fl.doParse=function(e,t,n,i){null==n&&(n=0);for(var r=null,a=1,l=1,o=null,_=0,c=0,d=0,f=h.fastCodeAt(e,n),g=new u,v=1,b=-1;!h.isEof(f);){switch(a){case 0:switch(f){case 9:case 10:case 13:case 32:break;default:a=l;continue}break;case 1:if(60!=f){_=n,a=13;continue}a=0,l=2;break;case 2:switch(f){case 33:if(91==h.fastCodeAt(e,n+1)){if("CDATA["!=s.substr(e,n+=2,6).toUpperCase())throw new $l(new jl("Expected <![CDATA[",e,n));a=17,_=(n+=5)+1}else if(68==h.fastCodeAt(e,n+1)||100==h.fastCodeAt(e,n+1)){if("OCTYPE"!=s.substr(e,n+2,6).toUpperCase())throw new $l(new jl("Expected <!DOCTYPE",e,n));a=16,_=(n+=8)+1}else{if(45!=h.fastCodeAt(e,n+1)||45!=h.fastCodeAt(e,n+2))throw new $l(new jl("Expected \x3c!--",e,n));a=15,_=(n+=2)+1}break;case 47:if(null==i)throw new $l(new jl("Expected node name",e,n));_=n+1,a=0,l=10;break;case 63:a=14,_=n;break;default:a=3,_=n;continue}break;case 3:if(Fl.isValidChar(f))break;if(n==_)throw new $l(new jl("Expected node name",e,n));r=m.createElement(s.substr(e,_,n-_)),i.addChild(r),++c,a=0,l=4;continue;case 4:switch(f){case 47:a=11;break;case 62:a=9;break;default:a=5,_=n;continue}break;case 5:if(Fl.isValidChar(f))break;if(_==n)throw new $l(new jl("Expected attribute name",e,n));if(o=s.substr(e,_,n-_),r.exists(o))throw new $l(new jl("Duplicate attribute ["+o+"]",e,n));a=0,l=6;continue;case 6:if(61!=f)throw new $l(new jl("Expected =",e,n));a=0,l=7;break;case 7:switch(f){case 34:case 39:g=new u,a=8,_=n+1,b=f;break;default:throw new $l(new jl('Expected "',e,n))}break;case 8:switch(f){case 38:g.addSub(e,_,n-_),a=18,v=8,_=n+1;break;case 60:case 62:if(t)throw new $l(new jl("Invalid unescaped "+String.fromCharCode(f)+" in attribute value",e,n));if(f==b){g.addSub(e,_,n-_);var y=g.toString();g=new u,r.set(o,y),a=0,l=4}break;default:if(f==b){g.addSub(e,_,n-_);var x=g.toString();g=new u,r.set(o,x),a=0,l=4}}break;case 9:_=n=Fl.doParse(e,t,n,r),a=1;break;case 10:if(Fl.isValidChar(f))break;if(_==n)throw new $l(new jl("Expected node name",e,n));if(s.substr(e,_,n-_)!=i.get_nodeName())throw new $l(new jl("Expected </"+i.get_nodeName()+">",e,n));a=0,l=12;continue;case 11:if(62!=f)throw new $l(new jl("Expected >",e,n));a=1;break;case 12:if(62==f)return 0==c&&i.addChild(m.createPCData("")),n;throw new $l(new jl("Expected >",e,n));case 13:if(60==f){g.addSub(e,_,n-_);var z=m.createPCData(g.toString());g=new u,i.addChild(z),++c,a=0,l=2}else 38==f&&(g.addSub(e,_,n-_),a=18,v=13,_=n+1);break;case 14:if(63==f&&62==h.fastCodeAt(e,n+1)){var w=s.substr(e,_+1,++n-_-2);i.addChild(m.createProcessingInstruction(w)),++c,a=1}break;case 15:45==f&&45==h.fastCodeAt(e,n+1)&&62==h.fastCodeAt(e,n+2)&&(i.addChild(m.createComment(s.substr(e,_,n-_))),++c,n+=2,a=1);break;case 16:91==f?++d:93==f?--d:62==f&&0==d&&(i.addChild(m.createDocType(s.substr(e,_,n-_))),++c,a=1);break;case 17:if(93==f&&93==h.fastCodeAt(e,n+1)&&62==h.fastCodeAt(e,n+2)){var k=m.createCData(s.substr(e,_,n-_));i.addChild(k),++c,n+=2,a=1}break;case 18:if(59==f){var S=s.substr(e,_,n-_);if(35==h.fastCodeAt(S,0)){var C=120==h.fastCodeAt(S,1)?p.parseInt("0"+s.substr(S,1,S.length-1)):p.parseInt(s.substr(S,1,S.length-1));g.addChar(C)}else if(Fl.escapes.exists(S))g.add(Fl.escapes.get(S));else{if(t)throw new $l(new jl("Undefined entity: "+S,e,n));g.add("&"+S+";")}_=n+1,a=v}else if(!Fl.isValidChar(f)&&35!=f){if(t)throw new $l(new jl("Invalid character in entity: "+String.fromCharCode(f),e,n));g.addChar(38),g.addSub(e,_,n-_),_=n--,a=v}}f=h.fastCodeAt(e,++n)}if(1==a&&(_=n,a=13),13==a)return n==_&&0!=c||(g.addSub(e,_,n-_),i.addChild(m.createPCData(g.toString())),++c),n;if(!t&&18==a&&13==v)return g.addChar(38),g.addSub(e,_,n-_),i.addChild(m.createPCData(g.toString())),++c,n;throw new $l(new jl("Unexpected end",e,n))},Fl.isValidChar=function(e){return 97<=e&&e<=122||65<=e&&e<=90||48<=e&&e<=57||58==e||46==e||95==e||45==e};var Rl=n["haxe.zip.Huffman"]={__ename__:["haxe","zip","Huffman"],__constructs__:["Found","NeedBit","NeedBits"]};Rl.Found=function(e){var t=["Found",0,e];return t.__enum__=Rl,t.toString=i,t},Rl.NeedBit=function(e,t){var n=["NeedBit",1,e,t];return n.__enum__=Rl,n.toString=i,n},Rl.NeedBits=function(e,t){var n=["NeedBits",2,e,t];return n.__enum__=Rl,n.toString=i,n},Rl.__empty_constructs__=[];var Gl=function(){};(n["haxe.zip.HuffTools"]=Gl).__name__=["haxe","zip","HuffTools"],Gl.prototype={treeDepth:function(e){switch(d.enumIndex(e)){case 0:return 0;case 1:var t=e[3],n=e[2],i=this.treeDepth(n),r=this.treeDepth(t);return 1+(i<r?i:r);case 2:throw new $l("assert")}},treeCompress:function(e){var t=this.treeDepth(e);if(0==t)return e;if(1==t){if(1!=d.enumIndex(e))throw new $l("assert");var n=e[3],i=e[2];return Rl.NeedBit(this.treeCompress(i),this.treeCompress(n))}for(var r=[],a=0,s=1<<t;a<s;)a++,r.push(Rl.Found(-1));return this.treeWalk(r,0,0,t,e),Rl.NeedBits(t,r)},treeWalk:function(e,t,n,i,r){if(1==d.enumIndex(r)){var a=r[3],s=r[2];0<i?(this.treeWalk(e,t,n+1,i-1,s),this.treeWalk(e,t|1<<n,n+1,i-1,a)):e[t]=this.treeCompress(r)}else e[t]=this.treeCompress(r)},treeMake:function(e,t,n,i){if(t<i)throw new $l("Invalid huffman");var r=n<<5|i;return e.exists(r)?Rl.Found(e.get(r)):(n<<=1,++i,Rl.NeedBit(this.treeMake(e,t,n,i),this.treeMake(e,t,1|n,i)))},make:function(e,t,n,i){var r=[],a=[];if(32<i)throw new $l("Invalid huffman");for(var s=0,l=i;s<l;)s++,r.push(0),a.push(0);for(var o=0,_=n;o<_;){var p=e[o+++t];if(i<=p)throw new $l("Invalid huffman");r[p]++}for(var u=0,h=1,c=i-1;h<c;){var d=h++;u=u+r[d]<<1,a[d]=u}for(var m=new Pl,f=0,g=n;f<g;){var v=f++,b=e[v+t];if(0!=b){var y=a[b-1];a[b-1]=y+1,m.set(y<<5|b,v)}}return this.treeCompress(Rl.NeedBit(this.treeMake(m,i,0,1),this.treeMake(m,i,1,1)))},__class__:Gl};var Zl=function(e){this.buffer=kl.alloc(65536),this.pos=0,e&&(this.crc=new wl)};(n["haxe.zip._InflateImpl.Window"]=Zl).__name__=["haxe","zip","_InflateImpl","Window"],Zl.prototype={buffer:null,pos:null,crc:null,slide:function(){null!=this.crc&&this.crc.update(this.buffer,0,32768);var e=kl.alloc(65536);this.pos-=32768,e.blit(0,this.buffer,32768,this.pos),this.buffer=e},addBytes:function(e,t,n){65536<this.pos+n&&this.slide(),this.buffer.blit(this.pos,e,t,n),this.pos+=n},addByte:function(e){65536==this.pos&&this.slide(),this.buffer.set(this.pos,e),this.pos++},getLastChar:function(){return this.buffer.get(this.pos-1)},available:function(){return this.pos},checksum:function(){return null!=this.crc&&this.crc.update(this.buffer,0,this.pos),this.crc},__class__:Zl};var Ul=n["haxe.zip._InflateImpl.State"]={__ename__:["haxe","zip","_InflateImpl","State"],__constructs__:["Head","Block","CData","Flat","Crc","Dist","DistOne","Done"]};Ul.Head=["Head",0],Ul.Head.toString=i,(Ul.Head.__enum__=Ul).Block=["Block",1],Ul.Block.toString=i,(Ul.Block.__enum__=Ul).CData=["CData",2],Ul.CData.toString=i,(Ul.CData.__enum__=Ul).Flat=["Flat",3],Ul.Flat.toString=i,(Ul.Flat.__enum__=Ul).Crc=["Crc",4],Ul.Crc.toString=i,(Ul.Crc.__enum__=Ul).Dist=["Dist",5],Ul.Dist.toString=i,(Ul.Dist.__enum__=Ul).DistOne=["DistOne",6],Ul.DistOne.toString=i,(Ul.DistOne.__enum__=Ul).Done=["Done",7],Ul.Done.toString=i,(Ul.Done.__enum__=Ul).__empty_constructs__=[Ul.Head,Ul.Block,Ul.CData,Ul.Flat,Ul.Crc,Ul.Dist,Ul.DistOne,Ul.Done];var Vl=function(e,t,n){null==n&&(n=!0),null==t&&(t=!0),this.final=!1,this.htools=new Gl,this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.len=0,this.dist=0,this.state=t?Ul.Head:Ul.Block,this.input=e,this.bits=0,this.nbits=0,this.needed=0,this.output=null,this.outpos=0,this.lengths=[];for(var i=0;i<19;)i++,this.lengths.push(-1);this.window=new Zl(n)};(n["haxe.zip.InflateImpl"]=Vl).__name__=["haxe","zip","InflateImpl"],Vl.run=function(e,t){null==t&&(t=65536);for(var n=kl.alloc(t),i=new Tl,r=new Vl(e);;){var a=r.readBytes(n,0,t);if(i.addBytes(n,0,a),a<t)break}return i.getBytes()},Vl.prototype={nbits:null,bits:null,state:null,final:null,huffman:null,huffdist:null,htools:null,len:null,dist:null,needed:null,output:null,outpos:null,input:null,lengths:null,window:null,buildFixedHuffman:function(){if(null!=Vl.FIXED_HUFFMAN)return Vl.FIXED_HUFFMAN;for(var e=[],t=0;t<288;){var n=t++;e.push(n<=143?8:n<=255?9:n<=279?7:8)}return Vl.FIXED_HUFFMAN=this.htools.make(e,0,288,10)},readBytes:function(e,t,n){if(this.needed=n,this.outpos=t,this.output=e,0<n)for(;this.inflateLoop(););return n-this.needed},getBits:function(e){for(;this.nbits<e;)this.bits|=this.input.readByte()<<this.nbits,this.nbits+=8;var t=this.bits&(1<<e)-1;return this.nbits-=e,this.bits>>=e,t},getBit:function(){0==this.nbits&&(this.nbits=8,this.bits=this.input.readByte());var e=1==(1&this.bits);return this.nbits--,this.bits>>=1,e},getRevBits:function(e){return 0==e?0:this.getBit()?1<<e-1|this.getRevBits(e-1):this.getRevBits(e-1)},resetBits:function(){this.bits=0,this.nbits=0},addBytes:function(e,t,n){this.window.addBytes(e,t,n),this.output.blit(this.outpos,e,t,n),this.needed-=n,this.outpos+=n},addByte:function(e){this.window.addByte(e),this.output.set(this.outpos,e),this.needed--,this.outpos++},addDistOne:function(e){for(var t=this.window.getLastChar(),n=0,i=e;n<i;)n++,this.addByte(t)},addDist:function(e,t){this.addBytes(this.window.buffer,this.window.pos-e,t)},applyHuffman:function(e){switch(d.enumIndex(e)){case 0:return e[2];case 1:var t=e[3],n=e[2];return this.applyHuffman(this.getBit()?t:n);case 2:var i=e[3],r=e[2];return this.applyHuffman(i[this.getBits(r)])}},inflateLengths:function(e,t){for(var n=0,i=0;n<t;){var r=this.applyHuffman(this.huffman);switch(r){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:i=r,e[n]=r,++n;break;case 16:var a=n+3+this.getBits(2);if(t<a)throw new $l("Invalid data");for(;n<a;)e[n]=i,++n;break;case 17:if(t<(n+=3+this.getBits(3)))throw new $l("Invalid data");break;case 18:if(t<(n+=11+this.getBits(7)))throw new $l("Invalid data");break;default:throw new $l("Invalid data")}}},inflateLoop:function(){var e=this.state;switch(d.enumIndex(e)){case 0:var t=this.input.readByte();if(8!=(15&t))throw new $l("Invalid data");var n=this.input.readByte(),i=0!=(32&n);if(((t<<8)+n)%31!=0)throw new $l("Invalid data");if(i)throw new $l("Unsupported dictionary");return this.state=Ul.Block,!0;case 1:switch(this.final=this.getBit(),this.getBits(2)){case 0:if(this.len=this.input.readUInt16(),this.input.readUInt16()!=65535-this.len)throw new $l("Invalid data");this.state=Ul.Flat;var r=this.inflateLoop();return this.resetBits(),r;case 1:return this.huffman=this.buildFixedHuffman(),this.huffdist=null,this.state=Ul.CData,!0;case 2:for(var a=this.getBits(5)+257,s=this.getBits(5)+1,l=this.getBits(4)+4,o=0,_=l;o<_;){var p=o++;this.lengths[Vl.CODE_LENGTHS_POS[p]]=this.getBits(3)}for(var u=l;u<19;){var h=u++;this.lengths[Vl.CODE_LENGTHS_POS[h]]=0}this.huffman=this.htools.make(this.lengths,0,19,8);for(var c=[],m=0,f=a+s;m<f;)m++,c.push(0);return this.inflateLengths(c,a+s),this.huffdist=this.htools.make(c,a,s,16),this.huffman=this.htools.make(c,0,a,16),this.state=Ul.CData,!0;default:throw new $l("Invalid data")}break;case 2:var g=this.applyHuffman(this.huffman);if(g<256)return this.addByte(g),0<this.needed;if(256==g)return this.state=this.final?Ul.Crc:Ul.Block,!0;var v=Vl.LEN_EXTRA_BITS_TBL[g-=257];if(-1==v)throw new $l("Invalid data");this.len=Vl.LEN_BASE_VAL_TBL[g]+this.getBits(v);var b=null==this.huffdist?this.getRevBits(5):this.applyHuffman(this.huffdist);if(-1==(v=Vl.DIST_EXTRA_BITS_TBL[b]))throw new $l("Invalid data");if(this.dist=Vl.DIST_BASE_VAL_TBL[b]+this.getBits(v),this.dist>this.window.available())throw new $l("Invalid data");return this.state=1==this.dist?Ul.DistOne:Ul.Dist,!0;case 3:var y=this.len<this.needed?this.len:this.needed,x=this.input.read(y);return this.len-=y,this.addBytes(x,0,y),0==this.len&&(this.state=this.final?Ul.Crc:Ul.Block),0<this.needed;case 4:var z=this.window.checksum();if(null==z)return this.state=Ul.Done,!0;var w=wl.read(this.input);if(!z.equals(w))throw new $l("Invalid CRC");return this.state=Ul.Done,!0;case 5:for(;0<this.len&&0<this.needed;){var k=this.len<this.dist?this.len:this.dist,S=this.needed<k?this.needed:k;this.addDist(this.dist,S),this.len-=S}return 0==this.len&&(this.state=Ul.CData),0<this.needed;case 6:var C=this.len<this.needed?this.len:this.needed;return this.addDistOne(C),this.len-=C,0==this.len&&(this.state=Ul.CData),0<this.needed;case 7:return!1}},__class__:Vl};var ql=function(){};(n["haxe.zip.Uncompress"]=ql).__name__=["haxe","zip","Uncompress"],ql.run=function(e,t){return Vl.run(new El(e),t)};var Wl=function(){};(n["hxGeomAlgo.Debug"]=Wl).__name__=["hxGeomAlgo","Debug"],Wl.assert=function(e,t,n){};var Xl=e.hxGeomAlgo.EarCut=function(){};(n["hxGeomAlgo.EarCut"]=Xl).__name__=["hxGeomAlgo","EarCut"],Xl.triangulate=function(e,t){var n=Ql.toFloatArray(e),i=null,r=e;if(null!=t&&0<t.length){r=e.concat([]),Ql.flatten(t,r),i=[];for(var a=e.length,s=0;s<t.length;){var l=t[s];++s;for(var o=0,_=Ql.toFloatArray(l);o<_.length;){var p=_[o];++o,n.push(p)}i.push(a),a+=l.length}}for(var u=Xl.earcut(n,i),h=[],c=0;c<u.length;){var d=[r[u[c]],r[u[c+1]],r[u[c+2]]];h.push(d),c+=3}return h},Xl.earcut=function(e,t,n){null==n&&(n=2);var i,r,a,s,l,o,_=null!=t&&0<t.length,p=_?t[0]*n:e.length,u=Xl.linkedList(e,0,p,n,!0),h=[];if(null==u)return h;u=Xl.filterPoints(u);var c=NaN;if(i=r=a=s=l=o=c,_&&(u=Xl.eliminateHoles(e,t,u,n)),e.length>80*n){i=a=e[0],r=s=e[1];for(var d=n;d<p;)(l=e[d])<i&&(i=l),(o=e[d+1])<r&&(r=o),a<l&&(a=l),s<o&&(s=o),d+=n;c=Math.max(a-i,s-r)}return Xl.earcutLinked(u,h,n,i,r,c),h},Xl.linkedList=function(e,t,n,i,r){var a,s=null;if(r==0<Xl.signedArea(e,t,n,i))for(a=t;a<n;)s=Xl.insertNode(a,e[a],e[a+1],s),a+=i;else for(a=n-i;t<=a;)s=Xl.insertNode(a,e[a],e[a+1],s),a-=i;return null!=s&&Xl.equals(s,s.next)&&(Xl.removeNode(s),s=s.next),s},Xl.filterPoints=function(e,t){if(null==e)return e;null==t&&(t=e);for(var n,i=e;;){if(n=!1,i.steiner||!Xl.equals(i,i.next)&&0!=Xl.area(i.prev,i,i.next))i=i.next;else{if(Xl.removeNode(i),(i=t=i.prev)==i.next)return null;n=!0}if(!n&&i==t)break}return t},Xl.earcutLinked=function(e,t,n,i,r,a,s){if(null==s&&(s=0),null!=e){0!=s||isNaN(a)||Xl.indexCurve(e,i,r,a);for(var l,o,_=e;e.prev!=e.next;)if(l=e.prev,o=e.next,isNaN(a)?Xl.isEar(e):Xl.isEarHashed(e,i,r,a))t.push(p.int(l.i/n)),t.push(p.int(e.i/n)),t.push(p.int(o.i/n)),Xl.removeNode(e),e=o.next,_=o.next;else if((e=o)==_){0==s?Xl.earcutLinked(Xl.filterPoints(e),t,n,i,r,a,1):1==s?(e=Xl.cureLocalIntersections(e,t,n),Xl.earcutLinked(e,t,n,i,r,a,2)):2==s&&Xl.splitEarcut(e,t,n,i,r,a);break}}},Xl.isEar=function(e){var t=e.prev,n=e,i=e.next;if(0<=Xl.area(t,n,i))return!1;for(var r=e.next.next;r!=e.prev;){if(Xl.pointInTriangle(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&0<=Xl.area(r.prev,r,r.next))return!1;r=r.next}return!0},Xl.isEarHashed=function(e,t,n,i){var r=e.prev,a=e,s=e.next;if(0<=Xl.area(r,a,s))return!1;for(var l=r.x<a.x?r.x<s.x?r.x:s.x:a.x<s.x?a.x:s.x,o=r.y<a.y?r.y<s.y?r.y:s.y:a.y<s.y?a.y:s.y,_=r.x>a.x?r.x>s.x?r.x:s.x:a.x>s.x?a.x:s.x,p=r.y>a.y?r.y>s.y?r.y:s.y:a.y>s.y?a.y:s.y,u=Xl.zOrder(l,o,t,n,i),h=Xl.zOrder(_,p,t,n,i),c=e.nextZ;null!=c&&c.z<=h;){if(c!=e.prev&&c!=e.next&&Xl.pointInTriangle(r.x,r.y,a.x,a.y,s.x,s.y,c.x,c.y)&&0<=Xl.area(c.prev,c,c.next))return!1;c=c.nextZ}for(c=e.prevZ;null!=c&&c.z>=u;){if(c!=e.prev&&c!=e.next&&Xl.pointInTriangle(r.x,r.y,a.x,a.y,s.x,s.y,c.x,c.y)&&0<=Xl.area(c.prev,c,c.next))return!1;c=c.prevZ}return!0},Xl.cureLocalIntersections=function(e,t,n){for(var i=e;;){var r=i.prev,a=i.next.next;if(!Xl.equals(r,a)&&Xl.intersects(r,i,i.next,a)&&Xl.locallyInside(r,a)&&Xl.locallyInside(a,r)&&(t.push(p.int(r.i/n)),t.push(p.int(i.i/n)),t.push(p.int(a.i/n)),Xl.removeNode(i),Xl.removeNode(i.next),i=e=a),(i=i.next)==e)break}return i},Xl.splitEarcut=function(e,t,n,i,r,a){for(var s=e;;){for(var l=s.next.next;l!=s.prev;){if(s.i!=l.i&&Xl.isValidDiagonal(s,l)){var o=Xl.splitPolygon(s,l);return s=Xl.filterPoints(s,s.next),o=Xl.filterPoints(o,o.next),Xl.earcutLinked(s,t,n,i,r,a),void Xl.earcutLinked(o,t,n,i,r,a)}l=l.next}if((s=s.next)==e)break}},Xl.eliminateHoles=function(e,t,n,i){var r,a,s,l,o,_=[];for(r=0,a=t.length;r<a;)s=t[r]*i,l=r<a-1?t[r+1]*i:e.length,(o=Xl.linkedList(e,s,l,i,!1))==o.next&&(o.steiner=!0),_.push(Xl.getLeftmost(o)),++r;Nl.sort(_,Xl.compareX);for(var p=0,u=_.length;p<u;){var h=p++;Xl.eliminateHole(_[h],n),n=Xl.filterPoints(n,n.next)}return n},Xl.compareX=function(e,t){return p.int(e.x-t.x)},Xl.eliminateHole=function(e,t){if(null!=(t=Xl.findHoleBridge(e,t))){var n=Xl.splitPolygon(t,e);Xl.filterPoints(n,n.next)}},Xl.findHoleBridge=function(e,t){for(var n=t,i=e.x,r=e.y,a=-1/0,s=null;;){if(r<=n.y&&r>=n.next.y){var l=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(l<=i&&a<l){if((a=l)==i){if(r==n.y)return n;if(r==n.next.y)return n.next}s=n.x<n.next.x?n:n.next}}if((n=n.next)==t)break}if(null==s)return null;if(i==a)return s.prev;var o,_=s,p=s.x,u=s.y,h=1/0;for(n=s.next;n!=_;)i>=n.x&&n.x>=p&&Xl.pointInTriangle(r<u?i:a,r,p,u,r<u?a:i,r,n.x,n.y)&&((o=Math.abs(r-n.y)/(i-n.x))<h||o==h&&n.x>s.x)&&Xl.locallyInside(n,e)&&(s=n,h=o),n=n.next;return s},Xl.indexCurve=function(e,t,n,i){for(var r=e;null==r.z&&(r.z=Xl.zOrder(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,(r=r.next)!=e;);r.prevZ.nextZ=null,r.prevZ=null,Xl.sortLinked(r)},Xl.sortLinked=function(e){for(var t,n,i,r=null,a=null,s=null,l=null,o=1;;){for(r=e,l=e=null,t=0;null!=r;){++t,a=r;for(var _=n=0,p=o;_<p&&(_++,++n,null!=(a=a.nextZ)););for(i=o;0<n||0<i&&null!=a;)0==n?(a=(s=a).nextZ,--i):0==i||null==a||r.z<=a.z?(r=(s=r).nextZ,--n):(a=(s=a).nextZ,--i),null!=l?l.nextZ=s:e=s,s.prevZ=l,l=s;r=a}if(l.nextZ=null,o*=2,!(1<t))break}return e},Xl.zOrder=function(e,t,n,i,r){var a=p.int(32767*(e-n)/r),s=p.int(32767*(t-i)/r);return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&(a|a<<8))|a<<4))|a<<2))|a<<1))|(s=1431655765&((s=858993459&((s=252645135&((s=16711935&(s|s<<8))|s<<4))|s<<2))|s<<1))<<1},Xl.getLeftmost=function(e){for(var t=e,n=e;t.x<n.x&&(n=t),(t=t.next)!=e;);return n},Xl.pointInTriangle=function(e,t,n,i,r,a,s,l){return 0<=(r-s)*(t-l)-(e-s)*(a-l)&&0<=(e-s)*(i-l)-(n-s)*(t-l)&&0<=(n-s)*(a-l)-(r-s)*(i-l)},Xl.isValidDiagonal=function(e,t){return!(e.next.i==t.i||e.prev.i==t.i||Xl.intersectsPolygon(e,t)||!Xl.locallyInside(e,t)||!Xl.locallyInside(t,e))&&Xl.middleInside(e,t)},Xl.area=function(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)},Xl.equals=function(e,t){return e.x==t.x&&e.y==t.y},Xl.intersects=function(e,t,n,i){return!!(Xl.equals(e,t)&&Xl.equals(n,i)||Xl.equals(e,i)&&Xl.equals(n,t))||0<Xl.area(e,t,n)!=0<Xl.area(e,t,i)&&0<Xl.area(n,i,e)!=0<Xl.area(n,i,t)},Xl.intersectsPolygon=function(e,t){for(var n=e;;){if(n.i!=e.i&&n.next.i!=e.i&&n.i!=t.i&&n.next.i!=t.i&&Xl.intersects(n,n.next,e,t))return!0;if((n=n.next)==e)break}return!1},Xl.locallyInside=function(e,t){return Xl.area(e.prev,e,e.next)<0?0<=Xl.area(e,t,e.next)&&0<=Xl.area(e,e.prev,t):Xl.area(e,t,e.prev)<0||Xl.area(e,e.next,t)<0},Xl.middleInside=function(e,t){for(var n=e,i=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;n.y>a!=n.next.y>a&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),(n=n.next)!=e;);return i},Xl.splitPolygon=function(e,t){var n=new Hl(e.i,e.x,e.y),i=new Hl(t.i,t.x,t.y),r=e.next,a=t.prev;return(e.next=t).prev=e,(n.next=r).prev=n,(i.next=n).prev=i,(a.next=i).prev=a,i},Xl.insertNode=function(e,t,n,i){var r=new Hl(e,t,n);return null==i?(r.prev=r).next=r:(r.next=i.next,(r.prev=i).next.prev=r,i.next=r),r},Xl.removeNode=function(e){e.next.prev=e.prev,e.prev.next=e.next,null!=e.prevZ&&(e.prevZ.nextZ=e.nextZ),null!=e.nextZ&&(e.nextZ.prevZ=e.prevZ)},Xl.deviation=function(e,t,n,i){var r=null!=t&&0<t.length,a=r?t[0]*n:e.length,s=Math.abs(Xl.signedArea(e,0,a,n));if(r)for(var l=0,o=t.length;l<o;){var _=t[l]*n,p=l<o-1?t[l+1]*n:e.length;s-=Math.abs(Xl.signedArea(e,_,p,n)),++l}for(var u=0,h=0;h<i.length;){var c=i[h]*n,d=i[h+1]*n,m=i[h+2]*n;u+=Math.abs((e[c]-e[m])*(e[d+1]-e[c+1])-(e[c]-e[d])*(e[m+1]-e[c+1])),h+=3}return 0==s&&0==u?0:Math.abs((u-s)/s)},Xl.signedArea=function(e,t,n,i){for(var r=0,a=t,s=n-i;a<n;)r+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a,a+=i;return r},Xl.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0,a=e.length;r<a;){for(var s=r++,l=0,o=e[s].length;l<o;)for(var _=l++,p=0,u=t;p<u;){var h=p++;n.vertices.push(e[s][_][h])}0<s&&(i+=e[s-1].length,n.holes.push(i))}return n},Xl.polygonize=function(e){var t=[];if(0==e.length)return[];for(var n=[],i=0,r=e.length;i<r;)n[i++]=!1;for(var a=!0;a;){for(var s=null,l=-1,o=0,_=e.length;o<_;){var p=o++;if(!n[p]){l=p;break}}if(-1==l)a=!1;else{s=e[l],n[l]=!0;for(var u=0,h=e.length;u<h;){var c=u++;if(!n[c]){var d=Xl.addTriangle(s,e[c]);null!=d&&Ql.isConvex(d)&&(s=d,n[c]=!0)}}t.push(s)}}return t},Xl.addTriangle=function(e,t){for(var n=-1,i=-1,r=-1,a=-1,s=0,l=e.length;s<l;){var o=s++;t[0].x==e[o].x&&t[0].y==e[o].y?-1==n?(n=o,i=0):(r=o,a=0):t[1].x==e[o].x&&t[1].y==e[o].y?-1==n?(n=o,i=1):(r=o,a=1):t[2].x==e[o].x&&t[2].y==e[o].y&&(-1==n?(n=o,i=2):(r=o,a=2))}if(0==n&&r==e.length-1&&(n=e.length-1,r=0),-1==r)return null;var _=0;_!=i&&_!=a||(_=1),_!=i&&_!=a||(_=2);for(var p=[],u=0,h=e.length;u<h;){var c=u++;p.push(e[c]),c==n&&p.push(t[_])}return p};var Hl=function(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1};(n["hxGeomAlgo.EarNode"]=Hl).__name__=["hxGeomAlgo","EarNode"],Hl.prototype={i:null,x:null,y:null,prev:null,next:null,z:null,prevZ:null,nextZ:null,steiner:null,__class__:Hl};var Yl=function(e,t,n){null==n&&(n=1),null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t,this.w=n};(n["hxGeomAlgo.HomogCoord"]=Yl).__name__=["hxGeomAlgo","HomogCoord"],Yl.det=function(e,t,n){return e.w*t.perpdot(n)-t.w*e.perpdot(n)+n.w*e.perpdot(t)},Yl.ccw=function(e,t,n){return 0<Yl.det(e,t,n)},Yl.cw=function(e,t,n){return Yl.det(e,t,n)<0},Yl.prototype={x:null,y:null,w:null,add:function(e){return this.x+=e.x,this.y+=e.y,this},sub:function(e){return this.x-=e.x,this.y-=e.y,this},neg:function(){return this.w=-this.w,this.x=-this.x,this.y=-this.y,this},mul:function(e){return this.w*=e,this.x*=e,this.y*=e,this},div:function(e){return this.w/=e,this.x/=e,this.y/=e,this},normalize:function(){return this.div(this.length())},lengthSquared:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.lengthSquared())},perp:function(){var e=-this.y;return this.y=this.x,this.x=e,this},dotPoint:function(e){return this.w+this.x*e.x+this.y*e.y},dot:function(e){return this.w*e.w+this.x*e.x+this.y*e.y},perpdot:function(e){return this.x*e.y-this.y*e.x},dotperp:function(e){return-this.x*e.y+this.y*e.x},equals:function(e){return e.w*this.x==this.w*e.x&&e.w*this.y==this.w*e.y},left:function(e){return 0<this.dotPoint(e)},right:function(e){return this.dotPoint(e)<0},toScreen:function(){return Kl._new(this.x/this.w,-this.y/this.w)},toPoint:function(){return Kl._new(this.x/this.w,this.y/this.w)},meet:function(e){return new Yl(e.w*this.y-this.w*e.y,this.w*e.x-e.w*this.x,this.x*e.y-this.y*e.x)},meetPoint:function(e){return new Yl(this.y-this.w*e.y,this.w*e.x-this.x,this.x*e.y-this.y*e.x)},toString:function(){return" (w:"+this.w+"; x:"+this.x+", y:"+this.y+")  "},__class__:Yl};var Jl=function(e,t){null==t&&(t=0),null==e&&(e=0),this.x=e,this.y=t};(n["hxGeomAlgo.HxPointData"]=Jl).__name__=["hxGeomAlgo","HxPointData"],Jl.prototype={x:null,y:null,toString:function(){return"("+this.x+", "+this.y+")"},__class__:Jl};var Kl=e.hxGeomAlgo._HxPoint.HxPoint_Impl_={};(n["hxGeomAlgo._HxPoint.HxPoint_Impl_"]=Kl).__name__=["hxGeomAlgo","_HxPoint","HxPoint_Impl_"],Kl.__properties__={set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"},Kl.get_x=function(e){return e.x},Kl.set_x=function(e,t){return e.x=t},Kl.get_y=function(e){return e.y},Kl.set_y=function(e,t){return e.y=t},Kl._new=function(e,t){return null==t&&(t=0),null==e&&(e=0),new Jl(e,t)},Kl.setTo=function(e,t,n){e.x=t,e.y=n},Kl.equals=function(e,t){return null!=t&&e.x==t.x&&e.y==t.y},Kl.clone=function(e){return Kl._new(e.x,e.y)},Kl.toString=function(e){return"("+e.x+", "+e.y+")"},Kl.fromPointStruct=function(e){return Kl._new(e.x,e.y)},Kl.toPointStruct=function(e){return{x:e.x,y:e.y}};var Ql=e.hxGeomAlgo.PolyTools=function(){};(n["hxGeomAlgo.PolyTools"]=Ql).__name__=["hxGeomAlgo","PolyTools"],Ql.isCCW=function(e){if(e.length<=2)return!0;for(var t=0,n=0,i=e.length;n<i;){var r=n++;t+=Ql.at(e,r-1).x*e[r].y-e[r].x*Ql.at(e,r-1).y}return t<0},Ql.isCW=function(e){if(e.length<=2)return!0;for(var t=0,n=0,i=e.length;n<i;){var r=n++;t+=Ql.at(e,r-1).x*e[r].y-e[r].x*Ql.at(e,r-1).y}return 0<t},Ql.makeCCW=function(e){var t=!1;return Ql.isCCW(e)||(e.reverse(),t=!0),t},Ql.makeCW=function(e){var t=!1;return Ql.isCCW(e)&&(e.reverse(),t=!0),t},Ql.isConvex=function(e){for(var t=null,n=0,i=e.length;n<i;){var r=n++,a=0==r?e.length-1:r-1,s=r,l=r==e.length-1?0:r+1,o=e[s].x-e[a].x,_=e[s].y-e[a].y,p=e[l].x-e[s].x,u=o*(e[l].y-e[s].y)-p*_,h=0<u;if(0!=u)if(null==t)t=h;else if(t!=h)return!1}return!0},Ql.isSimple=function(e){var t=e.length;if(t<=3)return!0;for(var n=0,i=t;n<i;)for(var r=n++,a=r,s=r==t-1?0:r+1,l=r+1,o=t;l<o;){var _=l++,p=_,u=_==t-1?0:_+1,h=Ql.segmentIntersect(e[a],e[s],e[p],e[u]);if(null!=h&&!(Ql.distance(h,e[a])<Ql.EPSILON||Ql.distance(h,e[s])<Ql.EPSILON)&&!(Ql.distance(h,e[p])<Ql.EPSILON||Ql.distance(h,e[u])<Ql.EPSILON))return!1}return!0},Ql.segmentIntersect=function(e,t,n,i){var r,a,s,l,o,_,p;a=t.y-e.y,l=e.x-t.x,_=t.x*e.y-e.x*t.y,s=i.y-n.y,o=n.x-i.x,p=i.x*n.y-n.x*i.y;var u=a*o-s*l;if(0==u)return null;(r=Kl._new()).x=(l*p-o*_)/u,r.y=(s*_-a*p)/u;var h=Ql.distanceSquared(e,t),c=Ql.distanceSquared(n,i);return Ql.distanceSquared(r,t)>h||Ql.distanceSquared(r,e)>h||Ql.distanceSquared(r,i)>c||Ql.distanceSquared(r,n)>c?null:r},Ql.findDuplicatePoints=function(e,t,n){null==n&&(n=!0),null==t&&(t=!0);var i=e.length;if(i<=1)return[];for(var r,a=[],s=0,l=i-1;s<l;)for(var o=s++,_=o+1;_<i;){var p=e[o],u=e[_],h=null!=u&&p.x==u.x&&p.y==u.y;if(h&&a.push(o),t||h&&!t)break;++_}if(n&&t){var c=e[0],d=e[i-1];r=null!=d&&c.x==d.x&&c.y==d.y}else r=!1;return r&&a.push(i-1),a},Ql.intersection=function(e,t,n,i){var r=null,a=t.y-e.y,s=e.x-t.x,l=a*e.x+s*e.y,o=i.y-n.y,_=n.x-i.x,p=o*n.x+_*n.y,u=a*_-o*s;return Ql.eq(u,0)||((r=Kl._new()).x=(_*l-s*p)/u,r.y=(a*p-o*l)/u),r},Ql.isReflex=function(e,t){return Ql.isRight(Ql.at(e,t-1),Ql.at(e,t),Ql.at(e,t+1))},Ql.at=function(e,t){return e[t=Ql.wrappedIdx(e,t)]},Ql.wrappedIdx=function(e,t){var n=e.length;return t<0&&(t+=n),t%n},Ql.side=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(n.x-e.x)*(t.y-e.y)},Ql.isLeft=function(e,t,n){return 0<Ql.side(e,t,n)},Ql.isLeftOrOn=function(e,t,n){return 0<=Ql.side(e,t,n)},Ql.isRight=function(e,t,n){return Ql.side(e,t,n)<0},Ql.isRightOrOn=function(e,t,n){return Ql.side(e,t,n)<=0},Ql.isCollinear=function(e,t,n){return 0==Ql.side(e,t,n)},Ql.distance=function(e,t){return Math.sqrt(Ql.distanceSquared(e,t))},Ql.distanceToSegment=function(e,t,n){return Math.sqrt(Ql.distanceToSegmentSquared(e,t,n))},Ql.distanceSquared=function(e,t){return Ql.sqr(e.x-t.x)+Ql.sqr(e.y-t.y)},Ql.distanceToSegmentSquared=function(e,t,n){var i=Ql.distanceSquared(t,n);if(0==i)return Ql.distanceSquared(e,t);var r=((e.x-t.x)*(n.x-t.x)+(e.y-t.y)*(n.y-t.y))/i;return r<0?Ql.distanceSquared(e,t):1<r?Ql.distanceSquared(e,n):(Kl.setTo(Ql.point,t.x+r*(n.x-t.x),t.y+r*(n.y-t.y)),Ql.distanceSquared(e,Ql.point))},Ql.getCentroid=function(e){var t=Kl._new(),n=Ql.getArea(e);if(0!=n){for(var i=e.length,r=0,a=i;r<a;){var s=r++,l=e[s],o=e[(s+1)%i],_=l.x*o.y-o.x*l.y;t.x+=(l.x+o.x)*_,t.y+=(l.y+o.y)*_}t.x/=6*n,t.y/=6*n}else t=Kl.EMPTY;return t},Ql.getArea=function(e){for(var t=0,n=e.length,i=0,r=n;i<r;){var a=i++,s=e[a],l=e[(a+1)%n];t+=s.x*l.y-l.x*s.y}return t*=.5},Ql.meet=function(e,t){return new Yl(e.y-t.y,t.x-e.x,e.x*t.y-e.y*t.x)},Ql.dot=function(e,t){return e.x*t.x+e.y*t.y},Ql.sqr=function(e){return e*e},Ql.eq=function(e,t){return Math.abs(e-t)<=Ql.EPSILON},Ql.clear=function(e){e.length=0},Ql.toFloatArray=function(e,t){t=null!=t?t:[];for(var n=0;n<e.length;){var i=e[n];++n,t.push(i.x),t.push(i.y)}return t},Ql.reverseFloatArray=function(e,t){null==t&&(t=!1);for(var n=t?e:[],i=e.length>>1,r=0,a=i;r<a;){var s=r++,l=2*(i-s-1);n[2*s]=e[l],n[2*s+1]=e[l+1]}return n},Ql.flatten=function(e,t){for(var n=null!=t?t:[],i=0;i<e.length;){var r=e[i];++i;for(var a=0;a<r.length;){var s=r[a];++a,n.push(s)}}return n},Ql.toPointArray=function(e,t){t=null!=t?t:[];var n=e.length;e.length%2==1&&--n;for(var i=0,r=n>>1;i<r;){var a=i++;t.push(Kl._new(e[2*a],e[2*a+1]))}return t},Ql.inflateLine=function(e,t,n){var i=n/2,r=t.x-e.x,a=t.y-e.y,s=Math.sqrt(Ql.sqr(r)+Ql.sqr(a)),l=r/s*i,o=a/s*i;return[Kl._new(e.x-o,e.y+l),Kl._new(t.x-o,t.y+l),Kl._new(t.x+o,t.y-l),Kl._new(e.x+o,e.y-l)]},Ql.clip=function(e,t){Wl.assert(3<=t.length&&Ql.isConvex(t),"`clipPoly` must be a valid convex poly",{fileName:"PolyTools.hx",lineNumber:458,className:"hxGeomAlgo.PolyTools",methodName:"clip"});for(var n,i,r,a,s=[],l=e,o=Ql.isCCW(t)?Ql.isRight:Ql.isLeft,_=0,p=t.length;_<p;){var u=_++;n=t[u],i=t[Ql.wrappedIdx(t,u+1)];var h=l;l=[],r=h[h.length-1];for(var c=0,d=h.length;c<d;){if(o(a=h[c++],n,i)){if(!o(r,n,i)){var m=Ql.intersection(r,a,n,i);null!=m&&l.push(m)}l.push(a)}else if(o(r,n,i)){var f=Ql.intersection(r,a,n,i);null!=f&&l.push(f)}r=a}s.push(l)}return s},Ql.exposeEnum=function(t,n){for(var i=(null!=n?n:d.getEnumName(t)).split("."),r=e,a=0;a<i.length-1;){var s=i[a];r[s]=r[s]||{},r=r[s],++a}r[i[a]]=t};var $l=function(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,$l)};(n["js._Boot.HaxeError"]=$l).__name__=["js","_Boot","HaxeError"],$l.wrap=function(e){return e instanceof Error?e:new $l(e)},$l.__super__=Error,$l.prototype=r(Error.prototype,{val:null,__class__:$l});var eo=function(){};(n["js.Boot"]=eo).__name__=["js","Boot"],eo.__unhtml=function(e){return e.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;")},eo.__trace=function(e,t){var n,i=null!=t?t.fileName+":"+t.lineNumber+": ":"";if(i+=eo.__string_rec(e,""),null!=t&&null!=t.customParams)for(var r=0,a=t.customParams;r<a.length;){var s=a[r];++r,i+=","+eo.__string_rec(s,"")}"undefined"!=typeof document&&null!=(n=document.getElementById("haxe:trace"))?n.innerHTML+=eo.__unhtml(i)+"<br/>":"undefined"!=typeof console&&console.log},eo.__clear_trace=function(){var e=document.getElementById("haxe:trace");null!=e&&(e.innerHTML="")},eo.isClass=function(e){return e.__name__},eo.isEnum=function(e){return e.__ename__},eo.getClass=function(e){if(e instanceof Array&&null==e.__enum__)return Array;var t=e.__class__;if(null!=t)return t;var n=eo.__nativeClassName(e);return null!=n?eo.__resolveNativeClass(n):null},eo.__string_rec=function(e,t){if(null==e)return"null";if(5<=t.length)return"<...>";var n=typeof e;switch("function"==n&&(eo.isClass(e)||eo.isEnum(e))&&(n="object"),n){case"function":return"<function>";case"object":if(e instanceof Array){if(e.__enum__){if(2==e.length)return e[0];var i=e[0]+"(";t+="\t";for(var r=2,a=e.length;r<a;){var s=r++;i+=2!=s?","+eo.__string_rec(e[s],t):eo.__string_rec(e[s],t)}return i+")"}var l="[";t+="\t";for(var o=0,_=e.length;o<_;){var p=o++;l+=(0<p?",":"")+eo.__string_rec(e[p],t)}return l+="]"}var u;try{u=e.toString}catch(e){return"???"}if(null!=u&&u!=Object.toString&&"function"==typeof u){var h=e.toString();if("[object Object]"!=h)return h}var c=null,d="{\n";t+="\t";var m=null!=e.hasOwnProperty;for(var c in e)m&&!e.hasOwnProperty(c)||"prototype"!=c&&"__class__"!=c&&"__super__"!=c&&"__interfaces__"!=c&&"__properties__"!=c&&(2!=d.length&&(d+=", \n"),d+=t+c+" : "+eo.__string_rec(e[c],t));return d+="\n"+(t=t.substring(1))+"}";case"string":return e;default:return String(e)}},eo.__interfLoop=function(e,t){if(null==e)return!1;if(e==t)return!0;var n=e.__interfaces__;if(null!=n)for(var i=0,r=n.length;i<r;){var a=n[i++];if(a==t||eo.__interfLoop(a,t))return!0}return eo.__interfLoop(e.__super__,t)},eo.__instanceof=function(e,t){if(null==t)return!1;switch(t){case Array:return e instanceof Array&&null==e.__enum__;case kc:return"boolean"==typeof e;case zc:return!0;case wc:return"number"==typeof e;case xc:return"number"==typeof e&&(0|e)===e;case String:return"string"==typeof e;default:if(null==e)return!1;if("function"==typeof t){if(e instanceof t)return!0;if(eo.__interfLoop(eo.getClass(e),t))return!0}else if("object"==typeof t&&eo.__isNativeObj(t)&&e instanceof t)return!0;return t==Sc&&null!=e.__name__||t==Cc&&null!=e.__ename__||e.__enum__==t}},eo.__cast=function(e,t){if(eo.__instanceof(e,t))return e;throw new $l("Cannot cast "+p.string(e)+" to "+p.string(t))},eo.__nativeClassName=function(e){var t=eo.__toStr.call(e).slice(8,-1);return"Object"==t||"Function"==t||"Math"==t||"JSON"==t?null:t},eo.__isNativeObj=function(e){return null!=eo.__nativeClassName(e)},eo.__resolveNativeClass=function(e){return t[e]};var to=function(){};(n["js.Browser"]=to).__name__=["js","Browser"],to.__properties__={get_navigator:"get_navigator",get_document:"get_document",get_window:"get_window"},to.get_window=function(){return window},to.get_document=function(){return window.document},to.get_navigator=function(){return window.navigator};var no=function(){};(n["js.Lib"]=no).__name__=["js","Lib"],no.__properties__={get_undefined:"get_undefined"},no.get_undefined=function(){};var io=function(e){if(e instanceof Array&&null==e.__enum__)this.a=e,this.byteLength=e.length;else{var t=e;this.a=[];for(var n=0,i=t;n<i;){var r=n++;this.a[r]=0}this.byteLength=t}};(n["js.html.compat.ArrayBuffer"]=io).__name__=["js","html","compat","ArrayBuffer"],io.sliceImpl=function(e,t){var n=new Tc(this,e,null==t?null:t-e),i=new Pc(n.byteLength);return new Tc(i).set(n),i},io.prototype={byteLength:null,a:null,slice:function(e,t){return new io(this.a.slice(e,t))},__class__:io};var ro=function(e,t,n){if(this.buf=e,this.offset=null==t?0:t,this.length=null==n?e.byteLength-this.offset:n,this.offset<0||this.length<0||this.offset+this.length>e.byteLength)throw new $l(Bl.OutsideBounds);this.byteLength=this.length,this.byteOffset=this.offset,this.buffer=this.buf};(n["js.html.compat.DataView"]=ro).__name__=["js","html","compat","DataView"],ro.prototype={buf:null,offset:null,length:null,byteLength:null,byteOffset:null,buffer:null,getInt8:function(e){var t=this.buf.a[this.offset+e];return 128<=t?t-256:t},getUint8:function(e){return this.buf.a[this.offset+e]},getInt16:function(e,t){var n=this.getUint16(e,t);return 32768<=n?n-65536:n},getUint16:function(e,t){return t?this.buf.a[this.offset+e]|this.buf.a[this.offset+e+1]<<8:this.buf.a[this.offset+e]<<8|this.buf.a[this.offset+e+1]},getInt32:function(e,t){var n=this.offset+e,i=this.buf.a[n++],r=this.buf.a[n++],a=this.buf.a[n++],s=this.buf.a[n++];return t?i|r<<8|a<<16|s<<24:s|a<<8|r<<16|i<<24},getUint32:function(e,t){var n=this.getInt32(e,t);return n<0?n+4294967296:n},getFloat32:function(e,t){return Ll.i32ToFloat(this.getInt32(e,t))},getFloat64:function(e,t){var n=this.getInt32(e,t),i=this.getInt32(e+4,t);return Ll.i64ToDouble(t?n:i,t?i:n)},setInt8:function(e,t){this.buf.a[e+this.offset]=t<0?t+128&255:255&t},setUint8:function(e,t){this.buf.a[e+this.offset]=255&t},setInt16:function(e,t,n){this.setUint16(e,t<0?t+65536:t,n)},setUint16:function(e,t,n){var i=e+this.offset;n?(this.buf.a[i]=255&t,this.buf.a[i++]=t>>8&255):(this.buf.a[i++]=t>>8&255,this.buf.a[i]=255&t)},setInt32:function(e,t,n){this.setUint32(e,t,n)},setUint32:function(e,t,n){var i=e+this.offset;this.buf.a[i++]=n?(this.buf.a[i++]=255&t,this.buf.a[i++]=t>>8&255,this.buf.a[i++]=t>>16&255,t>>>24):(this.buf.a[i++]=t>>>24,this.buf.a[i++]=t>>16&255,this.buf.a[i++]=t>>8&255,255&t)},setFloat32:function(e,t,n){this.setUint32(e,Ll.floatToI32(t),n)},setFloat64:function(e,t,n){var i=Ll.doubleToI64(t);n?(this.setUint32(e,i.low),this.setUint32(e,i.high)):(this.setUint32(e,i.high),this.setUint32(e,i.low))},__class__:ro};var ao=function(){};(n["js.html.compat.Float32Array"]=ao).__name__=["js","html","compat","Float32Array"],ao._new=function(e,t,n){var i;if("number"==typeof e){i=[];for(var r=0,a=e;r<a;)i[r++]=0;i.byteLength=i.length<<2;for(var s=[],l=i.byteOffset=0,o=i.length<<2;l<o;)l++,s.push(0);i.buffer=new io(s)}else if(p.is(e,io)){var _=e;null==t&&(t=0),null==n&&(n=_.byteLength-t>>2),i=[];for(var u=0,h=n;u<h;){u++;var c=_.a[t++]|_.a[t++]<<8|_.a[t++]<<16|_.a[t++]<<24;i.push(Ll.i32ToFloat(c))}i.byteLength=i.length<<2,i.byteOffset=t,i.buffer=_}else{if(!(e instanceof Array&&null==e.__enum__))throw new $l("TODO "+p.string(e));i=e.slice();for(var d=[],m=0;m<i.length;){var f=i[m];++m;var g=Ll.floatToI32(f);d.push(255&g),d.push(g>>8&255),d.push(g>>16&255),d.push(g>>>24)}i.byteLength=i.length<<2,i.byteOffset=0,i.buffer=new io(d)}return i.subarray=ao._subarray,i.set=ao._set,i},ao._set=function(e,t){if(p.is(e.buffer,io)){var n=e;if(e.byteLength+t>this.byteLength)throw new $l("set() outside of range");for(var i=0,r=e.byteLength;i<r;){var a=i++;this[a+t]=n[a]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new $l("TODO");var s=e;if(s.length+t>this.byteLength)throw new $l("set() outside of range");for(var l=0,o=s.length;l<o;){var _=l++;this[_+t]=s[_]}}},ao._subarray=function(e,t){var n=ao._new(this.slice(e,t));return n.byteOffset=4*e,n};var so=function(){};(n["js.html.compat.Uint8Array"]=so).__name__=["js","html","compat","Uint8Array"],so._new=function(e,t,n){var i;if("number"==typeof e){i=[];for(var r=0,a=e;r<a;)i[r++]=0;i.byteLength=i.length,i.byteOffset=0,i.buffer=new io(i)}else if(p.is(e,io)){var s=e;null==t&&(t=0),null==n&&(n=s.byteLength-t),(i=0==t?s.a:s.a.slice(t,t+n)).byteLength=i.length,i.byteOffset=t,i.buffer=s}else{if(!(e instanceof Array&&null==e.__enum__))throw new $l("TODO "+p.string(e));(i=e.slice()).byteLength=i.length,i.byteOffset=0,i.buffer=new io(i)}return i.subarray=so._subarray,i.set=so._set,i},so._set=function(e,t){if(p.is(e.buffer,io)){var n=e;if(e.byteLength+t>this.byteLength)throw new $l("set() outside of range");for(var i=0,r=e.byteLength;i<r;){var a=i++;this[a+t]=n[a]}}else{if(!(e instanceof Array&&null==e.__enum__))throw new $l("TODO");var s=e;if(s.length+t>this.byteLength)throw new $l("set() outside of range");for(var l=0,o=s.length;l<o;){var _=l++;this[_+t]=s[_]}}},so._subarray=function(e,t){var n=so._new(this.slice(e,t));return n.byteOffset=e,n};var lo=function(){};(n["nape.Config"]=lo).__name__=["nape","Config"],lo.prototype={__class__:lo};var oo=function(){this.zpp_inner=null};(n["nape.callbacks.Callback"]=oo).__name__=["nape","callbacks","Callback"],oo.prototype={zpp_inner:null,get_event:function(){return sp.events[this.zpp_inner.event]},get_listener:function(){return this.zpp_inner.listener.outer},toString:function(){return""},__class__:oo,__properties__:{get_listener:"get_listener",get_event:"get_event"}};var _o=function(){oo.call(this)};(n["nape.callbacks.BodyCallback"]=_o).__name__=["nape","callbacks","BodyCallback"],_o.__super__=oo,_o.prototype=r(oo.prototype,{get_body:function(){return this.zpp_inner.body.outer},toString:function(){var e="Cb:";return e+=["WAKE","SLEEP"][this.zpp_inner.event-2],e+=":"+this.get_body().toString(),e+=" : listener: "+p.string(this.get_listener())},__class__:_o,__properties__:r(oo.prototype.__properties__,{get_body:"get_body"})});var po=function(){this.zpp_inner=null};(n["nape.callbacks.Listener"]=po).__name__=["nape","callbacks","Listener"],po.prototype={zpp_inner:null,get_type:function(){return sp.types[this.zpp_inner.type]},get_event:function(){return sp.events[this.zpp_inner.event]},set_event:function(e){if(this.get_event()!=e){var t=e==ho.get_BEGIN()?0:e==ho.get_ONGOING()?6:e==ho.get_END()?1:e==ho.get_SLEEP()?3:e==ho.get_WAKE()?2:e==ho.get_PRE()?5:4;this.zpp_inner.swapEvent(t)}return this.get_event()},get_precedence:function(){return this.zpp_inner.precedence},set_precedence:function(e){return this.get_precedence()!=e&&(this.zpp_inner.precedence=e,this.zpp_inner.invalidate_precedence()),this.get_precedence()},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(e){return this.get_space()!=e&&(null!=this.zpp_inner.space&&this.zpp_inner.space.outer.get_listeners().remove(this),null!=e?e.get_listeners().add(this):this.zpp_inner.space=null),this.get_space()},toString:function(){var e=["BEGIN","END","WAKE","SLEEP","BREAK","PRE","ONGOING"][this.zpp_inner.event];if(0==this.zpp_inner.type){var t=this.zpp_inner.body;return"BodyListener{"+e+"::"+p.string(t.outer_zn.get_options())+"}"}if(1==this.zpp_inner.type){var n=this.zpp_inner.constraint;return"ConstraintListener{"+e+"::"+p.string(n.outer_zn.get_options())+"}"}var i,r=this.zpp_inner.interaction;switch(r.itype){case 1:i="COLLISION";break;case 2:i="SENSOR";break;case 4:i="FLUID";break;default:i="ALL"}return(2==this.zpp_inner.type?"InteractionListener{"+e+"#"+i+"::"+p.string(r.outer_zni.get_options1())+":"+p.string(r.outer_zni.get_options2())+"}":"PreListener{"+i+"::"+p.string(r.outer_znp.get_options1())+":"+p.string(r.outer_znp.get_options2())+"}")+" precedence="+this.zpp_inner.precedence},__class__:po,__properties__:{set_space:"set_space",get_space:"get_space",set_precedence:"set_precedence",get_precedence:"get_precedence",set_event:"set_event",get_event:"get_event",get_type:"get_type"}};var uo=function(e,t,n,i){null==i&&(i=0),this.zpp_inner_zn=null,po.call(this);var r=-1;e==ho.get_WAKE()?r=2:e==ho.get_SLEEP()&&(r=3),this.zpp_inner_zn=new lp(up.argument(t),r,n),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner.precedence=i};(n["nape.callbacks.BodyListener"]=uo).__name__=["nape","callbacks","BodyListener"],uo.__super__=po,uo.prototype=r(po.prototype,{zpp_inner_zn:null,get_options:function(){return this.zpp_inner_zn.options.outer},set_options:function(e){return this.zpp_inner_zn.options.set(e.zpp_inner),this.get_options()},get_handler:function(){return this.zpp_inner_zn.handler},set_handler:function(e){return this.zpp_inner_zn.handler=e,this.get_handler()},__class__:uo,__properties__:r(po.prototype.__properties__,{set_handler:"set_handler",get_handler:"get_handler",set_options:"set_options",get_options:"get_options"})});var ho=function(){};(n["nape.callbacks.CbEvent"]=ho).__name__=["nape","callbacks","CbEvent"],ho.__properties__={get_PRE:"get_PRE",get_BREAK:"get_BREAK",get_SLEEP:"get_SLEEP",get_WAKE:"get_WAKE",get_END:"get_END",get_ONGOING:"get_ONGOING",get_BEGIN:"get_BEGIN"},ho.get_BEGIN=function(){return null==ap.CbEvent_BEGIN&&(ap.internal=!0,ap.CbEvent_BEGIN=new ho,ap.internal=!1),ap.CbEvent_BEGIN},ho.get_ONGOING=function(){return null==ap.CbEvent_ONGOING&&(ap.internal=!0,ap.CbEvent_ONGOING=new ho,ap.internal=!1),ap.CbEvent_ONGOING},ho.get_END=function(){return null==ap.CbEvent_END&&(ap.internal=!0,ap.CbEvent_END=new ho,ap.internal=!1),ap.CbEvent_END},ho.get_WAKE=function(){return null==ap.CbEvent_WAKE&&(ap.internal=!0,ap.CbEvent_WAKE=new ho,ap.internal=!1),ap.CbEvent_WAKE},ho.get_SLEEP=function(){return null==ap.CbEvent_SLEEP&&(ap.internal=!0,ap.CbEvent_SLEEP=new ho,ap.internal=!1),ap.CbEvent_SLEEP},ho.get_BREAK=function(){return null==ap.CbEvent_BREAK&&(ap.internal=!0,ap.CbEvent_BREAK=new ho,ap.internal=!1),ap.CbEvent_BREAK},ho.get_PRE=function(){return null==ap.CbEvent_PRE&&(ap.internal=!0,ap.CbEvent_PRE=new ho,ap.internal=!1),ap.CbEvent_PRE},ho.prototype={toString:function(){return this==ho.get_PRE()?"PRE":this==ho.get_BEGIN()?"BEGIN":this==ho.get_ONGOING()?"ONGOING":this==ho.get_END()?"END":this==ho.get_WAKE()?"WAKE":this==ho.get_SLEEP()?"SLEEP":this==ho.get_BREAK()?"BREAK":""},__class__:ho};var co=function(){this.zpp_inner=null,this.zpp_inner=new rp,this.zpp_inner.outer=this};(n["nape.callbacks.CbType"]=co).__name__=["nape","callbacks","CbType"],co.__properties__={get_ANY_COMPOUND:"get_ANY_COMPOUND",get_ANY_SHAPE:"get_ANY_SHAPE",get_ANY_CONSTRAINT:"get_ANY_CONSTRAINT",get_ANY_BODY:"get_ANY_BODY"},co.get_ANY_BODY=function(){return rp.ANY_BODY},co.get_ANY_CONSTRAINT=function(){return rp.ANY_CONSTRAINT},co.get_ANY_SHAPE=function(){return rp.ANY_SHAPE},co.get_ANY_COMPOUND=function(){return rp.ANY_COMPOUND},co.prototype={zpp_inner:null,get_id:function(){return this.zpp_inner.id},including:function(e){return new So(this).including(e)},excluding:function(e){return new So(this).excluding(e)},get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_interactors:function(){return null==this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=Yh.get(this.zpp_inner.interactors,!0)),this.zpp_inner.wrap_interactors},get_constraints:function(){return null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=Xh.get(this.zpp_inner.constraints,!0)),this.zpp_inner.wrap_constraints},toString:function(){return this==co.get_ANY_BODY()?"ANY_BODY":this==co.get_ANY_SHAPE()?"ANY_SHAPE":this==co.get_ANY_COMPOUND()?"ANY_COMPOUND":this==co.get_ANY_CONSTRAINT()?"ANY_CONSTRAINT":"CbType#"+this.get_id()},__class__:co,__properties__:{get_constraints:"get_constraints",get_interactors:"get_interactors",get_userData:"get_userData",get_id:"get_id"}};var mo=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.callbacks.CbTypeIterator"]=mo).__name__=["nape","callbacks","CbTypeIterator"],mo.get=function(e){var t;if(null==mo.zpp_pool){Qh.internal=!0;var n=new mo;Qh.internal=!1,t=n}else{var i=mo.zpp_pool;mo.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},mo.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=mo.zpp_pool,(mo.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:mo};var fo=function(){this.zpp_inner=null,this.zpp_inner=new Qh,this.zpp_inner.outer=this};(n["nape.callbacks.CbTypeList"]=fo).__name__=["nape","callbacks","CbTypeList"],fo.fromArray=function(e){for(var t=new fo,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},fo.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),mo.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new fo,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=mo.zpp_pool,(mo.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:fo,__properties__:{get_length:"get_length"}};var go=function(){oo.call(this)};(n["nape.callbacks.ConstraintCallback"]=go).__name__=["nape","callbacks","ConstraintCallback"],go.__super__=oo,go.prototype=r(oo.prototype,{get_constraint:function(){return this.zpp_inner.constraint.outer},toString:function(){var e="Cb:";return e+=["WAKE","SLEEP","BREAK"][this.zpp_inner.event-2],e+=":"+this.get_constraint().toString(),e+=" : listener: "+p.string(this.get_listener())},__class__:go,__properties__:r(oo.prototype.__properties__,{get_constraint:"get_constraint"})});var vo=function(e,t,n,i){null==i&&(i=0),this.zpp_inner_zn=null,po.call(this);var r=-1;e==ho.get_WAKE()?r=2:e==ho.get_SLEEP()?r=3:e==ho.get_BREAK()&&(r=4),this.zpp_inner_zn=new op(up.argument(t),r,n),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner.precedence=i};(n["nape.callbacks.ConstraintListener"]=vo).__name__=["nape","callbacks","ConstraintListener"],vo.__super__=po,vo.prototype=r(po.prototype,{zpp_inner_zn:null,get_options:function(){return this.zpp_inner_zn.options.outer},set_options:function(e){return this.zpp_inner_zn.options.set(e.zpp_inner),this.get_options()},get_handler:function(){return this.zpp_inner_zn.handler},set_handler:function(e){return this.zpp_inner_zn.handler=e,this.get_handler()},__class__:vo,__properties__:r(po.prototype.__properties__,{set_handler:"set_handler",get_handler:"get_handler",set_options:"set_options",get_options:"get_options"})});var bo=function(){oo.call(this)};(n["nape.callbacks.InteractionCallback"]=bo).__name__=["nape","callbacks","InteractionCallback"],bo.__super__=oo,bo.prototype=r(oo.prototype,{get_int1:function(){return this.zpp_inner.int1.outer_i},get_int2:function(){return this.zpp_inner.int2.outer_i},get_arbiters:function(){return this.zpp_inner.wrap_arbiters},toString:function(){var e="Cb:";return e+=["BEGIN","END","","","","","ONGOING"][this.zpp_inner.event],e+=":"+this.get_int1().toString()+"/"+this.get_int2().toString(),e+=" : "+this.get_arbiters().toString(),e+=" : listener: "+p.string(this.get_listener())},__class__:bo,__properties__:r(oo.prototype.__properties__,{get_arbiters:"get_arbiters",get_int2:"get_int2",get_int1:"get_int1"})});var yo=function(e,t,n,i,r,a){null==a&&(a=0),this.zpp_inner_zn=null,po.call(this);var s=-1;e==ho.get_BEGIN()?s=0:e==ho.get_END()?s=1:e==ho.get_ONGOING()&&(s=6),this.zpp_inner_zn=new pp(up.argument(n),up.argument(i),s,2),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_zni=this).zpp_inner.precedence=a,this.zpp_inner_zn.handleri=r,this.set_interactionType(t)};(n["nape.callbacks.InteractionListener"]=yo).__name__=["nape","callbacks","InteractionListener"],yo.__super__=po,yo.prototype=r(po.prototype,{zpp_inner_zn:null,get_options1:function(){return this.zpp_inner_zn.options1.outer},set_options1:function(e){return this.zpp_inner_zn.options1.set(e.zpp_inner),this.get_options1()},get_options2:function(){return this.zpp_inner_zn.options2.outer},set_options2:function(e){return this.zpp_inner_zn.options2.set(e.zpp_inner),this.get_options2()},get_interactionType:function(){var e=this.zpp_inner_zn.itype;return 1==e?xo.get_COLLISION():2==e?xo.get_SENSOR():4==e?xo.get_FLUID():7==e?xo.get_ANY():null},set_interactionType:function(e){if(this.get_interactionType()!=e){var t=e==xo.get_COLLISION()?1:e==xo.get_SENSOR()?2:e==xo.get_FLUID()?4:7;this.zpp_inner_zn.setInteractionType(t)}return this.get_interactionType()},get_handler:function(){return this.zpp_inner_zn.handleri},set_handler:function(e){return this.zpp_inner_zn.handleri=e,this.get_handler()},get_allowSleepingCallbacks:function(){return this.zpp_inner_zn.allowSleepingCallbacks},set_allowSleepingCallbacks:function(e){return this.zpp_inner_zn.allowSleepingCallbacks=e,this.get_allowSleepingCallbacks()},__class__:yo,__properties__:r(po.prototype.__properties__,{set_allowSleepingCallbacks:"set_allowSleepingCallbacks",get_allowSleepingCallbacks:"get_allowSleepingCallbacks",set_handler:"set_handler",get_handler:"get_handler",set_interactionType:"set_interactionType",get_interactionType:"get_interactionType",set_options2:"set_options2",get_options2:"get_options2",set_options1:"set_options1",get_options1:"get_options1"})});var xo=function(){};(n["nape.callbacks.InteractionType"]=xo).__name__=["nape","callbacks","InteractionType"],xo.__properties__={get_ANY:"get_ANY",get_FLUID:"get_FLUID",get_SENSOR:"get_SENSOR",get_COLLISION:"get_COLLISION"},xo.get_COLLISION=function(){return null==ap.InteractionType_COLLISION&&(ap.internal=!0,ap.InteractionType_COLLISION=new xo,ap.internal=!1),ap.InteractionType_COLLISION},xo.get_SENSOR=function(){return null==ap.InteractionType_SENSOR&&(ap.internal=!0,ap.InteractionType_SENSOR=new xo,ap.internal=!1),ap.InteractionType_SENSOR},xo.get_FLUID=function(){return null==ap.InteractionType_FLUID&&(ap.internal=!0,ap.InteractionType_FLUID=new xo,ap.internal=!1),ap.InteractionType_FLUID},xo.get_ANY=function(){return null==ap.InteractionType_ANY&&(ap.internal=!0,ap.InteractionType_ANY=new xo,ap.internal=!1),ap.InteractionType_ANY},xo.prototype={toString:function(){return this==xo.get_COLLISION()?"COLLISION":this==xo.get_SENSOR()?"SENSOR":this==xo.get_FLUID()?"FLUID":this==xo.get_ANY()?"ANY":""},__class__:xo};var zo=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.callbacks.ListenerIterator"]=zo).__name__=["nape","callbacks","ListenerIterator"],zo.get=function(e){var t;if(null==zo.zpp_pool){Kh.internal=!0;var n=new zo;Kh.internal=!1,t=n}else{var i=zo.zpp_pool;zo.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},zo.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=zo.zpp_pool,(zo.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:zo};var wo=function(){this.zpp_inner=null,this.zpp_inner=new Kh,this.zpp_inner.outer=this};(n["nape.callbacks.ListenerList"]=wo).__name__=["nape","callbacks","ListenerList"],wo.fromArray=function(e){for(var t=new wo,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},wo.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),zo.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new wo,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=zo.zpp_pool,(zo.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:wo,__properties__:{get_length:"get_length"}};var ko=function(){};(n["nape.callbacks.ListenerType"]=ko).__name__=["nape","callbacks","ListenerType"],ko.__properties__={get_PRE:"get_PRE",get_INTERACTION:"get_INTERACTION",get_CONSTRAINT:"get_CONSTRAINT",get_BODY:"get_BODY"},ko.get_BODY=function(){return null==ap.ListenerType_BODY&&(ap.internal=!0,ap.ListenerType_BODY=new ko,ap.internal=!1),ap.ListenerType_BODY},ko.get_CONSTRAINT=function(){return null==ap.ListenerType_CONSTRAINT&&(ap.internal=!0,ap.ListenerType_CONSTRAINT=new ko,ap.internal=!1),ap.ListenerType_CONSTRAINT},ko.get_INTERACTION=function(){return null==ap.ListenerType_INTERACTION&&(ap.internal=!0,ap.ListenerType_INTERACTION=new ko,ap.internal=!1),ap.ListenerType_INTERACTION},ko.get_PRE=function(){return null==ap.ListenerType_PRE&&(ap.internal=!0,ap.ListenerType_PRE=new ko,ap.internal=!1),ap.ListenerType_PRE},ko.prototype={toString:function(){return this==ko.get_BODY()?"BODY":this==ko.get_CONSTRAINT()?"CONSTRAINT":this==ko.get_INTERACTION()?"INTERACTION":this==ko.get_PRE()?"PRE":""},__class__:ko};var So=function(e,t){this.zpp_inner=null,this.zpp_inner=new up,this.zpp_inner.outer=this,null!=e&&this.including(e),null!=t&&this.excluding(t)};(n["nape.callbacks.OptionType"]=So).__name__=["nape","callbacks","OptionType"],So.prototype={zpp_inner:null,get_includes:function(){return null==this.zpp_inner.wrap_includes&&this.zpp_inner.setup_includes(),this.zpp_inner.wrap_includes},get_excludes:function(){return null==this.zpp_inner.wrap_excludes&&this.zpp_inner.setup_excludes(),this.zpp_inner.wrap_excludes},including:function(e){return this.zpp_inner.append(this.zpp_inner.includes,e),this},excluding:function(e){return this.zpp_inner.append(this.zpp_inner.excludes,e),this},toString:function(){return"@{"+this.get_includes().toString()+" excluding "+this.get_excludes().toString()+"}"},__class__:So,__properties__:{get_excludes:"get_excludes",get_includes:"get_includes"}};var Co=function(){oo.call(this)};(n["nape.callbacks.PreCallback"]=Co).__name__=["nape","callbacks","PreCallback"],Co.__super__=oo,Co.prototype=r(oo.prototype,{get_arbiter:function(){return this.zpp_inner.pre_arbiter.wrapper()},get_int1:function(){return this.zpp_inner.int1.outer_i},get_int2:function(){return this.zpp_inner.int2.outer_i},get_swapped:function(){return this.zpp_inner.pre_swapped},toString:function(){var e="Cb:PRE:";return e+=":"+this.get_int1().toString()+"/"+this.get_int2().toString(),e+=" : "+this.get_arbiter().toString(),e+=" : listnener: "+p.string(this.get_listener())},__class__:Co,__properties__:r(oo.prototype.__properties__,{get_swapped:"get_swapped",get_int2:"get_int2",get_int1:"get_int1",get_arbiter:"get_arbiter"})});var No=function(){};(n["nape.callbacks.PreFlag"]=No).__name__=["nape","callbacks","PreFlag"],No.__properties__={get_IGNORE_ONCE:"get_IGNORE_ONCE",get_ACCEPT_ONCE:"get_ACCEPT_ONCE",get_IGNORE:"get_IGNORE",get_ACCEPT:"get_ACCEPT"},No.get_ACCEPT=function(){return null==ap.PreFlag_ACCEPT&&(ap.internal=!0,ap.PreFlag_ACCEPT=new No,ap.internal=!1),ap.PreFlag_ACCEPT},No.get_IGNORE=function(){return null==ap.PreFlag_IGNORE&&(ap.internal=!0,ap.PreFlag_IGNORE=new No,ap.internal=!1),ap.PreFlag_IGNORE},No.get_ACCEPT_ONCE=function(){return null==ap.PreFlag_ACCEPT_ONCE&&(ap.internal=!0,ap.PreFlag_ACCEPT_ONCE=new No,ap.internal=!1),ap.PreFlag_ACCEPT_ONCE},No.get_IGNORE_ONCE=function(){return null==ap.PreFlag_IGNORE_ONCE&&(ap.internal=!0,ap.PreFlag_IGNORE_ONCE=new No,ap.internal=!1),ap.PreFlag_IGNORE_ONCE},No.prototype={toString:function(){return this==No.get_ACCEPT()?"ACCEPT":this==No.get_IGNORE()?"IGNORE":this==No.get_ACCEPT_ONCE()?"ACCEPT_ONCE":this==No.get_IGNORE_ONCE()?"IGNORE_ONCE":""},__class__:No};var Po=function(e,t,n,i,r,a){null==a&&(a=!1),null==r&&(r=0),this.zpp_inner_zn=null,po.call(this),this.zpp_inner_zn=new pp(up.argument(t),up.argument(n),5,3),this.zpp_inner=this.zpp_inner_zn,((this.zpp_inner.outer=this).zpp_inner_zn.outer_znp=this).zpp_inner.precedence=r,this.zpp_inner_zn.pure=a,this.zpp_inner_zn.handlerp=i,this.set_interactionType(e)};(n["nape.callbacks.PreListener"]=Po).__name__=["nape","callbacks","PreListener"],Po.__super__=po,Po.prototype=r(po.prototype,{zpp_inner_zn:null,get_options1:function(){return this.zpp_inner_zn.options1.outer},set_options1:function(e){return this.zpp_inner_zn.options1.set(e.zpp_inner),this.get_options1()},get_options2:function(){return this.zpp_inner_zn.options2.outer},set_options2:function(e){return this.zpp_inner_zn.options2.set(e.zpp_inner),this.get_options2()},get_handler:function(){return this.zpp_inner_zn.handlerp},set_handler:function(e){return this.zpp_inner_zn.handlerp=e,this.zpp_inner_zn.wake(),this.get_handler()},get_pure:function(){return this.zpp_inner_zn.pure},set_pure:function(e){return e||this.zpp_inner_zn.wake(),this.zpp_inner_zn.pure=e,this.get_pure()},get_interactionType:function(){var e=this.zpp_inner_zn.itype;return 1==e?xo.get_COLLISION():2==e?xo.get_SENSOR():4==e?xo.get_FLUID():7==e?xo.get_ANY():null},set_interactionType:function(e){if(this.get_interactionType()!=e){var t=e==xo.get_COLLISION()?1:e==xo.get_SENSOR()?2:e==xo.get_FLUID()?4:7;this.zpp_inner_zn.setInteractionType(t)}return this.get_interactionType()},__class__:Po,__properties__:r(po.prototype.__properties__,{set_interactionType:"set_interactionType",get_interactionType:"get_interactionType",set_pure:"set_pure",get_pure:"get_pure",set_handler:"set_handler",get_handler:"get_handler",set_options2:"set_options2",get_options2:"get_options2",set_options1:"set_options1",get_options1:"get_options1"})});var Mo=function(){this.debugDraw=!0,this.zpp_inner.insert_cbtype(co.get_ANY_CONSTRAINT().zpp_inner)};(n["nape.constraint.Constraint"]=Mo).__name__=["nape","constraint","Constraint"],Mo.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},debugDraw:null,get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(e){return this.get_compound()!=e&&(null!=this.get_compound()&&this.get_compound().get_constraints().remove(this),null!=e&&e.get_constraints().add(this)),this.get_compound()},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(e){return this.get_space()!=e&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),null!=this.zpp_inner.space&&this.zpp_inner.space.outer.get_constraints().remove(this),null!=e?e.get_constraints().add(this):this.zpp_inner.space=null),this.get_space()},get_isSleeping:function(){return this.zpp_inner.component.sleeping},get_active:function(){return this.zpp_inner.active},set_active:function(e){return this.get_active()!=e&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.woken=!1),this.zpp_inner.clearcache(),e?(this.zpp_inner.active=e,this.zpp_inner.activate(),null!=this.zpp_inner.space&&(null!=this.zpp_inner.component&&(this.zpp_inner.component.sleeping=!0),this.zpp_inner.space.wake_constraint(this.zpp_inner,!0))):(null!=this.zpp_inner.space&&(this.zpp_inner.wake(),this.zpp_inner.space.live_constraints.remove(this.zpp_inner)),this.zpp_inner.active=e,this.zpp_inner.deactivate())),this.get_active()},get_ignore:function(){return this.zpp_inner.ignore},set_ignore:function(e){return this.get_ignore()!=e&&(this.zpp_inner.ignore=e,this.zpp_inner.wake()),this.get_ignore()},get_stiff:function(){return this.zpp_inner.stiff},set_stiff:function(e){return this.get_stiff()!=e&&(this.zpp_inner.stiff=e,this.zpp_inner.wake()),this.get_stiff()},get_frequency:function(){return this.zpp_inner.frequency},set_frequency:function(e){return this.get_frequency()!=e&&(this.zpp_inner.frequency=e,this.zpp_inner.stiff||this.zpp_inner.wake()),this.get_frequency()},get_damping:function(){return this.zpp_inner.damping},set_damping:function(e){return this.get_damping()!=e&&(this.zpp_inner.damping=e,this.zpp_inner.stiff||this.zpp_inner.wake()),this.get_damping()},get_maxForce:function(){return this.zpp_inner.maxForce},set_maxForce:function(e){return this.get_maxForce()!=e&&(this.zpp_inner.maxForce=e,this.zpp_inner.wake()),this.get_maxForce()},get_maxError:function(){return this.zpp_inner.maxError},set_maxError:function(e){return this.get_maxError()!=e&&(this.zpp_inner.maxError=e,this.zpp_inner.wake()),this.get_maxError()},get_breakUnderForce:function(){return this.zpp_inner.breakUnderForce},set_breakUnderForce:function(e){return this.get_breakUnderForce()!=e&&(this.zpp_inner.breakUnderForce=e,this.zpp_inner.wake()),this.get_breakUnderForce()},get_breakUnderError:function(){return this.zpp_inner.breakUnderError},set_breakUnderError:function(e){return this.get_breakUnderError()!=e&&(this.zpp_inner.breakUnderError=e,this.zpp_inner.wake()),this.get_breakUnderError()},get_removeOnBreak:function(){return this.zpp_inner.removeOnBreak},set_removeOnBreak:function(e){return this.zpp_inner.removeOnBreak=e,this.get_removeOnBreak()},impulse:function(){return null},bodyImpulse:function(e){return null},visitBodies:function(e){},get_cbTypes:function(){return null==this.zpp_inner.wrap_cbTypes&&this.zpp_inner.setupcbTypes(),this.zpp_inner.wrap_cbTypes},toString:function(){return"{Constraint}"},copy:function(){return this.zpp_inner.copy()},__class__:Mo,__properties__:{get_cbTypes:"get_cbTypes",set_removeOnBreak:"set_removeOnBreak",get_removeOnBreak:"get_removeOnBreak",set_breakUnderError:"set_breakUnderError",get_breakUnderError:"get_breakUnderError",set_breakUnderForce:"set_breakUnderForce",get_breakUnderForce:"get_breakUnderForce",set_maxError:"set_maxError",get_maxError:"get_maxError",set_maxForce:"set_maxForce",get_maxForce:"get_maxForce",set_damping:"set_damping",get_damping:"get_damping",set_frequency:"set_frequency",get_frequency:"get_frequency",set_stiff:"set_stiff",get_stiff:"get_stiff",set_ignore:"set_ignore",get_ignore:"get_ignore",set_active:"set_active",get_active:"get_active",get_isSleeping:"get_isSleeping",set_space:"set_space",get_space:"get_space",set_compound:"set_compound",get_compound:"get_compound",get_userData:"get_userData"}};var Io=function(e,t,n,i,r){null==r&&(r=1),this.zpp_inner_zn=null,this.zpp_inner_zn=new cp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Mo.call(this),this.set_body1(e),this.set_body2(t),this.set_jointMin(n),this.set_jointMax(i),this.set_ratio(r)};(n["nape.constraint.AngleJoint"]=Io).__name__=["nape","constraint","AngleJoint"],Io.__super__=Mo,Io.prototype=r(Mo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(e){return this.zpp_inner.immutable_midstep("AngleJoint::jointMin"),this.get_jointMin()!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.get_jointMin()},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(e){return this.zpp_inner.immutable_midstep("AngleJoint::jointMax"),this.get_jointMax()!=e&&(this.zpp_inner_zn.jointMax=e,this.zpp_inner.wake()),this.get_jointMax()},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(e){return this.zpp_inner.immutable_midstep("AngleJoint::ratio"),this.get_ratio()!=e&&(this.zpp_inner_zn.ratio=e,this.zpp_inner.wake()),this.get_ratio()},isSlack:function(){return this.zpp_inner_zn.is_slack()},impulse:function(){var e=new __(1,1);return e.setx(0,0,this.zpp_inner_zn.jAcc),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):g_.get(0,0,0)},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Io,__properties__:r(Mo.prototype.__properties__,{set_ratio:"set_ratio",get_ratio:"get_ratio",set_jointMax:"set_jointMax",get_jointMax:"get_jointMax",set_jointMin:"set_jointMin",get_jointMin:"get_jointMin",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Ao=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.constraint.ConstraintIterator"]=Ao).__name__=["nape","constraint","ConstraintIterator"],Ao.get=function(e){var t;if(null==Ao.zpp_pool){Xh.internal=!0;var n=new Ao;Xh.internal=!1,t=n}else{var i=Ao.zpp_pool;Ao.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Ao.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Ao.zpp_pool,(Ao.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Ao};var To=function(){this.zpp_inner=null,this.zpp_inner=new Xh,this.zpp_inner.outer=this};(n["nape.constraint.ConstraintList"]=To).__name__=["nape","constraint","ConstraintList"],To.fromArray=function(e){for(var t=new To,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},To.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),Ao.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new To,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Ao.zpp_pool,(Ao.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:To,__properties__:{get_length:"get_length"}};var Do=function(e,t,n,i,r,a){this.zpp_inner_zn=null,this.zpp_inner_zn=new mp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Mo.call(this),this.set_body1(e),this.set_body2(t),this.set_anchor1(n),this.set_anchor2(i),this.set_jointMin(r),this.set_jointMax(a)};(n["nape.constraint.DistanceJoint"]=Do).__name__=["nape","constraint","DistanceJoint"],Do.__super__=Mo,Do.prototype=r(Mo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(e){return this.zpp_inner.immutable_midstep("DistanceJoint::jointMin"),this.get_jointMin()!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.get_jointMin()},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(e){return this.zpp_inner.immutable_midstep("DistanceJoint::jointMax"),this.get_jointMax()!=e&&(this.zpp_inner_zn.jointMax=e,this.zpp_inner.wake()),this.get_jointMax()},isSlack:function(){return this.zpp_inner_zn.slack},impulse:function(){var e=new __(1,1);return e.setx(0,0,this.zpp_inner_zn.jAcc),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):g_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Do,__properties__:r(Mo.prototype.__properties__,{set_jointMax:"set_jointMax",get_jointMax:"get_jointMax",set_jointMin:"set_jointMin",get_jointMin:"get_jointMin",set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Eo=function(e,t,n,i,r,a,s){this.zpp_inner_zn=null,this.zpp_inner_zn=new fp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Mo.call(this),this.set_body1(e),this.set_body2(t),this.set_anchor1(n),this.set_anchor2(i),this.set_direction(r),this.set_jointMin(a),this.set_jointMax(s)};(n["nape.constraint.LineJoint"]=Eo).__name__=["nape","constraint","LineJoint"],Eo.__super__=Mo,Eo.prototype=r(Mo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},get_direction:function(){return null==this.zpp_inner_zn.wrap_n&&this.zpp_inner_zn.setup_n(),this.zpp_inner_zn.wrap_n},set_direction:function(e){return this.get_direction().set(e),this.get_direction()},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(e){return this.zpp_inner.immutable_midstep("LineJoint::jointMin"),this.get_jointMin()!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.get_jointMin()},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(e){return this.zpp_inner.immutable_midstep("LineJoint::jointMax"),this.get_jointMax()!=e&&(this.zpp_inner_zn.jointMax=e,this.zpp_inner.wake()),this.get_jointMax()},impulse:function(){var e=new __(2,1);return e.setx(0,0,this.zpp_inner_zn.jAccx),e.setx(1,0,this.zpp_inner_zn.jAccy),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):g_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Eo,__properties__:r(Mo.prototype.__properties__,{set_jointMax:"set_jointMax",get_jointMax:"get_jointMax",set_jointMin:"set_jointMin",get_jointMin:"get_jointMin",set_direction:"set_direction",get_direction:"get_direction",set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Oo=function(e,t,n,i){null==i&&(i=1),null==n&&(n=0),this.zpp_inner_zn=null,this.zpp_inner_zn=new gp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Mo.call(this),this.set_body1(e),this.set_body2(t),this.set_rate(n),this.set_ratio(i)};(n["nape.constraint.MotorJoint"]=Oo).__name__=["nape","constraint","MotorJoint"],Oo.__super__=Mo,Oo.prototype=r(Mo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(e){return this.zpp_inner.immutable_midstep("MotorJoint::ratio"),this.get_ratio()!=e&&(this.zpp_inner_zn.ratio=e,this.zpp_inner.wake()),this.get_ratio()},get_rate:function(){return this.zpp_inner_zn.rate},set_rate:function(e){return this.zpp_inner.immutable_midstep("MotorJoint::rate"),this.get_rate()!=e&&(this.zpp_inner_zn.rate=e,this.zpp_inner.wake()),this.get_rate()},impulse:function(){var e=new __(1,1);return e.setx(0,0,this.zpp_inner_zn.jAcc),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):g_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Oo,__properties__:r(Mo.prototype.__properties__,{set_rate:"set_rate",get_rate:"get_rate",set_ratio:"set_ratio",get_ratio:"get_ratio",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Bo=function(e,t,n,i){this.zpp_inner_zn=null,this.zpp_inner_zn=new vp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Mo.call(this),this.set_body1(e),this.set_body2(t),this.set_anchor1(n),this.set_anchor2(i)};(n["nape.constraint.PivotJoint"]=Bo).__name__=["nape","constraint","PivotJoint"],Bo.__super__=Mo,Bo.prototype=r(Mo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},impulse:function(){var e=new __(2,1);return e.setx(0,0,this.zpp_inner_zn.jAccx),e.setx(1,0,this.zpp_inner_zn.jAccy),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):g_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Bo,__properties__:r(Mo.prototype.__properties__,{set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Lo=function(e,t,n,i,r,a,s,l,o,_,p){null==p&&(p=1),this.zpp_inner_zn=null,this.zpp_inner_zn=new bp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Mo.call(this),this.set_body1(e),this.set_body2(t),this.set_body3(n),this.set_body4(i),this.set_anchor1(r),this.set_anchor2(a),this.set_anchor3(s),this.set_anchor4(l),this.set_ratio(p),this.set_jointMin(o),this.set_jointMax(_)};(n["nape.constraint.PulleyJoint"]=Lo).__name__=["nape","constraint","PulleyJoint"],Lo.__super__=Mo,Lo.prototype=r(Mo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b3!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b3!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_body3:function(){return null==this.zpp_inner_zn.b3?null:this.zpp_inner_zn.b3.outer},set_body3:function(e){this.zpp_inner.immutable_midstep("Constraint::body3");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b3&&(null!=this.zpp_inner_zn.b3&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b4!=this.zpp_inner_zn.b3&&null!=this.zpp_inner_zn.b3&&this.zpp_inner_zn.b3.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b3.wake()),this.zpp_inner_zn.b3=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b4!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body3()},get_body4:function(){return null==this.zpp_inner_zn.b4?null:this.zpp_inner_zn.b4.outer},set_body4:function(e){this.zpp_inner.immutable_midstep("Constraint::body4");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b4&&(null!=this.zpp_inner_zn.b4&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b3!=this.zpp_inner_zn.b4&&null!=this.zpp_inner_zn.b4&&this.zpp_inner_zn.b4.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b4.wake()),this.zpp_inner_zn.b4=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&this.zpp_inner_zn.b2!=t&&this.zpp_inner_zn.b3!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body4()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},get_anchor3:function(){return null==this.zpp_inner_zn.wrap_a3&&this.zpp_inner_zn.setup_a3(),this.zpp_inner_zn.wrap_a3},set_anchor3:function(e){return this.get_anchor3().set(e),this.get_anchor3()},get_anchor4:function(){return null==this.zpp_inner_zn.wrap_a4&&this.zpp_inner_zn.setup_a4(),this.zpp_inner_zn.wrap_a4},set_anchor4:function(e){return this.get_anchor4().set(e),this.get_anchor4()},get_jointMin:function(){return this.zpp_inner_zn.jointMin},set_jointMin:function(e){return this.zpp_inner.immutable_midstep("PulleyJoint::jointMin"),this.get_jointMin()!=e&&(this.zpp_inner_zn.jointMin=e,this.zpp_inner.wake()),this.get_jointMin()},get_jointMax:function(){return this.zpp_inner_zn.jointMax},set_jointMax:function(e){return this.zpp_inner.immutable_midstep("PulleyJoint::jointMax"),this.get_jointMax()!=e&&(this.zpp_inner_zn.jointMax=e,this.zpp_inner.wake()),this.get_jointMax()},get_ratio:function(){return this.zpp_inner_zn.ratio},set_ratio:function(e){return this.zpp_inner.immutable_midstep("PulleyJoint::ratio"),this.get_ratio()!=e&&(this.zpp_inner_zn.ratio=e,this.zpp_inner.wake()),this.get_ratio()},isSlack:function(){return this.zpp_inner_zn.slack},impulse:function(){var e=new __(1,1);return e.setx(0,0,this.zpp_inner_zn.jAcc),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):g_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2()),null!=this.get_body3()&&this.get_body3()!=this.get_body1()&&this.get_body3()!=this.get_body2()&&e(this.get_body3()),null!=this.get_body4()&&this.get_body4()!=this.get_body1()&&this.get_body4()!=this.get_body2()&&this.get_body4()!=this.get_body3()&&e(this.get_body4())},__class__:Lo,__properties__:r(Mo.prototype.__properties__,{set_ratio:"set_ratio",get_ratio:"get_ratio",set_jointMax:"set_jointMax",get_jointMax:"get_jointMax",set_jointMin:"set_jointMin",get_jointMin:"get_jointMin",set_anchor4:"set_anchor4",get_anchor4:"get_anchor4",set_anchor3:"set_anchor3",get_anchor3:"get_anchor3",set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body4:"set_body4",get_body4:"get_body4",set_body3:"set_body3",get_body3:"get_body3",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var jo=function(e,t){null==t&&(t=!1),this.zpp_inner_zn=null,this.zpp_inner_zn=new yp(e,t),this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Mo.call(this)};(n["nape.constraint.UserConstraint"]=jo).__name__=["nape","constraint","UserConstraint"],jo.__super__=Mo,jo.prototype=r(Mo.prototype,{zpp_inner_zn:null,__bindVec2:function(){var e=new d_;return e.zpp_inner._inuse=!0,e.zpp_inner._invalidate=yc(vc=this.zpp_inner_zn,vc.bindVec2_invalidate),e},__copy:function(){return null},__broken:function(){},__validate:function(){},__draw:function(e){},__prepare:function(){},__position:function(e){},__velocity:function(e){},__eff_mass:function(e){},__clamp:function(e){},__impulse:function(e,t,n){},impulse:function(){for(var e=new __(this.zpp_inner_zn.dim,1),t=0,n=this.zpp_inner_zn.dim;t<n;){var i=t++;e.setx(i,0,this.zpp_inner_zn.jAcc[i])}return e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):g_.get()},visitBodies:function(e){for(var t=0,n=this.zpp_inner_zn.bodies.length;t<n;){var i=this.zpp_inner_zn.bodies[t];if(null!=i.body){for(var r=!1,a=t+1,s=n;a<s;){var l=a++;if(this.zpp_inner_zn.bodies[l].body==i.body){r=!0;break}}r||e(i.body.outer)}++t}},__invalidate:function(){this.zpp_inner.immutable_midstep("UserConstraint::invalidate()"),this.get_active()&&null!=this.get_space()&&this.zpp_inner.wake()},__registerBody:function(e,t){return this.zpp_inner.immutable_midstep("UserConstraint::registerBody(..)"),e!=t&&(null!=e&&(this.zpp_inner_zn.remBody(e.zpp_inner),this.get_active()&&null!=this.get_space()&&e.zpp_inner.wake()),null!=t&&this.zpp_inner_zn.addBody(t.zpp_inner),this.zpp_inner.wake(),null!=t&&t.zpp_inner.wake()),t},__class__:jo});var Fo=function(e,t,n,i,r){null==r&&(r=0),this.zpp_inner_zn=null,this.zpp_inner_zn=new zp,this.zpp_inner=this.zpp_inner_zn,(this.zpp_inner.outer=this).zpp_inner_zn.outer_zn=this,Mo.call(this),this.set_body1(e),this.set_body2(t),this.set_anchor1(n),this.set_anchor2(i),this.set_phase(r)};(n["nape.constraint.WeldJoint"]=Fo).__name__=["nape","constraint","WeldJoint"],Fo.__super__=Mo,Fo.prototype=r(Mo.prototype,{zpp_inner_zn:null,get_body1:function(){return null==this.zpp_inner_zn.b1?null:this.zpp_inner_zn.b1.outer},set_body1:function(e){this.zpp_inner.immutable_midstep("Constraint::body1");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b1&&(null!=this.zpp_inner_zn.b1&&(null!=this.get_space()&&this.zpp_inner_zn.b2!=this.zpp_inner_zn.b1&&null!=this.zpp_inner_zn.b1&&this.zpp_inner_zn.b1.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b1.wake()),this.zpp_inner_zn.b1=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b2!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body1()},get_body2:function(){return null==this.zpp_inner_zn.b2?null:this.zpp_inner_zn.b2.outer},set_body2:function(e){this.zpp_inner.immutable_midstep("Constraint::body2");var t=null==e?null:e.zpp_inner;return t!=this.zpp_inner_zn.b2&&(null!=this.zpp_inner_zn.b2&&(null!=this.get_space()&&this.zpp_inner_zn.b1!=this.zpp_inner_zn.b2&&null!=this.zpp_inner_zn.b2&&this.zpp_inner_zn.b2.constraints.remove(this.zpp_inner),this.get_active()&&null!=this.get_space()&&this.zpp_inner_zn.b2.wake()),this.zpp_inner_zn.b2=t,null!=this.get_space()&&null!=t&&this.zpp_inner_zn.b1!=t&&null!=t&&t.constraints.add(this.zpp_inner),this.get_active()&&null!=this.get_space()&&(this.zpp_inner.wake(),null!=t&&t.wake())),this.get_body2()},get_anchor1:function(){return null==this.zpp_inner_zn.wrap_a1&&this.zpp_inner_zn.setup_a1(),this.zpp_inner_zn.wrap_a1},set_anchor1:function(e){return this.get_anchor1().set(e),this.get_anchor1()},get_anchor2:function(){return null==this.zpp_inner_zn.wrap_a2&&this.zpp_inner_zn.setup_a2(),this.zpp_inner_zn.wrap_a2},set_anchor2:function(e){return this.get_anchor2().set(e),this.get_anchor2()},get_phase:function(){return this.zpp_inner_zn.phase},set_phase:function(e){return this.zpp_inner.immutable_midstep("WeldJoint::phase"),this.get_phase()!=e&&(this.zpp_inner_zn.phase=e,this.zpp_inner.wake()),this.get_phase()},impulse:function(){var e=new __(3,1);return e.setx(0,0,this.zpp_inner_zn.jAccx),e.setx(1,0,this.zpp_inner_zn.jAccy),e.setx(1,0,this.zpp_inner_zn.jAccz),e},bodyImpulse:function(e){return this.get_active()?this.zpp_inner_zn.bodyImpulse(e.zpp_inner):g_.get()},visitBodies:function(e){null!=this.get_body1()&&e(this.get_body1()),null!=this.get_body2()&&this.get_body2()!=this.get_body1()&&e(this.get_body2())},__class__:Fo,__properties__:r(Mo.prototype.__properties__,{set_phase:"set_phase",get_phase:"get_phase",set_anchor2:"set_anchor2",get_anchor2:"get_anchor2",set_anchor1:"set_anchor1",get_anchor1:"get_anchor1",set_body2:"set_body2",get_body2:"get_body2",set_body1:"set_body1",get_body1:"get_body1"})});var Ro=function(){this.zpp_inner=null,wp.internal};(n["nape.dynamics.Arbiter"]=Ro).__name__=["nape","dynamics","Arbiter"],Ro.prototype={zpp_inner:null,get_isSleeping:function(){return this.zpp_inner.sleeping},get_type:function(){return wp.types[this.zpp_inner.type]},isCollisionArbiter:function(){return this.zpp_inner.type==wp.COL},isFluidArbiter:function(){return this.zpp_inner.type==wp.FLUID},isSensorArbiter:function(){return this.zpp_inner.type==wp.SENSOR},get_collisionArbiter:function(){return this.isCollisionArbiter()?this.zpp_inner.colarb.outer_zn:null},get_fluidArbiter:function(){return this.isFluidArbiter()?this.zpp_inner.fluidarb.outer_zn:null},get_shape1:function(){return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws2.outer:this.zpp_inner.ws1.outer},get_shape2:function(){return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.ws1.outer:this.zpp_inner.ws2.outer},get_body1:function(){return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b2.outer:this.zpp_inner.b1.outer},get_body2:function(){return this.zpp_inner.ws1.id>this.zpp_inner.ws2.id?this.zpp_inner.b1.outer:this.zpp_inner.b2.outer},get_state:function(){var e=this.zpp_inner.immState;return 5==e?No.get_ACCEPT():1==e?No.get_ACCEPT_ONCE():6==e?No.get_IGNORE():No.get_IGNORE_ONCE()},totalImpulse:function(e,t){return null==t&&(t=!1),g_.get(0,0,0)},toString:function(){var e=this.isCollisionArbiter()?"CollisionArbiter":this.isFluidArbiter()?"FluidArbiter":"SensorArbiter";return this.zpp_inner.cleared?e+"(object-pooled)":e+"("+this.get_shape1().toString()+"|"+this.get_shape2().toString()+")"+(this.isCollisionArbiter()?"["+["SD","DD"][this.zpp_inner.colarb.stat?0:1]+"]":"")+"<-"+this.get_state().toString()},__class__:Ro,__properties__:{get_state:"get_state",get_body2:"get_body2",get_body1:"get_body1",get_shape2:"get_shape2",get_shape1:"get_shape1",get_fluidArbiter:"get_fluidArbiter",get_collisionArbiter:"get_collisionArbiter",get_type:"get_type",get_isSleeping:"get_isSleeping"}};var Go=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.dynamics.ArbiterIterator"]=Go).__name__=["nape","dynamics","ArbiterIterator"],Go.get=function(e){var t;if(null==Go.zpp_pool){sc.internal=!0;var n=new Go;sc.internal=!1,t=n}else{var i=Go.zpp_pool;Go.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Go.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Go.zpp_pool,(Go.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Go};var Zo=function(){this.zpp_inner=null,this.zpp_inner=new sc,this.zpp_inner.outer=this};(n["nape.dynamics.ArbiterList"]=Zo).__name__=["nape","dynamics","ArbiterList"],Zo.fromArray=function(e){for(var t=new Zo,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},Zo.prototype={zpp_inner:null,get_length:function(){return this.zpp_gl()},zpp_gl:function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var e=this.zpp_inner.inner.begin();null!=e;)e.elem().active&&this.zpp_inner.user_length++,e=e.next}return this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},has:function(e){return this.zpp_vm(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_vm(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.begin();!this.zpp_inner.at_ite.elem().active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;for(;this.zpp_inner.at_index!=e;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;!this.zpp_inner.at_ite.elem().active;)this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_vm(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.get_length()},iterator:function(){return this.zpp_vm(),Go.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new Zo,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Go.zpp_pool,(Go.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:Zo,__properties__:{get_length:"get_length"}};var Uo=function(){};(n["nape.dynamics.ArbiterType"]=Uo).__name__=["nape","dynamics","ArbiterType"],Uo.__properties__={get_FLUID:"get_FLUID",get_SENSOR:"get_SENSOR",get_COLLISION:"get_COLLISION"},Uo.get_COLLISION=function(){return null==ap.ArbiterType_COLLISION&&(ap.internal=!0,ap.ArbiterType_COLLISION=new Uo,ap.internal=!1),ap.ArbiterType_COLLISION},Uo.get_SENSOR=function(){return null==ap.ArbiterType_SENSOR&&(ap.internal=!0,ap.ArbiterType_SENSOR=new Uo,ap.internal=!1),ap.ArbiterType_SENSOR},Uo.get_FLUID=function(){return null==ap.ArbiterType_FLUID&&(ap.internal=!0,ap.ArbiterType_FLUID=new Uo,ap.internal=!1),ap.ArbiterType_FLUID},Uo.prototype={toString:function(){return this==Uo.get_COLLISION()?"COLLISION":this==Uo.get_SENSOR()?"SENSOR":this==Uo.get_FLUID()?"FLUID":""},__class__:Uo};var Vo=function(){Ro.call(this)};(n["nape.dynamics.CollisionArbiter"]=Vo).__name__=["nape","dynamics","CollisionArbiter"],Vo.__super__=Ro,Vo.prototype=r(Ro.prototype,{get_contacts:function(){return null==this.zpp_inner.colarb.wrap_contacts&&this.zpp_inner.colarb.setupcontacts(),this.zpp_inner.colarb.wrap_contacts},get_normal:function(){return null==this.zpp_inner.colarb.wrap_normal&&this.zpp_inner.colarb.getnormal(),this.zpp_inner.colarb.wrap_normal},get_radius:function(){return this.zpp_inner.colarb.radius},get_referenceEdge1:function(){var e=this.zpp_inner.colarb.__ref_edge1;return null==e||this.get_shape1().isPolygon()&&this.get_shape1().zpp_inner==e.polygon||(e=this.zpp_inner.colarb.__ref_edge2),null==e?null:e.wrapper()},get_referenceEdge2:function(){var e=this.zpp_inner.colarb.__ref_edge1;return null==e||this.get_shape2().isPolygon()&&this.get_shape2().zpp_inner==e.polygon||(e=this.zpp_inner.colarb.__ref_edge2),null==e?null:e.wrapper()},firstVertex:function(){return!(null!=this.zpp_inner.colarb.__ref_edge1==(null!=this.zpp_inner.colarb.__ref_edge2))&&-1==this.zpp_inner.colarb.__ref_vertex},secondVertex:function(){return!(null!=this.zpp_inner.colarb.__ref_edge1==(null!=this.zpp_inner.colarb.__ref_edge2))&&1==this.zpp_inner.colarb.__ref_vertex},normalImpulse:function(e,t){null==t&&(t=!1);var n=0,i=0,r=0,a=this.zpp_inner.colarb;if(!t||a.oc1.fresh){var s=a.oc1.wrapper().normalImpulse(e);n+=1*s.get_x(),i+=1*s.get_y(),r+=1*s.get_z(),s.dispose()}if(a.hc2&&(!t||a.oc2.fresh)){var l=a.oc2.wrapper().normalImpulse(e);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}return g_.get(n,i,r)},tangentImpulse:function(e,t){null==t&&(t=!1);var n=0,i=0,r=0,a=this.zpp_inner.colarb;if(!t||a.oc1.fresh){var s=a.oc1.wrapper().tangentImpulse(e);n+=1*s.get_x(),i+=1*s.get_y(),r+=1*s.get_z(),s.dispose()}if(a.hc2&&(!t||a.oc2.fresh)){var l=a.oc2.wrapper().tangentImpulse(e);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}return g_.get(n,i,r)},totalImpulse:function(e,t){null==t&&(t=!1);var n=0,i=0,r=0,a=this.zpp_inner.colarb;if(!t||a.oc1.fresh){var s=a.oc1.wrapper().totalImpulse(e);n+=1*s.get_x(),i+=1*s.get_y(),r+=1*s.get_z(),s.dispose()}if(a.hc2&&(!t||a.oc2.fresh)){var l=a.oc2.wrapper().totalImpulse(e);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}return g_.get(n,i,r)},rollingImpulse:function(e,t){null==t&&(t=!1);var n=this.zpp_inner.colarb;return!t||n.oc1.fresh?n.oc1.wrapper().rollingImpulse(e):0},get_elasticity:function(){var e=this.zpp_inner.colarb;return e.validate_props(),e.restitution},set_elasticity:function(e){var t=this.zpp_inner.colarb;return t.restitution=e,t.userdef_restitution=!0,this.get_elasticity()},get_dynamicFriction:function(){var e=this.zpp_inner.colarb;return e.validate_props(),e.dyn_fric},set_dynamicFriction:function(e){var t=this.zpp_inner.colarb;return t.dyn_fric=e,t.userdef_dyn_fric=!0,this.get_dynamicFriction()},get_staticFriction:function(){var e=this.zpp_inner.colarb;return e.validate_props(),e.stat_fric},set_staticFriction:function(e){var t=this.zpp_inner.colarb;return t.stat_fric=e,t.userdef_stat_fric=!0,this.get_staticFriction()},get_rollingFriction:function(){var e=this.zpp_inner.colarb;return e.validate_props(),e.rfric},set_rollingFriction:function(e){var t=this.zpp_inner.colarb;return t.rfric=e,t.userdef_rfric=!0,this.get_rollingFriction()},__class__:Vo,__properties__:r(Ro.prototype.__properties__,{set_rollingFriction:"set_rollingFriction",get_rollingFriction:"get_rollingFriction",set_staticFriction:"set_staticFriction",get_staticFriction:"get_staticFriction",set_dynamicFriction:"set_dynamicFriction",get_dynamicFriction:"get_dynamicFriction",set_elasticity:"set_elasticity",get_elasticity:"get_elasticity",get_referenceEdge2:"get_referenceEdge2",get_referenceEdge1:"get_referenceEdge1",get_radius:"get_radius",get_normal:"get_normal",get_contacts:"get_contacts"})});var qo=function(){this.zpp_inner=null};(n["nape.dynamics.Contact"]=qo).__name__=["nape","dynamics","Contact"],qo.prototype={zpp_inner:null,get_arbiter:function(){return null==this.zpp_inner.arbiter?null:this.zpp_inner.arbiter.outer.get_collisionArbiter()},get_penetration:function(){return-this.zpp_inner.dist},get_position:function(){return null==this.zpp_inner.wrap_position&&this.zpp_inner.getposition(),this.zpp_inner.wrap_position},get_fresh:function(){return this.zpp_inner.fresh},normalImpulse:function(e){var t=this.zpp_inner.arbiter.colarb,n=this.zpp_inner.inner,i=n.jnAcc;return null==e?g_.get(t.nx*i,t.ny*i):e==t.b1.outer?g_.get(t.nx*-i,t.ny*-i,-(t.ny*n.r1x-t.nx*n.r1y)*i):g_.get(t.nx*i,t.ny*i,(t.ny*n.r2x-t.nx*n.r2y)*i)},tangentImpulse:function(e){var t=this.zpp_inner.arbiter.colarb,n=this.zpp_inner.inner,i=n.jtAcc;return null==e?g_.get(-t.ny*i,t.nx*i):e==t.b1.outer?g_.get(t.ny*i,-t.nx*i,-(n.r1x*t.nx+n.r1y*t.ny)*i):g_.get(-t.ny*i,t.nx*i,(n.r2x*t.nx+n.r2y*t.ny)*i)},rollingImpulse:function(e){var t=this.zpp_inner.arbiter.colarb,n=this.zpp_inner.arbiter.colarb.jrAcc;return null==e?n:e==t.b1.outer?-n:n},totalImpulse:function(e){var t=this.zpp_inner.arbiter.colarb,n=this.zpp_inner.inner,i=n.jnAcc,r=n.jtAcc,a=t.jrAcc;if(null==e)return g_.get(t.nx*i-t.ny*r,t.ny*i+t.nx*r,a);var s=t.nx*i-t.ny*r,l=t.ny*i+t.nx*r;return e==t.b1.outer?g_.get(-s,-l,-(l*n.r1x-s*n.r1y)-a):g_.get(s,l,l*n.r2x-s*n.r2y+a)},get_friction:function(){return this.zpp_inner.inner.friction},toString:function(){return null==this.zpp_inner.arbiter||this.zpp_inner.arbiter.cleared?"{object-pooled}":"{Contact}"},__class__:qo,__properties__:{get_friction:"get_friction",get_fresh:"get_fresh",get_position:"get_position",get_penetration:"get_penetration",get_arbiter:"get_arbiter"}};var Wo=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.dynamics.ContactIterator"]=Wo).__name__=["nape","dynamics","ContactIterator"],Wo.get=function(e){var t;if(null==Wo.zpp_pool){lc.internal=!0;var n=new Wo;lc.internal=!1,t=n}else{var i=Wo.zpp_pool;Wo.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Wo.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Wo.zpp_pool,(Wo.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Wo};var Xo=function(){this.zpp_inner=null,this.zpp_inner=new lc,this.zpp_inner.outer=this};(n["nape.dynamics.ContactList"]=Xo).__name__=["nape","dynamics","ContactList"],Xo.fromArray=function(e){for(var t=new Xo,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},Xo.prototype={zpp_inner:null,get_length:function(){if(this.zpp_inner.valmod(),this.zpp_inner.zip_length){this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=0;for(var e=this.zpp_inner.inner.begin();null!=e;){var t=e.elem();t.active&&t.arbiter.active&&this.zpp_inner.user_length++,e=e.next}}return this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)for(this.zpp_inner.at_index=0,this.zpp_inner.at_ite=this.zpp_inner.inner.begin();;){var t=this.zpp_inner.at_ite.elem();if(t.active&&t.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}for(;this.zpp_inner.at_index!=e;)for(this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;;){var n=this.zpp_inner.at_ite.elem();if(n.active&&n.arbiter.active)break;this.zpp_inner.at_ite=this.zpp_inner.at_ite.next}return this.zpp_inner.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.get_length()},iterator:function(){return this.zpp_inner.valmod(),Wo.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new Xo,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Wo.zpp_pool,(Wo.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:Xo,__properties__:{get_length:"get_length"}};var Ho=function(){Ro.call(this)};(n["nape.dynamics.FluidArbiter"]=Ho).__name__=["nape","dynamics","FluidArbiter"],Ho.__super__=Ro,Ho.prototype=r(Ro.prototype,{get_position:function(){return null==this.zpp_inner.fluidarb.wrap_position&&this.zpp_inner.fluidarb.getposition(),this.zpp_inner.fluidarb.wrap_position},set_position:function(e){return this.get_position().set(e),this.get_position()},get_overlap:function(){return this.zpp_inner.fluidarb.overlap},set_overlap:function(e){return this.zpp_inner.fluidarb.overlap=e,this.get_overlap()},buoyancyImpulse:function(e){var t=this.zpp_inner.fluidarb;return null==e?g_.get(t.buoyx,t.buoyy,0):e.zpp_inner==this.zpp_inner.b2?g_.get(t.buoyx,t.buoyy,t.buoyy*t.r2x-t.buoyx*t.r2y):g_.get(-t.buoyx,-t.buoyy,-(t.buoyy*t.r1x-t.buoyx*t.r1y))},dragImpulse:function(e){var t=this.zpp_inner.fluidarb,n=null==e||e.zpp_inner==this.zpp_inner.b2?1:-1;return g_.get(t.dampx*n,t.dampy*n,t.adamp*n)},totalImpulse:function(e,t){null==t&&(t=!1);var n=this.buoyancyImpulse(e),i=this.dragImpulse(e),r=i;r.set_x(r.get_x()+n.get_x());var a=i;a.set_y(a.get_y()+n.get_y());var s=i;return s.set_z(s.get_z()+n.get_z()),n.dispose(),i},__class__:Ho,__properties__:r(Ro.prototype.__properties__,{set_overlap:"set_overlap",get_overlap:"get_overlap",set_position:"set_position",get_position:"get_position"})});var Yo=function(e){null==e&&(e=!1),this.zpp_inner=null,this.zpp_inner=new Mp,(this.zpp_inner.outer=this).set_ignore(e)};(n["nape.dynamics.InteractionGroup"]=Yo).__name__=["nape","dynamics","InteractionGroup"],Yo.prototype={zpp_inner:null,get_group:function(){return null==this.zpp_inner.group?null:this.zpp_inner.group.outer},set_group:function(e){return this.zpp_inner.setGroup(null==e?null:e.zpp_inner),this.get_group()},get_ignore:function(){return this.zpp_inner.ignore},set_ignore:function(e){return this.get_ignore()!=e&&(this.zpp_inner.invalidate(!0),this.zpp_inner.ignore=e),this.get_ignore()},get_interactors:function(){return null==this.zpp_inner.wrap_interactors&&(this.zpp_inner.wrap_interactors=Yh.get(this.zpp_inner.interactors,!0)),this.zpp_inner.wrap_interactors},get_groups:function(){return null==this.zpp_inner.wrap_groups&&(this.zpp_inner.wrap_groups=ac.get(this.zpp_inner.groups,!0)),this.zpp_inner.wrap_groups},toString:function(){var e="InteractionGroup";return this.get_ignore()&&(e+=":ignore"),e},__class__:Yo,__properties__:{get_groups:"get_groups",get_interactors:"get_interactors",set_ignore:"set_ignore",get_ignore:"get_ignore",set_group:"set_group",get_group:"get_group"}};var Jo=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.dynamics.InteractionGroupIterator"]=Jo).__name__=["nape","dynamics","InteractionGroupIterator"],Jo.get=function(e){var t;if(null==Jo.zpp_pool){ac.internal=!0;var n=new Jo;ac.internal=!1,t=n}else{var i=Jo.zpp_pool;Jo.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},Jo.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=Jo.zpp_pool,(Jo.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:Jo};var Ko=function(){this.zpp_inner=null,this.zpp_inner=new ac,this.zpp_inner.outer=this};(n["nape.dynamics.InteractionGroupList"]=Ko).__name__=["nape","dynamics","InteractionGroupList"],Ko.fromArray=function(e){for(var t=new Ko,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},Ko.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),Jo.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new Ko,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=Jo.zpp_pool,(Jo.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:Ko,__properties__:{get_length:"get_length"}};var Qo=function(e,t,n,i){null==i&&(i=0),null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.zpp_inner=null,this.zpp_inner=Ap.get(e,t,e+n,t+i),this.zpp_inner.outer=this};(n["nape.geom.AABB"]=Qo).__name__=["nape","geom","AABB"],Qo.prototype={zpp_inner:null,copy:function(){return this.zpp_inner.validate(),this.zpp_inner.copy().wrapper()},get_min:function(){return this.zpp_inner.getmin()},set_min:function(e){return this.get_min().set(e),this.get_min()},get_max:function(){return this.zpp_inner.getmax()},set_max:function(e){return this.get_max().set(e),this.get_max()},get_x:function(){return this.zpp_inner.validate(),this.zpp_inner.minx},set_x:function(e){return this.get_x()!=e&&(this.zpp_inner.maxx+=e-this.zpp_inner.minx,this.zpp_inner.minx=e,this.zpp_inner.invalidate()),this.get_x()},get_y:function(){return this.zpp_inner.validate(),this.zpp_inner.miny},set_y:function(e){return this.get_y()!=e&&(this.zpp_inner.maxy+=e-this.zpp_inner.miny,this.zpp_inner.miny=e,this.zpp_inner.invalidate()),this.get_y()},get_width:function(){return this.zpp_inner.validate(),this.zpp_inner.width()},set_width:function(e){if(this.get_width()!=e){var t=this.get_x();this.zpp_inner.maxx=t+e,this.zpp_inner.invalidate()}return this.get_width()},get_height:function(){return this.zpp_inner.validate(),this.zpp_inner.height()},set_height:function(e){if(this.get_height()!=e){var t=this.get_y();this.zpp_inner.maxy=t+e,this.zpp_inner.invalidate()}return this.get_height()},toString:function(){return this.zpp_inner.validate(),this.zpp_inner.toString()},__class__:Qo,__properties__:{set_height:"set_height",get_height:"get_height",set_width:"set_width",get_width:"get_width",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x",set_max:"set_max",get_max:"get_max",set_min:"set_min",get_min:"get_min"}};var $o=function(){this.zpp_inner=null};(n["nape.geom.ConvexResult"]=$o).__name__=["nape","geom","ConvexResult"],$o.prototype={zpp_inner:null,get_normal:function(){return this.zpp_inner.normal},get_position:function(){return this.zpp_inner.position},get_toi:function(){return this.zpp_inner.toiDistance},get_shape:function(){return this.zpp_inner.shape},dispose:function(){this.zpp_inner.free()},toString:function(){return"{ shape: "+p.string(this.get_shape())+" toi: "+this.get_toi()+" }"},__class__:$o,__properties__:{get_shape:"get_shape",get_toi:"get_toi",get_position:"get_position",get_normal:"get_normal"}};var e_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.geom.ConvexResultIterator"]=e_).__name__=["nape","geom","ConvexResultIterator"],e_.get=function(e){var t;if(null==e_.zpp_pool){nc.internal=!0;var n=new e_;nc.internal=!1,t=n}else{var i=e_.zpp_pool;e_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},e_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=e_.zpp_pool,(e_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:e_};var t_=function(){this.zpp_inner=null,this.zpp_inner=new nc,this.zpp_inner.outer=this};(n["nape.geom.ConvexResultList"]=t_).__name__=["nape","geom","ConvexResultList"],t_.fromArray=function(e){for(var t=new t_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},t_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem()},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e)}else this.zpp_inner.inner.add(e);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=e=this.zpp_inner.inner.front();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=e=null==n?this.zpp_inner.inner.front():n.next.elem();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=e=null==t?this.zpp_inner.inner.front():t.next.elem();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=e=this.zpp_inner.inner.front();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),e_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new t_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=e_.zpp_pool,(e_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:t_,__properties__:{get_length:"get_length"}};var n_=function(){};(n["nape.geom.Geom"]=n_).__name__=["nape","geom","Geom"],n_.distanceBody=function(e,t,n,i){n.zpp_inner.immutable(),i.zpp_inner.immutable();for(var r=e.zpp_inner.shapes.begin();null!=r;){var a=r.elem();Fp.validateShape(a),r=r.next}for(var s=t.zpp_inner.shapes.begin();null!=s;){var l=s.elem();Fp.validateShape(l),s=s.next}return lu.distanceBody(e.zpp_inner,t.zpp_inner,n.zpp_inner,i.zpp_inner)},n_.distance=function(e,t,n,i){var r;n.zpp_inner.immutable(),i.zpp_inner.immutable(),Fp.validateShape(e.zpp_inner),Fp.validateShape(t.zpp_inner),null==pu.zpp_pool?r=new pu:(r=pu.zpp_pool,pu.zpp_pool=r.next,r.next=null),r.alloc();var a=lu.distance(e.zpp_inner,t.zpp_inner,n.zpp_inner,i.zpp_inner,r,X_.FMAX),s=r;return s.free(),s.next=pu.zpp_pool,pu.zpp_pool=s,a},n_.intersectsBody=function(e,t){for(var n=e.zpp_inner.shapes.begin();null!=n;){var i=n.elem();Fp.validateShape(i),n=n.next}for(var r=t.zpp_inner.shapes.begin();null!=r;){var a=r.elem();Fp.validateShape(a),r=r.next}if(e.zpp_inner.aabb.intersect(t.zpp_inner.aabb)){for(var s=e.zpp_inner.shapes.begin();null!=s;){for(var l=s.elem(),o=t.zpp_inner.shapes.begin();null!=o;){var _=o.elem();if(Dp.testCollide_safe(l,_))return!0;o=o.next}s=s.next}return!1}return!1},n_.intersects=function(e,t){return Fp.validateShape(e.zpp_inner),Fp.validateShape(t.zpp_inner),!!e.zpp_inner.aabb.intersect(t.zpp_inner.aabb)&&Dp.testCollide_safe(e.zpp_inner,t.zpp_inner)},n_.contains=function(e,t){return Fp.validateShape(e.zpp_inner),Fp.validateShape(t.zpp_inner),Dp.containTest(e.zpp_inner,t.zpp_inner)};var i_=function(e){if(this.zpp_inner=null,this.zpp_pool=null,this.zpp_inner=new Gp(this),null!=e){if(e instanceof Array&&null==e.__enum__)for(var t=e,n=0;n<t.length;){var i=t[n];++n;var r=i,a=Rp.get(r.get_x(),r.get_y());null==this.zpp_inner.vertices?this.zpp_inner.vertices=a.prev=a.next=a:(a.prev=this.zpp_inner.vertices,a.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=a,this.zpp_inner.vertices.next=a),this.zpp_inner.vertices=a}else if(p.is(e,f_))for(var s=e.iterator();s.hasNext();){var l=s.next(),o=Rp.get(l.get_x(),l.get_y());null==this.zpp_inner.vertices?this.zpp_inner.vertices=o.prev=o.next=o:(o.prev=this.zpp_inner.vertices,o.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=o,this.zpp_inner.vertices.next=o),this.zpp_inner.vertices=o}else if(p.is(e,i_)){var _=e.zpp_inner.vertices;if(null!=_)for(var u=_;;){var h=d_.get(u.x,u.y);u=u.next;var c=Rp.get(h.get_x(),h.get_y());if(null==this.zpp_inner.vertices?this.zpp_inner.vertices=c.prev=c.next=c:(c.prev=this.zpp_inner.vertices,c.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=c,this.zpp_inner.vertices.next=c),this.zpp_inner.vertices=c,h.dispose(),u==_)break}}if(this.skipForward(1),e instanceof Array&&null==e.__enum__)for(var d=e,m=0;m<d.length;){var f=d[m];f.zpp_inner.weak&&(f.dispose(),1)?d.splice(m,1):++m}else if(p.is(e,f_)){var g=e;null!=g.zpp_inner._validate&&g.zpp_inner._validate();for(var v=g.zpp_inner.inner,b=null,y=v.begin();null!=y;){var x=y.elem();x.outer.zpp_inner.weak?(y=v.erase(b),x.outer.zpp_inner.weak&&x.outer.dispose()):y=(b=y).next}}}};(n["nape.geom.GeomPoly"]=i_).__name__=["nape","geom","GeomPoly"],i_.get=function(e){var t;if(null==_c.poolGeomPoly?t=new i_:(t=_c.poolGeomPoly,_c.poolGeomPoly=t.zpp_pool,t.zpp_pool=null),null!=e){if(e instanceof Array&&null==e.__enum__)for(var n=e,i=0;i<n.length;){var r=n[i];++i;var a=r,s=Rp.get(a.get_x(),a.get_y());null==t.zpp_inner.vertices?t.zpp_inner.vertices=s.prev=s.next=s:(s.prev=t.zpp_inner.vertices,s.next=t.zpp_inner.vertices.next,t.zpp_inner.vertices.next.prev=s,t.zpp_inner.vertices.next=s),t.zpp_inner.vertices=s}else if(p.is(e,f_))for(var l=e.iterator();l.hasNext();){var o=l.next(),_=Rp.get(o.get_x(),o.get_y());null==t.zpp_inner.vertices?t.zpp_inner.vertices=_.prev=_.next=_:(_.prev=t.zpp_inner.vertices,_.next=t.zpp_inner.vertices.next,t.zpp_inner.vertices.next.prev=_,t.zpp_inner.vertices.next=_),t.zpp_inner.vertices=_}else if(p.is(e,i_)){var u=e.zpp_inner.vertices;if(null!=u)for(var h=u;;){var c=d_.get(h.x,h.y);h=h.next;var d=Rp.get(c.get_x(),c.get_y());if(null==t.zpp_inner.vertices?t.zpp_inner.vertices=d.prev=d.next=d:(d.prev=t.zpp_inner.vertices,d.next=t.zpp_inner.vertices.next,t.zpp_inner.vertices.next.prev=d,t.zpp_inner.vertices.next=d),t.zpp_inner.vertices=d,c.dispose(),h==u)break}}if(t.skipForward(1),e instanceof Array&&null==e.__enum__)for(var m=e,f=0;f<m.length;){var g=m[f];g.zpp_inner.weak&&(g.dispose(),1)?m.splice(f,1):++f}else if(p.is(e,f_)){var v=e;null!=v.zpp_inner._validate&&v.zpp_inner._validate();for(var b=v.zpp_inner.inner,y=null,x=b.begin();null!=x;){var z=x.elem();z.outer.zpp_inner.weak?(x=b.erase(y),z.outer.zpp_inner.weak&&z.outer.dispose()):x=(y=x).next}}}return t},i_.prototype={zpp_pool:null,zpp_inner:null,empty:function(){return null==this.zpp_inner.vertices},size:function(){var e=0,t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;++e,(i=i.next)!=n;);return e},iterator:function(){return Zp.get(this.zpp_inner.vertices,!0)},forwardIterator:function(){return Zp.get(this.zpp_inner.vertices,!0)},backwardsIterator:function(){return Zp.get(this.zpp_inner.vertices,!1)},current:function(){return this.zpp_inner.vertices.wrapper()},push:function(e){var t=Rp.get(e.get_x(),e.get_y());return null==this.zpp_inner.vertices?this.zpp_inner.vertices=t.prev=t.next=t:(t.prev=this.zpp_inner.vertices,t.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=t,this.zpp_inner.vertices.next=t),this.zpp_inner.vertices=t,e.zpp_inner.weak&&e.dispose(),this},pop:function(){var e,t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,e=null;else{var n=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,e=n}this.zpp_inner.vertices=e;var i=t;return i.free(),i.next=Rp.zpp_pool,Rp.zpp_pool=i,this},unshift:function(e){var t=Rp.get(e.get_x(),e.get_y());return null==this.zpp_inner.vertices?this.zpp_inner.vertices=t.prev=t.next=t:(t.next=this.zpp_inner.vertices,t.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.prev.next=t,this.zpp_inner.vertices.prev=t),this.zpp_inner.vertices=t,e.zpp_inner.weak&&e.dispose(),this},shift:function(){var e,t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,e=this.zpp_inner.vertices=null;else{var n=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,e=n}this.zpp_inner.vertices=e;var i=t;return i.free(),i.next=Rp.zpp_pool,Rp.zpp_pool=i,this},skipForward:function(e){if(null!=this.zpp_inner.vertices)if(0<e)for(;0<e--;)this.zpp_inner.vertices=this.zpp_inner.vertices.next;else if(e<0)for(;e++<0;)this.zpp_inner.vertices=this.zpp_inner.vertices.prev;return this},skipBackwards:function(e){return this.skipForward(-e)},erase:function(e){for(;0!=e&&null!=this.zpp_inner.vertices;){var t=this.zpp_inner.vertices;if(0<e){var n;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,n=this.zpp_inner.vertices=null;else{var i=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,n=i}this.zpp_inner.vertices=n,--e}else if(e<0){var r;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,r=null;else{var a=this.zpp_inner.vertices.prev;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,r=a}this.zpp_inner.vertices=r,++e}var s=t;s.free(),s.next=Rp.zpp_pool,Rp.zpp_pool=s}return this},clear:function(){for(;null!=this.zpp_inner.vertices;){var e,t=this.zpp_inner.vertices;if(null!=this.zpp_inner.vertices&&this.zpp_inner.vertices.prev==this.zpp_inner.vertices)this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,e=this.zpp_inner.vertices=null;else{var n=this.zpp_inner.vertices.next;this.zpp_inner.vertices.prev.next=this.zpp_inner.vertices.next,this.zpp_inner.vertices.next.prev=this.zpp_inner.vertices.prev,this.zpp_inner.vertices.next=this.zpp_inner.vertices.prev=null,this.zpp_inner.vertices=null,e=n}this.zpp_inner.vertices=e;var i=t;i.free(),i.next=Rp.zpp_pool,Rp.zpp_pool=i}return this},copy:function(){var e=i_.get(),t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i,a=Rp.get(r.x,r.y);if(null==e.zpp_inner.vertices?e.zpp_inner.vertices=a.prev=a.next=a:(a.prev=e.zpp_inner.vertices,a.next=e.zpp_inner.vertices.next,e.zpp_inner.vertices.next.prev=a,e.zpp_inner.vertices.next=a),e.zpp_inner.vertices=a,(i=i.next)==n)break}return e.skipForward(1)},dispose:function(){this.clear(),this.zpp_pool=_c.poolGeomPoly,_c.poolGeomPoly=this},toString:function(){var e="GeomPoly[",t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r!=this.zpp_inner.vertices&&(e+=","),e+="{"+r.x+","+r.y+"}",(i=i.next)==n)break}return e+"]"},area:function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return 0;var e=0,t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(e+=r.x*(r.next.y-r.prev.y),(i=i.next)==n)break}var a=.5*e;return a<0?-a:a},winding:function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return v_.get_UNDEFINED();var e=0,t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(e+=r.x*(r.next.y-r.prev.y),(i=i.next)==n)break}var a=.5*e;return 0<a?v_.get_CLOCKWISE():0==a?v_.get_UNDEFINED():v_.get_ANTICLOCKWISE()},contains:function(e){var t=e.get_x(),n=e.get_y(),i=!1,r=this.zpp_inner.vertices,a=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var l=s,o=l.prev;if((l.y<n&&o.y>=n||o.y<n&&l.y>=n)&&(l.x<=t||o.x<=t)&&l.x+(n-l.y)/(o.y-l.y)*(o.x-l.x)<t&&(i=!i),(s=s.next)==a)break}var _=i;return e.zpp_inner.weak&&e.dispose(),_},isClockwise:function(){return this.winding()==v_.get_CLOCKWISE()},isConvex:function(){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return!0;var e=!1,t=!1,n=!0,i=this.zpp_inner.vertices,r=this.zpp_inner.vertices;if(null!=i)for(var a=i;;){var s,l,o,_=a,p=_.prev,u=_.next;s=u.x-_.x,l=u.y-_.y,o=_.x-p.x;var h=(_.y-p.y)*s-o*l;if(0<h?t=!0:h<0&&(e=!0),t&&e){n=!1;break}if((a=a.next)==r)break}return n},isSimple:function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||nu.isSimple(this.zpp_inner.vertices)},isMonotone:function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||Hp.isMonotone(this.zpp_inner.vertices)},isDegenerate:function(){return null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next||this.area()<lo.epsilon},simplify:function(e){if(null==this.zpp_inner.vertices||null==this.zpp_inner.vertices.next||this.zpp_inner.vertices.prev==this.zpp_inner.vertices.next)return this.copy();var t=au.simplify(this.zpp_inner.vertices,e),n=i_.get();return n.zpp_inner.vertices=t,n},simpleDecomposition:function(e){for(var t=nu.decompose(this.zpp_inner.vertices,Jp.getShared()),n=null==e?new a_:e;!t.empty();){var i=t.pop_unsafe(),r=i_.get();r.zpp_inner.vertices=i,n.add(r)}return n},monotoneDecomposition:function(e){for(var t=Hp.decompose(this.zpp_inner.vertices,Hp.getShared()).extract(Jp.getShared()),n=null==e?new a_:e;!t.empty();){var i=t.pop_unsafe(),r=i_.get();r.zpp_inner.vertices=i,n.add(r)}return n},convexDecomposition:function(e,t){null==e&&(e=!1);for(var n=Hp.decompose(this.zpp_inner.vertices,Hp.getShared()).extract_partitions(Jp.getSharedPP()),i=null==t?new a_:t;!n.empty();){var r=n.pop_unsafe();_u.triangulate(r),e&&_u.optimise(r),Ep.optimise(r);var a=r.extract(Jp.getShared()),s=r;for(s.free(),s.next=Jp.zpp_pool,Jp.zpp_pool=s;!a.empty();){var l=a.pop_unsafe(),o=i_.get();o.zpp_inner.vertices=l,i.add(o)}}return i},triangularDecomposition:function(e,t){null==e&&(e=!1);for(var n=Hp.decompose(this.zpp_inner.vertices,Hp.getShared()).extract_partitions(Jp.getSharedPP()),i=null==t?new a_:t;!n.empty();){var r=n.pop_unsafe();_u.triangulate(r),e&&_u.optimise(r);var a=r.extract(Jp.getShared()),s=r;for(s.free(),s.next=Jp.zpp_pool,Jp.zpp_pool=s;!a.empty();){var l=a.pop_unsafe(),o=i_.get();o.zpp_inner.vertices=l,i.add(o)}}return i},inflate:function(e){var t=i_.get();this.isClockwise()&&(e=-e);var n=this.zpp_inner.vertices,i=this.zpp_inner.vertices;if(null!=n)for(var r=n;;){var a,s,l,o,_=r,p=_.prev,u=_.next;a=_.x-p.x,s=_.y-p.y,l=u.x-_.x,o=u.y-_.y;var h=0,c=0,d=0,m=0,f=(h=a)*h+(c=s)*c,g=oc.invsqrt(f),v=h*=g;h=-(c*=g),c=v,h*=e,c*=e;var b=(d=l)*d+(m=o)*m,y=oc.invsqrt(b),x=d*=y;d=-(m*=y),m=x;var z=o*((d*=e)-h)-l*((m*=e)-c),w=0==z?0:z/(o*a-l*s),k=0,S=0;if(k=_.x+h,S=_.y+c,k+=a*w,S+=s*w,t.push(d_.get(k,S)),(r=r.next)==i)break}return t.skipForward(1)},cut:function(e,t,n,i,r){null==i&&(i=!1),null==n&&(n=!1);var a=jp.run(this.zpp_inner.vertices,e,t,n,i,r);return e.zpp_inner.weak&&e.dispose(),t.zpp_inner.weak&&t.dispose(),a},transform:function(e){var t=this.zpp_inner.vertices,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i,a=e.get_a()*r.x+e.get_b()*r.y+e.get_tx();if(r.y=e.get_c()*r.x+e.get_d()*r.y+e.get_ty(),r.x=a,(i=i.next)==n)break}return this},bounds:function(){var e=X_.FMAX,t=X_.FMAX,n=-X_.FMAX,i=-X_.FMAX,r=this.zpp_inner.vertices,a=this.zpp_inner.vertices;if(null!=r)for(var s=r;;){var l=s;if(l.x<e&&(e=l.x),l.y<t&&(t=l.y),l.x>n&&(n=l.x),l.y>i&&(i=l.y),(s=s.next)==a)break}return new Qo(e,t,n-e,i-t)},top:function(){var e=this.zpp_inner.vertices,t=this.zpp_inner.vertices.next,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r.y<e.y&&(e=r),(i=i.next)==n)break}return e.wrapper()},bottom:function(){var e=this.zpp_inner.vertices,t=this.zpp_inner.vertices.next,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r.y>e.y&&(e=r),(i=i.next)==n)break}return e.wrapper()},left:function(){var e=this.zpp_inner.vertices,t=this.zpp_inner.vertices.next,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r.x<e.x&&(e=r),(i=i.next)==n)break}return e.wrapper()},right:function(){var e=this.zpp_inner.vertices,t=this.zpp_inner.vertices.next,n=this.zpp_inner.vertices;if(null!=t)for(var i=t;;){var r=i;if(r.x>e.x&&(e=r),(i=i.next)==n)break}return e.wrapper()},__class__:i_};var r_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.geom.GeomPolyIterator"]=r_).__name__=["nape","geom","GeomPolyIterator"],r_.get=function(e){var t;if(null==r_.zpp_pool){ec.internal=!0;var n=new r_;ec.internal=!1,t=n}else{var i=r_.zpp_pool;r_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},r_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=r_.zpp_pool,(r_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:r_};var a_=function(){this.zpp_inner=null,this.zpp_inner=new ec,this.zpp_inner.outer=this};(n["nape.geom.GeomPolyList"]=a_).__name__=["nape","geom","GeomPolyList"],a_.fromArray=function(e){for(var t=new a_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},a_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),r_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new a_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=r_.zpp_pool,(r_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:a_,__properties__:{get_length:"get_length"}};var s_=function(){};(n["nape.geom.GeomVertexIterator"]=s_).__name__=["nape","geom","GeomVertexIterator"],s_.prototype={zpp_inner:null,hasNext:function(){var e=this.zpp_inner.ptr!=this.zpp_inner.start||this.zpp_inner.first;if(this.zpp_inner.first=!1,!e){var t=this.zpp_inner;t.free(),t.next=Zp.zpp_pool,Zp.zpp_pool=t}return e},next:function(){var e=this.zpp_inner.ptr.wrapper();return this.zpp_inner.ptr=this.zpp_inner.forward?this.zpp_inner.ptr.next:this.zpp_inner.ptr.prev,e},__class__:s_};var l_=function(){};(n["nape.geom.MarchingSquares"]=l_).__name__=["nape","geom","MarchingSquares"],l_.run=function(e,t,n,i,r,a,s){null==a&&(a=!0),null==i&&(i=2);var l=null!=s?s:new a_;if(null==r)qp.run(e,t.get_x(),t.get_y(),t.get_max().get_x(),t.get_max().get_y(),n,i,a,l);else{var o=t.get_width()/r.get_x(),_=t.get_height()/r.get_y(),u=p.int(o),h=p.int(_);u!=o&&++u,h!=_&&++h;for(var c=0,d=u;c<d;)for(var m=c++,f=t.get_x()+r.get_x()*m,g=m==u-1?t.get_max().get_x():f+r.get_x(),v=0,b=h;v<b;){var y=v++,x=t.get_y()+r.get_y()*y,z=y==h-1?t.get_max().get_y():x+r.get_y();qp.run(e,f,x,g,z,n,i,a,l)}}return n.zpp_inner.weak&&n.dispose(),null!=r&&r.zpp_inner.weak&&r.dispose(),l};var o_=function(e,t,n,i,r,a){null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=1),this.zpp_inner=null,this.zpp_inner=Wp.get(),(this.zpp_inner.outer=this).set_a(e),this.set_b(t),this.set_tx(r),this.set_c(n),this.set_d(i),this.set_ty(a)};(n["nape.geom.Mat23"]=o_).__name__=["nape","geom","Mat23"],o_.rotation=function(e){var t=Math.cos(e),n=Math.sin(e);return new o_(t,-n,n,t,0,0)},o_.translation=function(e,t){return new o_(1,0,0,1,e,t)},o_.scale=function(e,t){return new o_(e,0,0,t,0,0)},o_.prototype={zpp_inner:null,get_a:function(){return this.zpp_inner.a},set_a:function(e){return this.zpp_inner.a=e,this.zpp_inner.invalidate(),this.get_a()},get_b:function(){return this.zpp_inner.b},set_b:function(e){return this.zpp_inner.b=e,this.zpp_inner.invalidate(),this.get_b()},get_c:function(){return this.zpp_inner.c},set_c:function(e){return this.zpp_inner.c=e,this.zpp_inner.invalidate(),this.get_c()},get_d:function(){return this.zpp_inner.d},set_d:function(e){return this.zpp_inner.d=e,this.zpp_inner.invalidate(),this.get_d()},get_tx:function(){return this.zpp_inner.tx},set_tx:function(e){return this.zpp_inner.tx=e,this.zpp_inner.invalidate(),this.get_tx()},get_ty:function(){return this.zpp_inner.ty},set_ty:function(e){return this.zpp_inner.ty=e,this.zpp_inner.invalidate(),this.get_ty()},copy:function(){return new o_(this.get_a(),this.get_b(),this.get_c(),this.get_d(),this.get_tx(),this.get_ty())},set:function(e){return this.zpp_inner.set(e.zpp_inner),this.zpp_inner.invalidate(),this},setAs:function(e,t,n,i,r,a){return null==a&&(a=0),null==r&&(r=0),null==i&&(i=1),null==n&&(n=0),null==t&&(t=0),null==e&&(e=1),this.zpp_inner.setas(e,t,n,i,r,a),this.zpp_inner.invalidate(),this},reset:function(){return this.setAs()},get_determinant:function(){return this.get_a()*this.get_d()-this.get_b()*this.get_c()},singular:function(){var e=this.get_a()*this.get_a()+this.get_b()*this.get_b()+this.get_c()*this.get_c()+this.get_d()*this.get_d(),t=this.get_determinant();return t<0&&(t=-t),lo.illConditionedThreshold*t<e},inverse:function(){var e=1/this.get_determinant();return new o_(this.get_d()*e,-this.get_b()*e,-this.get_c()*e,this.get_a()*e,(this.get_b()*this.get_ty()-this.get_d()*this.get_tx())*e,(this.get_c()*this.get_tx()-this.get_a()*this.get_ty())*e)},transpose:function(){return new o_(this.get_a(),this.get_c(),this.get_b(),this.get_d(),-this.get_a()*this.get_tx()-this.get_c()*this.get_ty(),-this.get_b()*this.get_tx()-this.get_d()*this.get_ty())},concat:function(e){var t=e;return new o_(t.get_a()*this.get_a()+t.get_b()*this.get_c(),t.get_a()*this.get_b()+t.get_b()*this.get_d(),t.get_c()*this.get_a()+t.get_d()*this.get_c(),t.get_c()*this.get_b()+t.get_d()*this.get_d(),t.get_a()*this.get_tx()+t.get_b()*this.get_ty()+t.get_tx(),t.get_c()*this.get_tx()+t.get_d()*this.get_ty()+t.get_ty())},transform:function(e,t,n){var i;return null==n&&(n=!1),null==t&&(t=!1),i=t?d_.get(e.get_x()*this.get_a()+e.get_y()*this.get_b(),e.get_x()*this.get_c()+e.get_y()*this.get_d(),n):d_.get(e.get_x()*this.get_a()+e.get_y()*this.get_b()+this.get_tx(),e.get_x()*this.get_c()+e.get_y()*this.get_d()+this.get_ty(),n),e.zpp_inner.weak&&e.dispose(),i},inverseTransform:function(e,t,n){null==n&&(n=!1),null==t&&(t=!1);var i,r=1/this.get_determinant();if(t)i=d_.get((e.get_x()*this.get_d()-e.get_y()*this.get_b())*r,(e.get_y()*this.get_a()-e.get_x()*this.get_c())*r,n);else{var a=e.get_x()-this.get_tx(),s=e.get_y()-this.get_ty();i=d_.get((a*this.get_d()-s*this.get_b())*r,(s*this.get_a()-a*this.get_c())*r,n)}return e.zpp_inner.weak&&e.dispose(),i},toString:function(){return"{ a: "+this.get_a()+" b: "+this.get_b()+" c: "+this.get_c()+" d: "+this.get_d()+" tx: "+this.get_tx()+" ty: "+this.get_ty()+" }"},equiorthogonal:function(){if(this.singular())return!1;var e=this.get_a()*this.get_b()+this.get_c()*this.get_d();if(e*e<lo.epsilon){var t=this.get_a()*this.get_a()+this.get_b()*this.get_b()-this.get_c()*this.get_c()-this.get_d()*this.get_d();return t*t<lo.epsilon}return!1},orthogonal:function(){var e=this.get_a()*this.get_b()+this.get_c()*this.get_d();if(e*e<lo.epsilon){var t=this.get_a()*this.get_a()+this.get_b()*this.get_b()-1,n=this.get_c()*this.get_c()+this.get_d()*this.get_d()-1;return t*t<lo.epsilon&&n*n<lo.epsilon}return!1},equiorthogonalise:function(){if(!this.equiorthogonal()){var e=Math.sqrt(this.get_a()*this.get_a()+this.get_c()*this.get_c()),t=Math.sqrt(this.get_b()*this.get_b()+this.get_d()*this.get_d()),n=(e+t)/2;e=n/e,t=n/t,this.set_a(this.get_a()*e),this.set_c(this.get_c()*e),this.set_b(this.get_b()*t),this.set_d(this.get_d()*t);var i=this.get_a()*this.get_b()+this.get_c()*this.get_d(),r=.25*Math.PI-.5*Math.acos(i/(n*n));0<this.get_determinant()&&(r=-r);var a=Math.sin(r),s=Math.cos(r),l=this.get_a()*s-this.get_c()*a,o=this.get_b()*s+this.get_d()*a;this.set_c(this.get_c()*s+this.get_a()*a),this.set_a(l),this.set_d(this.get_d()*s-this.get_b()*a),this.set_b(o),this.zpp_inner.invalidate()}return this},orthogonalise:function(){if(!this.orthogonal()){var e=Math.sqrt(this.get_a()*this.get_a()+this.get_c()*this.get_c()),t=Math.sqrt(this.get_b()*this.get_b()+this.get_d()*this.get_d());e=1/e,t=1/t,this.set_a(this.get_a()*e),this.set_c(this.get_c()*e),this.set_b(this.get_b()*t),this.set_d(this.get_d()*t);var n=this.get_a()*this.get_b()+this.get_c()*this.get_d(),i=.25*Math.PI-.5*Math.acos(n/1);0<this.get_determinant()&&(i=-i);var r=Math.sin(i),a=Math.cos(i),s=this.get_a()*a-this.get_c()*r,l=this.get_b()*a+this.get_d()*r;this.set_c(this.get_c()*a+this.get_a()*r),this.set_a(s),this.set_d(this.get_d()*a-this.get_b()*r),this.set_b(l),this.zpp_inner.invalidate()}return this},__class__:o_,__properties__:{get_determinant:"get_determinant",set_ty:"set_ty",get_ty:"get_ty",set_tx:"set_tx",get_tx:"get_tx",set_d:"set_d",get_d:"get_d",set_c:"set_c",get_c:"get_c",set_b:"set_b",get_b:"get_b",set_a:"set_a",get_a:"get_a"}};var __=function(e,t){this.zpp_inner=null,this.zpp_inner=new Xp(e,t),this.zpp_inner.outer=this};(n["nape.geom.MatMN"]=__).__name__=["nape","geom","MatMN"],__.prototype={zpp_inner:null,get_rows:function(){return this.zpp_inner.m},get_cols:function(){return this.zpp_inner.n},x:function(e,t){return this.zpp_inner.x[e*this.get_cols()+t]},setx:function(e,t,n){return this.zpp_inner.x[e*this.get_cols()+t]=n},toString:function(){for(var e="{ ",t=!0,n=0,i=this.get_rows();n<i;){var r=n++;t||(e+="; "),t=!1;for(var a=0,s=this.get_cols();a<s;){var l=a++;e+=this.x(r,l)+" "}}return e+="}"},transpose:function(){for(var e=new __(this.get_cols(),this.get_rows()),t=0,n=this.get_rows();t<n;)for(var i=t++,r=0,a=this.get_cols();r<a;){var s=r++;e.setx(s,i,this.x(i,s))}return e},mul:function(e){for(var t=e,n=new __(this.get_rows(),t.get_cols()),i=0,r=this.get_rows();i<r;)for(var a=i++,s=0,l=t.get_cols();s<l;){for(var o=s++,_=0,p=0,u=this.get_cols();p<u;){var h=p++;_+=this.x(a,h)*t.x(h,o)}n.setx(a,o,_)}return n},__class__:__,__properties__:{get_cols:"get_cols",get_rows:"get_rows"}};var p_=function(e,t){this.zpp_inner=null,this.zpp_inner=new Kp,this.set_origin(e),this.set_direction(t),this.zpp_inner.maxdist=X_.POSINF()};(n["nape.geom.Ray"]=p_).__name__=["nape","geom","Ray"],p_.fromSegment=function(e,t){var n=t.sub(e,!0),i=new p_(e,n);return i.set_maxDistance(Math.sqrt(hu.vec_dsq(e.get_x(),e.get_y(),t.get_x(),t.get_y()))),e.zpp_inner.weak&&e.dispose(),t.zpp_inner.weak&&t.dispose(),i},p_.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_origin:function(){return this.zpp_inner.origin},set_origin:function(e){return this.zpp_inner.origin.set(e),this.get_origin()},get_direction:function(){return this.zpp_inner.direction},set_direction:function(e){return this.zpp_inner.direction.set(e),this.zpp_inner.invalidate_dir(),this.get_direction()},get_maxDistance:function(){return this.zpp_inner.maxdist},set_maxDistance:function(e){return this.zpp_inner.maxdist=e,this.get_maxDistance()},aabb:function(){return this.zpp_inner.rayAABB().wrapper()},at:function(e,t){return null==t&&(t=!1),this.zpp_inner.validate_dir(),d_.get(this.get_origin().get_x()+e*this.zpp_inner.dirx,this.get_origin().get_y()+e*this.zpp_inner.diry,t)},copy:function(){var e=new p_(this.get_origin(),this.get_direction());return e.set_maxDistance(this.get_maxDistance()),e},__class__:p_,__properties__:{set_maxDistance:"set_maxDistance",get_maxDistance:"get_maxDistance",set_direction:"set_direction",get_direction:"get_direction",set_origin:"set_origin",get_origin:"get_origin",get_userData:"get_userData"}};var u_=function(){this.zpp_inner=null};(n["nape.geom.RayResult"]=u_).__name__=["nape","geom","RayResult"],u_.prototype={zpp_inner:null,get_normal:function(){return this.zpp_inner.normal},get_distance:function(){return this.zpp_inner.toiDistance},get_inner:function(){return this.zpp_inner.inner},get_shape:function(){return this.zpp_inner.shape},dispose:function(){this.zpp_inner.free()},toString:function(){return"{ shape: "+p.string(this.get_shape())+" distance: "+this.get_distance()+" ?inner: "+p.string(this.get_inner())+" }"},__class__:u_,__properties__:{get_shape:"get_shape",get_inner:"get_inner",get_distance:"get_distance",get_normal:"get_normal"}};var h_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.geom.RayResultIterator"]=h_).__name__=["nape","geom","RayResultIterator"],h_.get=function(e){var t;if(null==h_.zpp_pool){tc.internal=!0;var n=new h_;tc.internal=!1,t=n}else{var i=h_.zpp_pool;h_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},h_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=h_.zpp_pool,(h_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:h_};var c_=function(){this.zpp_inner=null,this.zpp_inner=new tc,this.zpp_inner.outer=this};(n["nape.geom.RayResultList"]=c_).__name__=["nape","geom","RayResultList"],c_.fromArray=function(e){for(var t=new c_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},c_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem()},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e)}else this.zpp_inner.inner.add(e);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=e=this.zpp_inner.inner.front();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=e=null==n?this.zpp_inner.inner.front():n.next.elem();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=e=null==t?this.zpp_inner.inner.front():t.next.elem();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=e=this.zpp_inner.inner.front();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),h_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new c_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=h_.zpp_pool,(h_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:c_,__properties__:{get_length:"get_length"}};var d_=function(e,t){null==t&&(t=0),null==e&&(e=0),this.zpp_pool=null,this.zpp_inner=null,this.zpp_inner=pu.get(e,t),this.zpp_inner.outer=this};(n["nape.geom.Vec2"]=d_).__name__=["nape","geom","Vec2"],d_.weak=function(e,t){return null==t&&(t=0),null==e&&(e=0),d_.get(e,t,!0)},d_.get=function(e,t,n){var i;return null==n&&(n=!1),null==t&&(t=0),null==e&&(e=0),null==_c.poolVec2?i=new d_:(i=_c.poolVec2,_c.poolVec2=i.zpp_pool,i.zpp_pool=null),null==i.zpp_inner?(i.zpp_inner=pu.get(e,t),i.zpp_inner.outer=i):i.setxy(e,t),i.zpp_inner.weak=n,i},d_.fromPolar=function(e,t,n){return null==n&&(n=!1),d_.get(e*Math.cos(t),e*Math.sin(t),n)},d_.dsq=function(e,t){var n=hu.vec_dsq(e.get_x(),e.get_y(),t.get_x(),t.get_y());return e.zpp_inner.weak&&e.dispose(),t.zpp_inner.weak&&t.dispose(),n},d_.distance=function(e,t){var n=Math.sqrt(hu.vec_dsq(e.get_x(),e.get_y(),t.get_x(),t.get_y()));return e.zpp_inner.weak&&e.dispose(),t.zpp_inner.weak&&t.dispose(),n},d_.prototype={zpp_inner:null,zpp_pool:null,dispose:function(){this.zpp_inner.immutable();var e=this.zpp_inner;this.zpp_inner.outer=null,this.zpp_inner=null,this.zpp_pool=_c.poolVec2,_c.poolVec2=this;var t=e;t.free(),t.next=pu.zpp_pool,pu.zpp_pool=t},copy:function(e){return null==e&&(e=!1),d_.get(this.get_x(),this.get_y(),e)},get_x:function(){return this.zpp_inner.validate(),this.zpp_inner.x},set_x:function(e){return this.zpp_inner.immutable(),this.get_x()!=e&&(this.zpp_inner.x=e,this.zpp_inner.invalidate()),this.get_x()},get_y:function(){return this.zpp_inner.validate(),this.zpp_inner.y},set_y:function(e){return this.zpp_inner.immutable(),this.get_y()!=e&&(this.zpp_inner.y=e,this.zpp_inner.invalidate()),this.get_y()},get_length:function(){return Math.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y())},set_length:function(e){this.zpp_inner.immutable();var t=e/Math.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y());return this.set_x(this.get_x()*t),this.set_y(this.get_y()*t),this.zpp_inner.invalidate(),this.get_length()},lsq:function(){return this.get_x()*this.get_x()+this.get_y()*this.get_y()},set:function(e){this.zpp_inner.immutable();var t=this.setxy(e.get_x(),e.get_y());return e.zpp_inner.weak&&e.dispose(),t},setxy:function(e,t){return this.zpp_inner.immutable(),this.get_x()==e&&this.get_y()==t||(this.zpp_inner.x=e,this.zpp_inner.y=t,this.zpp_inner.invalidate()),this},get_angle:function(){return this.get_x()==this.get_y()&&0==this.get_x()?0:Math.atan2(this.get_y(),this.get_x())},set_angle:function(e){this.zpp_inner.immutable();var t=this.get_length();return this.setxy(t*Math.cos(e),t*Math.sin(e)),this.get_angle()},rotate:function(e){if(this.zpp_inner.immutable(),e%(2*Math.PI)!=0){var t=Math.sin(e),n=Math.cos(e),i=n*this.zpp_inner.x-t*this.zpp_inner.y;this.zpp_inner.y=this.zpp_inner.x*t+this.zpp_inner.y*n,this.zpp_inner.x=i,this.zpp_inner.invalidate()}return this},reflect:function(e,t){null==t&&(t=!1);var n=this.copy(!0).normalise(),i=e.sub(n.muleq(2*n.dot(e)),t);return e.zpp_inner.weak&&e.dispose(),i},normalise:function(){this.zpp_inner.immutable();var e=this.get_x()*this.get_x()+this.get_y()*this.get_y(),t=1/Math.sqrt(e);return this.set_x(this.get_x()*t),this.set_y(this.get_y()*t),this.zpp_inner.invalidate(),this},unit:function(e){null==e&&(e=!1);var t=1/oc.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y());return d_.get(this.get_x()*t,this.get_y()*t,e)},add:function(e,t){null==t&&(t=!1);var n=d_.get(this.get_x()+e.get_x(),this.get_y()+e.get_y(),t);return e.zpp_inner.weak&&e.dispose(),n},addMul:function(e,t,n){null==n&&(n=!1);var i=d_.get(this.get_x()+e.get_x()*t,this.get_y()+e.get_y()*t,n);return e.zpp_inner.weak&&e.dispose(),i},sub:function(e,t){null==t&&(t=!1);var n=d_.get(this.get_x()-e.get_x(),this.get_y()-e.get_y(),t);return e.zpp_inner.weak&&e.dispose(),n},mul:function(e,t){return null==t&&(t=!1),d_.get(this.get_x()*e,this.get_y()*e,t)},addeq:function(e){return this.zpp_inner.immutable(),this.setxy(this.get_x()+e.get_x(),this.get_y()+e.get_y()),e.zpp_inner.weak&&e.dispose(),this},subeq:function(e){return this.zpp_inner.immutable(),this.setxy(this.get_x()-e.get_x(),this.get_y()-e.get_y()),e.zpp_inner.weak&&e.dispose(),this},muleq:function(e){return this.zpp_inner.immutable(),this.setxy(this.get_x()*e,this.get_y()*e)},dot:function(e){var t=this.get_x()*e.get_x()+this.get_y()*e.get_y();return e.zpp_inner.weak&&e.dispose(),t},cross:function(e){var t=e.get_y()*this.get_x()-e.get_x()*this.get_y();return e.zpp_inner.weak&&e.dispose(),t},perp:function(e){return null==e&&(e=!1),d_.get(-this.get_y(),this.get_x(),e)},toString:function(){return this.zpp_inner.validate(),this.zpp_inner.toString()},__class__:d_,__properties__:{set_angle:"set_angle",get_angle:"get_angle",set_length:"set_length",get_length:"get_length",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var m_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.geom.Vec2Iterator"]=m_).__name__=["nape","geom","Vec2Iterator"],m_.get=function(e){var t;if(null==m_.zpp_pool){$h.internal=!0;var n=new m_;$h.internal=!1,t=n}else{var i=m_.zpp_pool;m_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},m_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=m_.zpp_pool,(m_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:m_};var f_=function(){this.zpp_inner=null,this.zpp_inner=new $h,this.zpp_inner.outer=this};(n["nape.geom.Vec2List"]=f_).__name__=["nape","geom","Vec2List"],f_.fromArray=function(e){for(var t=new f_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},f_.prototype={zpp_inner:null,get_length:function(){return this.zpp_gl()},zpp_gl:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},zpp_vm:function(){this.zpp_inner.valmod()},has:function(e){return this.zpp_vm(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_vm(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_vm(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return 0==this.get_length()},iterator:function(){return this.zpp_vm(),m_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new f_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?i.copy():i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=m_.zpp_pool,(m_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:f_,__properties__:{get_length:"get_length"}};var g_=function(e,t,n){null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),this.zpp_pool=null,this.zpp_inner=null,this.zpp_inner=new uu,(this.zpp_inner.outer=this).set_x(e),this.set_y(t),this.set_z(n)};(n["nape.geom.Vec3"]=g_).__name__=["nape","geom","Vec3"],g_.get=function(e,t,n){var i;return null==n&&(n=0),null==t&&(t=0),null==e&&(e=0),null==_c.poolVec3?i=new g_:(i=_c.poolVec3,_c.poolVec3=i.zpp_pool,i.zpp_pool=null),i.setxyz(e,t,n),i.zpp_inner.immutable=!1,i.zpp_inner._validate=null,i},g_.prototype={zpp_inner:null,zpp_pool:null,get_x:function(){return this.zpp_inner.validate(),this.zpp_inner.x},set_x:function(e){return this.zpp_inner.x=e,this.get_x()},get_y:function(){return this.zpp_inner.validate(),this.zpp_inner.y},set_y:function(e){return this.zpp_inner.y=e,this.get_y()},get_z:function(){return this.zpp_inner.validate(),this.zpp_inner.z},set_z:function(e){return this.zpp_inner.z=e,this.get_z()},dispose:function(){this.zpp_pool=_c.poolVec3,_c.poolVec3=this},get_length:function(){return Math.sqrt(this.get_x()*this.get_x()+this.get_y()*this.get_y()+this.get_z()*this.get_z())},set_length:function(e){var t=e/this.get_length(),n=t;return this.set_x(this.get_x()*n),this.set_y(this.get_y()*n),this.set_z(this.get_z()*t),this.get_length()},lsq:function(){return this.get_x()*this.get_x()+this.get_y()*this.get_y()+this.get_z()*this.get_z()},set:function(e){return this.setxyz(e.get_x(),e.get_y(),e.get_z())},setxyz:function(e,t,n){return this.set_x(e),this.set_y(t),this.set_z(n),this},xy:function(e){return null==e&&(e=!1),d_.get(this.get_x(),this.get_y(),e)},toString:function(){return"{ x: "+this.get_x()+" y: "+this.get_y()+" z: "+this.get_z()+" }"},__class__:g_,__properties__:{set_length:"set_length",get_length:"get_length",set_z:"set_z",get_z:"get_z",set_y:"set_y",get_y:"get_y",set_x:"set_x",get_x:"get_x"}};var v_=function(){};(n["nape.geom.Winding"]=v_).__name__=["nape","geom","Winding"],v_.__properties__={get_ANTICLOCKWISE:"get_ANTICLOCKWISE",get_CLOCKWISE:"get_CLOCKWISE",get_UNDEFINED:"get_UNDEFINED"},v_.get_UNDEFINED=function(){return null==ap.Winding_UNDEFINED&&(ap.internal=!0,ap.Winding_UNDEFINED=new v_,ap.internal=!1),ap.Winding_UNDEFINED},v_.get_CLOCKWISE=function(){return null==ap.Winding_CLOCKWISE&&(ap.internal=!0,ap.Winding_CLOCKWISE=new v_,ap.internal=!1),ap.Winding_CLOCKWISE},v_.get_ANTICLOCKWISE=function(){return null==ap.Winding_ANTICLOCKWISE&&(ap.internal=!0,ap.Winding_ANTICLOCKWISE=new v_,ap.internal=!1),ap.Winding_ANTICLOCKWISE},v_.prototype={toString:function(){return this==v_.get_UNDEFINED()?"UNDEFINED":this==v_.get_CLOCKWISE()?"CLOCKWISE":this==v_.get_ANTICLOCKWISE()?"ANTICLOCKWISE":""},__class__:v_};var b_=function(){this.zpp_inner_i=null};(n["nape.phys.Interactor"]=b_).__name__=["nape","phys","Interactor"],b_.prototype={zpp_inner_i:null,get_id:function(){return this.zpp_inner_i.id},get_userData:function(){return null==this.zpp_inner_i.userData&&(this.zpp_inner_i.userData={}),this.zpp_inner_i.userData},isShape:function(){return null!=this.zpp_inner_i.ishape},isBody:function(){return null!=this.zpp_inner_i.ibody},isCompound:function(){return null!=this.zpp_inner_i.icompound},get_castShape:function(){return this.isShape()?this.zpp_inner_i.ishape.outer:null},get_castBody:function(){return this.isBody()?this.zpp_inner_i.ibody.outer:null},get_castCompound:function(){return this.isCompound()?this.zpp_inner_i.icompound.outer:null},get_group:function(){return null==this.zpp_inner_i.group?null:this.zpp_inner_i.group.outer},set_group:function(e){return this.zpp_inner_i.immutable_midstep("Interactor::group"),this.zpp_inner_i.setGroup(null==e?null:e.zpp_inner),this.get_group()},get_cbTypes:function(){return null==this.zpp_inner_i.wrap_cbTypes&&this.zpp_inner_i.setupcbTypes(),this.zpp_inner_i.wrap_cbTypes},toString:function(){return""},__class__:b_,__properties__:{get_cbTypes:"get_cbTypes",set_group:"set_group",get_group:"get_group",get_castCompound:"get_castCompound",get_castBody:"get_castBody",get_castShape:"get_castShape",get_userData:"get_userData",get_id:"get_id"}};var y_=function(e,t){this.debugDraw=!0,this.zpp_inner=null,b_.call(this),this.zpp_inner=new du,((this.zpp_inner.outer=this).zpp_inner.outer_i=this).zpp_inner_i=this.zpp_inner,this.zpp_inner.posy=null!=t?(this.zpp_inner.posx=t.get_x(),t.get_y()):this.zpp_inner.posx=0,this.set_type(null==e?w_.get_DYNAMIC():e),null!=t&&t.zpp_inner.weak&&t.dispose(),this.zpp_inner_i.insert_cbtype(co.get_ANY_BODY().zpp_inner)};(n["nape.phys.Body"]=y_).__name__=["nape","phys","Body"],y_.__super__=b_,y_.prototype=r(b_.prototype,{zpp_inner:null,debugDraw:null,get_type:function(){return du.types[this.zpp_inner.type]},set_type:function(e){if(this.zpp_inner.immutable_midstep("Body::type"),this.get_type()!=e){var t=e==w_.get_DYNAMIC()?2:e==w_.get_KINEMATIC()?3:1;1==t&&null!=this.zpp_inner.space&&(this.zpp_inner.velx=0,this.zpp_inner.vely=0,this.zpp_inner.angvel=0),this.zpp_inner.invalidate_type(),null!=this.zpp_inner.space?this.zpp_inner.space.transmitType(this.zpp_inner,t):this.zpp_inner.type=t}return this.get_type()},get_isBullet:function(){return this.zpp_inner.bulletEnabled},set_isBullet:function(e){return this.zpp_inner.bulletEnabled=e,this.get_isBullet()},get_disableCCD:function(){return this.zpp_inner.disableCCD},set_disableCCD:function(e){return this.zpp_inner.disableCCD=e,this.get_disableCCD()},integrate:function(e){if(this.zpp_inner.immutable_midstep("Body::space"),0==e)return this;var t=this.zpp_inner;return t.sweepTime=0,t.sweep_angvel=t.angvel,t.sweepIntegrate(e),t.invalidate_pos(),t.invalidate_rot(),t.sweepTime=0,this},isStatic:function(){return this.zpp_inner.isStatic()},isDynamic:function(){return this.zpp_inner.isDynamic()},isKinematic:function(){return this.zpp_inner.isKinematic()},get_shapes:function(){return this.zpp_inner.wrap_shapes},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(e){return this.get_compound()!=e&&(null!=this.get_compound()&&this.get_compound().get_bodies().remove(this),null!=e&&e.get_bodies().add(this)),this.get_compound()},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(e){return this.zpp_inner.immutable_midstep("Body::space"),this.get_space()!=e&&(null!=this.get_space()&&(this.zpp_inner.component.woken=!1),null!=this.get_space()&&this.get_space().get_bodies().remove(this),null!=e&&e.get_bodies().add(this)),this.get_space()},get_arbiters:function(){return null==this.zpp_inner.wrap_arbiters&&(this.zpp_inner.wrap_arbiters=sc.get(this.zpp_inner.arbiters,!0)),this.zpp_inner.wrap_arbiters},get_isSleeping:function(){return this.zpp_inner.component.sleeping},get_constraints:function(){return null==this.zpp_inner.wrap_constraints&&(this.zpp_inner.wrap_constraints=Xh.get(this.zpp_inner.constraints,!0)),this.zpp_inner.wrap_constraints},copy:function(){return this.zpp_inner.copy()},get_position:function(){return null==this.zpp_inner.wrap_pos&&this.zpp_inner.setupPosition(),this.zpp_inner.wrap_pos},set_position:function(e){return this.get_position().set(e),this.get_position()},get_velocity:function(){return null==this.zpp_inner.wrap_vel&&this.zpp_inner.setupVelocity(),this.zpp_inner.wrap_vel},set_velocity:function(e){return this.get_velocity().set(e),this.get_velocity()},setVelocityFromTarget:function(e,t,n){var i=1/n;return this.get_velocity().set(e.sub(this.get_position(),!0).muleq(i)),this.set_angularVel((t-this.get_rotation())*i),e.zpp_inner.weak&&e.dispose(),this},get_kinematicVel:function(){return null==this.zpp_inner.wrap_kinvel&&this.zpp_inner.setupkinvel(),this.zpp_inner.wrap_kinvel},set_kinematicVel:function(e){return this.get_kinematicVel().set(e),this.get_kinematicVel()},get_surfaceVel:function(){return null==this.zpp_inner.wrap_svel&&this.zpp_inner.setupsvel(),this.zpp_inner.wrap_svel},set_surfaceVel:function(e){return this.get_surfaceVel().set(e),this.get_surfaceVel()},get_force:function(){return null==this.zpp_inner.wrap_force&&this.zpp_inner.setupForce(),this.zpp_inner.wrap_force},set_force:function(e){return this.get_force().set(e),this.get_force()},get_constraintVelocity:function(){return null==this.zpp_inner.wrapcvel&&this.zpp_inner.setup_cvel(),this.zpp_inner.wrapcvel},get_rotation:function(){return this.zpp_inner.rot},set_rotation:function(e){return this.zpp_inner.immutable_midstep("Body::rotation"),this.get_rotation()!=e&&(this.zpp_inner.rot=e,this.zpp_inner.invalidate_rot(),this.zpp_inner.wake()),this.get_rotation()},get_angularVel:function(){return this.zpp_inner.angvel},set_angularVel:function(e){return this.get_angularVel()!=e&&(this.zpp_inner.angvel=e,this.zpp_inner.invalidate_wake()),this.get_angularVel()},get_kinAngVel:function(){return this.zpp_inner.kinangvel},set_kinAngVel:function(e){return this.get_kinAngVel()!=e&&(this.zpp_inner.kinangvel=e,this.zpp_inner.invalidate_wake()),this.get_kinAngVel()},get_torque:function(){return this.zpp_inner.torque},set_torque:function(e){return this.get_torque()!=e&&(this.zpp_inner.torque=e,this.zpp_inner.invalidate_wake()),this.get_torque()},get_bounds:function(){return this.zpp_inner.aabb.wrapper()},get_allowMovement:function(){return!this.zpp_inner.nomove},set_allowMovement:function(e){return this.zpp_inner.immutable_midstep("Body::"+(null==e?"null":""+e)),this.get_allowMovement()!=e&&(this.zpp_inner.nomove=!e,this.zpp_inner.invalidate_mass()),this.get_allowMovement()},get_allowRotation:function(){return!this.zpp_inner.norotate},set_allowRotation:function(e){return this.zpp_inner.immutable_midstep("Body::"+(null==e?"null":""+e)),this.get_allowRotation()!=e&&(this.zpp_inner.norotate=!e,this.zpp_inner.invalidate_inertia()),this.get_allowRotation()},get_massMode:function(){return[T_.get_DEFAULT(),T_.get_FIXED()][this.zpp_inner.massMode]},set_massMode:function(e){this.zpp_inner.immutable_midstep("Body::massMode");var t=e==T_.get_DEFAULT()?0:1;return this.zpp_inner.massMode=t,this.zpp_inner.invalidate_mass(),this.get_massMode()},get_constraintMass:function(){return this.zpp_inner.world||this.zpp_inner.validate_mass(),this.zpp_inner.smass},get_mass:function(){return this.zpp_inner.validate_mass(),this.zpp_inner.cmass},set_mass:function(e){return this.zpp_inner.immutable_midstep("Body::mass"),this.zpp_inner.massMode=1,this.zpp_inner.cmass=e,this.zpp_inner.invalidate_mass(),this.get_mass()},get_gravMassMode:function(){return[P_.get_DEFAULT(),P_.get_FIXED(),P_.get_SCALED()][this.zpp_inner.massMode]},set_gravMassMode:function(e){this.zpp_inner.immutable_midstep("Body::gravMassMode");var t=e==P_.get_SCALED()?2:e==P_.get_DEFAULT()?0:1;return this.zpp_inner.gravMassMode=t,this.zpp_inner.invalidate_gravMass(),this.get_gravMassMode()},get_gravMass:function(){return this.zpp_inner.validate_gravMass(),this.zpp_inner.gravMass},set_gravMass:function(e){return this.zpp_inner.immutable_midstep("Body::gravMass"),this.zpp_inner.gravMassMode=1,this.zpp_inner.gravMass=e,this.zpp_inner.invalidate_gravMass(),this.get_gravMass()},get_gravMassScale:function(){return this.zpp_inner.validate_gravMassScale(),this.zpp_inner.gravMassScale},set_gravMassScale:function(e){return this.zpp_inner.immutable_midstep("Body::gravMassScale"),this.zpp_inner.gravMassMode=2,this.zpp_inner.gravMassScale=e,this.zpp_inner.invalidate_gravMassScale(),this.get_gravMassScale()},get_inertiaMode:function(){return[M_.get_DEFAULT(),M_.get_FIXED()][this.zpp_inner.inertiaMode]},set_inertiaMode:function(e){this.zpp_inner.immutable_midstep("Body::inertiaMode");var t=e==M_.get_FIXED()?1:0;return this.zpp_inner.inertiaMode=t,this.zpp_inner.invalidate_inertia(),this.get_inertiaMode()},get_constraintInertia:function(){return this.zpp_inner.world||this.zpp_inner.validate_inertia(),this.zpp_inner.sinertia},get_inertia:function(){return this.zpp_inner.validate_inertia(),this.zpp_inner.cinertia},set_inertia:function(e){return this.zpp_inner.immutable_midstep("Body::inertia"),this.zpp_inner.inertiaMode=1,this.zpp_inner.cinertia=e,this.zpp_inner.invalidate_inertia(),this.get_inertia()},connectedBodies:function(e,t){return null==e&&(e=-1),this.zpp_inner.connectedBodies(e,t)},interactingBodies:function(e,t,n){null==t&&(t=-1);var i=null==e?wp.COL|wp.SENSOR|wp.FLUID:e==xo.get_COLLISION()?wp.COL:e==xo.get_SENSOR()?wp.SENSOR:wp.FLUID;return this.zpp_inner.interactingBodies(i,t,n)},crushFactor:function(){for(var e=0,t=d_.get(),n=this.get_arbiters().iterator();n.hasNext();){var i=n.next().totalImpulse(this),r=i.xy();t.addeq(r),e+=r.get_length(),r.dispose(),i.dispose()}for(var a=this.get_constraints().iterator();a.hasNext();){var s=a.next().bodyImpulse(this),l=s.xy();t.addeq(l),e+=l.get_length(),l.dispose(),s.dispose()}var o=(e-t.get_length())/(this.get_mass()*this.get_space().zpp_inner.pre_dt);return t.dispose(),o},localPointToWorld:function(e,t){var n,i;return null==t&&(t=!1),this.zpp_inner.validate_axis(),n=this.zpp_inner.axisy*e.get_x()-this.zpp_inner.axisx*e.get_y(),i=e.get_x()*this.zpp_inner.axisx+e.get_y()*this.zpp_inner.axisy,e.zpp_inner.weak&&e.dispose(),d_.get(n+this.zpp_inner.posx,i+this.zpp_inner.posy,t)},worldPointToLocal:function(e,t){var n,i,r,a;return null==t&&(t=!1),this.zpp_inner.validate_axis(),r=e.get_x()-this.zpp_inner.posx,a=e.get_y()-this.zpp_inner.posy,n=r*this.zpp_inner.axisy+a*this.zpp_inner.axisx,i=a*this.zpp_inner.axisy-r*this.zpp_inner.axisx,e.zpp_inner.weak&&e.dispose(),d_.get(n,i,t)},localVectorToWorld:function(e,t){var n,i;return null==t&&(t=!1),this.zpp_inner.validate_axis(),n=this.zpp_inner.axisy*e.get_x()-this.zpp_inner.axisx*e.get_y(),i=e.get_x()*this.zpp_inner.axisx+e.get_y()*this.zpp_inner.axisy,e.zpp_inner.weak&&e.dispose(),d_.get(n,i,t)},worldVectorToLocal:function(e,t){var n,i;return null==t&&(t=!1),this.zpp_inner.validate_axis(),n=e.get_x()*this.zpp_inner.axisy+e.get_y()*this.zpp_inner.axisx,i=e.get_y()*this.zpp_inner.axisy-e.get_x()*this.zpp_inner.axisx,e.zpp_inner.weak&&e.dispose(),d_.get(n,i,t)},applyImpulse:function(e,t,n){if(null==n&&(n=!1),n&&this.get_isSleeping())return e.zpp_inner.weak&&e.dispose(),null!=t&&t.zpp_inner.weak&&t.dispose(),this;this.zpp_inner.validate_mass();var i,r,a=this.zpp_inner.imass;(this.zpp_inner.velx+=e.get_x()*a,this.zpp_inner.vely+=e.get_y()*a,null!=t)&&(i=t.get_x()-this.zpp_inner.posx,r=t.get_y()-this.zpp_inner.posy,this.zpp_inner.validate_inertia(),this.zpp_inner.angvel+=(e.get_y()*i-e.get_x()*r)*this.zpp_inner.iinertia,t.zpp_inner.weak&&t.dispose());return n||this.isDynamic()&&this.zpp_inner.invalidate_wake(),e.zpp_inner.weak&&e.dispose(),this},applyAngularImpulse:function(e,t){return null==t&&(t=!1),t&&this.get_isSleeping()||(this.zpp_inner.validate_inertia(),this.zpp_inner.angvel+=e*this.zpp_inner.iinertia,t||this.isDynamic()&&this.zpp_inner.invalidate_wake()),this},translateShapes:function(e){this.zpp_inner.immutable_midstep("Body::translateShapes()");var t=e.zpp_inner.weak;e.zpp_inner.weak=!1;for(var n=this.zpp_inner.shapes.begin();null!=n;)n.elem().outer.translate(e),n=n.next;return e.zpp_inner.weak=t,e.zpp_inner.weak&&e.dispose(),this},rotateShapes:function(e){this.zpp_inner.immutable_midstep("Body::rotateShapes()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.rotate(e),t=t.next;return this},scaleShapes:function(e,t){this.zpp_inner.immutable_midstep("Body::scaleShapes()");for(var n=this.zpp_inner.shapes.begin();null!=n;)n.elem().outer.scale(e,t),n=n.next;return this},transformShapes:function(e){this.zpp_inner.immutable_midstep("Body::transformShapes()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.transform(e),t=t.next;return this},align:function(){this.zpp_inner.immutable_midstep("Body::align()"),this.zpp_inner.validate_localCOM();var e=d_.get(-this.zpp_inner.localCOMx,-this.zpp_inner.localCOMy);this.translateShapes(e);var t=this.localVectorToWorld(e);return this.get_position().subeq(t),this.zpp_inner.pre_posx<X_.POSINF()&&(this.zpp_inner.pre_posx-=1*t.get_x(),this.zpp_inner.pre_posy-=1*t.get_y()),e.dispose(),t.dispose(),this},rotate:function(e,t){var n=e.zpp_inner.weak;e.zpp_inner.weak=!1;var i=this.get_position().sub(e);return i.rotate(t),this.set_position(e.add(i,!0)),i.dispose(),this.set_rotation(this.get_rotation()+t),e.zpp_inner.weak=n,e.zpp_inner.weak&&e.dispose(),this},setShapeMaterials:function(e){this.zpp_inner.immutable_midstep("Body::setShapeMaterials()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.set_material(e),t=t.next;return this},setShapeFilters:function(e){this.zpp_inner.immutable_midstep("Body::setShapeFilters()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.set_filter(e),t=t.next;return this},setShapeFluidProperties:function(e){this.zpp_inner.immutable_midstep("Body::setShapeFluidProperties()");for(var t=this.zpp_inner.shapes.begin();null!=t;)t.elem().outer.set_fluidProperties(e),t=t.next;return this},get_localCOM:function(){return null==this.zpp_inner.wrap_localCOM&&(this.zpp_inner.wrap_localCOM=d_.get(this.zpp_inner.localCOMx,this.zpp_inner.localCOMy),this.zpp_inner.wrap_localCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_localCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_localCOM.zpp_inner._validate=yc(vc=this.zpp_inner,vc.getlocalCOM)),this.zpp_inner.wrap_localCOM},get_worldCOM:function(){return null==this.zpp_inner.wrap_worldCOM&&(this.zpp_inner.wrap_worldCOM=d_.get(this.zpp_inner.worldCOMx,this.zpp_inner.worldCOMy),this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=yc(vc=this.zpp_inner,vc.getworldCOM)),this.zpp_inner.wrap_worldCOM},normalImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=0,a=(this.zpp_inner.arbiters,this.get_arbiters().iterator());a.hasNext();){var s=a.next().zpp_inner;if(s.type==wp.COL&&(null==e||s.b2==e.zpp_inner||s.b1==e.zpp_inner)){var l=s.wrapper().get_collisionArbiter().normalImpulse(this,t);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}}return g_.get(n,i,r)},tangentImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=0,a=(this.zpp_inner.arbiters,this.get_arbiters().iterator());a.hasNext();){var s=a.next().zpp_inner;if(s.type==wp.COL&&(null==e||s.b2==e.zpp_inner||s.b1==e.zpp_inner)){var l=s.wrapper().get_collisionArbiter().tangentImpulse(this,t);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}}return g_.get(n,i,r)},totalContactsImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=0,a=(this.zpp_inner.arbiters,this.get_arbiters().iterator());a.hasNext();){var s=a.next().zpp_inner;if(s.type==wp.COL&&(null==e||s.b2==e.zpp_inner||s.b1==e.zpp_inner)){var l=s.wrapper().get_collisionArbiter().totalImpulse(this,t);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}}return g_.get(n,i,r)},rollingImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=(this.zpp_inner.arbiters,this.get_arbiters().iterator());i.hasNext();){var r=i.next().zpp_inner;r.type==wp.COL&&(null!=e&&r.b2!=e.zpp_inner&&r.b1!=e.zpp_inner||(n+=r.wrapper().get_collisionArbiter().rollingImpulse(this,t)))}return n},buoyancyImpulse:function(e){for(var t=0,n=0,i=0,r=(this.zpp_inner.arbiters,this.get_arbiters().iterator());r.hasNext();){var a=r.next().zpp_inner;if(a.type==wp.FLUID&&(null==e||a.b2==e.zpp_inner||a.b1==e.zpp_inner)){var s=a.wrapper().get_fluidArbiter().buoyancyImpulse(this);t+=1*s.get_x(),n+=1*s.get_y(),i+=1*s.get_z(),s.dispose()}}return g_.get(t,n,i)},dragImpulse:function(e){for(var t=0,n=0,i=0,r=(this.zpp_inner.arbiters,this.get_arbiters().iterator());r.hasNext();){var a=r.next().zpp_inner;if(a.type==wp.FLUID&&(null==e||a.b2==e.zpp_inner||a.b1==e.zpp_inner)){var s=a.wrapper().get_fluidArbiter().dragImpulse(this);t+=1*s.get_x(),n+=1*s.get_y(),i+=1*s.get_z(),s.dispose()}}return g_.get(t,n,i)},totalFluidImpulse:function(e){for(var t=0,n=0,i=0,r=(this.zpp_inner.arbiters,this.get_arbiters().iterator());r.hasNext();){var a=r.next().zpp_inner;if(a.type==wp.FLUID&&(null==e||a.b2==e.zpp_inner||a.b1==e.zpp_inner)){var s=a.wrapper().get_fluidArbiter().totalImpulse(this);t+=1*s.get_x(),n+=1*s.get_y(),i+=1*s.get_z(),s.dispose()}}return g_.get(t,n,i)},constraintsImpulse:function(){for(var e=0,t=0,n=0,i=this.zpp_inner.constraints.begin();null!=i;){var r=i.elem().outer.bodyImpulse(this);e+=1*r.get_x(),t+=1*r.get_y(),n+=1*r.get_z(),r.dispose(),i=i.next}return g_.get(e,t,n)},totalImpulse:function(e,t){null==t&&(t=!1);for(var n=0,i=0,r=0,a=(this.zpp_inner.arbiters,this.get_arbiters().iterator());a.hasNext();){var s=a.next().zpp_inner;if(s.type!=wp.SENSOR&&(null==e||s.b2==e.zpp_inner||s.b1==e.zpp_inner)){var l=s.wrapper().totalImpulse(this,t);n+=1*l.get_x(),i+=1*l.get_y(),r+=1*l.get_z(),l.dispose()}}for(var o=this.zpp_inner.constraints.begin();null!=o;){var _=o.elem();if(_.active){var p=_.outer.bodyImpulse(this);n+=1*p.get_x(),i+=1*p.get_y(),r+=1*p.get_z(),p.dispose()}o=o.next}return g_.get(n,i,r)},contains:function(e){var t,n=e.zpp_inner.weak;t=e.zpp_inner.weak=!1;for(var i=this.zpp_inner.shapes.begin();null!=i;){if(i.elem().outer.contains(e)){t=!0;break}i=i.next}return e.zpp_inner.weak=n,e.zpp_inner.weak&&e.dispose(),t},toString:function(){return(this.zpp_inner.world?"(space::world":"("+(this.isDynamic()?"dynamic":this.isStatic()?"static":"kinematic"))+")#"+this.get_id()},__class__:y_,__properties__:r(b_.prototype.__properties__,{get_worldCOM:"get_worldCOM",get_localCOM:"get_localCOM",set_inertia:"set_inertia",get_inertia:"get_inertia",get_constraintInertia:"get_constraintInertia",set_inertiaMode:"set_inertiaMode",get_inertiaMode:"get_inertiaMode",set_gravMassScale:"set_gravMassScale",get_gravMassScale:"get_gravMassScale",set_gravMass:"set_gravMass",get_gravMass:"get_gravMass",set_gravMassMode:"set_gravMassMode",get_gravMassMode:"get_gravMassMode",set_mass:"set_mass",get_mass:"get_mass",get_constraintMass:"get_constraintMass",set_massMode:"set_massMode",get_massMode:"get_massMode",set_allowRotation:"set_allowRotation",get_allowRotation:"get_allowRotation",set_allowMovement:"set_allowMovement",get_allowMovement:"get_allowMovement",get_bounds:"get_bounds",set_torque:"set_torque",get_torque:"get_torque",set_kinAngVel:"set_kinAngVel",get_kinAngVel:"get_kinAngVel",set_angularVel:"set_angularVel",get_angularVel:"get_angularVel",set_rotation:"set_rotation",get_rotation:"get_rotation",get_constraintVelocity:"get_constraintVelocity",set_force:"set_force",get_force:"get_force",set_surfaceVel:"set_surfaceVel",get_surfaceVel:"get_surfaceVel",set_kinematicVel:"set_kinematicVel",get_kinematicVel:"get_kinematicVel",set_velocity:"set_velocity",get_velocity:"get_velocity",set_position:"set_position",get_position:"get_position",get_constraints:"get_constraints",get_isSleeping:"get_isSleeping",get_arbiters:"get_arbiters",set_space:"set_space",get_space:"get_space",set_compound:"set_compound",get_compound:"get_compound",get_shapes:"get_shapes",set_disableCCD:"set_disableCCD",get_disableCCD:"get_disableCCD",set_isBullet:"set_isBullet",get_isBullet:"get_isBullet",set_type:"set_type",get_type:"get_type"})});var x_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.phys.BodyIterator"]=x_).__name__=["nape","phys","BodyIterator"],x_.get=function(e){var t;if(null==x_.zpp_pool){Hh.internal=!0;var n=new x_;Hh.internal=!1,t=n}else{var i=x_.zpp_pool;x_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},x_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=x_.zpp_pool,(x_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:x_};var z_=function(){this.zpp_inner=null,this.zpp_inner=new Hh,this.zpp_inner.outer=this};(n["nape.phys.BodyList"]=z_).__name__=["nape","phys","BodyList"],z_.fromArray=function(e){for(var t=new z_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},z_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),x_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new z_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=x_.zpp_pool,(x_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:z_,__properties__:{get_length:"get_length"}};var w_=function(){};(n["nape.phys.BodyType"]=w_).__name__=["nape","phys","BodyType"],w_.__properties__={get_KINEMATIC:"get_KINEMATIC",get_DYNAMIC:"get_DYNAMIC",get_STATIC:"get_STATIC"},w_.get_STATIC=function(){return null==ap.BodyType_STATIC&&(ap.internal=!0,ap.BodyType_STATIC=new w_,ap.internal=!1),ap.BodyType_STATIC},w_.get_DYNAMIC=function(){return null==ap.BodyType_DYNAMIC&&(ap.internal=!0,ap.BodyType_DYNAMIC=new w_,ap.internal=!1),ap.BodyType_DYNAMIC},w_.get_KINEMATIC=function(){return null==ap.BodyType_KINEMATIC&&(ap.internal=!0,ap.BodyType_KINEMATIC=new w_,ap.internal=!1),ap.BodyType_KINEMATIC},w_.prototype={toString:function(){return this==w_.get_STATIC()?"STATIC":this==w_.get_DYNAMIC()?"DYNAMIC":this==w_.get_KINEMATIC()?"KINEMATIC":""},__class__:w_};var k_=function(){this.zpp_inner=null,b_.call(this),this.zpp_inner=new mu,((this.zpp_inner.outer=this).zpp_inner.outer_i=this).zpp_inner_i=this.zpp_inner,this.zpp_inner.insert_cbtype(co.get_ANY_COMPOUND().zpp_inner)};(n["nape.phys.Compound"]=k_).__name__=["nape","phys","Compound"],k_.__super__=b_,k_.prototype=r(b_.prototype,{zpp_inner:null,get_bodies:function(){return this.zpp_inner.wrap_bodies},get_constraints:function(){return this.zpp_inner.wrap_constraints},get_compounds:function(){return this.zpp_inner.wrap_compounds},get_compound:function(){return null==this.zpp_inner.compound?null:this.zpp_inner.compound.outer},set_compound:function(e){return this.zpp_inner.immutable_midstep("Compound::compound"),this.get_compound()!=e&&(null!=this.get_compound()&&this.get_compound().get_compounds().remove(this),null!=e&&e.get_compounds().add(this)),this.get_compound()},get_space:function(){return null==this.zpp_inner.space?null:this.zpp_inner.space.outer},set_space:function(e){return this.zpp_inner.immutable_midstep("Compound::space"),this.get_space()!=e&&(null!=this.get_space()&&this.get_space().get_compounds().remove(this),null!=e&&e.get_compounds().add(this)),this.get_space()},toString:function(){return"Compound"+this.get_id()},copy:function(){return this.zpp_inner.copy()},breakApart:function(){this.zpp_inner.breakApart()},visitBodies:function(e){for(var t=this.get_bodies().iterator();t.hasNext();)e(t.next());for(var n=this.get_compounds().iterator();n.hasNext();)n.next().visitBodies(e)},visitConstraints:function(e){for(var t=this.get_constraints().iterator();t.hasNext();)e(t.next());for(var n=this.get_compounds().iterator();n.hasNext();)n.next().visitConstraints(e)},visitCompounds:function(e){for(var t=this.get_compounds().iterator();t.hasNext();){var n=t.next();e(n),n.visitCompounds(e)}},COM:function(e){null==e&&(e=!1);var t=d_.get(0,0,e),n=0;return this.visitBodies((function(e){if(!e.get_shapes().empty()){var i=e.get_worldCOM().mul(e.get_mass(),!0);t.addeq(i),n+=e.get_mass()}})),t.muleq(1/n),t},translate:function(e){var t=e.zpp_inner.weak;return e.zpp_inner.weak=!1,this.visitBodies((function(t){t.get_position().addeq(e)})),e.zpp_inner.weak=t,e.zpp_inner.weak&&e.dispose(),this},rotate:function(e,t){var n=e.zpp_inner.weak;return e.zpp_inner.weak=!1,this.visitBodies((function(n){n.rotate(e,t)})),e.zpp_inner.weak=n,e.zpp_inner.weak&&e.dispose(),this},__class__:k_,__properties__:r(b_.prototype.__properties__,{set_space:"set_space",get_space:"get_space",set_compound:"set_compound",get_compound:"get_compound",get_compounds:"get_compounds",get_constraints:"get_constraints",get_bodies:"get_bodies"})});var S_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.phys.CompoundIterator"]=S_).__name__=["nape","phys","CompoundIterator"],S_.get=function(e){var t;if(null==S_.zpp_pool){Jh.internal=!0;var n=new S_;Jh.internal=!1,t=n}else{var i=S_.zpp_pool;S_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},S_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=S_.zpp_pool,(S_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:S_};var C_=function(){this.zpp_inner=null,this.zpp_inner=new Jh,this.zpp_inner.outer=this};(n["nape.phys.CompoundList"]=C_).__name__=["nape","phys","CompoundList"],C_.fromArray=function(e){for(var t=new C_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},C_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),S_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new C_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=S_.zpp_pool,(S_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:C_,__properties__:{get_length:"get_length"}};var N_=function(e,t){null==t&&(t=1),null==e&&(e=1),(this.zpp_inner=null)==fu.zpp_pool?this.zpp_inner=new fu:(this.zpp_inner=fu.zpp_pool,fu.zpp_pool=this.zpp_inner.next,this.zpp_inner.next=null),this.zpp_inner.alloc(),(this.zpp_inner.outer=this).set_density(e),this.set_viscosity(t)};(n["nape.phys.FluidProperties"]=N_).__name__=["nape","phys","FluidProperties"],N_.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_shapes:function(){return null==this.zpp_inner.wrap_shapes&&(this.zpp_inner.wrap_shapes=rc.get(this.zpp_inner.shapes,!0)),this.zpp_inner.wrap_shapes},copy:function(){var e=new N_(this.get_density(),this.get_viscosity());return null!=this.zpp_inner.userData&&(e.zpp_inner.userData=_.copy(this.zpp_inner.userData)),e.set_gravity(this.get_gravity()),e},get_density:function(){return 1e3*this.zpp_inner.density},set_density:function(e){return e!=this.get_density()&&(this.zpp_inner.density=e/1e3,this.zpp_inner.invalidate()),this.get_density()},get_viscosity:function(){return this.zpp_inner.viscosity},set_viscosity:function(e){return e!=this.get_viscosity()&&(this.zpp_inner.viscosity=e/1,this.zpp_inner.invalidate()),this.get_viscosity()},get_gravity:function(){return this.zpp_inner.wrap_gravity},set_gravity:function(e){return null==e?null!=this.zpp_inner.wrap_gravity&&(this.zpp_inner.wrap_gravity.zpp_inner._inuse=!1,this.zpp_inner.wrap_gravity.dispose(),this.zpp_inner.wrap_gravity=null):(null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),this.get_gravity().set(e)),this.get_gravity()},toString:function(){return"{ density: "+this.get_density()+" viscosity: "+this.get_viscosity()+" gravity: "+p.string(this.get_gravity())+" }"},__class__:N_,__properties__:{set_gravity:"set_gravity",get_gravity:"get_gravity",set_viscosity:"set_viscosity",get_viscosity:"get_viscosity",set_density:"set_density",get_density:"get_density",get_shapes:"get_shapes",get_userData:"get_userData"}};var P_=function(){};(n["nape.phys.GravMassMode"]=P_).__name__=["nape","phys","GravMassMode"],P_.__properties__={get_SCALED:"get_SCALED",get_FIXED:"get_FIXED",get_DEFAULT:"get_DEFAULT"},P_.get_DEFAULT=function(){return null==ap.GravMassMode_DEFAULT&&(ap.internal=!0,ap.GravMassMode_DEFAULT=new P_,ap.internal=!1),ap.GravMassMode_DEFAULT},P_.get_FIXED=function(){return null==ap.GravMassMode_FIXED&&(ap.internal=!0,ap.GravMassMode_FIXED=new P_,ap.internal=!1),ap.GravMassMode_FIXED},P_.get_SCALED=function(){return null==ap.GravMassMode_SCALED&&(ap.internal=!0,ap.GravMassMode_SCALED=new P_,ap.internal=!1),ap.GravMassMode_SCALED},P_.prototype={toString:function(){return this==P_.get_DEFAULT()?"DEFAULT":this==P_.get_FIXED()?"FIXED":this==P_.get_SCALED()?"SCALED":""},__class__:P_};var M_=function(){};(n["nape.phys.InertiaMode"]=M_).__name__=["nape","phys","InertiaMode"],M_.__properties__={get_FIXED:"get_FIXED",get_DEFAULT:"get_DEFAULT"},M_.get_DEFAULT=function(){return null==ap.InertiaMode_DEFAULT&&(ap.internal=!0,ap.InertiaMode_DEFAULT=new M_,ap.internal=!1),ap.InertiaMode_DEFAULT},M_.get_FIXED=function(){return null==ap.InertiaMode_FIXED&&(ap.internal=!0,ap.InertiaMode_FIXED=new M_,ap.internal=!1),ap.InertiaMode_FIXED},M_.prototype={toString:function(){return this==M_.get_DEFAULT()?"DEFAULT":this==M_.get_FIXED()?"FIXED":""},__class__:M_};var I_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.phys.InteractorIterator"]=I_).__name__=["nape","phys","InteractorIterator"],I_.get=function(e){var t;if(null==I_.zpp_pool){Yh.internal=!0;var n=new I_;Yh.internal=!1,t=n}else{var i=I_.zpp_pool;I_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},I_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=I_.zpp_pool,(I_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:I_};var A_=function(){this.zpp_inner=null,this.zpp_inner=new Yh,this.zpp_inner.outer=this};(n["nape.phys.InteractorList"]=A_).__name__=["nape","phys","InteractorList"],A_.fromArray=function(e){for(var t=new A_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},A_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner_i)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer_i},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner_i);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner_i)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner_i)}else this.zpp_inner.inner.add(e.zpp_inner_i);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer_i},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer_i;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer_i},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner_i){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner_i),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),I_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new A_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=I_.zpp_pool,(I_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:A_,__properties__:{get_length:"get_length"}};var T_=function(){};(n["nape.phys.MassMode"]=T_).__name__=["nape","phys","MassMode"],T_.__properties__={get_FIXED:"get_FIXED",get_DEFAULT:"get_DEFAULT"},T_.get_DEFAULT=function(){return null==ap.MassMode_DEFAULT&&(ap.internal=!0,ap.MassMode_DEFAULT=new T_,ap.internal=!1),ap.MassMode_DEFAULT},T_.get_FIXED=function(){return null==ap.MassMode_FIXED&&(ap.internal=!0,ap.MassMode_FIXED=new T_,ap.internal=!1),ap.MassMode_FIXED},T_.prototype={toString:function(){return this==T_.get_DEFAULT()?"DEFAULT":this==T_.get_FIXED()?"FIXED":""},__class__:T_};var D_=function(){this.zpp_inner=null,b_.call(this)};(n["nape.shape.Shape"]=D_).__name__=["nape","shape","Shape"],D_.__super__=b_,D_.prototype=r(b_.prototype,{zpp_inner:null,get_type:function(){return gu.types[this.zpp_inner.type]},isCircle:function(){return this.zpp_inner.isCircle()},isPolygon:function(){return this.zpp_inner.isPolygon()},get_body:function(){return null!=this.zpp_inner.body?this.zpp_inner.body.outer:null},set_body:function(e){return this.zpp_inner.immutable_midstep("Shape::body"),this.get_body()!=e&&(null!=this.zpp_inner.body&&this.get_body().get_shapes().remove(this),null!=e&&e.get_shapes().add(this)),this.get_body()},get_castCircle:function(){return this.isCircle()?this.zpp_inner.circle.outer_zn:null},get_castPolygon:function(){return this.isPolygon()?this.zpp_inner.polygon.outer_zn:null},get_worldCOM:function(){return null==this.zpp_inner.wrap_worldCOM&&(this.zpp_inner.wrap_worldCOM=d_.get(this.zpp_inner.worldCOMx,this.zpp_inner.worldCOMy),this.zpp_inner.wrap_worldCOM.zpp_inner._inuse=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._immutable=!0,this.zpp_inner.wrap_worldCOM.zpp_inner._validate=yc(vc=this.zpp_inner,vc.getworldCOM)),this.zpp_inner.wrap_worldCOM},get_localCOM:function(){return null==this.zpp_inner.wrap_localCOM&&(this.isCircle()?this.zpp_inner.circle.setupLocalCOM():this.zpp_inner.polygon.setupLocalCOM()),this.zpp_inner.wrap_localCOM},set_localCOM:function(e){return this.zpp_inner.immutable_midstep("Body::localCOM"),this.get_localCOM().set(e),this.get_localCOM()},get_area:function(){return this.zpp_inner.validate_area_inertia(),this.zpp_inner.area},get_inertia:function(){return this.zpp_inner.validate_area_inertia(),this.zpp_inner.inertia},get_angDrag:function(){return this.zpp_inner.validate_angDrag(),this.zpp_inner.angDrag},get_material:function(){return this.zpp_inner.material.wrapper()},set_material:function(e){return this.zpp_inner.immutable_midstep("Shape::material"),this.zpp_inner.setMaterial(e.zpp_inner),this.get_material()},get_filter:function(){return this.zpp_inner.filter.wrapper()},set_filter:function(e){return this.zpp_inner.immutable_midstep("Shape::filter"),this.zpp_inner.setFilter(e.zpp_inner),this.get_filter()},get_fluidProperties:function(){return this.zpp_inner.immutable_midstep("Shape::fluidProperties"),null==this.zpp_inner.fluidProperties&&this.zpp_inner.setFluid((new N_).zpp_inner),this.zpp_inner.fluidProperties.wrapper()},set_fluidProperties:function(e){return this.zpp_inner.setFluid(e.zpp_inner),this.get_fluidProperties()},get_fluidEnabled:function(){return this.zpp_inner.fluidEnabled},set_fluidEnabled:function(e){return this.zpp_inner.immutable_midstep("Shape::fluidEnabled"),(this.zpp_inner.fluidEnabled=e)&&null==this.zpp_inner.fluidProperties&&this.set_fluidProperties(new N_),this.zpp_inner.wake(),this.get_fluidEnabled()},get_sensorEnabled:function(){return this.zpp_inner.sensorEnabled},set_sensorEnabled:function(e){return this.zpp_inner.immutable_midstep("Shape::sensorEnabled"),this.zpp_inner.sensorEnabled=e,this.zpp_inner.wake(),this.get_sensorEnabled()},get_bounds:function(){return this.zpp_inner.aabb.wrapper()},translate:function(e){return this.zpp_inner.immutable_midstep("Shape::translate()"),0<e.lsq()&&(this.isCircle()?this.zpp_inner.circle.__translate(e.get_x(),e.get_y()):this.zpp_inner.polygon.__translate(e.get_x(),e.get_y())),e.zpp_inner.weak&&e.dispose(),this},scale:function(e,t){if(this.zpp_inner.immutable_midstep("Shape::scale()"),this.isCircle()){var n=e*e-t*t;n*n<lo.epsilon*lo.epsilon&&this.zpp_inner.circle.__scale(e,t)}else this.zpp_inner.polygon.__scale(e,t);return this},rotate:function(e){if(this.zpp_inner.immutable_midstep("Shape::rotate()"),0!=e%(2*Math.PI)){var t=Math.cos(e),n=Math.sin(e);this.isCircle()?this.zpp_inner.circle.__rotate(n,t):this.zpp_inner.polygon.__rotate(n,t)}return this},transform:function(e){return this.zpp_inner.immutable_midstep("Shape::transform()"),this.isCircle()?e.equiorthogonal()&&this.zpp_inner.circle.__transform(e):this.zpp_inner.polygon.__transform(e),this},contains:function(e){Fp.validateShape(this.zpp_inner),e.zpp_inner.validate();var t=Dp.shapeContains(this.zpp_inner,e.zpp_inner);return e.zpp_inner.weak&&e.dispose(),t},copy:function(){return this.zpp_inner.copy()},toString:function(){return(this.isCircle()?"Circle":"Polygon")+"#"+this.get_id()},__class__:D_,__properties__:r(b_.prototype.__properties__,{get_bounds:"get_bounds",set_sensorEnabled:"set_sensorEnabled",get_sensorEnabled:"get_sensorEnabled",set_fluidEnabled:"set_fluidEnabled",get_fluidEnabled:"get_fluidEnabled",set_fluidProperties:"set_fluidProperties",get_fluidProperties:"get_fluidProperties",set_filter:"set_filter",get_filter:"get_filter",set_material:"set_material",get_material:"get_material",get_angDrag:"get_angDrag",get_inertia:"get_inertia",get_area:"get_area",set_localCOM:"set_localCOM",get_localCOM:"get_localCOM",get_worldCOM:"get_worldCOM",get_castPolygon:"get_castPolygon",get_castCircle:"get_castCircle",set_body:"set_body",get_body:"get_body",get_type:"get_type"})});var E_=function(e,t,n,i){this.zpp_inner_zn=null,D_.call(this),this.zpp_inner_zn=new vu,((this.zpp_inner_zn.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner=this.zpp_inner_zn,this.zpp_inner_i=this.zpp_inner,(this.zpp_inner_i.outer_i=this).set_radius(e),null==t?(this.zpp_inner.localCOMx=0,this.zpp_inner.localCOMy=0):(this.zpp_inner.localCOMx=t.get_x(),this.zpp_inner.localCOMy=t.get_y(),t.zpp_inner.weak&&t.dispose()),null==n?(null==Qi.zpp_pool?this.zpp_inner.material=new Qi:(this.zpp_inner.material=Qi.zpp_pool,Qi.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),this.zpp_inner.material.alloc()):this.set_material(n),null==i?(null==xi.zpp_pool?this.zpp_inner.filter=new xi:(this.zpp_inner.filter=xi.zpp_pool,xi.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),this.zpp_inner.filter.alloc()):this.set_filter(i),this.zpp_inner_i.insert_cbtype(co.get_ANY_SHAPE().zpp_inner)};(n["nape.shape.Circle"]=E_).__name__=["nape","shape","Circle"],E_.__super__=D_,E_.prototype=r(D_.prototype,{zpp_inner_zn:null,get_radius:function(){return this.zpp_inner_zn.radius},set_radius:function(e){return this.zpp_inner.immutable_midstep("Circle::radius"),e!=this.get_radius()&&(this.zpp_inner_zn.radius=e,this.zpp_inner_zn.invalidate_radius()),this.get_radius()},__class__:E_,__properties__:r(D_.prototype.__properties__,{set_radius:"set_radius",get_radius:"get_radius"})});var O_=function(){this.zpp_inner=null};(n["nape.shape.Edge"]=O_).__name__=["nape","shape","Edge"],O_.prototype={zpp_inner:null,get_polygon:function(){return this.zpp_inner.polygon.outer_zn},get_localNormal:function(){return null==this.zpp_inner.wrap_lnorm&&this.zpp_inner.getlnorm(),this.zpp_inner.wrap_lnorm},get_worldNormal:function(){return null==this.zpp_inner.wrap_gnorm&&this.zpp_inner.getgnorm(),this.zpp_inner.wrap_gnorm},get_length:function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.length},get_localProjection:function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lprojection},get_worldProjection:function(){return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gprojection},get_localVertex1:function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lp0.wrapper()},get_localVertex2:function(){return this.zpp_inner.polygon.validate_laxi(),this.zpp_inner.lp1.wrapper()},get_worldVertex1:function(){return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gp0.wrapper()},get_worldVertex2:function(){return this.zpp_inner.polygon.validate_gaxi(),this.zpp_inner.gp1.wrapper()},toString:function(){return null==this.zpp_inner.polygon?"Edge(object-pooled)":null==this.zpp_inner.polygon.body?(this.zpp_inner.polygon.validate_laxi(),"{ localNormal : { x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" } }"):(this.zpp_inner.polygon.validate_gaxi(),"{ localNormal : { x: "+this.zpp_inner.lnormx+" y: "+this.zpp_inner.lnormy+" } worldNormal : { x: "+this.zpp_inner.gnormx+" y: "+this.zpp_inner.gnormy+" } }")},__class__:O_,__properties__:{get_worldVertex2:"get_worldVertex2",get_worldVertex1:"get_worldVertex1",get_localVertex2:"get_localVertex2",get_localVertex1:"get_localVertex1",get_worldProjection:"get_worldProjection",get_localProjection:"get_localProjection",get_length:"get_length",get_worldNormal:"get_worldNormal",get_localNormal:"get_localNormal",get_polygon:"get_polygon"}};var B_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.shape.EdgeIterator"]=B_).__name__=["nape","shape","EdgeIterator"],B_.get=function(e){var t;if(null==B_.zpp_pool){ic.internal=!0;var n=new B_;ic.internal=!1,t=n}else{var i=B_.zpp_pool;B_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},B_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=B_.zpp_pool,(B_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:B_};var L_=function(){this.zpp_inner=null,this.zpp_inner=new ic,this.zpp_inner.outer=this};(n["nape.shape.EdgeList"]=L_).__name__=["nape","shape","EdgeList"],L_.fromArray=function(e){for(var t=new L_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},L_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=e==this.get_length()-1?e:this.get_length()-2-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),B_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new L_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=B_.zpp_pool,(B_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:L_,__properties__:{get_length:"get_length"}};var j_=function(e,t,n){if(this.zpp_inner_zn=null,D_.call(this),this.zpp_inner_zn=new yu,((this.zpp_inner_zn.outer=this).zpp_inner_zn.outer_zn=this).zpp_inner=this.zpp_inner_zn,this.zpp_inner_i=this.zpp_inner,this.zpp_inner_i.outer_i=this,e instanceof Array&&null==e.__enum__)for(var i=e,r=0;r<i.length;){var a=i[r];++r;var s=a;this.get_localVerts().push(s.copy())}else if(p.is(e,f_))for(var l=e.iterator();l.hasNext();){var o=l.next();this.get_localVerts().push(o.copy())}else if(p.is(e,i_)){var _=e.zpp_inner.vertices;if(null!=_)for(var u=_;;){var h=d_.get(u.x,u.y);if(u=u.next,this.get_localVerts().push(h.copy()),h.dispose(),u==_)break}}if(e instanceof Array&&null==e.__enum__)for(var c=e,d=0;d<c.length;){var m=c[d];m.zpp_inner.weak&&(m.dispose(),1)?c.splice(d,1):++d}else if(p.is(e,f_)){var f=e;null!=f.zpp_inner._validate&&f.zpp_inner._validate();for(var g=f.zpp_inner.inner,v=null,b=g.begin();null!=b;){var y=b.elem();y.outer.zpp_inner.weak?(b=g.erase(v),y.outer.zpp_inner.weak&&y.outer.dispose()):b=(v=b).next}}null==t?(null==Qi.zpp_pool?this.zpp_inner.material=new Qi:(this.zpp_inner.material=Qi.zpp_pool,Qi.zpp_pool=this.zpp_inner.material.next,this.zpp_inner.material.next=null),this.zpp_inner.material.alloc()):this.set_material(t),null==n?(null==xi.zpp_pool?this.zpp_inner.filter=new xi:(this.zpp_inner.filter=xi.zpp_pool,xi.zpp_pool=this.zpp_inner.filter.next,this.zpp_inner.filter.next=null),this.zpp_inner.filter.alloc()):this.set_filter(n),this.zpp_inner_i.insert_cbtype(co.get_ANY_SHAPE().zpp_inner)};(n["nape.shape.Polygon"]=j_).__name__=["nape","shape","Polygon"],j_.rect=function(e,t,n,i,r){return null==r&&(r=!1),[d_.get(e,t,r),d_.get(e+n,t,r),d_.get(e+n,t+i,r),d_.get(e,t+i,r)]},j_.box=function(e,t,n){return null==n&&(n=!1),j_.rect(-e/2,-t/2,e,t,n)},j_.regular=function(e,t,n,i,r){null==r&&(r=!1),null==i&&(i=0);for(var a=[],s=2*Math.PI/n,l=0,o=n;l<o;){var _=l++*s+i,p=d_.get(Math.cos(_)*e,Math.sin(_)*t,r);a.push(p)}return a},j_.__super__=D_,j_.prototype=r(D_.prototype,{zpp_inner_zn:null,get_localVerts:function(){return null==this.zpp_inner_zn.wrap_lverts&&this.zpp_inner_zn.getlverts(),this.zpp_inner_zn.wrap_lverts},get_worldVerts:function(){return null==this.zpp_inner_zn.wrap_gverts&&this.zpp_inner_zn.getgverts(),this.zpp_inner_zn.wrap_gverts},get_edges:function(){return null==this.zpp_inner_zn.wrap_edges&&this.zpp_inner_zn.getedges(),this.zpp_inner_zn.wrap_edges},validity:function(){return this.zpp_inner_zn.valid()},__class__:j_,__properties__:r(D_.prototype.__properties__,{get_edges:"get_edges",get_worldVerts:"get_worldVerts",get_localVerts:"get_localVerts"})});var F_=function(){this.zpp_next=null,this.zpp_critical=!1,this.zpp_i=0,this.zpp_inner=null};(n["nape.shape.ShapeIterator"]=F_).__name__=["nape","shape","ShapeIterator"],F_.get=function(e){var t;if(null==F_.zpp_pool){rc.internal=!0;var n=new F_;rc.internal=!1,t=n}else{var i=F_.zpp_pool;F_.zpp_pool=i.zpp_next,t=i}return t.zpp_i=0,t.zpp_inner=e,t.zpp_critical=!1,t},F_.prototype={zpp_inner:null,zpp_i:null,zpp_critical:null,zpp_next:null,hasNext:function(){this.zpp_inner.zpp_inner.valmod();var e=this.zpp_inner.get_length();return this.zpp_critical=!0,this.zpp_i<e||(this.zpp_next=F_.zpp_pool,(F_.zpp_pool=this).zpp_inner=null,!1)},next:function(){return this.zpp_critical=!1,this.zpp_inner.at(this.zpp_i++)},__class__:F_};var R_=function(){this.zpp_inner=null,this.zpp_inner=new rc,this.zpp_inner.outer=this};(n["nape.shape.ShapeList"]=R_).__name__=["nape","shape","ShapeList"],R_.fromArray=function(e){for(var t=new R_,n=0;n<e.length;){var i=e[n];++n,t.push(i)}return t},R_.prototype={zpp_inner:null,get_length:function(){return this.zpp_inner.valmod(),this.zpp_inner.zip_length&&(this.zpp_inner.zip_length=!1,this.zpp_inner.user_length=this.zpp_inner.inner.length),this.zpp_inner.user_length},has:function(e){return this.zpp_inner.valmod(),this.zpp_inner.inner.has(e.zpp_inner)},at:function(e){if(this.zpp_inner.valmod(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.zpp_inner.at_index||null==this.zpp_inner.at_ite)this.zpp_inner.at_index=e,this.zpp_inner.at_ite=this.zpp_inner.inner.iterator_at(e);else for(;this.zpp_inner.at_index!=e;)this.zpp_inner.at_index++,this.zpp_inner.at_ite=this.zpp_inner.at_ite.next;return this.zpp_inner.at_ite.elem().outer},push:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.zpp_inner.inner.add(e.zpp_inner);else{if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){if(null==this.zpp_inner.push_ite){var n=this.empty()?null:this.zpp_inner.inner.iterator_at(this.get_length()-1);this.zpp_inner.push_ite=n}this.zpp_inner.push_ite=this.zpp_inner.inner.insert(this.zpp_inner.push_ite,e.zpp_inner)}else this.zpp_inner.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}else{null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var n=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.zpp_inner.inner.front():n.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(n)}return this.zpp_inner.invalidate(),e.outer},shift:function(){this.zpp_inner.modify_test(),this.zpp_inner.valmod();var e=null;if(this.zpp_inner.reverse_flag){null!=this.zpp_inner.at_ite&&null==this.zpp_inner.at_ite.next&&(this.zpp_inner.at_ite=null);var t=1==this.get_length()?null:this.zpp_inner.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.zpp_inner.inner.front():t.next.elem()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.zpp_inner.inner.erase(t)}else{var i=(e=this.zpp_inner.inner.front()).outer;null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.zpp_inner.inner.pop()}return this.zpp_inner.invalidate(),e.outer},add:function(e){return this.zpp_inner.reverse_flag?this.push(e):this.unshift(e)},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_inner.valmod(),t=!1;for(var n=this.zpp_inner.inner.begin();null!=n;){if(n.elem()==e.zpp_inner){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.zpp_inner.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},empty:function(){return this.zpp_inner.inner.empty()},iterator:function(){return this.zpp_inner.valmod(),F_.get(this)},copy:function(e){null==e&&(e=!1);for(var t=new R_,n=this.iterator();n.hasNext();){var i=n.next();t.push(e?null:i)}return t},merge:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();this.has(n)||this.add(n)}},toString:function(){for(var e="[",t=!0,n=this.iterator();n.hasNext();){var i=n.next();t||(e+=","),e+=null==i?"NULL":i.toString(),t=!1}return e+"]"},foreach:function(e){for(var t=this.iterator();t.hasNext();)try{e(t.next())}catch(e){t.zpp_next=F_.zpp_pool,(F_.zpp_pool=t).zpp_inner=null;break}return this},filter:function(e){for(var t=0;t<this.get_length();){var n=this.at(t);try{e(n)?++t:this.remove(n)}catch(e){break}}return this},__class__:R_,__properties__:{get_length:"get_length"}};var G_=function(){};(n["nape.shape.ShapeType"]=G_).__name__=["nape","shape","ShapeType"],G_.__properties__={get_POLYGON:"get_POLYGON",get_CIRCLE:"get_CIRCLE"},G_.get_CIRCLE=function(){return null==ap.ShapeType_CIRCLE&&(ap.internal=!0,ap.ShapeType_CIRCLE=new G_,ap.internal=!1),ap.ShapeType_CIRCLE},G_.get_POLYGON=function(){return null==ap.ShapeType_POLYGON&&(ap.internal=!0,ap.ShapeType_POLYGON=new G_,ap.internal=!1),ap.ShapeType_POLYGON},G_.prototype={toString:function(){return this==G_.get_CIRCLE()?"CIRCLE":this==G_.get_POLYGON()?"POLYGON":""},__class__:G_};var Z_=function(){};(n["nape.shape.ValidationResult"]=Z_).__name__=["nape","shape","ValidationResult"],Z_.__properties__={get_SELF_INTERSECTING:"get_SELF_INTERSECTING",get_CONCAVE:"get_CONCAVE",get_DEGENERATE:"get_DEGENERATE",get_VALID:"get_VALID"},Z_.get_VALID=function(){return null==ap.ValidationResult_VALID&&(ap.internal=!0,ap.ValidationResult_VALID=new Z_,ap.internal=!1),ap.ValidationResult_VALID},Z_.get_DEGENERATE=function(){return null==ap.ValidationResult_DEGENERATE&&(ap.internal=!0,ap.ValidationResult_DEGENERATE=new Z_,ap.internal=!1),ap.ValidationResult_DEGENERATE},Z_.get_CONCAVE=function(){return null==ap.ValidationResult_CONCAVE&&(ap.internal=!0,ap.ValidationResult_CONCAVE=new Z_,ap.internal=!1),ap.ValidationResult_CONCAVE},Z_.get_SELF_INTERSECTING=function(){return null==ap.ValidationResult_SELF_INTERSECTING&&(ap.internal=!0,ap.ValidationResult_SELF_INTERSECTING=new Z_,ap.internal=!1),ap.ValidationResult_SELF_INTERSECTING},Z_.prototype={toString:function(){return this==Z_.get_VALID()?"VALID":this==Z_.get_DEGENERATE()?"DEGENERATE":this==Z_.get_CONCAVE()?"CONCAVE":this==Z_.get_SELF_INTERSECTING()?"SELF_INTERSECTING":""},__class__:Z_};var U_=function(){};(n["nape.space.Broadphase"]=U_).__name__=["nape","space","Broadphase"],U_.__properties__={get_SWEEP_AND_PRUNE:"get_SWEEP_AND_PRUNE",get_DYNAMIC_AABB_TREE:"get_DYNAMIC_AABB_TREE"},U_.get_DYNAMIC_AABB_TREE=function(){return null==ap.Broadphase_DYNAMIC_AABB_TREE&&(ap.internal=!0,ap.Broadphase_DYNAMIC_AABB_TREE=new U_,ap.internal=!1),ap.Broadphase_DYNAMIC_AABB_TREE},U_.get_SWEEP_AND_PRUNE=function(){return null==ap.Broadphase_SWEEP_AND_PRUNE&&(ap.internal=!0,ap.Broadphase_SWEEP_AND_PRUNE=new U_,ap.internal=!1),ap.Broadphase_SWEEP_AND_PRUNE},U_.prototype={toString:function(){return this==U_.get_DYNAMIC_AABB_TREE()?"DYNAMIC_AABB_TREE":this==U_.get_SWEEP_AND_PRUNE()?"SWEEP_AND_PRUNE":""},__class__:U_};var V_=function(e,t){this.zpp_inner=null,this.zpp_inner=new Iu(null==e?null:e.zpp_inner,t),this.zpp_inner.outer=this,null!=e&&e.zpp_inner.weak&&e.dispose()};(n["nape.space.Space"]=V_).__name__=["nape","space","Space"],V_.prototype={zpp_inner:null,get_userData:function(){return null==this.zpp_inner.userData&&(this.zpp_inner.userData={}),this.zpp_inner.userData},get_gravity:function(){return null==this.zpp_inner.wrap_gravity&&this.zpp_inner.getgravity(),this.zpp_inner.wrap_gravity},set_gravity:function(e){return this.get_gravity().set(e),this.get_gravity()},get_broadphase:function(){return this.zpp_inner.bphase.is_sweep?U_.get_SWEEP_AND_PRUNE():U_.get_DYNAMIC_AABB_TREE()},get_sortContacts:function(){return this.zpp_inner.sortcontacts},set_sortContacts:function(e){return this.zpp_inner.sortcontacts=e,this.get_sortContacts()},get_worldAngularDrag:function(){return this.zpp_inner.global_ang_drag},set_worldAngularDrag:function(e){var t=e;return this.zpp_inner.global_ang_drag=t,this.get_worldAngularDrag()},get_worldLinearDrag:function(){return this.zpp_inner.global_lin_drag},set_worldLinearDrag:function(e){var t=e;return this.zpp_inner.global_lin_drag=t,this.get_worldLinearDrag()},get_compounds:function(){return this.zpp_inner.wrap_compounds},get_bodies:function(){return this.zpp_inner.wrap_bodies},get_liveBodies:function(){return this.zpp_inner.wrap_live},get_constraints:function(){return this.zpp_inner.wrap_constraints},get_liveConstraints:function(){return this.zpp_inner.wrap_livecon},visitBodies:function(e){for(var t=this.get_bodies().iterator();t.hasNext();)e(t.next());for(var n=this.get_compounds().iterator();n.hasNext();)n.next().visitBodies(e)},visitConstraints:function(e){for(var t=this.get_constraints().iterator();t.hasNext();)e(t.next());for(var n=this.get_compounds().iterator();n.hasNext();)n.next().visitConstraints(e)},visitCompounds:function(e){for(var t=this.get_compounds().iterator();t.hasNext();){var n=t.next();e(n),n.visitCompounds(e)}},get_world:function(){return this.zpp_inner.__static},get_arbiters:function(){if(null==this.zpp_inner.wrap_arbiters){var e=new Ip;e.space=this.zpp_inner,this.zpp_inner.wrap_arbiters=e}return this.zpp_inner.wrap_arbiters},get_listeners:function(){return this.zpp_inner.wrap_listeners},clear:function(){this.zpp_inner.clear()},step:function(e,t,n){null==n&&(n=10),null==t&&(t=10),this.zpp_inner.step(e,t,n)},get_timeStamp:function(){return this.zpp_inner.stamp},get_elapsedTime:function(){return this.zpp_inner.time},interactionType:function(e,t){if(e.get_body().isStatic()&&t.get_body().isStatic())return null;if(e.get_body()==t.get_body())return null;var n=e.zpp_inner,i=t.zpp_inner;switch(this.zpp_inner.interactionType(n,i,n.body,i.body)){case 0:return xo.get_FLUID();case 1:return xo.get_COLLISION();case 2:return xo.get_SENSOR();default:return null}},shapesUnderPoint:function(e,t,n){var i=this.zpp_inner.shapesUnderPoint(e.get_x(),e.get_y(),null==t?null:t.zpp_inner,n);return e.zpp_inner.weak&&e.dispose(),i},bodiesUnderPoint:function(e,t,n){var i=this.zpp_inner.bodiesUnderPoint(e.get_x(),e.get_y(),null==t?null:t.zpp_inner,n);return e.zpp_inner.weak&&e.dispose(),i},shapesInAABB:function(e,t,n,i,r){return null==n&&(n=!0),null==t&&(t=!1),this.zpp_inner.shapesInAABB(e,n,t,null==i?null:i.zpp_inner,r)},bodiesInAABB:function(e,t,n,i,r){return null==n&&(n=!0),null==t&&(t=!1),this.zpp_inner.bodiesInAABB(e,n,t,null==i?null:i.zpp_inner,r)},shapesInCircle:function(e,t,n,i,r){null==n&&(n=!1);var a=this.zpp_inner.shapesInCircle(e,t,n,null==i?null:i.zpp_inner,r);return e.zpp_inner.weak&&e.dispose(),a},bodiesInCircle:function(e,t,n,i,r){null==n&&(n=!1);var a=this.zpp_inner.bodiesInCircle(e,t,n,null==i?null:i.zpp_inner,r);return e.zpp_inner.weak&&e.dispose(),a},shapesInShape:function(e,t,n,i){return null==t&&(t=!1),this.zpp_inner.shapesInShape(e.zpp_inner,t,null==n?null:n.zpp_inner,i)},bodiesInShape:function(e,t,n,i){return null==t&&(t=!1),this.zpp_inner.bodiesInShape(e.zpp_inner,t,null==n?null:n.zpp_inner,i)},shapesInBody:function(e,t,n){for(var i=null==n?new R_:n,r=e.get_shapes().iterator();r.hasNext();){var a=r.next();this.shapesInShape(a,!1,t,i)}return i},bodiesInBody:function(e,t,n){for(var i=null==n?new z_:n,r=e.get_shapes().iterator();r.hasNext();){var a=r.next();this.bodiesInShape(a,!1,t,i)}return i},convexCast:function(e,t,n,i){return null==n&&(n=!1),this.zpp_inner.convexCast(e.zpp_inner,t,i,n)},convexMultiCast:function(e,t,n,i,r){return null==n&&(n=!1),this.zpp_inner.convexMultiCast(e.zpp_inner,t,i,n,r)},rayCast:function(e,t,n){return null==t&&(t=!1),this.zpp_inner.rayCast(e,t,n)},rayMultiCast:function(e,t,n,i){return null==t&&(t=!1),this.zpp_inner.rayMultiCast(e,t,n,i)},__class__:V_,__properties__:{get_elapsedTime:"get_elapsedTime",get_timeStamp:"get_timeStamp",get_listeners:"get_listeners",get_arbiters:"get_arbiters",get_world:"get_world",get_liveConstraints:"get_liveConstraints",get_constraints:"get_constraints",get_liveBodies:"get_liveBodies",get_bodies:"get_bodies",get_compounds:"get_compounds",set_worldLinearDrag:"set_worldLinearDrag",get_worldLinearDrag:"get_worldLinearDrag",set_worldAngularDrag:"set_worldAngularDrag",get_worldAngularDrag:"get_worldAngularDrag",set_sortContacts:"set_sortContacts",get_sortContacts:"get_sortContacts",get_broadphase:"get_broadphase",set_gravity:"set_gravity",get_gravity:"get_gravity",get_userData:"get_userData"}};var q_=function(){};(n["nape.util.Debug"]=q_).__name__=["nape","util","Debug"],q_.version=function(){return"Nape 2.0.19"},q_.clearObjectPools=function(){for(;null!=Ao.zpp_pool;){var e=Ao.zpp_pool.zpp_next;Ao.zpp_pool.zpp_next=null,Ao.zpp_pool=e}for(;null!=I_.zpp_pool;){var t=I_.zpp_pool.zpp_next;I_.zpp_pool.zpp_next=null,I_.zpp_pool=t}for(;null!=x_.zpp_pool;){var n=x_.zpp_pool.zpp_next;x_.zpp_pool.zpp_next=null,x_.zpp_pool=n}for(;null!=S_.zpp_pool;){var i=S_.zpp_pool.zpp_next;S_.zpp_pool.zpp_next=null,S_.zpp_pool=i}for(;null!=zo.zpp_pool;){var r=zo.zpp_pool.zpp_next;zo.zpp_pool.zpp_next=null,zo.zpp_pool=r}for(;null!=mo.zpp_pool;){var a=mo.zpp_pool.zpp_next;mo.zpp_pool.zpp_next=null,mo.zpp_pool=a}for(;null!=e_.zpp_pool;){var s=e_.zpp_pool.zpp_next;e_.zpp_pool.zpp_next=null,e_.zpp_pool=s}for(;null!=r_.zpp_pool;){var l=r_.zpp_pool.zpp_next;r_.zpp_pool.zpp_next=null,r_.zpp_pool=l}for(;null!=m_.zpp_pool;){var o=m_.zpp_pool.zpp_next;m_.zpp_pool.zpp_next=null,m_.zpp_pool=o}for(;null!=h_.zpp_pool;){var _=h_.zpp_pool.zpp_next;h_.zpp_pool.zpp_next=null,h_.zpp_pool=_}for(;null!=F_.zpp_pool;){var p=F_.zpp_pool.zpp_next;F_.zpp_pool.zpp_next=null,F_.zpp_pool=p}for(;null!=B_.zpp_pool;){var u=B_.zpp_pool.zpp_next;B_.zpp_pool.zpp_next=null,B_.zpp_pool=u}for(;null!=Wo.zpp_pool;){var h=Wo.zpp_pool.zpp_next;Wo.zpp_pool.zpp_next=null,Wo.zpp_pool=h}for(;null!=Go.zpp_pool;){var c=Go.zpp_pool.zpp_next;Go.zpp_pool.zpp_next=null,Go.zpp_pool=c}for(;null!=Jo.zpp_pool;){var d=Jo.zpp_pool.zpp_next;Jo.zpp_pool.zpp_next=null,Jo.zpp_pool=d}for(;null!=uh.zpp_pool;){var m=uh.zpp_pool.next;uh.zpp_pool.next=null,uh.zpp_pool=m}for(;null!=hh.zpp_pool;){var f=hh.zpp_pool.next;hh.zpp_pool.next=null,hh.zpp_pool=f}for(;null!=Qi.zpp_pool;){var g=Qi.zpp_pool.next;Qi.zpp_pool.next=null,Qi.zpp_pool=g}for(;null!=ch.zpp_pool;){var v=ch.zpp_pool.next;ch.zpp_pool.next=null,ch.zpp_pool=v}for(;null!=fu.zpp_pool;){var b=fu.zpp_pool.next;fu.zpp_pool.next=null,fu.zpp_pool=b}for(;null!=dh.zpp_pool;){var y=dh.zpp_pool.next;dh.zpp_pool.next=null,dh.zpp_pool=y}for(;null!=mh.zpp_pool;){var x=mh.zpp_pool.next;mh.zpp_pool.next=null,mh.zpp_pool=x}for(;null!=fh.zpp_pool;){var z=fh.zpp_pool.next;fh.zpp_pool.next=null,fh.zpp_pool=z}for(;null!=K_.zpp_pool;){var w=K_.zpp_pool.next;K_.zpp_pool.next=null,K_.zpp_pool=w}for(;null!=gh.zpp_pool;){var k=gh.zpp_pool.next;gh.zpp_pool.next=null,gh.zpp_pool=k}for(;null!=vh.zpp_pool;){var S=vh.zpp_pool.next;vh.zpp_pool.next=null,vh.zpp_pool=S}for(;null!=bh.zpp_pool;){var C=bh.zpp_pool.next;bh.zpp_pool.next=null,bh.zpp_pool=C}for(;null!=yh.zpp_pool;){var N=yh.zpp_pool.next;yh.zpp_pool.next=null,yh.zpp_pool=N}for(;null!=xh.zpp_pool;){var P=xh.zpp_pool.next;xh.zpp_pool.next=null,xh.zpp_pool=P}for(;null!=zh.zpp_pool;){var M=zh.zpp_pool.next;zh.zpp_pool.next=null,zh.zpp_pool=M}for(;null!=pc.zpp_pool;){var I=pc.zpp_pool.next;pc.zpp_pool.next=null,pc.zpp_pool=I}for(;null!=J_.zpp_pool;){var A=J_.zpp_pool.next;J_.zpp_pool.next=null,J_.zpp_pool=A}for(;null!=wh.zpp_pool;){var T=wh.zpp_pool.next;wh.zpp_pool.next=null,wh.zpp_pool=T}for(;null!=Y_.zpp_pool;){var D=Y_.zpp_pool.next;Y_.zpp_pool.next=null,Y_.zpp_pool=D}for(;null!=Rp.zpp_pool;){var E=Rp.zpp_pool.next;Rp.zpp_pool.next=null,Rp.zpp_pool=E}for(;null!=Zp.zpp_pool;){var O=Zp.zpp_pool.next;Zp.zpp_pool.next=null,Zp.zpp_pool=O}for(;null!=uc.zpp_pool;){var B=uc.zpp_pool.next;uc.zpp_pool.next=null,uc.zpp_pool=B}for(;null!=Wp.zpp_pool;){var L=Wp.zpp_pool.next;Wp.zpp_pool.next=null,Wp.zpp_pool=L}for(;null!=Bp.zpp_pool;){var j=Bp.zpp_pool.next;Bp.zpp_pool.next=null,Bp.zpp_pool=j}for(;null!=Lp.zpp_pool;){var F=Lp.zpp_pool.next;Lp.zpp_pool.next=null,Lp.zpp_pool=F}for(;null!=kh.zpp_pool;){var R=kh.zpp_pool.next;kh.zpp_pool.next=null,kh.zpp_pool=R}for(;null!=Sh.zpp_pool;){var G=Sh.zpp_pool.next;Sh.zpp_pool.next=null,Sh.zpp_pool=G}for(;null!=pu.zpp_pool;){var Z=pu.zpp_pool.next;pu.zpp_pool.next=null,pu.zpp_pool=Z}for(;null!=Ch.zpp_pool;){var U=Ch.zpp_pool.next;Ch.zpp_pool.next=null,Ch.zpp_pool=U}for(;null!=Yp.zpp_pool;){var V=Yp.zpp_pool.next;Yp.zpp_pool.next=null,Yp.zpp_pool=V}for(;null!=hc.zpp_pool;){var q=hc.zpp_pool.next;hc.zpp_pool.next=null,hc.zpp_pool=q}for(;null!=Jp.zpp_pool;){var W=Jp.zpp_pool.next;Jp.zpp_pool.next=null,Jp.zpp_pool=W}for(;null!=Nh.zpp_pool;){var X=Nh.zpp_pool.next;Nh.zpp_pool.next=null,Nh.zpp_pool=X}for(;null!=ou.zpp_pool;){var H=ou.zpp_pool.next;ou.zpp_pool.next=null,ou.zpp_pool=H}for(;null!=cc.zpp_pool;){var Y=cc.zpp_pool.next;cc.zpp_pool.next=null,cc.zpp_pool=Y}for(;null!=Ph.zpp_pool;){var J=Ph.zpp_pool.next;Ph.zpp_pool.next=null,Ph.zpp_pool=J}for(;null!=iu.zpp_pool;){var K=iu.zpp_pool.next;iu.zpp_pool.next=null,iu.zpp_pool=K}for(;null!=ru.zpp_pool;){var Q=ru.zpp_pool.next;ru.zpp_pool.next=null,ru.zpp_pool=Q}for(;null!=Mh.zpp_pool;){var $=Mh.zpp_pool.next;Mh.zpp_pool.next=null,Mh.zpp_pool=$}for(;null!=Ap.zpp_pool;){var ee=Ap.zpp_pool.next;Ap.zpp_pool.next=null,Ap.zpp_pool=ee}for(;null!=su.zpp_pool;){var te=su.zpp_pool.next;su.zpp_pool.next=null,su.zpp_pool=te}for(;null!=dc.zpp_pool;){var ne=dc.zpp_pool.next;dc.zpp_pool.next=null,dc.zpp_pool=ne}for(;null!=Qp.zpp_pool;){var ie=Qp.zpp_pool.next;Qp.zpp_pool.next=null,Qp.zpp_pool=ie}for(;null!=$p.zpp_pool;){var re=$p.zpp_pool.next;$p.zpp_pool.next=null,$p.zpp_pool=re}for(;null!=mc.zpp_pool;){var ae=mc.zpp_pool.next;mc.zpp_pool.next=null,mc.zpp_pool=ae}for(;null!=Up.zpp_pool;){var se=Up.zpp_pool.next;Up.zpp_pool.next=null,Up.zpp_pool=se}for(;null!=Vp.zpp_pool;){var le=Vp.zpp_pool.next;Vp.zpp_pool.next=null,Vp.zpp_pool=le}for(;null!=fc.zpp_pool;){var oe=fc.zpp_pool.next;fc.zpp_pool.next=null,fc.zpp_pool=oe}for(;null!=eu.zpp_pool;){var _e=eu.zpp_pool.next;eu.zpp_pool.next=null,eu.zpp_pool=_e}for(;null!=Bu.zpp_pool;){var pe=Bu.zpp_pool.next;Bu.zpp_pool.next=null,Bu.zpp_pool=pe}for(;null!=Ih.zpp_pool;){var ue=Ih.zpp_pool.next;Ih.zpp_pool.next=null,Ih.zpp_pool=ue}for(;null!=Ah.zpp_pool;){var he=Ah.zpp_pool.next;Ah.zpp_pool.next=null,Ah.zpp_pool=he}for(;null!=Th.zpp_pool;){var ce=Th.zpp_pool.next;Th.zpp_pool.next=null,Th.zpp_pool=ce}for(;null!=bu.zpp_pool;){var de=bu.zpp_pool.next;bu.zpp_pool.next=null,bu.zpp_pool=de}for(;null!=Dh.zpp_pool;){var me=Dh.zpp_pool.next;Dh.zpp_pool.next=null,Dh.zpp_pool=me}for(;null!=Eh.zpp_pool;){var fe=Eh.zpp_pool.next;Eh.zpp_pool.next=null,Eh.zpp_pool=fe}for(;null!=Au.zpp_pool;){var ge=Au.zpp_pool.next;Au.zpp_pool.next=null,Au.zpp_pool=ge}for(;null!=zu.zpp_pool;){var ve=zu.zpp_pool.next;zu.zpp_pool.next=null,zu.zpp_pool=ve}for(;null!=wu.zpp_pool;){var be=wu.zpp_pool.next;wu.zpp_pool.next=null,wu.zpp_pool=be}for(;null!=Np.zpp_pool;){var ye=Np.zpp_pool.next;Np.zpp_pool.next=null,Np.zpp_pool=ye}for(;null!=Oh.zpp_pool;){var xe=Oh.zpp_pool.next;Oh.zpp_pool.next=null,Oh.zpp_pool=xe}for(;null!=Bh.zpp_pool;){var ze=Bh.zpp_pool.next;Bh.zpp_pool.next=null,Bh.zpp_pool=ze}for(;null!=Cu.zpp_pool;){var we=Cu.zpp_pool.next;Cu.zpp_pool.next=null,Cu.zpp_pool=we}for(;null!=Nu.zpp_pool;){var ke=Nu.zpp_pool.next;Nu.zpp_pool.next=null,Nu.zpp_pool=ke}for(;null!=Pu.zpp_pool;){var Se=Pu.zpp_pool.next;Pu.zpp_pool.next=null,Pu.zpp_pool=Se}for(;null!=gc.zpp_pool;){var Ce=gc.zpp_pool.next;gc.zpp_pool.next=null,gc.zpp_pool=Ce}for(;null!=Lh.zpp_pool;){var Ne=Lh.zpp_pool.next;Lh.zpp_pool.next=null,Lh.zpp_pool=Ne}for(;null!=jh.zpp_pool;){var Pe=jh.zpp_pool.next;jh.zpp_pool.next=null,jh.zpp_pool=Pe}for(;null!=xi.zpp_pool;){var Me=xi.zpp_pool.next;xi.zpp_pool.next=null,xi.zpp_pool=Me}for(;null!=Fh.zpp_pool;){var Ie=Fh.zpp_pool.next;Fh.zpp_pool.next=null,Fh.zpp_pool=Ie}for(;null!=Rh.zpp_pool;){var Ae=Rh.zpp_pool.next;Rh.zpp_pool.next=null,Rh.zpp_pool=Ae}for(;null!=Gh.zpp_pool;){var Te=Gh.zpp_pool.next;Gh.zpp_pool.next=null,Gh.zpp_pool=Te}for(;null!=kp.zpp_pool;){var De=kp.zpp_pool.next;kp.zpp_pool.next=null,kp.zpp_pool=De}for(;null!=Sp.zpp_pool;){var Ee=Sp.zpp_pool.next;Sp.zpp_pool.next=null,Sp.zpp_pool=Ee}for(;null!=Zh.zpp_pool;){var Oe=Zh.zpp_pool.next;Zh.zpp_pool.next=null,Zh.zpp_pool=Oe}for(;null!=Cp.zpp_pool;){var Be=Cp.zpp_pool.next;Cp.zpp_pool.next=null,Cp.zpp_pool=Be}for(;null!=Uh.zpp_pool;){var Le=Uh.zpp_pool.next;Uh.zpp_pool.next=null,Uh.zpp_pool=Le}for(;null!=Vh.zpp_pool;){var je=Vh.zpp_pool.next;Vh.zpp_pool.next=null,Vh.zpp_pool=je}for(;null!=qh.zpp_pool;){var Fe=qh.zpp_pool.next;qh.zpp_pool.next=null,qh.zpp_pool=Fe}for(;null!=_c.poolGeomPoly;){var Re=_c.poolGeomPoly.zpp_pool;_c.poolGeomPoly.zpp_pool=null,_c.poolGeomPoly=Re}for(;null!=_c.poolVec2;){var Ge=_c.poolVec2.zpp_pool;_c.poolVec2.zpp_pool=null,_c.poolVec2=Ge}for(;null!=_c.poolVec3;){var Ze=_c.poolVec3.zpp_pool;_c.poolVec3.zpp_pool=null,_c.poolVec3=Ze}};var W_=function(){};(n["pixi.core.renderers.webgl.filters.CurrentState"]=W_).__name__=["pixi","core","renderers","webgl","filters","CurrentState"],W_.prototype={destinationFrame:null,filters:null,renderTarget:null,resolution:null,sourceFrame:null,target:null,__class__:W_};var X_=function(){};(n["zpp_nape.ZPP_Const"]=X_).__name__=["zpp_nape","ZPP_Const"],X_.POSINF=function(){return 1/0},X_.NEGINF=function(){return-1/0};var H_=function(){};(n["zpp_nape.ZPP_ID"]=H_).__name__=["zpp_nape","ZPP_ID"],H_.Constraint=function(){return H_._Constraint++},H_.Interactor=function(){return H_._Interactor++},H_.CbType=function(){return H_._CbType++},H_.CbSet=function(){return H_._CbSet++},H_.Listener=function(){return H_._Listener++},H_.ZPP_SimpleVert=function(){return H_._ZPP_SimpleVert++},H_.ZPP_SimpleSeg=function(){return H_._ZPP_SimpleSeg++},H_.Space=function(){return H_._Space++},H_.InteractionGroup=function(){return H_._InteractionGroup++};var Y_=function(){this.constraint=null,this.body=null,this.pre_swapped=!1,this.pre_arbiter=null,this.wrap_arbiters=null,this.set=null,this.int2=null,this.int1=null,this.length=0,this.prev=null,this.next=null,this.index=0,this.space=null,this.listener=null,this.event=0,this.outer_int=null,this.outer_con=null,this.outer_body=null,this.length=0};(n["zpp_nape.callbacks.ZPP_Callback"]=Y_).__name__=["zpp_nape","callbacks","ZPP_Callback"],Y_.prototype={outer_body:null,outer_con:null,outer_int:null,wrapper_body:function(){return null==this.outer_body&&(this.outer_body=new _o,this.outer_body.zpp_inner=this),this.outer_body},wrapper_con:function(){return null==this.outer_con&&(this.outer_con=new go,this.outer_con.zpp_inner=this),this.outer_con},wrapper_int:function(){return null==this.outer_int&&(this.outer_int=new bo,this.outer_int.zpp_inner=this),this.genarbs(),this.outer_int},event:null,listener:null,space:null,index:null,next:null,prev:null,length:null,push:function(e){null!=this.prev?this.prev.next=e:this.next=e,e.prev=this.prev,e.next=null,this.prev=e,this.length++},push_rev:function(e){null!=this.next?this.next.prev=e:this.prev=e,e.next=this.next,e.prev=null,this.next=e,this.length++},pop:function(){var e=this.next;return this.next=e.next,null==this.next?this.prev=null:this.next.prev=null,this.length--,e},pop_rev:function(){var e=this.prev;return this.prev=e.prev,null==this.prev?this.next=null:this.prev.next=null,this.length--,e},empty:function(){return null==this.next},clear:function(){for(;!this.empty();)this.pop()},splice:function(e){var t=e.next;return null==e.prev?(this.next=e.next,null!=this.next?this.next.prev=null:this.prev=null):(e.prev.next=e.next,null!=e.next?e.next.prev=e.prev:this.prev=e.prev),this.length--,t},rotateL:function(){this.push(this.pop())},rotateR:function(){this.push_rev(this.pop_rev())},cycleNext:function(e){return null==e.next?this.next:e.next},cyclePrev:function(e){return null==e.prev?this.prev:e.prev},at:function(e){for(var t=this.next;0!=e--;)t=t.next;return t},rev_at:function(e){for(var t=this.prev;0!=e--;)t=t.prev;return t},free:function(){this.int1=this.int2=null,this.body=null,this.constraint=null,(this.listener=null)!=this.wrap_arbiters&&(this.wrap_arbiters.zpp_inner.inner=null),this.set=null},alloc:function(){},int1:null,int2:null,set:null,wrap_arbiters:null,pre_arbiter:null,pre_swapped:null,genarbs:function(){null==this.wrap_arbiters?this.wrap_arbiters=sc.get(this.set.arbiters,!0):this.wrap_arbiters.zpp_inner.inner=this.set.arbiters,this.wrap_arbiters.zpp_inner.zip_length=!0,this.wrap_arbiters.zpp_inner.at_ite=null},body:null,constraint:null,__class__:Y_};var J_=function(){this.wrap_constraints=null,this.constraints=null,this.wrap_interactors=null,this.interactors=null,this.zip_conlisteners=!1,this.conlisteners=null,this.zip_bodylisteners=!1,this.bodylisteners=null,this.zip_listeners=!1,this.listeners=null,this.cbpairs=null,this.manager=null,this.id=0,this.next=null,this.count=0,this.cbTypes=null,this.cbTypes=new _p,this.listeners=new Q_,this.zip_listeners=!0,this.bodylisteners=new $_,this.zip_bodylisteners=!0,this.conlisteners=new ep,this.zip_conlisteners=!0,this.constraints=new tp,this.interactors=new np,this.id=H_.CbSet(),this.cbpairs=new Uu};(n["zpp_nape.callbacks.ZPP_CbSet"]=J_).__name__=["zpp_nape","callbacks","ZPP_CbSet"],J_.setlt=function(e,t){for(var n=e.cbTypes.begin(),i=t.cbTypes.begin();null!=n&&null!=i;){var r=n.elem(),a=i.elem();if(rp.setlt(r,a))return!0;if(rp.setlt(a,r))return!1;n=n.next,i=i.next}return null!=i&&null==n},J_.get=function(e){var t;null==J_.zpp_pool?t=new J_:(t=J_.zpp_pool,J_.zpp_pool=t.next,t.next=null),t.alloc();for(var n=null,i=e.begin();null!=i;){var r=i.elem();n=t.cbTypes.insert(n,r),r.cbsets.add(t),i=i.next}return t},J_.compatible=function(e,t,n){return!(!e.options1.compatible(t.cbTypes)||!e.options2.compatible(n.cbTypes))||!!e.options2.compatible(t.cbTypes)&&e.options1.compatible(n.cbTypes)},J_.empty_intersection=function(e,t){return e.manager.pair(e,t).empty_intersection()},J_.single_intersection=function(e,t,n){return e.manager.pair(e,t).single_intersection(n)},J_.find_all=function(e,t,n,i){e.manager.pair(e,t).forall(n,i)},J_.prototype={cbTypes:null,count:null,next:null,id:null,manager:null,cbpairs:null,increment:function(){this.count++},decrement:function(){return 0==--this.count},invalidate_pairs:function(){for(var e=this.cbpairs.begin();null!=e;)e.elem().invalidate(),e=e.next},listeners:null,zip_listeners:null,invalidate_listeners:function(){this.zip_listeners=!0,this.invalidate_pairs()},validate_listeners:function(){this.zip_listeners&&(this.zip_listeners=!1,this.realvalidate_listeners())},realvalidate_listeners:function(){this.listeners.clear();for(var e=this.cbTypes.begin();null!=e;){for(var t=e.elem(),n=null,i=this.listeners.begin(),r=t.listeners.begin();null!=r;){var a=r.elem();null!=i&&i.elem()==a?(r=r.next,i=(n=i).next):null==i||sp.setlt(a,i.elem())?(this.manager.valid_listener(a)&&(n=this.listeners.inlined_insert(n,a)),r=r.next):i=(n=i).next}e=e.next}},bodylisteners:null,zip_bodylisteners:null,invalidate_bodylisteners:function(){this.zip_bodylisteners=!0},validate_bodylisteners:function(){this.zip_bodylisteners&&(this.zip_bodylisteners=!1,this.realvalidate_bodylisteners())},realvalidate_bodylisteners:function(){this.bodylisteners.clear();for(var e=this.cbTypes.begin();null!=e;){for(var t=e.elem(),n=null,i=this.bodylisteners.begin(),r=t.bodylisteners.begin();null!=r;){var a=r.elem();null!=i&&i.elem()==a?(r=r.next,i=(n=i).next):null==i||sp.setlt(a,i.elem())?(!a.options.excluded(this.cbTypes)&&this.manager.valid_listener(a)&&(n=this.bodylisteners.inlined_insert(n,a)),r=r.next):i=(n=i).next}e=e.next}},conlisteners:null,zip_conlisteners:null,invalidate_conlisteners:function(){this.zip_conlisteners=!0},validate_conlisteners:function(){this.zip_conlisteners&&(this.zip_conlisteners=!1,this.realvalidate_conlisteners())},realvalidate_conlisteners:function(){this.conlisteners.clear();for(var e=this.cbTypes.begin();null!=e;){for(var t=e.elem(),n=null,i=this.conlisteners.begin(),r=t.conlisteners.begin();null!=r;){var a=r.elem();null!=i&&i.elem()==a?(r=r.next,i=(n=i).next):null==i||sp.setlt(a,i.elem())?(!a.options.excluded(this.cbTypes)&&this.manager.valid_listener(a)&&(n=this.conlisteners.inlined_insert(n,a)),r=r.next):i=(n=i).next}e=e.next}},validate:function(){this.validate_listeners(),this.validate_bodylisteners(),this.validate_conlisteners()},interactors:null,wrap_interactors:null,constraints:null,wrap_constraints:null,addConstraint:function(e){this.constraints.add(e)},addInteractor:function(e){this.interactors.add(e)},remConstraint:function(e){this.constraints.remove(e)},remInteractor:function(e){this.interactors.remove(e)},free:function(){for(this.listeners.clear(),this.zip_listeners=!0,this.bodylisteners.clear(),this.zip_bodylisteners=!0,this.conlisteners.clear(),this.zip_conlisteners=!0;!this.cbTypes.empty();)this.cbTypes.pop_unsafe().cbsets.remove(this)},alloc:function(){},__class__:J_};var K_=function(){this.listeners=null,this.zip_listeners=!1,this.next=null,this.b=null,this.a=null,this.listeners=new Q_};(n["zpp_nape.callbacks.ZPP_CbSetPair"]=K_).__name__=["zpp_nape","callbacks","ZPP_CbSetPair"],K_.get=function(e,t){var n;return null==K_.zpp_pool?n=new K_:(n=K_.zpp_pool,K_.zpp_pool=n.next,n.next=null),n.alloc(),J_.setlt(e,t)?(n.a=e,n.b=t):(n.a=t,n.b=e),n},K_.setlt=function(e,t){return!!J_.setlt(e.a,t.a)||e.a==t.a&&J_.setlt(e.b,t.b)},K_.prototype={a:null,b:null,next:null,free:function(){this.a=this.b=null,this.listeners.clear()},alloc:function(){this.zip_listeners=!0},compatible:function(e){return!(!e.options1.compatible(this.a.cbTypes)||!e.options2.compatible(this.b.cbTypes))||!!e.options2.compatible(this.a.cbTypes)&&e.options1.compatible(this.b.cbTypes)},zip_listeners:null,listeners:null,invalidate:function(){this.zip_listeners=!0},validate:function(){this.zip_listeners&&(this.zip_listeners=!1,this.__validate())},__validate:function(){this.listeners.clear();for(var e=this.a.listeners.begin(),t=this.b.listeners.begin();null!=e&&null!=t;){var n=e.elem(),i=t.elem();n==i?(this.compatible(n)&&this.listeners.add(n),e=e.next,t=t.next):sp.setlt(n,i)?e=e.next:t=t.next}},empty_intersection:function(){return this.listeners.empty()},single_intersection:function(e){var t=this.listeners.begin();return null!=t&&t.elem()==e&&null==t.next},forall:function(e,t){for(var n=this.listeners.begin();null!=n;){var i=n.elem();i.event==e&&t(i),n=n.next}},__class__:K_};var Q_=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_InteractionListener"]=Q_).__name__=["zpp_nape","util","ZNPList_ZPP_InteractionListener"],Q_.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==gh.zpp_pool?t=new gh:(t=gh.zpp_pool,gh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==gh.zpp_pool?n=new gh:(n=gh.zpp_pool,gh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=gh.zpp_pool,gh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=gh.zpp_pool,gh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Q_};var $_=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_BodyListener"]=$_).__name__=["zpp_nape","util","ZNPList_ZPP_BodyListener"],$_.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==yh.zpp_pool?t=new yh:(t=yh.zpp_pool,yh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==yh.zpp_pool?n=new yh:(n=yh.zpp_pool,yh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=yh.zpp_pool,yh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=yh.zpp_pool,yh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:$_};var ep=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_ConstraintListener"]=ep).__name__=["zpp_nape","util","ZNPList_ZPP_ConstraintListener"],ep.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==zh.zpp_pool?t=new zh:(t=zh.zpp_pool,zh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==zh.zpp_pool?n=new zh:(n=zh.zpp_pool,zh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=zh.zpp_pool,zh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=zh.zpp_pool,zh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ep};var tp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Constraint"]=tp).__name__=["zpp_nape","util","ZNPList_ZPP_Constraint"],tp.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==mh.zpp_pool?t=new mh:(t=mh.zpp_pool,mh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==mh.zpp_pool?n=new mh:(n=mh.zpp_pool,mh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=mh.zpp_pool,mh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=mh.zpp_pool,mh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:tp};var np=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Interactor"]=np).__name__=["zpp_nape","util","ZNPList_ZPP_Interactor"],np.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==bh.zpp_pool?t=new bh:(t=bh.zpp_pool,bh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==bh.zpp_pool?n=new bh:(n=bh.zpp_pool,bh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=bh.zpp_pool,bh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=bh.zpp_pool,bh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:np};var ip=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CbSet"]=ip).__name__=["zpp_nape","util","ZNPList_ZPP_CbSet"],ip.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==vh.zpp_pool?t=new vh:(t=vh.zpp_pool,vh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==vh.zpp_pool?n=new vh:(n=vh.zpp_pool,vh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=vh.zpp_pool,vh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=vh.zpp_pool,vh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ip};var rp=function(){this.conlisteners=null,this.bodylisteners=null,this.listeners=null,this.cbsets=null,this.id=0,this.userData=null,this.outer=null,this.id=H_.CbType(),this.listeners=new Q_,this.bodylisteners=new $_,this.conlisteners=new ep,this.constraints=new tp,this.interactors=new np,this.cbsets=new ip};(n["zpp_nape.callbacks.ZPP_CbType"]=rp).__name__=["zpp_nape","callbacks","ZPP_CbType"],rp.setlt=function(e,t){return e.id<t.id},rp.prototype={outer:null,userData:null,id:null,cbsets:null,interactors:null,wrap_interactors:null,constraints:null,wrap_constraints:null,addConstraint:function(e){this.constraints.add(e)},addInteractor:function(e){this.interactors.add(e)},remConstraint:function(e){this.constraints.remove(e)},remInteractor:function(e){this.interactors.remove(e)},listeners:null,addint:function(e){for(var t=null,n=this.listeners.begin();null!=n;){var i=n.elem();if(sp.setlt(e,i))break;n=(t=n).next}this.listeners.inlined_insert(t,e),this.invalidateint()},removeint:function(e){this.listeners.remove(e),this.invalidateint()},invalidateint:function(){for(var e=this.cbsets.begin();null!=e;)e.elem().invalidate_listeners(),e=e.next},bodylisteners:null,addbody:function(e){for(var t=null,n=this.bodylisteners.begin();null!=n;){var i=n.elem();if(sp.setlt(e,i))break;n=(t=n).next}this.bodylisteners.inlined_insert(t,e),this.invalidatebody()},removebody:function(e){this.bodylisteners.remove(e),this.invalidatebody()},invalidatebody:function(){for(var e=this.cbsets.begin();null!=e;)e.elem().invalidate_bodylisteners(),e=e.next},conlisteners:null,addconstraint:function(e){for(var t=null,n=this.conlisteners.begin();null!=n;){var i=n.elem();if(sp.setlt(e,i))break;n=(t=n).next}this.conlisteners.inlined_insert(t,e),this.invalidateconstraint()},removeconstraint:function(e){this.conlisteners.remove(e),this.invalidateconstraint()},invalidateconstraint:function(){for(var e=this.cbsets.begin();null!=e;)e.elem().invalidate_conlisteners(),e=e.next},__class__:rp};var ap=function(){};(n["zpp_nape.util.ZPP_Flags"]=ap).__name__=["zpp_nape","util","ZPP_Flags"];var sp=function(){this.space=null,this.interaction=null,this.constraint=null,this.body=null,this.precedence=0,this.event=0,this.type=0,this.id=0,this.outer=null,this.id=H_.Listener()};(n["zpp_nape.callbacks.ZPP_Listener"]=sp).__name__=["zpp_nape","callbacks","ZPP_Listener"],sp.setlt=function(e,t){return!(e.precedence<=t.precedence)||e.precedence==t.precedence&&e.id>t.id},sp.prototype={outer:null,id:null,type:null,event:null,precedence:null,body:null,constraint:null,interaction:null,space:null,swapEvent:function(e){},invalidate_precedence:function(){},addedToSpace:function(){},removedFromSpace:function(){},__class__:sp};var lp=function(e,t,n){this.handler=null,this.options=null,this.outer_zn=null,sp.call(this),this.event=t,this.handler=n,(this.body=this).type=0,this.options=e.zpp_inner};(n["zpp_nape.callbacks.ZPP_BodyListener"]=lp).__name__=["zpp_nape","callbacks","ZPP_BodyListener"],lp.__super__=sp,lp.prototype=r(sp.prototype,{outer_zn:null,options:null,handler:null,addedToSpace:function(){this.options.handler=yc(this,this.cbtype_change);for(var e=this.options.includes.begin();null!=e;)e.elem().addbody(this),e=e.next},removedFromSpace:function(){for(var e=this.options.includes.begin();null!=e;)e.elem().removebody(this),e=e.next;this.options.handler=null},cbtype_change:function(e,t,n){this.removedFromSpace(),this.options.effect_change(e,t,n),this.addedToSpace()},invalidate_precedence:function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},swapEvent:function(e){this.removedFromSpace(),this.event=e,this.addedToSpace()},__class__:lp});var op=function(e,t,n){this.handler=null,this.options=null,this.outer_zn=null,sp.call(this),this.event=t,this.handler=n,(this.constraint=this).type=1,this.options=e.zpp_inner};(n["zpp_nape.callbacks.ZPP_ConstraintListener"]=op).__name__=["zpp_nape","callbacks","ZPP_ConstraintListener"],op.__super__=sp,op.prototype=r(sp.prototype,{outer_zn:null,options:null,handler:null,addedToSpace:function(){this.options.handler=yc(this,this.cbtype_change);for(var e=this.options.includes.begin();null!=e;)e.elem().addconstraint(this),e=e.next},removedFromSpace:function(){for(var e=this.options.includes.begin();null!=e;)e.elem().removeconstraint(this),e=e.next;this.options.handler=null},cbtype_change:function(e,t,n){this.removedFromSpace(),this.options.effect_change(e,t,n),this.addedToSpace()},invalidate_precedence:function(){null!=this.space&&(this.removedFromSpace(),this.addedToSpace())},swapEvent:function(e){this.removedFromSpace(),this.event=e,this.addedToSpace()},__class__:op});var _p=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CbType"]=_p).__name__=["zpp_nape","util","ZNPList_ZPP_CbType"],_p.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==uh.zpp_pool?t=new uh:(t=uh.zpp_pool,uh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==uh.zpp_pool?n=new uh:(n=uh.zpp_pool,uh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=uh.zpp_pool,uh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=uh.zpp_pool,uh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:_p};var pp=function(e,t,n,i){this.handlerp=null,this.pure=!1,this.allowSleepingCallbacks=!1,this.handleri=null,this.options2=null,this.options1=null,this.itype=0,this.outer_znp=null,this.outer_zni=null,sp.call(this),this.type=i,(this.interaction=this).event=n,this.options1=e.zpp_inner,this.options2=t.zpp_inner,this.allowSleepingCallbacks=!1};(n["zpp_nape.callbacks.ZPP_InteractionListener"]=pp).__name__=["zpp_nape","callbacks","ZPP_InteractionListener"],pp.__super__=sp,pp.prototype=r(sp.prototype,{outer_zni:null,outer_znp:null,itype:null,options1:null,options2:null,handleri:null,allowSleepingCallbacks:null,pure:null,handlerp:null,setInteractionType:function(e){this.itype=e},wake:function(){this.with_union((function(e){for(var t=e.interactors.begin();null!=t;)t.elem().wake(),t=t.next}))},CbSetset:function(e,t,n){for(var i=pp.UCbSet,r=pp.VCbSet,a=pp.WCbSet,s=e.begin(),l=t.begin();null!=s&&null!=l;){var o=s.elem(),_=l.elem();o==_?(a.inlined_add(o),s=s.next,l=l.next):J_.setlt(o,_)?(i.inlined_add(o),s=s.next):(r.inlined_add(_),l=l.next)}for(;null!=s;)i.inlined_add(s.elem()),s=s.next;for(;null!=l;)r.inlined_add(l.elem()),l=l.next;for(;!i.empty();)for(var p=i.pop_unsafe(),u=t.begin();null!=u;)n(p,u.elem()),u=u.next;for(;!r.empty();)for(var h=r.pop_unsafe(),c=a.begin();null!=c;)n(h,c.elem()),c=c.next;for(;!a.empty();){var d=a.pop_unsafe();n(d,d);for(var m=a.begin();null!=m;)n(d,m.elem()),m=m.next}},CbTypeset:function(e,t,n){for(var i=pp.UCbType,r=pp.VCbType,a=pp.WCbType,s=e.begin(),l=t.begin();null!=s&&null!=l;){var o=s.elem(),_=l.elem();o==_?(a.inlined_add(o),s=s.next,l=l.next):rp.setlt(o,_)?(i.inlined_add(o),s=s.next):(r.inlined_add(_),l=l.next)}for(;null!=s;)i.inlined_add(s.elem()),s=s.next;for(;null!=l;)r.inlined_add(l.elem()),l=l.next;for(;!i.empty();)for(var p=i.pop_unsafe(),u=t.begin();null!=u;)n(p,u.elem()),u=u.next;for(;!r.empty();)for(var h=r.pop_unsafe(),c=a.begin();null!=c;)n(h,c.elem()),c=c.next;for(;!a.empty();){var d=a.pop_unsafe();n(d,d);for(var m=a.begin();null!=m;)n(d,m.elem()),m=m.next}},with_uniquesets:function(e){var t,n=this;null==uc.zpp_pool?t=new uc:(t=uc.zpp_pool,uc.zpp_pool=t.next,t.next=null),t.alloc(),t.lt=K_.setlt,this.CbTypeset(this.options1.includes,this.options2.includes,(function(e,i){n.CbSetset(e.cbsets,i.cbsets,(function(e,i){if(e.validate(),i.validate(),J_.single_intersection(e,i,n)){var r=K_.get(e,i);t.try_insert(r)}}))})),t.clear_with((function(t){e?n.space.freshListenerType(t.a,t.b):n.space.nullListenerType(t.a,t.b);var i=t;i.free(),i.next=K_.zpp_pool,K_.zpp_pool=i}));var i=t;i.free(),i.next=uc.zpp_pool,uc.zpp_pool=i},with_union:function(e){for(var t=this.options1.includes.begin(),n=this.options2.includes.begin();null!=t&&null!=n;){var i=t.elem(),r=n.elem();i==r?(e(i),t=t.next,n=n.next):rp.setlt(i,r)?(e(i),t=t.next):(e(r),n=n.next)}for(;null!=t;)e(t.elem()),t=t.next;for(;null!=n;)e(n.elem()),n=n.next},addedToSpace:function(){var e=this,t=3==this.type;this.with_union((function(n){if(n.addint(e),t)for(var i=n.interactors.begin();null!=i;)i.elem().wake(),i=i.next})),this.options1.handler=yc(this,this.cbtype_change1),this.options2.handler=yc(this,this.cbtype_change2),this.with_uniquesets(!0)},removedFromSpace:function(){var e=this;this.with_uniquesets(!1);var t=3==this.type;this.with_union((function(n){if(n.removeint(e),t)for(var i=n.interactors.begin();null!=i;)i.elem().wake(),i=i.next})),this.options1.handler=null,this.options2.handler=null},invalidate_precedence:function(){var e=this;if(null!=this.space){var t=3==this.type;this.with_union((function(n){if(n.removeint(e),n.addint(e),t)for(var i=n.interactors.begin();null!=i;)i.elem().wake(),i=i.next}))}},cbtype_change1:function(e,t,n){this.cbtype_change(this.options1,e,t,n)},cbtype_change2:function(e,t,n){this.cbtype_change(this.options2,e,t,n)},cbtype_change:function(e,t,n,i){this.space.revoke_listener(this),this.removedFromSpace(),e.effect_change(t,n,i),this.addedToSpace(),this.space.unrevoke_listener(this)},swapEvent:function(e){this.removedFromSpace(),this.event=e,this.addedToSpace()},__class__:pp});var up=function(){this.wrap_excludes=null,this.wrap_includes=null,this.excludes=null,this.includes=null,this.handler=null,this.outer=null,this.includes=new _p,this.excludes=new _p};(n["zpp_nape.callbacks.ZPP_OptionType"]=up).__name__=["zpp_nape","callbacks","ZPP_OptionType"],up.argument=function(e){return null==e?new So:p.is(e,So)?e:(new So).including(e)},up.prototype={outer:null,handler:null,includes:null,excludes:null,wrap_includes:null,wrap_excludes:null,setup_includes:function(){this.wrap_includes=Qh.get(this.includes,!0)},setup_excludes:function(){this.wrap_excludes=Qh.get(this.excludes,!0)},excluded:function(e){return this.nonemptyintersection(e,this.excludes)},included:function(e){return this.nonemptyintersection(e,this.includes)},compatible:function(e){return!!this.included(e)&&!this.excluded(e)},nonemptyintersection:function(e,t){for(var n=!1,i=e.begin(),r=t.begin();null!=r&&null!=i;){var a=r.elem(),s=i.elem();if(a==s){n=!0;break}rp.setlt(a,s)?r=r.next:i=i.next}return n},effect_change:function(e,t,n){if(t)if(n){for(var i=null,r=this.includes.begin();null!=r;){var a=r.elem();if(rp.setlt(e,a))break;r=(i=r).next}this.includes.inlined_insert(i,e)}else this.includes.remove(e);else if(n){for(var s=null,l=this.excludes.begin();null!=l;){var o=l.elem();if(rp.setlt(e,o))break;l=(s=l).next}this.excludes.inlined_insert(s,e)}else this.excludes.remove(e)},append_type:function(e,t){e==this.includes?this.includes.has(t)||(this.excludes.has(t)?null!=this.handler?this.handler(t,!1,!1):this.effect_change(t,!1,!1):null!=this.handler?this.handler(t,!0,!0):this.effect_change(t,!0,!0)):this.excludes.has(t)||(this.includes.has(t)?null!=this.handler?this.handler(t,!0,!1):this.effect_change(t,!0,!1):null!=this.handler?this.handler(t,!1,!0):this.effect_change(t,!1,!0))},set:function(e){if(e!=this){for(;!this.includes.empty();)this.append_type(this.excludes,this.includes.front());for(;!this.excludes.empty();)this.append_type(this.includes,this.excludes.front());for(var t=e.excludes.begin();null!=t;){var n=t.elem();this.append_type(this.excludes,n),t=t.next}for(var i=e.includes.begin();null!=i;){var r=i.elem();this.append_type(this.includes,r),i=i.next}}return this},append:function(e,t){if(p.is(t,co)){var n=t;this.append_type(e,n.zpp_inner)}else if(p.is(t,fo))for(var i=t.iterator();i.hasNext();){var r=i.next();this.append_type(e,r.zpp_inner)}else if(t instanceof Array&&null==t.__enum__)for(var a=t,s=0;s<a.length;){var l=a[s];++s;var o=l;this.append_type(e,o.zpp_inner)}},__class__:up};var hp=function(){this.pre_dt=0,this.wrap_cbTypes=null,this.cbSet=null,this.cbTypes=null,this.__velocity=!1,this.ignore=!1,this.component=null,this.removeOnBreak=!1,this.breakUnderError=!1,this.breakUnderForce=!1,this.maxError=0,this.maxForce=0,this.damping=0,this.frequency=0,this.stiff=!1,this.active=!1,this.space=null,this.compound=null,this.userData=null,this.id=0,this.outer=null,this.__velocity=!1,this.id=H_.Constraint(),this.stiff=!0,this.active=!0,this.ignore=!1,this.frequency=10,this.damping=1,this.maxForce=X_.POSINF(),this.maxError=X_.POSINF(),this.breakUnderForce=!1,this.removeOnBreak=!0,this.pre_dt=-1,this.cbTypes=new _p};(n["zpp_nape.constraint.ZPP_Constraint"]=hp).__name__=["zpp_nape","constraint","ZPP_Constraint"],hp.prototype={outer:null,clear:function(){},id:null,userData:null,compound:null,space:null,active:null,stiff:null,frequency:null,damping:null,maxForce:null,maxError:null,breakUnderForce:null,breakUnderError:null,removeOnBreak:null,component:null,ignore:null,__velocity:null,immutable_midstep:function(e){},cbTypes:null,cbSet:null,wrap_cbTypes:null,setupcbTypes:function(){this.wrap_cbTypes=Qh.get(this.cbTypes),this.wrap_cbTypes.zpp_inner.adder=yc(this,this.wrap_cbTypes_adder),this.wrap_cbTypes.zpp_inner.subber=yc(this,this.wrap_cbTypes_subber),this.wrap_cbTypes.zpp_inner.dontremove=!0},wrap_cbTypes_subber:function(e){var t=e.zpp_inner;this.cbTypes.has(t)&&(null!=this.space&&(this.dealloc_cbSet(),t.remConstraint(this)),this.cbTypes.remove(t),null!=this.space&&(this.alloc_cbSet(),this.wake()))},wrap_cbTypes_adder:function(e){return this.insert_cbtype(e.zpp_inner),!1},insert_cbtype:function(e){if(!this.cbTypes.has(e)){null!=this.space&&(this.dealloc_cbSet(),e.addConstraint(this));for(var t=null,n=this.cbTypes.begin();null!=n;){var i=n.elem();if(rp.setlt(e,i))break;n=(t=n).next}this.cbTypes.inlined_insert(t,e),null!=this.space&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){null!=(this.cbSet=this.space.cbsets.get(this.cbTypes))&&(this.cbSet.increment(),this.cbSet.addConstraint(this))},dealloc_cbSet:function(){if(null!=this.cbSet){if(this.cbSet.remConstraint(this),this.cbSet.decrement()){this.space.cbsets.remove(this.cbSet);var e=this.cbSet;e.free(),e.next=J_.zpp_pool,J_.zpp_pool=e}this.cbSet=null}},activate:function(){null!=this.space&&this.activeInSpace()},deactivate:function(){null!=this.space&&this.inactiveOrOutSpace()},addedToSpace:function(){this.active&&this.activeInSpace(),this.activeBodies();for(var e=this.cbTypes.begin();null!=e;)e.elem().addConstraint(this),e=e.next},removedFromSpace:function(){this.active&&this.inactiveOrOutSpace(),this.inactiveBodies();for(var e=this.cbTypes.begin();null!=e;)e.elem().remConstraint(this),e=e.next},activeInSpace:function(){this.alloc_cbSet(),null==Nu.zpp_pool?this.component=new Nu:(this.component=Nu.zpp_pool,Nu.zpp_pool=this.component.next,this.component.next=null),this.component.alloc(),this.component.isBody=!1,this.component.constraint=this},inactiveOrOutSpace:function(){this.dealloc_cbSet();var e=this.component;e.free(),e.next=Nu.zpp_pool,Nu.zpp_pool=e,this.component=null},activeBodies:function(){},inactiveBodies:function(){},clearcache:function(){},validate:function(){},wake_connected:function(){},forest:function(){},pair_exists:function(e,t){return!1},broken:function(){},warmStart:function(){},pre_dt:null,preStep:function(e){return!1},applyImpulseVel:function(){return!1},applyImpulsePos:function(){return!1},wake:function(){null!=this.space&&this.space.wake_constraint(this)},draw:function(e){},copy:function(e,t){return null},copyto:function(e){for(var t=this.outer,n=t.get_cbTypes().iterator();n.hasNext();){var i=n.next();e.get_cbTypes().add(i)}e.set_removeOnBreak(t.get_removeOnBreak()),e.set_breakUnderError(t.get_breakUnderError()),e.set_breakUnderForce(t.get_breakUnderForce()),e.set_maxError(t.get_maxError()),e.set_maxForce(t.get_maxForce()),e.set_damping(t.get_damping()),e.set_frequency(t.get_frequency()),e.set_stiff(t.get_stiff()),e.set_ignore(t.get_ignore()),e.set_active(t.get_active())},__class__:hp};var cp=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.b2=null,this.b1=null,this.scale=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.ratio=0,this.outer_zn=null,hp.call(this),this.ratio=1,this.jAcc=0,this.slack=!1,this.jMax=X_.POSINF(),this.stepped=!1};(n["zpp_nape.constraint.ZPP_AngleJoint"]=cp).__name__=["zpp_nape","constraint","ZPP_AngleJoint"],cp.__super__=hp,cp.prototype=r(hp.prototype,{outer_zn:null,ratio:null,jointMin:null,jointMax:null,slack:null,equal:null,scale:null,is_slack:function(){var e,t=this.ratio*this.b2.rot-this.b1.rot;return this.equal?(t-=this.jointMax,e=!1,this.scale=1):e=t<this.jointMin?(t=this.jointMin-t,!(this.scale=-1)):t>this.jointMax?(t-=this.jointMax,!(this.scale=1)):!(t=this.scale=0),e},bodyImpulse:function(e){return this.stepped?e==this.b1?g_.get(0,0,-this.scale*this.jAcc):g_.get(0,0,this.ratio*this.scale*this.jAcc):g_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,b2:null,kMass:null,jAcc:null,jMax:null,gamma:null,bias:null,stepped:null,copy:function(e,t){var n=new Io(null,null,this.jointMin,this.jointMax,this.ratio);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(dp.todo(this.b1.id,(function(e){n.zpp_inner_zn.b1=e.zpp_inner})))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(dp.todo(this.b2.id,(function(e){n.zpp_inner_zn.b2=e.zpp_inner})))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new $l("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new $l("Error: AngleJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new $l("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new $l("Error: AngleJoint must have jointMin <= jointMax");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new $l("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAcc=0,this.pre_dt=-1,this.slack=!1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.equal=this.jointMin==this.jointMax;var n=this.ratio*this.b2.rot-this.b1.rot;this.equal?(n-=this.jointMax,this.slack=!1,this.scale=1):n<this.jointMin?(n=this.jointMin-n,this.scale=-1,this.slack=!1):n>this.jointMax?(n-=this.jointMax,this.scale=1,this.slack=!1):(n=this.scale=0,this.slack=!0);var i=n;if(!this.slack){if(this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&i*i>this.maxError*this.maxError)return!0;var r,a=2*Math.PI*this.frequency;this.gamma=1/(e*a*(2*this.damping+a*e));var s=1/(1+this.gamma);r=e*a*a*this.gamma,this.gamma*=s,this.kMass*=s,this.bias=-i*r,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=t,this.jMax=this.maxForce*e}return!1},warmStart:function(){this.slack||(this.b1.angvel-=this.scale*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*this.jAcc)},applyImpulseVel:function(){if(this.slack)return!1;var e=this.scale*(this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel),t=this.kMass*(this.bias-e)-this.jAcc*this.gamma,n=this.jAcc;return this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),!(!this.breakUnderForce||!(this.jAcc>this.jMax||this.jAcc<-this.jMax))||(this.stiff||(this.jAcc>this.jMax?this.jAcc=this.jMax:this.jAcc<-this.jMax&&(this.jAcc=-this.jMax)),t=this.jAcc-n,this.b1.angvel-=this.scale*this.b1.iinertia*t,this.b2.angvel+=this.ratio*this.scale*this.b2.iinertia*t,!1)},applyImpulsePos:function(){var e,t,n,i=this.ratio*this.b2.rot-this.b1.rot;if(this.equal?(i-=this.jointMax,n=!1,this.scale=1):n=i<this.jointMin?(i=this.jointMin-i,!(this.scale=-1)):i>this.jointMax?(i-=this.jointMax,!(this.scale=1)):!(i=this.scale=0),e=i,!n){if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;t=-(e*=.5)*this.kMass,(this.equal||t<0)&&(this.b1.delta_rot(-this.scale*t*this.b1.iinertia),this.b2.delta_rot(this.ratio*this.scale*t*this.b2.iinertia))}return!1},draw:function(e){},__class__:cp});var dp=function(){this.cb=null,this.bc=null,this.id=0};(n["zpp_nape.constraint.ZPP_CopyHelper"]=dp).__name__=["zpp_nape","constraint","ZPP_CopyHelper"],dp.dict=function(e,t){var n=new dp;return n.id=e,n.bc=t,n},dp.todo=function(e,t){var n=new dp;return n.id=e,n.cb=t,n},dp.prototype={id:null,bc:null,cb:null,__class__:dp};var mp=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.cx2=0,this.cx1=0,this.ny=0,this.nx=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.outer_zn=null,hp.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.jAcc=0,this.jMax=X_.POSINF(),this.stepped=!1,this.cx1=this.cx2=0};(n["zpp_nape.constraint.ZPP_DistanceJoint"]=mp).__name__=["zpp_nape","constraint","ZPP_DistanceJoint"],mp.__super__=hp,mp.prototype=r(hp.prototype,{outer_zn:null,jointMin:null,jointMax:null,slack:null,equal:null,is_slack:function(){var e;this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var t=0,n=0,i=(t=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx))*t+(n=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely))*n;if(i<lo.epsilon)e=!(i=n=t=0);else{var r=1/(i=oc.sqrt(i));t*=r,n*=r,e=this.equal?(i-=this.jointMax,!1):i<this.jointMin?(i=this.jointMin-i,t=-t,n=-n,!1):i>this.jointMax?(i-=this.jointMax,!1):!(i=n=t=0)}return e},nx:null,ny:null,cx1:null,cx2:null,bodyImpulse:function(e){return this.stepped?e==this.b1?g_.get(-this.jAcc*this.nx,-this.jAcc*this.ny,-this.cx1*this.jAcc):g_.get(this.jAcc*this.nx,this.jAcc*this.ny,this.cx2*this.jAcc):g_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=d_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=yc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=yc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=d_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=yc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=yc(this,this.invalidate_a2)},wrap_a2:null,kMass:null,jAcc:null,jMax:null,gamma:null,bias:null,stepped:null,copy:function(e,t){var n=new Do(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.jointMin,this.jointMax);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(dp.todo(this.b1.id,(function(e){n.zpp_inner_zn.b1=e.zpp_inner})))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(dp.todo(this.b2.id,(function(e){n.zpp_inner_zn.b2=e.zpp_inner})))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new $l("Error: DistanceJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new $l("Error: DistanceJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new $l("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new $l("Error: DistanceJoint must have jointMin <= jointMax");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new $l("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.equal=this.jointMin==this.jointMax,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.nx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.ny=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely);var n=this.nx*this.nx+this.ny*this.ny;if(n<lo.epsilon)this.nx=0,n=this.ny=0,this.slack=!0;else{var i=1/(n=oc.sqrt(n));this.nx*=i,this.ny*=i,this.equal?(n-=this.jointMax,this.slack=!1):n<this.jointMin?(n=this.jointMin-n,this.nx=-this.nx,this.ny=-this.ny,this.slack=!1):n>this.jointMax?(n-=this.jointMax,this.slack=!1):(this.nx=0,n=this.ny=0,this.slack=!0)}var r=n;if(!this.slack){if(this.cx1=this.ny*this.a1relx-this.nx*this.a1rely,this.cx2=this.ny*this.a2relx-this.nx*this.a2rely,this.kMass=this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&r*r>this.maxError*this.maxError)return!0;var a,s=2*Math.PI*this.frequency;this.gamma=1/(e*s*(2*this.damping+s*e));var l=1/(1+this.gamma);a=e*s*s*this.gamma,this.gamma*=l,this.kMass*=l,this.bias=-r*a,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=t,this.jMax=this.maxForce*e}return!1},warmStart:function(){if(!this.slack){var e=this.b1.imass*this.jAcc;this.b1.velx-=this.nx*e,this.b1.vely-=this.ny*e;var t=this.b2.imass*this.jAcc;this.b2.velx+=this.nx*t,this.b2.vely+=this.ny*t,this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var e=this.nx*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.ny*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1,t=this.kMass*(this.bias-e)-this.jAcc*this.gamma,n=this.jAcc;if(this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),this.breakUnderForce&&this.jAcc<-this.jMax)return!0;this.stiff||this.jAcc<-this.jMax&&(this.jAcc=-this.jMax),t=this.jAcc-n;var i=this.b1.imass*t;this.b1.velx-=this.nx*i,this.b1.vely-=this.ny*i;var r=this.b2.imass*t;return this.b2.velx+=this.nx*r,this.b2.vely+=this.ny*r,this.b1.angvel-=this.cx1*this.b1.iinertia*t,this.b2.angvel+=this.cx2*this.b2.iinertia*t,!1},applyImpulsePos:function(){var e,t,n,i,r,a,s;n=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,a=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var l=0,o=0,_=(l=this.b2.posx+r-(this.b1.posx+n))*l+(o=this.b2.posy+a-(this.b1.posy+i))*o;if(_<lo.epsilon)s=!(_=o=l=0);else{var p=1/(_=oc.sqrt(_));l*=p,o*=p,s=this.equal?(_-=this.jointMax,!1):_<this.jointMin?(_=this.jointMin-_,l=-l,o=-o,!1):_>this.jointMax?(_-=this.jointMax,!1):!(_=o=l=0)}if(e=_,!s){if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;if(e*e<lo.constraintLinearSlop*lo.constraintLinearSlop)return!1;if(6<(e*=.5)*e){var u=this.b1.smass+this.b2.smass;if(lo.epsilon<u&&(t=-e*(u=.75/u),this.equal||t<0)){var h=t*this.b1.imass;this.b1.posx-=l*h,this.b1.posy-=o*h;var c=t*this.b2.imass;this.b2.posx+=l*c,this.b2.posy+=o*c;var d=(l=this.b2.posx+r-(this.b1.posx+n))*l+(o=this.b2.posy+a-(this.b1.posy+i))*o;if(d<lo.epsilon)s=!(d=o=l=0);else{var m=1/(d=oc.sqrt(d));l*=m,o*=m,s=this.equal?(d-=this.jointMax,!1):d<this.jointMin?(d=this.jointMin-d,l=-l,o=-o,!1):d>this.jointMax?(d-=this.jointMax,!1):!(d=o=l=0)}e=d,e*=.5}}var f,g;f=o*n-l*i,g=o*r-l*a;var v=this.b1.smass+this.b2.smass+f*f*this.b1.sinertia+g*g*this.b2.sinertia;if(0!=v&&(v=1/v),t=-e*v,this.equal||t<0){var b=this.b1.imass*t;this.b1.posx-=l*b,this.b1.posy-=o*b;var y=this.b2.imass*t;this.b2.posx+=l*y,this.b2.posy+=o*y,this.b1.delta_rot(-f*this.b1.iinertia*t),this.b2.delta_rot(g*this.b2.iinertia*t)}}return!1},draw:function(e){},__class__:mp});var fp=function(){this.biasy=0,this.biasx=0,this.jAccy=0,this.jAccx=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_n=null,this.nrely=0,this.nrelx=0,this.nlocaly=0,this.nlocalx=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.cx2=0,this.cx1=0,this.dot2=0,this.dot1=0,this.equal=!1,this.jointMax=0,this.jointMin=0,this.scale=0,this.outer_zn=null,hp.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.nlocalx=0,this.nlocaly=0,this.nrelx=0,this.nrely=0,this.jAccx=0,this.jAccy=0,this.jMax=X_.POSINF(),this.jointMin=X_.NEGINF(),this.jointMax=X_.POSINF(),this.stepped=!1};(n["zpp_nape.constraint.ZPP_LineJoint"]=fp).__name__=["zpp_nape","constraint","ZPP_LineJoint"],fp.__super__=hp,fp.prototype=r(hp.prototype,{outer_zn:null,scale:null,jointMin:null,jointMax:null,equal:null,dot1:null,dot2:null,cx1:null,cx2:null,bodyImpulse:function(e){if(this.stepped){var t=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,n=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy;return e==this.b1?g_.get(-t,-n,this.scale*this.cx1*n-this.dot1*t):g_.get(t,n,this.scale*this.cx1*n-this.dot1*t)}return g_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=d_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=yc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=yc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=d_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=yc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=yc(this,this.invalidate_a2)},wrap_a2:null,zip_n:null,nlocalx:null,nlocaly:null,nrelx:null,nrely:null,validate_n:function(){this.wrap_n.zpp_inner.x=this.nlocalx,this.wrap_n.zpp_inner.y=this.nlocaly},invalidate_n:function(e){this.immutable_midstep("Constraint::n"),this.nlocalx=e.x,this.nlocaly=e.y,this.zip_n=!0,this.wake()},setup_n:function(){this.wrap_n=d_.get(this.nlocalx,this.nlocaly),this.wrap_n.zpp_inner._inuse=!0,this.wrap_n.zpp_inner._validate=yc(this,this.validate_n),this.wrap_n.zpp_inner._invalidate=yc(this,this.invalidate_n)},wrap_n:null,validate_norm:function(){if(this.zip_n){this.zip_n=!1;var e=this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly,t=1/Math.sqrt(e);this.nlocalx*=t,this.nlocaly*=t}},kMassa:null,kMassb:null,kMassc:null,jAccx:null,jAccy:null,jMax:null,gamma:null,biasx:null,biasy:null,stepped:null,copy:function(e,t){var n=new Eo(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_direction(),this.jointMin,this.jointMax);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(dp.todo(this.b1.id,(function(e){n.zpp_inner_zn.b1=e.zpp_inner})))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(dp.todo(this.b2.id,(function(e){n.zpp_inner_zn.b2=e.zpp_inner})))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new $l("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new $l("Error: DistanceJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new $l("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new $l("Error: DistanceJoint must have jointMin <= jointMax");if(this.nlocalx*this.nlocalx+this.nlocaly*this.nlocaly<lo.epsilon)throw new $l("Error: DistanceJoint direction must be non-degenerate");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new $l("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAccx=0,this.jAccy=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.equal=this.jointMin==this.jointMax,this.stepped=!0,this.validate_norm(),this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.nrelx=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,this.nrely=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var n,i,r,a,s,l=0;n=this.b2.posx+this.a2relx-this.b1.posx-this.a1relx,r=(i=this.b2.posy+this.a2rely-this.b1.posy-this.a1rely)*this.nrelx-n*this.nrely,l=this.nrelx*n+this.nrely*i,this.equal?(l-=this.jointMin,this.scale=1):l>this.jointMax?(l-=this.jointMax,this.scale=1):l<this.jointMin?(l=this.jointMin-l,this.scale=-1):(l=0,this.scale=0),a=n+this.a1relx,s=i+this.a1rely,this.dot1=this.nrelx*a+this.nrely*s,this.cx1=s*this.nrelx-a*this.nrely,this.dot2=this.nrelx*this.a2relx+this.nrely*this.a2rely,this.cx2=this.a2rely*this.nrelx-this.a2relx*this.nrely,this.kMassa=this.b1.smass+this.b2.smass+this.dot1*this.dot1*this.b1.sinertia+this.dot2*this.dot2*this.b2.sinertia,this.kMassb=-this.scale*(this.dot1*this.cx1*this.b1.sinertia+this.dot2*this.cx2*this.b2.sinertia),this.kMassc=this.scale*this.scale*(this.b1.smass+this.b2.smass+this.cx1*this.cx1*this.b1.sinertia+this.cx2*this.cx2*this.b2.sinertia);var o,_=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(_!=_)this.kMassa=this.kMassb=this.kMassc=0,o=3;else if(0==_){var p=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,p|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,p|=2),this.kMassb=0,o=p}else{_=1/_;var u=this.kMassc*_;this.kMassc=this.kMassa*_,this.kMassa=u,this.kMassb*=-_,o=0}if(0!=(1&o)&&(this.jAccx=0),0!=(2&o)&&(this.jAccy=0),this.stiff)this.gamma=0,this.biasx=0,this.biasy=0;else{if(this.breakUnderError&&r*r+l*l>this.maxError*this.maxError)return!0;var h,c=2*Math.PI*this.frequency;this.gamma=1/(e*c*(2*this.damping+c*e));var d=1/(1+this.gamma);h=e*c*c*this.gamma,this.gamma*=d;var m=d;this.kMassa*=m,this.kMassb*=m,this.kMassc*=m,this.biasx=r,this.biasy=l;var f=-h;this.biasx*=f,this.biasy*=f;var g=this.maxError,v=this.biasx*this.biasx+this.biasy*this.biasy;if(g*g<v){var b=g*oc.invsqrt(v);this.biasx*=b,this.biasy*=b}}var y=t;return this.jAccx*=y,this.jAccy*=y,this.jMax=this.maxForce*e,!1},warmStart:function(){var e=this.scale*this.nrelx*this.jAccy-this.nrely*this.jAccx,t=this.nrelx*this.jAccx+this.scale*this.nrely*this.jAccy,n=this.b1.imass;this.b1.velx-=e*n,this.b1.vely-=t*n;var i=this.b2.imass;this.b2.velx+=e*i,this.b2.vely+=t*i,this.b1.angvel+=(this.scale*this.cx1*this.jAccy-this.dot1*this.jAccx)*this.b1.iinertia,this.b2.angvel+=(this.dot2*this.jAccx-this.scale*this.cx2*this.jAccy)*this.b2.iinertia},applyImpulseVel:function(){var e,t,n=0,i=0;n=this.b2.velx-this.b1.velx,i=this.b2.vely-this.b1.vely,n+=this.b2.kinvelx-this.b1.kinvelx,e=(i+=this.b2.kinvely-this.b1.kinvely)*this.nrelx-n*this.nrely+(this.b2.angvel+this.b2.kinangvel)*this.dot2-(this.b1.angvel+this.b1.kinangvel)*this.dot1,t=this.scale*(this.nrelx*n+this.nrely*i-(this.b2.angvel+this.b2.kinangvel)*this.cx2+(this.b1.angvel+this.b1.kinangvel)*this.cx1);var r=0,a=0;r=this.biasx-e,a=this.biasy-t;var s=this.kMassa*r+this.kMassb*a;a=this.kMassb*r+this.kMassc*a,r=s;var l,o,_=this.gamma;if(r-=this.jAccx*_,a-=this.jAccy*_,l=this.jAccx,o=this.jAccy,this.jAccx+=1*r,this.jAccy+=1*a,0<this.jAccy&&(this.jAccy=0),this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else if(!this.stiff){var p=this.jMax,u=this.jAccx*this.jAccx+this.jAccy*this.jAccy;if(p*p<u){var h=p*oc.invsqrt(u);this.jAccx*=h,this.jAccy*=h}}r=this.jAccx-l,a=this.jAccy-o;var c=this.scale*this.nrelx*a-this.nrely*r,d=this.nrelx*r+this.scale*this.nrely*a,m=this.b1.imass;this.b1.velx-=c*m,this.b1.vely-=d*m;var f=this.b2.imass;return this.b2.velx+=c*f,this.b2.vely+=d*f,this.b1.angvel+=(this.scale*this.cx1*a-this.dot1*r)*this.b1.iinertia,this.b2.angvel+=(this.dot2*r-this.scale*this.cx2*a)*this.b2.iinertia,!1},applyImpulsePos:function(){var e,t,n,i,r,a;e=this.b1.axisy*this.nlocalx-this.b1.axisx*this.nlocaly,t=this.nlocalx*this.b1.axisx+this.nlocaly*this.b1.axisy,n=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,a=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var s,l=0,o=0,_=0,p=0;if(l=this.b2.posx+r-this.b1.posx-n,_=(o=this.b2.posy+a-this.b1.posy-i)*e-l*t,p=e*l+t*o,s=this.equal?(p-=this.jointMin,1):p>this.jointMax?(p-=this.jointMax,1):p<this.jointMin?(p=this.jointMin-p,-1):p=0,this.breakUnderError&&_*_+p*p>this.maxError*this.maxError)return!0;if(_*_+p*p<lo.constraintLinearSlop*lo.constraintLinearSlop)return!1;var u,h,c,d,m,f,g,v,b,y=0,x=0;if(6<(_*=.5)*_+(p*=.5)*p){var z=this.b1.smass+this.b2.smass;if(lo.epsilon<z){var w=(z=.8/z)*(t*_-s*e*p),k=z*(e*_*s-t*_),S=this.b1.imass;this.b1.posx-=w*S,this.b1.posy-=k*S;var C=this.b2.imass;this.b2.posx+=w*C,this.b2.posy+=k*C,l=this.b2.posx+r-this.b1.posx-n,_=(o=this.b2.posy+a-this.b1.posy-i)*e-l*t,p=e*l+t*o,s=this.equal?(p-=this.jointMin,1):p>this.jointMax?(p-=this.jointMax,1):p<this.jointMin?(p=this.jointMin-p,-1):p=0,_*=.5,p*=.5}}u=e*(v=l+n)+t*(b=o+i),c=b*e-v*t,h=e*r+t*a,d=a*e-r*t,m=this.b1.smass+this.b2.smass+u*u*this.b1.sinertia+h*h*this.b2.sinertia,f=-s*(u*c*this.b1.sinertia+h*d*this.b2.sinertia),y=-_,x=-p;var N=m*(g=s*s*(this.b1.smass+this.b2.smass+c*c*this.b1.sinertia+d*d*this.b2.sinertia))-f*f;if(N!=N)y=x=0;else if(0==N)0!=m?y/=m:y=0,0!=g?x/=g:x=0;else{var P=(N=1/N)*(g*y-f*x);x=N*(m*x-f*y),y=P}0<x&&(x=0);var M=s*e*x-t*y,I=e*y+s*t*x,A=this.b1.imass;this.b1.posx-=M*A,this.b1.posy-=I*A;var T=this.b2.imass;return this.b2.posx+=M*T,this.b2.posy+=I*T,this.b1.delta_rot((s*c*x-u*y)*this.b1.iinertia),this.b2.delta_rot((h*y-s*d*x)*this.b2.iinertia),!1},draw:function(e){},__class__:fp});var gp=function(){this.stepped=!1,this.jMax=0,this.jAcc=0,this.kMass=0,this.b2=null,this.b1=null,this.rate=0,this.ratio=0,this.outer_zn=null,hp.call(this),this.jAcc=0,this.stepped=!1,this.__velocity=!0};(n["zpp_nape.constraint.ZPP_MotorJoint"]=gp).__name__=["zpp_nape","constraint","ZPP_MotorJoint"],gp.__super__=hp,gp.prototype=r(hp.prototype,{outer_zn:null,ratio:null,rate:null,bodyImpulse:function(e){return this.stepped?e==this.b1?g_.get(0,0,-this.jAcc):g_.get(0,0,this.ratio*this.jAcc):g_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,b2:null,kMass:null,jAcc:null,jMax:null,stepped:null,copy:function(e,t){var n=new Oo(null,null,this.rate,this.ratio);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(dp.todo(this.b1.id,(function(e){n.zpp_inner_zn.b1=e.zpp_inner})))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(dp.todo(this.b2.id,(function(e){n.zpp_inner_zn.b2=e.zpp_inner})))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new $l("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new $l("Error: MotorJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new $l("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new $l("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;return this.pre_dt=e,this.stepped=!0,this.kMass=this.b1.sinertia+this.ratio*this.ratio*this.b2.sinertia,this.kMass=1/this.kMass,this.jAcc*=t,this.jMax=this.maxForce*e,!1},warmStart:function(){this.b1.angvel-=this.b1.iinertia*this.jAcc,this.b2.angvel+=this.ratio*this.b2.iinertia*this.jAcc},applyImpulseVel:function(){var e=this.ratio*(this.b2.angvel+this.b2.kinangvel)-this.b1.angvel-this.b1.kinangvel-this.rate,t=-this.kMass*e,n=this.jAcc;if(this.jAcc+=t,this.breakUnderForce){if(this.jAcc>this.jMax||this.jAcc<-this.jMax)return!0}else this.jAcc<-this.jMax?this.jAcc=-this.jMax:this.jAcc>this.jMax&&(this.jAcc=this.jMax);return t=this.jAcc-n,this.b1.angvel-=this.b1.iinertia*t,this.b2.angvel+=this.ratio*this.b2.iinertia*t,!1},applyImpulsePos:function(){return!1},__class__:gp});var vp=function(){this.stepped=!1,this.biasy=0,this.biasx=0,this.gamma=0,this.jMax=0,this.jAccy=0,this.jAccx=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.outer_zn=null,hp.call(this),this.stepped=!1,this.jAccx=0,this.jAccy=0,this.jMax=X_.POSINF(),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0};(n["zpp_nape.constraint.ZPP_PivotJoint"]=vp).__name__=["zpp_nape","constraint","ZPP_PivotJoint"],vp.__super__=hp,vp.prototype=r(hp.prototype,{outer_zn:null,bodyImpulse:function(e){return this.stepped?e==this.b1?g_.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely)):g_.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely):g_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=d_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=yc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=yc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=d_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=yc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=yc(this,this.invalidate_a2)},wrap_a2:null,kMassa:null,kMassb:null,kMassc:null,jAccx:null,jAccy:null,jMax:null,gamma:null,biasx:null,biasy:null,stepped:null,copy:function(e,t){var n=new Bo(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(dp.todo(this.b1.id,(function(e){n.zpp_inner_zn.b1=e.zpp_inner})))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(dp.todo(this.b2.id,(function(e){n.zpp_inner_zn.b2=e.zpp_inner})))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new $l("Error: PivotJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new $l("Error: PivotJoint cannot be simulated with body1 == body2 (body1=body2="+this.b1.outer.toString()+")");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new $l("Error: Constraints must have each body within the same space to which the constraint has been assigned (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new $l("Error: Constraints cannot have both bodies non-dynamic (body1="+this.b1.outer.toString()+", body2="+this.b2.outer.toString()+")")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAccx=0,this.jAccy=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var n=this.b1.smass+this.b2.smass;if(this.kMassa=n,this.kMassb=0,this.kMassc=n,0!=this.b1.sinertia){var i=this.a1relx*this.b1.sinertia,r=this.a1rely*this.b1.sinertia;this.kMassa+=r*this.a1rely,this.kMassb+=-r*this.a1relx,this.kMassc+=i*this.a1relx}if(0!=this.b2.sinertia){var a=this.a2relx*this.b2.sinertia,s=this.a2rely*this.b2.sinertia;this.kMassa+=s*this.a2rely,this.kMassb+=-s*this.a2relx,this.kMassc+=a*this.a2relx}var l,o=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(o!=o)this.kMassa=this.kMassb=this.kMassc=0,l=3;else if(0==o){var _=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,_|=1),0!=this.kMassc?this.kMassc=1/this.kMassc:(this.kMassc=0,_|=2),this.kMassb=0,l=_}else{o=1/o;var p=this.kMassc*o;this.kMassc=this.kMassa*o,this.kMassa=p,this.kMassb*=-o,l=0}if(0!=(1&l)&&(this.jAccx=0),0!=(2&l)&&(this.jAccy=0),this.stiff)this.biasx=0,this.biasy=0,this.gamma=0;else{var u,h=2*Math.PI*this.frequency;this.gamma=1/(e*h*(2*this.damping+h*e));var c=1/(1+this.gamma);u=e*h*h*this.gamma,this.gamma*=c;var d=c;if(this.kMassa*=d,this.kMassb*=d,this.kMassc*=d,this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy>this.maxError*this.maxError)return!0;var m=-u;this.biasx*=m,this.biasy*=m;var f=this.maxError,g=this.biasx*this.biasx+this.biasy*this.biasy;if(f*f<g){var v=f*oc.invsqrt(g);this.biasx*=v,this.biasy*=v}}var b=t;return this.jAccx*=b,this.jAccy*=b,this.jMax=this.maxForce*e,!1},warmStart:function(){var e=this.b1.imass;this.b1.velx-=this.jAccx*e,this.b1.vely-=this.jAccy*e;var t=this.b2.imass;this.b2.velx+=this.jAccx*t,this.b2.vely+=this.jAccy*t,this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely)*this.b1.iinertia,this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely)*this.b2.iinertia},applyImpulseVel:function(){var e,t;e=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),t=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel));var n=0,i=0;n=this.biasx-e,i=this.biasy-t;var r=this.kMassa*n+this.kMassb*i;i=this.kMassb*n+this.kMassc*i,n=r;var a,s,l=this.gamma;if(n-=this.jAccx*l,i-=this.jAccy*l,a=this.jAccx,s=this.jAccy,this.jAccx+=1*n,this.jAccy+=1*i,this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy>this.jMax*this.jMax)return!0}else if(!this.stiff){var o=this.jMax,_=this.jAccx*this.jAccx+this.jAccy*this.jAccy;if(o*o<_){var p=o*oc.invsqrt(_);this.jAccx*=p,this.jAccy*=p}}n=this.jAccx-a,i=this.jAccy-s;var u=this.b1.imass;this.b1.velx-=n*u,this.b1.vely-=i*u;var h=this.b2.imass;return this.b2.velx+=n*h,this.b2.vely+=i*h,this.b1.angvel-=(i*this.a1relx-n*this.a1rely)*this.b1.iinertia,this.b2.angvel+=(i*this.a2relx-n*this.a2rely)*this.b2.iinertia,!1},applyImpulsePos:function(){var e,t,n,i;e=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,t=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,n=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,i=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var r=0,a=0;if(r=this.b2.posx+n-(this.b1.posx+e),a=this.b2.posy+i-(this.b1.posy+t),this.breakUnderError&&r*r+a*a>this.maxError*this.maxError)return!0;if(r*r+a*a<lo.constraintLinearSlop*lo.constraintLinearSlop)return!1;var s=0,l=0;if(6<(r*=.5)*r+(a*=.5)*a){var o=this.b1.smass+this.b2.smass;if(lo.epsilon<o){var _=(s=-r*(o=.75/o))*s+(l=-a*o)*l;if(400<_){var p=20*oc.invsqrt(_);s*=p,l*=p}var u=this.b1.imass;this.b1.posx-=s*u,this.b1.posy-=l*u;var h=this.b2.imass;this.b2.posx+=s*h,this.b2.posy+=l*h,r=this.b2.posx+n-(this.b1.posx+e),a=this.b2.posy+i-(this.b1.posy+t),r*=.5,a*=.5}}var c=0,d=0,m=0;if(m=c=this.b1.smass+this.b2.smass,(d=0)!=this.b1.sinertia){var f=e*this.b1.sinertia,g=t*this.b1.sinertia;c+=g*t,d+=-g*e,m+=f*e}if(0!=this.b2.sinertia){var v=n*this.b2.sinertia,b=i*this.b2.sinertia;c+=b*i,d+=-b*n,m+=v*n}var y=(s=-r)*s+(l=-a)*l;if(36<y){var x=6*oc.invsqrt(y);s*=x,l*=x}var z=c*m-d*d;if(z!=z)s=l=0;else if(0==z)0!=c?s/=c:s=0,0!=m?l/=m:l=0;else{var w=(z=1/z)*(m*s-d*l);l=z*(c*l-d*s),s=w}var k=this.b1.imass;this.b1.posx-=s*k,this.b1.posy-=l*k;var S=this.b2.imass;return this.b2.posx+=s*S,this.b2.posy+=l*S,this.b1.delta_rot(-(l*e-s*t)*this.b1.iinertia),this.b2.delta_rot((l*n-s*i)*this.b2.iinertia),!1},draw:function(e){},__class__:vp});var bp=function(){this.stepped=!1,this.bias=0,this.gamma=0,this.jMax=0,this.jAcc=0,this.kMass=0,this.wrap_a4=null,this.a4rely=0,this.a4relx=0,this.a4localy=0,this.a4localx=0,this.b4=null,this.wrap_a3=null,this.a3rely=0,this.a3relx=0,this.a3localy=0,this.a3localx=0,this.b3=null,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.cx4=0,this.cx3=0,this.cx2=0,this.cx1=0,this.n34y=0,this.n34x=0,this.n12y=0,this.n12x=0,this.equal=!1,this.slack=!1,this.jointMax=0,this.jointMin=0,this.ratio=1,this.outer_zn=null,hp.call(this),this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0,this.a3localx=0,this.a3localy=0,this.a3relx=0,this.a3rely=0,this.a4localx=0,this.a4localy=0,this.a4relx=0,this.a4rely=0,this.n12x=1,this.n12y=0,this.n34x=1,this.n34y=0,this.jAcc=0,this.jMax=X_.POSINF(),this.stepped=!1,this.cx1=this.cx2=this.cx3=this.cx4=0};(n["zpp_nape.constraint.ZPP_PulleyJoint"]=bp).__name__=["zpp_nape","constraint","ZPP_PulleyJoint"],bp.__super__=hp,bp.prototype=r(hp.prototype,{outer_zn:null,ratio:null,jointMin:null,jointMax:null,slack:null,equal:null,is_slack:function(){this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var e,t,n,i,r=0,a=0,s=0,l=0;e=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),t=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),n=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),i=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);var o=oc.sqrt(e*e+t*t),_=oc.sqrt(n*n+i*i);if(0!=o){var p=1/o;r=e*p,a=t*p}if(0!=_){var u=1/_;s=n*u,l=i*u;var h=this.ratio;s*=h,l*=h}else{var c=this.ratio/oc.sqrt(s*s+l*l);s*=c,l*=c}var d=o+this.ratio*_;return this.equal?(d-=this.jointMax,!1):d<this.jointMin?(d=this.jointMin-d,r=-r,a=-a,s=-s,l=-l,!1):d>this.jointMax?(d-=this.jointMax,!1):!(d=l=s=a=r=0)},n12x:null,n12y:null,n34x:null,n34y:null,cx1:null,cx2:null,cx3:null,cx4:null,bodyImpulse:function(e){if(this.stepped){var t=g_.get();if(e==this.b1){var n=t;n.set_x(n.get_x()-this.jAcc*this.n12x);var i=t;i.set_y(i.get_y()-this.jAcc*this.n12y);var r=t;r.set_z(r.get_z()-this.cx1*this.jAcc)}if(e==this.b2){var a=t;a.set_x(a.get_x()+this.jAcc*this.n12x);var s=t;s.set_y(s.get_y()+this.jAcc*this.n12y);var l=t;l.set_z(l.get_z()+this.cx2*this.jAcc)}if(e==this.b3){var o=t;o.set_x(o.get_x()-this.jAcc*this.n34x);var _=t;_.set_y(_.get_y()-this.jAcc*this.n34y);var p=t;p.set_z(p.get_z()-this.cx3*this.jAcc)}if(e==this.b4){var u=t;u.set_x(u.get_x()+this.jAcc*this.n34x);var h=t;h.set_y(h.get_y()+this.jAcc*this.n34y);var c=t;c.set_z(c.get_z()+this.cx4*this.jAcc)}return t}return g_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this),this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.add(this),this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this),this.b3!=this.b1&&this.b3!=this.b2&&null!=this.b3&&this.b3.constraints.remove(this),this.b4!=this.b1&&this.b4!=this.b2&&this.b4!=this.b3&&null!=this.b4&&this.b4.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=d_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=yc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=yc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=d_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=yc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=yc(this,this.invalidate_a2)},wrap_a2:null,b3:null,a3localx:null,a3localy:null,a3relx:null,a3rely:null,validate_a3:function(){this.wrap_a3.zpp_inner.x=this.a3localx,this.wrap_a3.zpp_inner.y=this.a3localy},invalidate_a3:function(e){this.immutable_midstep("Constraint::a3"),this.a3localx=e.x,this.a3localy=e.y,this.wake()},setup_a3:function(){this.wrap_a3=d_.get(this.a3localx,this.a3localy),this.wrap_a3.zpp_inner._inuse=!0,this.wrap_a3.zpp_inner._validate=yc(this,this.validate_a3),this.wrap_a3.zpp_inner._invalidate=yc(this,this.invalidate_a3)},wrap_a3:null,b4:null,a4localx:null,a4localy:null,a4relx:null,a4rely:null,validate_a4:function(){this.wrap_a4.zpp_inner.x=this.a4localx,this.wrap_a4.zpp_inner.y=this.a4localy},invalidate_a4:function(e){this.immutable_midstep("Constraint::a4"),this.a4localx=e.x,this.a4localy=e.y,this.wake()},setup_a4:function(){this.wrap_a4=d_.get(this.a4localx,this.a4localy),this.wrap_a4.zpp_inner._inuse=!0,this.wrap_a4.zpp_inner._validate=yc(this,this.validate_a4),this.wrap_a4.zpp_inner._invalidate=yc(this,this.invalidate_a4)},wrap_a4:null,kMass:null,jAcc:null,jMax:null,gamma:null,bias:null,stepped:null,copy:function(e,t){var n=new Lo(null,null,null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2(),this.outer_zn.get_anchor3(),this.outer_zn.get_anchor4(),this.jointMin,this.jointMax,this.ratio);if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(dp.todo(this.b1.id,(function(e){n.zpp_inner_zn.b1=e.zpp_inner})))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(dp.todo(this.b2.id,(function(e){n.zpp_inner_zn.b2=e.zpp_inner})))}if(null!=e&&null!=this.b3){for(var _=null,p=0;p<e.length;){var u=e[p];if(++p,u.id==this.b3.id){_=u.bc;break}}null!=_?n.zpp_inner_zn.b3=_.zpp_inner:t.push(dp.todo(this.b3.id,(function(e){n.zpp_inner_zn.b3=e.zpp_inner})))}if(null!=e&&null!=this.b4){for(var h=null,c=0;c<e.length;){var d=e[c];if(++c,d.id==this.b4.id){h=d.bc;break}}null!=h?n.zpp_inner_zn.b4=h.zpp_inner:t.push(dp.todo(this.b4.id,(function(e){n.zpp_inner_zn.b4=e.zpp_inner})))}return n},validate:function(){if(null==this.b1||null==this.b2||null==this.b3||null==this.b4)throw new $l("Error: PulleyJoint cannot be simulated with null bodies");if(this.b1==this.b2||this.b3==this.b4)throw new $l("Error: PulleyJoint cannot have body1==body2 or body3==body4");if(this.b1.space!=this.space||this.b2.space!=this.space||this.b3.space!=this.space||this.b4.space!=this.space)throw new $l("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(this.jointMin>this.jointMax)throw new $l("Error: PulleyJoint must have jointMin <= jointMax");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new $l("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic");if(!this.b3.isDynamic()&&!this.b4.isDynamic())throw new $l("Error: PulleyJoint cannot have both bodies in a linked pair non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake(),null!=this.b3&&this.b3.isDynamic()&&this.b3.wake(),null!=this.b4&&this.b4.isDynamic()&&this.b4.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}if(this.b3.isDynamic()){var y,x;if(this.b3.component==this.b3.component.parent)y=this.b3.component;else{for(var z=this.b3.component,w=null;z!=z.parent;){var k=z.parent;z.parent=w,w=z,z=k}for(;null!=w;){var S=w.parent;w.parent=z,w=S}y=z}if(this.component==this.component.parent)x=this.component;else{for(var C=this.component,N=null;C!=C.parent;){var P=C.parent;C.parent=N,N=C,C=P}for(;null!=N;){var M=N.parent;N.parent=C,N=M}x=C}y!=x&&(y.rank<x.rank?y.parent=x:y.rank>x.rank?x.parent=y:(x.parent=y).rank++)}if(this.b4.isDynamic()){var I,A;if(this.b4.component==this.b4.component.parent)I=this.b4.component;else{for(var T=this.b4.component,D=null;T!=T.parent;){var E=T.parent;T.parent=D,D=T,T=E}for(;null!=D;){var O=D.parent;D.parent=T,D=O}I=T}if(this.component==this.component.parent)A=this.component;else{for(var B=this.component,L=null;B!=B.parent;){var j=B.parent;B.parent=L,L=B,B=j}for(;null!=L;){var F=L.parent;L.parent=B,L=F}A=B}I!=A&&(I.rank<A.rank?I.parent=A:I.rank>A.rank?A.parent=I:(A.parent=I).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&(this.b2.id==t||this.b3.id==t||this.b4.id==t)||this.b2.id==e&&(this.b3.id==t||this.b4.id==t||this.b1.id==t)||this.b3.id==e&&(this.b4.id==t||this.b1.id==t||this.b2.id==t)||this.b4.id==e&&(this.b1.id==t||this.b2.id==t||this.b3.id==t)},clearcache:function(){this.jAcc=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t,n,i,r,a=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.equal=this.jointMin==this.jointMax,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,this.a3relx=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,this.a3rely=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,this.a4relx=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,this.a4rely=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy,t=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),n=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),i=this.b4.posx+this.a4relx-(this.b3.posx+this.a3relx),r=this.b4.posy+this.a4rely-(this.b3.posy+this.a3rely);var s=oc.sqrt(t*t+n*n),l=oc.sqrt(i*i+r*r);if(0!=s){var o=1/s;this.n12x=t*o,this.n12y=n*o}if(0!=l){var _=1/l;this.n34x=i*_,this.n34y=r*_;var p=this.ratio;this.n34x*=p,this.n34y*=p}else{var u=this.ratio/oc.sqrt(this.n34x*this.n34x+this.n34y*this.n34y);this.n34x*=u,this.n34y*=u}var h=s+this.ratio*l;this.equal?(h-=this.jointMax,this.slack=!1):h<this.jointMin?(h=this.jointMin-h,this.n12x=-this.n12x,this.n12y=-this.n12y,this.n34x=-this.n34x,this.n34y=-this.n34y,this.slack=!1):h>this.jointMax?(h-=this.jointMax,this.slack=!1):(this.n12x=0,this.n12y=0,this.n34x=0,h=this.n34y=0,this.slack=!0);var c=h;if(!this.slack){this.cx1=this.n12y*this.a1relx-this.n12x*this.a1rely,this.cx2=this.n12y*this.a2relx-this.n12x*this.a2rely,this.cx3=this.n34y*this.a3relx-this.n34x*this.a3rely,this.cx4=this.n34y*this.a4relx-this.n34x*this.a4rely;var d=this.ratio*this.ratio,m=this.b1.smass+this.b2.smass+d*(this.b3.smass+this.b4.smass)+this.b1.sinertia*this.cx1*this.cx1+this.b2.sinertia*this.cx2*this.cx2+this.b3.sinertia*this.cx3*this.cx3+this.b4.sinertia*this.cx4*this.cx4;if(this.b1==this.b4&&(m-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx4*this.b1.sinertia)),this.b1==this.b3&&(m+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b1.smass+this.cx1*this.cx3*this.b1.sinertia)),this.b2==this.b3&&(m-=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx3*this.b2.sinertia)),this.b2==this.b4&&(m+=2*((this.n12x*this.n34x+this.n12y*this.n34y)*this.b2.smass+this.cx2*this.cx4*this.b2.sinertia)),this.kMass=m,0!=this.kMass?this.kMass=1/this.kMass:this.jAcc=0,this.stiff)this.bias=0,this.gamma=0;else{if(this.breakUnderError&&c*c>this.maxError*this.maxError)return!0;var f,g=2*Math.PI*this.frequency;this.gamma=1/(e*g*(2*this.damping+g*e));var v=1/(1+this.gamma);f=e*g*g*this.gamma,this.gamma*=v,this.kMass*=v,this.bias=-c*f,this.bias<-this.maxError?this.bias=-this.maxError:this.bias>this.maxError&&(this.bias=this.maxError)}this.jAcc*=a,this.jMax=this.maxForce*e}return!1},warmStart:function(){if(!this.slack){var e=this.b1.imass*this.jAcc;this.b1.velx-=this.n12x*e,this.b1.vely-=this.n12y*e;var t=this.b2.imass*this.jAcc;this.b2.velx+=this.n12x*t,this.b2.vely+=this.n12y*t;var n=this.b3.imass*this.jAcc;this.b3.velx-=this.n34x*n,this.b3.vely-=this.n34y*n;var i=this.b4.imass*this.jAcc;this.b4.velx+=this.n34x*i,this.b4.vely+=this.n34y*i,this.b1.angvel-=this.cx1*this.b1.iinertia*this.jAcc,this.b2.angvel+=this.cx2*this.b2.iinertia*this.jAcc,this.b3.angvel-=this.cx3*this.b3.iinertia*this.jAcc,this.b4.angvel+=this.cx4*this.b4.iinertia*this.jAcc}},applyImpulseVel:function(){if(this.slack)return!1;var e=this.n12x*(this.b2.velx+this.b2.kinvelx-this.b1.velx-this.b1.kinvelx)+this.n12y*(this.b2.vely+this.b2.kinvely-this.b1.vely-this.b1.kinvely)+this.n34x*(this.b4.velx+this.b4.kinvelx-this.b3.velx-this.b3.kinvelx)+this.n34y*(this.b4.vely+this.b4.kinvely-this.b3.vely-this.b3.kinvely)+(this.b2.angvel+this.b2.kinangvel)*this.cx2-(this.b1.angvel+this.b1.kinangvel)*this.cx1+(this.b4.angvel+this.b4.kinangvel)*this.cx4-(this.b3.angvel+this.b3.kinangvel)*this.cx3,t=this.kMass*(this.bias-e)-this.jAcc*this.gamma,n=this.jAcc;if(this.jAcc+=t,!this.equal&&0<this.jAcc&&(this.jAcc=0),this.breakUnderForce&&this.jAcc<-this.jMax)return!0;this.stiff||this.jAcc<-this.jMax&&(this.jAcc=-this.jMax),t=this.jAcc-n;var i=this.b1.imass*t;this.b1.velx-=this.n12x*i,this.b1.vely-=this.n12y*i;var r=this.b2.imass*t;this.b2.velx+=this.n12x*r,this.b2.vely+=this.n12y*r;var a=this.b3.imass*t;this.b3.velx-=this.n34x*a,this.b3.vely-=this.n34y*a;var s=this.b4.imass*t;return this.b4.velx+=this.n34x*s,this.b4.vely+=this.n34y*s,this.b1.angvel-=this.cx1*this.b1.iinertia*t,this.b2.angvel+=this.cx2*this.b2.iinertia*t,this.b3.angvel-=this.cx3*this.b3.iinertia*t,this.b4.angvel+=this.cx4*this.b4.iinertia*t,!1},applyImpulsePos:function(){var e,t,n,i,r,a,s,l,o,_,p;n=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,i=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,r=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,a=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy,s=this.b3.axisy*this.a3localx-this.b3.axisx*this.a3localy,l=this.a3localx*this.b3.axisx+this.a3localy*this.b3.axisy,o=this.b4.axisy*this.a4localx-this.b4.axisx*this.a4localy,_=this.a4localx*this.b4.axisx+this.a4localy*this.b4.axisy;var u,h,c,d,m=0,f=0,g=0,v=0;m=this.n12x,f=this.n12y,g=this.n34x,v=this.n34y,u=this.b2.posx+r-(this.b1.posx+n),h=this.b2.posy+a-(this.b1.posy+i),c=this.b4.posx+o-(this.b3.posx+s),d=this.b4.posy+_-(this.b3.posy+l);var b=oc.sqrt(u*u+h*h),y=oc.sqrt(c*c+d*d);if(0!=b){var x=1/b;m=u*x,f=h*x}if(0!=y){var z=1/y;g=c*z,v=d*z;var w=this.ratio;g*=w,v*=w}else{var k=this.ratio/oc.sqrt(g*g+v*v);g*=k,v*=k}var S=b+this.ratio*y;if(p=this.equal?(S-=this.jointMax,!1):S<this.jointMin?(S=this.jointMin-S,m=-m,f=-f,g=-g,v=-v,!1):S>this.jointMax?(S-=this.jointMax,!1):!(S=v=g=f=m=0),e=S,!p){if(this.breakUnderError&&e*e>this.maxError*this.maxError)return!0;if(e*e<lo.constraintLinearSlop*lo.constraintLinearSlop)return!1;if(6<(e*=.5)*e){var C=this.b1.smass+this.b2.smass;if(lo.epsilon<C&&(t=-e*(C=.75/C),this.equal||t<0)){var N=t*this.b1.imass;this.b1.posx-=m*N,this.b1.posy-=f*N;var P=t*this.b2.imass;this.b2.posx+=m*P,this.b2.posy+=f*P;var M=t*this.b3.imass;this.b3.posx-=g*M,this.b3.posy-=v*M;var I,A,T,D,E=t*this.b4.imass;this.b4.posx+=g*E,this.b4.posy+=v*E,I=this.b2.posx+r-(this.b1.posx+n),A=this.b2.posy+a-(this.b1.posy+i),T=this.b4.posx+o-(this.b3.posx+s),D=this.b4.posy+_-(this.b3.posy+l);var O=oc.sqrt(I*I+A*A),B=oc.sqrt(T*T+D*D);if(0!=O){var L=1/O;m=I*L,f=A*L}if(0!=B){var j=1/B;g=T*j,v=D*j;var F=this.ratio;g*=F,v*=F}else{var R=this.ratio/oc.sqrt(g*g+v*v);g*=R,v*=R}var G=O+this.ratio*B;p=this.equal?(G-=this.jointMax,!1):G<this.jointMin?(G=this.jointMin-G,m=-m,f=-f,g=-g,v=-v,!1):G>this.jointMax?(G-=this.jointMax,!1):!(G=v=g=f=m=0),e=G,e*=.5}}var Z,U,V,q;Z=f*n-m*i,U=f*r-m*a,V=v*s-g*l,q=v*o-g*_;var W=this.ratio*this.ratio,X=this.b1.smass+this.b2.smass+W*(this.b3.smass+this.b4.smass)+this.b1.sinertia*Z*Z+this.b2.sinertia*U*U+this.b3.sinertia*V*V+this.b4.sinertia*q*q;this.b1==this.b4&&(X-=2*((m*g+f*v)*this.b1.smass+Z*q*this.b1.sinertia)),this.b1==this.b3&&(X+=2*((m*g+f*v)*this.b1.smass+Z*V*this.b1.sinertia)),this.b2==this.b3&&(X-=2*((m*g+f*v)*this.b2.smass+U*V*this.b2.sinertia)),this.b2==this.b4&&(X+=2*((m*g+f*v)*this.b2.smass+U*q*this.b2.sinertia));var H=X;if(0!=H&&(H=1/H),t=-e*H,this.equal||t<0){var Y=this.b1.imass*t;this.b1.posx-=m*Y,this.b1.posy-=f*Y;var J=this.b2.imass*t;this.b2.posx+=m*J,this.b2.posy+=f*J;var K=this.b3.imass*t;this.b3.posx-=g*K,this.b3.posy-=v*K;var Q=this.b4.imass*t;this.b4.posx+=g*Q,this.b4.posy+=v*Q,this.b1.delta_rot(-Z*this.b1.iinertia*t),this.b2.delta_rot(U*this.b2.iinertia*t),this.b3.delta_rot(-V*this.b3.iinertia*t),this.b4.delta_rot(q*this.b4.iinertia*t)}}return!1},draw:function(e){},__class__:bp});var yp=function(e,t){this.jOld=null,this.J=null,this.vec3=null,this.Keff=null,this.jMax=0,this.velonly=!1,this.gamma=0,this.soft=0,this.y=null,this.L=null,this.stepped=!1,this.bias=null,this.jAcc=null,this.dim=0,this.bodies=null,this.outer_zn=null,hp.call(this),this.bodies=[],this.dim=e,this.velonly=t,this.jAcc=[],this.bias=[],this.L=[],this.J=[],this.jOld=[],this.y=[],this.Keff=[],this.vec3=g_.get(0,0,0);for(var n=0,i=e;n<i;){var r=n++,a=this.bias[r]=this.J[r]=this.jOld[r]=this.y[r]=0;this.jAcc[r]=a;for(var s=0,l=e;s<l;){var o=s++;this.L[r*e+o]=0}}this.stepped=!1};(n["zpp_nape.constraint.ZPP_UserConstraint"]=yp).__name__=["zpp_nape","constraint","ZPP_UserConstraint"],yp.__super__=hp,yp.prototype=r(hp.prototype,{outer_zn:null,bindVec2_invalidate:function(e){this.outer_zn.__invalidate()},bodies:null,dim:null,jAcc:null,bias:null,addBody:function(e){for(var t=null,n=0,i=this.bodies;n<i.length;){var r=i[n];if(++n,r.body==e){t=r;break}}null==t?(this.bodies.push(new xp(1,e)),this.active&&null!=this.space&&null!=e&&e.constraints.add(this)):t.cnt++},remBody:function(e){for(var t=null,n=p.int(this.bodies.length),i=0;i<n;){var r=this.bodies[i];if(r.body==e){r.cnt--,0==r.cnt&&(0<n&&(this.bodies[i]=this.bodies[n-1]),this.bodies.pop(),this.active&&null!=this.space&&null!=e&&e.constraints.remove(this)),t=r;break}++i}return null!=t},bodyImpulse:function(e){for(var t=0,n=this.dim;t<n;){var i=t++;this.J[i]=this.jAcc[i]}var r=g_.get(0,0,0);return this.stepped&&this.outer_zn.__impulse(this.J,e.outer,r),r},activeBodies:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];++e,null!=n.body&&n.body.constraints.add(this)}},inactiveBodies:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];++e,null!=n.body&&n.body.constraints.remove(this)}},stepped:null,copy:function(e,t){var n=this.outer_zn.__copy();throw this.copyto(n),new $l("not done yet")},validate:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];if(++e,n.body.space!=this.space)throw new $l("Error: Constraints must have each body within the same sapce to which the constraint has been assigned")}this.outer_zn.__validate()},wake_connected:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];++e,n.body.isDynamic()&&n.body.wake()}},forest:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];if(++e,n.body.isDynamic()){var i,r;if(n.body.component==n.body.component.parent)i=n.body.component;else{for(var a=n.body.component,s=null;a!=a.parent;){var l=a.parent;a.parent=s,s=a,a=l}for(;null!=s;){var o=s.parent;s.parent=a,s=o}i=a}if(this.component==this.component.parent)r=this.component;else{for(var _=this.component,p=null;_!=_.parent;){var u=_.parent;_.parent=p,p=_,_=u}for(;null!=p;){var h=p.parent;p.parent=_,p=h}r=_}i!=r&&(i.rank<r.rank?i.parent=r:i.rank>r.rank?r.parent=i:(r.parent=i).rank++)}}},pair_exists:function(e,t){for(var n=!1,i=p.int(this.bodies.length),r=0,a=i;r<a;){for(var s=r++,l=this.bodies[s].body,o=s+1,_=i;o<_;){var u=o++,h=this.bodies[u].body;if(l.id==e&&h.id==t||l.id==t&&h.id==e){n=!0;break}}if(n)break}return n},broken:function(){this.outer_zn.__broken()},clearcache:function(){for(var e=0,t=this.dim;e<t;){var n=e++;this.jAcc[n]=0}this.pre_dt=-1},lsq:function(e){for(var t=0,n=0,i=this.dim;n<i;){var r=n++;t+=e[r]*e[r]}return t},_clamp:function(e,t){var n=this.lsq(e);if(t*t<n)for(var i=t/Math.sqrt(n),r=0,a=this.dim;r<a;)e[r++]*=i},L:null,solve:function(e){for(var t=0,n=0,i=this.dim;n<i;){for(var r=n++,a=0,s=0,l=r-1;s<l;){var o=s++;a+=this.L[r*this.dim+o]*this.L[r*this.dim+o]}var _=Math.sqrt(e[t++]-a);if(0!=(this.L[r*this.dim+r]=_)){_=1/_;for(var p=r+1,u=this.dim;p<u;){for(var h=p++,c=0,d=0,m=r-1;d<m;){var f=d++;c+=this.L[h*this.dim+f]*this.L[r*this.dim+f]}this.L[h*this.dim+r]=_*(e[t++]-c)}}else{for(var g=r+1,v=this.dim;g<v;){var b=g++;this.L[b*this.dim+r]=0}t+=this.dim-r-1}}return this.L},y:null,transform:function(e,t){for(var n=0,i=this.dim;n<i;){var r=n++,a=t[r],s=e[r*this.dim+r];if(0!=s){for(var l=0,o=r;l<o;){var _=l++;a-=e[r*this.dim+_]*this.y[_]}this.y[r]=a/s}else this.y[r]=0}for(var p=0,u=this.dim;p<u;){var h=p++,c=this.dim-1-h,d=e[c*this.dim+c];if(0!=d){for(var m=this.y[c],f=c+1,g=this.dim;f<g;){var v=f++;m-=e[v*this.dim+c]*t[v]}t[c]=m/d}else t[c]=0}},soft:null,gamma:null,velonly:null,jMax:null,Keff:null,preStep:function(e){this.outer_zn.__validate(),-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;if(this.pre_dt=e,this.stepped=!0,this.outer_zn.__prepare(),this.outer_zn.__eff_mass(this.Keff),this.L=this.solve(this.Keff),this.stiff||this.velonly){for(var n=0,i=this.dim;n<i;){var r=n++;this.bias[r]=0}this.gamma=0,this.soft=1}else{var a,s=2*Math.PI*this.frequency;this.gamma=1/(e*s*(2*this.damping+s*e));var l=1/(1+this.gamma);if(a=e*s*s*this.gamma,this.gamma*=l,this.soft=l,this.outer_zn.__position(this.bias),this.breakUnderError&&this.lsq(this.bias)>this.maxError*this.maxError)return!0;for(var o=0,_=this.dim;o<_;){var p=o++;this.bias[p]*=-a}this._clamp(this.bias,this.maxError)}for(var u=0,h=this.dim;u<h;){var c=u++;this.jAcc[c]*=t}return this.jMax=this.maxForce*e,!1},vec3:null,warmStart:function(){for(var e=0,t=this.bodies;e<t.length;){var n=t[e];++e;var i=n.body;this.outer_zn.__impulse(this.jAcc,i.outer,this.vec3);var r=i.imass;i.velx+=this.vec3.get_x()*r,i.vely+=this.vec3.get_y()*r,i.angvel+=this.vec3.get_z()*i.iinertia}},J:null,jOld:null,applyImpulseVel:function(){this.outer_zn.__velocity(this.J);for(var e=0,t=this.dim;e<t;){var n=e++;this.J[n]=this.bias[n]-this.J[n]}this.transform(this.L,this.J);for(var i=0,r=this.dim;i<r;){var a=i++;this.jOld[a]=this.jAcc[a],this.jAcc[a]+=this.J[a]=this.J[a]*this.soft-this.jAcc[a]*this.gamma}if(this.outer_zn.__clamp(this.jAcc),(this.breakUnderForce||!this.stiff)&&this.lsq(this.jAcc)>this.jMax*this.jMax){if(this.breakUnderForce)return!0;this.stiff||this._clamp(this.jAcc,this.jMax)}for(var s=0,l=this.dim;s<l;){var o=s++;this.J[o]=this.jAcc[o]-this.jOld[o]}for(var _=0,p=this.bodies;_<p.length;){var u=p[_];++_;var h=u.body;this.outer_zn.__impulse(this.J,h.outer,this.vec3);var c=h.imass;h.velx+=this.vec3.get_x()*c,h.vely+=this.vec3.get_y()*c,h.angvel+=this.vec3.get_z()*h.iinertia}return!1},applyImpulsePos:function(){if(this.velonly)return!1;this.outer_zn.__prepare(),this.outer_zn.__position(this.J);var e=this.lsq(this.J);if(this.breakUnderError&&e>this.maxError*this.maxError)return!0;if(e<lo.constraintLinearSlop*lo.constraintLinearSlop)return!1;for(var t=0,n=this.dim;t<n;){var i=t++;this.J[i]*=-1}this.outer_zn.__eff_mass(this.Keff),this.transform(this.solve(this.Keff),this.J),this.outer_zn.__clamp(this.J);for(var r=0,a=this.bodies;r<a.length;){var s=a[r];++r;var l=s.body;this.outer_zn.__impulse(this.J,l.outer,this.vec3);var o=l.imass;l.posx+=this.vec3.get_x()*o,l.posy+=this.vec3.get_y()*o,l.delta_rot(this.vec3.get_z()*l.iinertia)}return!1},draw:function(e){this.outer_zn.__draw(e)},__class__:yp});var xp=function(e,t){this.body=null,this.cnt=0,this.cnt=e,this.body=t};(n["zpp_nape.constraint.ZPP_UserBody"]=xp).__name__=["zpp_nape","constraint","ZPP_UserBody"],xp.prototype={cnt:null,body:null,__class__:xp};var zp=function(){this.stepped=!1,this.biasz=0,this.biasy=0,this.biasx=0,this.gamma=0,this.jMax=0,this.jAccz=0,this.jAccy=0,this.jAccx=0,this.kMassf=0,this.kMasse=0,this.kMassc=0,this.kMassd=0,this.kMassb=0,this.kMassa=0,this.phase=0,this.wrap_a2=null,this.a2rely=0,this.a2relx=0,this.a2localy=0,this.a2localx=0,this.b2=null,this.wrap_a1=null,this.a1rely=0,this.a1relx=0,this.a1localy=0,this.a1localx=0,this.b1=null,this.outer_zn=null,hp.call(this),this.phase=0,this.jAccx=0,this.jAccy=0,this.jAccz=0,this.jMax=X_.POSINF(),this.stepped=!1,this.a1localx=0,this.a1localy=0,this.a1relx=0,this.a1rely=0,this.a2localx=0,this.a2localy=0,this.a2relx=0,this.a2rely=0};(n["zpp_nape.constraint.ZPP_WeldJoint"]=zp).__name__=["zpp_nape","constraint","ZPP_WeldJoint"],zp.__super__=hp,zp.prototype=r(hp.prototype,{outer_zn:null,bodyImpulse:function(e){return this.stepped?e==this.b1?g_.get(-this.jAccx,-this.jAccy,-(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)):g_.get(this.jAccx,this.jAccy,this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz):g_.get(0,0,0)},activeBodies:function(){null!=this.b1&&this.b1.constraints.add(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.add(this)},inactiveBodies:function(){null!=this.b1&&this.b1.constraints.remove(this),this.b2!=this.b1&&null!=this.b2&&this.b2.constraints.remove(this)},b1:null,a1localx:null,a1localy:null,a1relx:null,a1rely:null,validate_a1:function(){this.wrap_a1.zpp_inner.x=this.a1localx,this.wrap_a1.zpp_inner.y=this.a1localy},invalidate_a1:function(e){this.immutable_midstep("Constraint::a1"),this.a1localx=e.x,this.a1localy=e.y,this.wake()},setup_a1:function(){this.wrap_a1=d_.get(this.a1localx,this.a1localy),this.wrap_a1.zpp_inner._inuse=!0,this.wrap_a1.zpp_inner._validate=yc(this,this.validate_a1),this.wrap_a1.zpp_inner._invalidate=yc(this,this.invalidate_a1)},wrap_a1:null,b2:null,a2localx:null,a2localy:null,a2relx:null,a2rely:null,validate_a2:function(){this.wrap_a2.zpp_inner.x=this.a2localx,this.wrap_a2.zpp_inner.y=this.a2localy},invalidate_a2:function(e){this.immutable_midstep("Constraint::a2"),this.a2localx=e.x,this.a2localy=e.y,this.wake()},setup_a2:function(){this.wrap_a2=d_.get(this.a2localx,this.a2localy),this.wrap_a2.zpp_inner._inuse=!0,this.wrap_a2.zpp_inner._validate=yc(this,this.validate_a2),this.wrap_a2.zpp_inner._invalidate=yc(this,this.invalidate_a2)},wrap_a2:null,phase:null,kMassa:null,kMassb:null,kMassd:null,kMassc:null,kMasse:null,kMassf:null,jAccx:null,jAccy:null,jAccz:null,jMax:null,gamma:null,biasx:null,biasy:null,biasz:null,stepped:null,copy:function(e,t){var n=new Bo(null,null,this.outer_zn.get_anchor1(),this.outer_zn.get_anchor2());if(this.copyto(n),null!=e&&null!=this.b1){for(var i=null,r=0;r<e.length;){var a=e[r];if(++r,a.id==this.b1.id){i=a.bc;break}}null!=i?n.zpp_inner_zn.b1=i.zpp_inner:t.push(dp.todo(this.b1.id,(function(e){n.zpp_inner_zn.b1=e.zpp_inner})))}if(null!=e&&null!=this.b2){for(var s=null,l=0;l<e.length;){var o=e[l];if(++l,o.id==this.b2.id){s=o.bc;break}}null!=s?n.zpp_inner_zn.b2=s.zpp_inner:t.push(dp.todo(this.b2.id,(function(e){n.zpp_inner_zn.b2=e.zpp_inner})))}return n},validate:function(){if(null==this.b1||null==this.b2)throw new $l("Error: AngleJoint cannot be simulated null bodies");if(this.b1==this.b2)throw new $l("Error: WeldJoint cannot be simulated with body1 == body2");if(this.b1.space!=this.space||this.b2.space!=this.space)throw new $l("Error: Constraints must have each body within the same space to which the constraint has been assigned");if(!this.b1.isDynamic()&&!this.b2.isDynamic())throw new $l("Error: Constraints cannot have both bodies non-dynamic")},wake_connected:function(){null!=this.b1&&this.b1.isDynamic()&&this.b1.wake(),null!=this.b2&&this.b2.isDynamic()&&this.b2.wake()},forest:function(){if(this.b1.isDynamic()){var e,t;if(this.b1.component==this.b1.component.parent)e=this.b1.component;else{for(var n=this.b1.component,i=null;n!=n.parent;){var r=n.parent;n.parent=i,i=n,n=r}for(;null!=i;){var a=i.parent;i.parent=n,i=a}e=n}if(this.component==this.component.parent)t=this.component;else{for(var s=this.component,l=null;s!=s.parent;){var o=s.parent;s.parent=l,l=s,s=o}for(;null!=l;){var _=l.parent;l.parent=s,l=_}t=s}e!=t&&(e.rank<t.rank?e.parent=t:e.rank>t.rank?t.parent=e:(t.parent=e).rank++)}if(this.b2.isDynamic()){var p,u;if(this.b2.component==this.b2.component.parent)p=this.b2.component;else{for(var h=this.b2.component,c=null;h!=h.parent;){var d=h.parent;h.parent=c,c=h,h=d}for(;null!=c;){var m=c.parent;c.parent=h,c=m}p=h}if(this.component==this.component.parent)u=this.component;else{for(var f=this.component,g=null;f!=f.parent;){var v=f.parent;f.parent=g,g=f,f=v}for(;null!=g;){var b=g.parent;g.parent=f,g=b}u=f}p!=u&&(p.rank<u.rank?p.parent=u:p.rank>u.rank?u.parent=p:(u.parent=p).rank++)}},pair_exists:function(e,t){return this.b1.id==e&&this.b2.id==t||this.b1.id==t&&this.b2.id==e},clearcache:function(){this.jAccx=0,this.jAccy=0,this.jAccz=0,this.pre_dt=-1},preStep:function(e){-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e,this.stepped=!0,this.a1relx=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,this.a1rely=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,this.a2relx=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,this.a2rely=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var n=this.b1.smass+this.b2.smass;if(this.kMassa=n,this.kMassb=0,this.kMassd=n,this.kMassc=0,this.kMasse=0,(this.kMassf=0)!=this.b1.sinertia){var i=this.a1relx*this.b1.sinertia,r=this.a1rely*this.b1.sinertia;this.kMassa+=r*this.a1rely,this.kMassb+=-r*this.a1relx,this.kMassd+=i*this.a1relx,this.kMassc+=-r,this.kMasse+=i,this.kMassf+=this.b1.sinertia}if(0!=this.b2.sinertia){var a=this.a2relx*this.b2.sinertia,s=this.a2rely*this.b2.sinertia;this.kMassa+=s*this.a2rely,this.kMassb+=-s*this.a2relx,this.kMassd+=a*this.a2relx,this.kMassc+=-s,this.kMasse+=a,this.kMassf+=this.b2.sinertia}var l,o=this.kMassa*(this.kMassd*this.kMassf-this.kMasse*this.kMasse)+this.kMassb*(this.kMassc*this.kMasse-this.kMassb*this.kMassf)+this.kMassc*(this.kMassb*this.kMasse-this.kMassc*this.kMassd);if(o!=o)this.kMassa=0,this.kMassb=0,this.kMassd=0,this.kMassc=0,this.kMasse=0,this.kMassf=0,l=7;else if(0==o){var _=0;0!=this.kMassa?this.kMassa=1/this.kMassa:(this.kMassa=0,_|=1),0!=this.kMassd?this.kMassd=1/this.kMassd:(this.kMassd=0,_|=2),0!=this.kMassf?this.kMassf=1/this.kMassf:(this.kMassf=0,_|=4),this.kMassb=this.kMassc=this.kMasse=0,l=_}else{var p=(o=1/o)*(this.kMassd*this.kMassf-this.kMasse*this.kMasse),u=o*(this.kMasse*this.kMassc-this.kMassb*this.kMassf),h=o*(this.kMassa*this.kMassf-this.kMassc*this.kMassc),c=o*(this.kMassb*this.kMasse-this.kMassc*this.kMassd),d=o*(this.kMassb*this.kMassc-this.kMassa*this.kMasse),m=o*(this.kMassa*this.kMassd-this.kMassb*this.kMassb);this.kMassa=p,this.kMassb=u,this.kMassd=h,this.kMassc=c,this.kMasse=d,this.kMassf=m,l=0}if(0!=(1&l)&&(this.jAccx=0),0!=(2&l)&&(this.jAccy=0),0!=(4&l)&&(this.jAccz=0),this.stiff)this.biasx=0,this.biasy=0,this.biasz=0,this.gamma=0;else{var f,g=2*Math.PI*this.frequency;this.gamma=1/(e*g*(2*this.damping+g*e));var v=1/(1+this.gamma);f=e*g*g*this.gamma,this.gamma*=v;var b=v;if(this.kMassa*=b,this.kMassb*=b,this.kMassd*=b,this.kMassc*=b,this.kMasse*=b,this.kMassf*=b,this.biasx=this.b2.posx+this.a2relx-(this.b1.posx+this.a1relx),this.biasy=this.b2.posy+this.a2rely-(this.b1.posy+this.a1rely),this.biasz=this.b2.rot-this.b1.rot-this.phase,this.breakUnderError&&this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz>this.maxError*this.maxError)return!0;var y=-f,x=y;this.biasx*=x,this.biasy*=x,this.biasz*=y;var z=this.maxError,w=this.biasx*this.biasx+this.biasy*this.biasy+this.biasz*this.biasz;if(z*z<w){var k=z*oc.invsqrt(w),S=k;this.biasx*=S,this.biasy*=S,this.biasz*=k}}var C=t,N=C;return this.jAccx*=N,this.jAccy*=N,this.jAccz*=C,this.jMax=this.maxForce*e,!1},warmStart:function(){var e=this.b1.imass;this.b1.velx-=this.jAccx*e,this.b1.vely-=this.jAccy*e;var t=this.b2.imass;this.b2.velx+=this.jAccx*t,this.b2.vely+=this.jAccy*t,this.b1.angvel-=(this.jAccy*this.a1relx-this.jAccx*this.a1rely+this.jAccz)*this.b1.iinertia,this.b2.angvel+=(this.jAccy*this.a2relx-this.jAccx*this.a2rely+this.jAccz)*this.b2.iinertia},applyImpulseVel:function(){var e,t,n;e=this.b2.velx+this.b2.kinvelx-this.a2rely*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.a1rely*(this.b1.angvel+this.b1.kinangvel)),t=this.b2.vely+this.b2.kinvely+this.a2relx*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.a1relx*(this.b1.angvel+this.b1.kinangvel)),n=this.b2.angvel+this.b2.kinangvel-this.b1.angvel-this.b1.kinangvel;var i=0,r=0,a=0;i=this.biasx-e,r=this.biasy-t,a=this.biasz-n;var s=this.kMassa*i+this.kMassb*r+this.kMassc*a,l=this.kMassb*i+this.kMassd*r+this.kMasse*a;a=this.kMassc*i+this.kMasse*r+this.kMassf*a,i=s,r=l;var o,_,p,u=this.gamma,h=u;if(i-=this.jAccx*h,r-=this.jAccy*h,a-=this.jAccz*u,o=this.jAccx,_=this.jAccy,p=this.jAccz,this.jAccx+=1*i,this.jAccy+=1*r,this.jAccz+=1*a,this.breakUnderForce){if(this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz>this.jMax*this.jMax)return!0}else if(!this.stiff){var c=this.jMax,d=this.jAccx*this.jAccx+this.jAccy*this.jAccy+this.jAccz*this.jAccz;if(c*c<d){var m=c*oc.invsqrt(d),f=m;this.jAccx*=f,this.jAccy*=f,this.jAccz*=m}}i=this.jAccx-o,r=this.jAccy-_,a=this.jAccz-p;var g=this.b1.imass;this.b1.velx-=i*g,this.b1.vely-=r*g;var v=this.b2.imass;return this.b2.velx+=i*v,this.b2.vely+=r*v,this.b1.angvel-=(r*this.a1relx-i*this.a1rely+a)*this.b1.iinertia,this.b2.angvel+=(r*this.a2relx-i*this.a2rely+a)*this.b2.iinertia,!1},applyImpulsePos:function(){var e,t,n,i;e=this.b1.axisy*this.a1localx-this.b1.axisx*this.a1localy,t=this.a1localx*this.b1.axisx+this.a1localy*this.b1.axisy,n=this.b2.axisy*this.a2localx-this.b2.axisx*this.a2localy,i=this.a2localx*this.b2.axisx+this.a2localy*this.b2.axisy;var r=0,a=0,s=0;r=this.b2.posx+n-(this.b1.posx+e),a=this.b2.posy+i-(this.b1.posy+t),s=this.b2.rot-this.b1.rot-this.phase;var l=0,o=0,_=0;if(this.breakUnderError&&r*r+a*a+s*s>this.maxError*this.maxError)return!0;var p=!0;if(r*r+a*a<lo.constraintLinearSlop*lo.constraintLinearSlop&&(p=!1,a=r=0),oc.sqr(s)<oc.sqr(lo.constraintAngularSlop)){if(!p)return!1;s=0}if(s*=.5,6<(r*=.5)*r+(a*=.5)*a){var u=this.b1.smass+this.b2.smass;if(lo.epsilon<u){var h=(l=-r*(u=.75/u))*l+(o=-a*u)*o;if(400<h){var c=20*oc.invsqrt(h);l*=c,o*=c}var d=this.b1.imass;this.b1.posx-=l*d,this.b1.posy-=o*d;var m=this.b2.imass;this.b2.posx+=l*m,this.b2.posy+=o*m,r=this.b2.posx+n-(this.b1.posx+e),a=this.b2.posy+i-(this.b1.posy+t),s=this.b2.rot-this.b1.rot-this.phase,r*=.5,a*=.5,s*=.5}}var f=0,g=0,v=0,b=0,y=0,x=0;if(v=f=this.b1.smass+this.b2.smass,(x=y=b=g=0)!=this.b1.sinertia){var z=e*this.b1.sinertia,w=t*this.b1.sinertia;f+=w*t,g+=-w*e,v+=z*e,b+=-w,y+=z,x+=this.b1.sinertia}if(0!=this.b2.sinertia){var k=n*this.b2.sinertia,S=i*this.b2.sinertia;f+=S*i,g+=-S*n,v+=k*n,b+=-S,y+=k,x+=this.b2.sinertia}_=-s;var C=(l=-r)*l+(o=-a)*o;if(36<C){var N=6*oc.invsqrt(C);l*=N,o*=N}oc.clamp2(_,.25);var P=f*(v*x-y*y)+g*(b*y-g*x)+b*(g*y-b*v);if(P!=P)l=o=_=0;else if(0==P)0!=f?l/=f:l=0,0!=v?o/=v:o=0,0!=x?_/=x:_=0;else{var M=y*b-g*x,I=g*y-b*v,A=g*b-f*y,T=(P=1/P)*(l*(v*x-y*y)+o*M+_*I),D=P*(l*M+o*(f*x-b*b)+_*A);_=P*(l*I+o*A+_*(f*v-g*g)),l=T,o=D}var E=this.b1.imass;this.b1.posx-=l*E,this.b1.posy-=o*E;var O=this.b2.imass;return this.b2.posx+=l*O,this.b2.posy+=o*O,this.b1.delta_rot(-(o*e-l*t+_)*this.b1.iinertia),this.b2.delta_rot((o*n-l*i+_)*this.b2.iinertia),!1},draw:function(e){},__class__:zp});var wp=function(){this.sensorarb=null,this.fluidarb=null,this.colarb=null,this.type=0,this.pair=null,this.ws2=null,this.ws1=null,this.b2=null,this.b1=null,this.invalidated=!1,this.immState=0,this.fresh=!1,this.continuous=!1,this.presentable=!1,this.intchange=!1,this.present=0,this.sleeping=!1,this.cleared=!1,this.active=!1,this.endGenerated=0,this.sleep_stamp=0,this.up_stamp=0,this.stamp=0,this.di=0,this.id=0,this.hnext=null,this.outer=null};(n["zpp_nape.dynamics.ZPP_Arbiter"]=wp).__name__=["zpp_nape","dynamics","ZPP_Arbiter"],wp.prototype={outer:null,wrapper:function(){return null==this.outer&&(wp.internal=!0,this.type==wp.COL?(this.colarb.outer_zn=new Vo,this.outer=this.colarb.outer_zn):this.type==wp.FLUID?(this.fluidarb.outer_zn=new Ho,this.outer=this.fluidarb.outer_zn):this.outer=new Ro,this.outer.zpp_inner=this,wp.internal=!1),this.outer},inactiveme:function(){return!this.active},hnext:null,id:null,di:null,stamp:null,up_stamp:null,sleep_stamp:null,endGenerated:null,active:null,cleared:null,sleeping:null,present:null,intchange:null,presentable:null,continuous:null,fresh:null,immState:null,acting:function(){return!!this.active&&0!=(1&this.immState)},invalidated:null,b1:null,b2:null,ws1:null,ws2:null,pair:null,swap_features:function(){var e=this.b1;this.b1=this.b2,this.b2=e;var t=this.ws1;this.ws1=this.ws2,this.ws2=t;var n=this.colarb.s1;this.colarb.s1=this.colarb.s2,this.colarb.s2=n},type:null,colarb:null,fluidarb:null,sensorarb:null,lazyRetire:function(e,t){this.cleared=!0,null!=t&&this.b2!=t||this.b1.arbiters.inlined_remove(this),null!=t&&this.b1!=t||this.b2.arbiters.inlined_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null),this.active=!1,e.f_arbiters.modified=!0},sup_assign:function(e,t,n,i){this.b1=e.body,this.ws1=e,this.b2=t.body,this.ws2=t,this.id=n,this.di=i,this.b1.arbiters.inlined_add(this),this.b2.arbiters.inlined_add(this),this.active=!0,this.present=0,this.cleared=!1,this.sleeping=!1,this.fresh=!1,this.presentable=!1},sup_retire:function(){this.cleared||(this.b1.arbiters.inlined_remove(this),this.b2.arbiters.inlined_remove(this),null!=this.pair&&(this.pair.arb=null,this.pair=null)),this.b1=this.b2=null,this.active=!1,this.intchange=!1},__class__:wp};var kp=function(){this.next=null,wp.call(this),this.type=wp.SENSOR,this.sensorarb=this};(n["zpp_nape.dynamics.ZPP_SensorArbiter"]=kp).__name__=["zpp_nape","dynamics","ZPP_SensorArbiter"],kp.__super__=wp,kp.prototype=r(wp.prototype,{next:null,alloc:function(){},free:function(){},assign:function(e,t,n,i){this.sup_assign(e,t,n,i)},retire:function(){this.sup_retire(),this.free(),this.next=kp.zpp_pool,kp.zpp_pool=this},makemutable:function(){},makeimmutable:function(){},__class__:kp});var Sp=function(){this.pre_dt=0,this.mutable=!1,this.wrap_position=null,this.buoyy=0,this.buoyx=0,this.ny=0,this.nx=0,this.lgamma=0,this.dampy=0,this.dampx=0,this.vMassc=0,this.vMassb=0,this.vMassa=0,this.agamma=0,this.adamp=0,this.wMass=0,this.nodrag=!1,this.r2y=0,this.r2x=0,this.r1y=0,this.r1x=0,this.overlap=0,this.centroidy=0,this.centroidx=0,this.next=null,this.outer_zn=null,wp.call(this),this.type=wp.FLUID,(this.fluidarb=this).buoyx=0,this.buoyy=0,this.pre_dt=-1};(n["zpp_nape.dynamics.ZPP_FluidArbiter"]=Sp).__name__=["zpp_nape","dynamics","ZPP_FluidArbiter"],Sp.__super__=wp,Sp.prototype=r(wp.prototype,{outer_zn:null,next:null,alloc:function(){},free:function(){},centroidx:null,centroidy:null,overlap:null,r1x:null,r1y:null,r2x:null,r2y:null,nodrag:null,wMass:null,adamp:null,agamma:null,vMassa:null,vMassb:null,vMassc:null,dampx:null,dampy:null,lgamma:null,nx:null,ny:null,buoyx:null,buoyy:null,position_validate:function(){this.wrap_position.zpp_inner.x=this.centroidx,this.wrap_position.zpp_inner.y=this.centroidy},position_invalidate:function(e){this.centroidx=e.x,this.centroidy=e.y},wrap_position:null,getposition:function(){this.wrap_position=d_.get(),this.wrap_position.zpp_inner._inuse=!0,this.wrap_position.zpp_inner._immutable=!this.mutable,this.wrap_position.zpp_inner._validate=yc(this,this.position_validate),this.wrap_position.zpp_inner._invalidate=yc(this,this.position_invalidate)},assign:function(e,t,n,i){this.sup_assign(e,t,n,i),this.nx=0,this.ny=1,this.dampx=0,this.dampy=0,this.adamp=0},retire:function(){this.sup_retire(),this.free(),this.next=Sp.zpp_pool,(Sp.zpp_pool=this).pre_dt=-1},mutable:null,makemutable:function(){this.mutable=!0,null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!1)},makeimmutable:function(){this.mutable=!1,null!=this.wrap_position&&(this.wrap_position.zpp_inner._immutable=!0)},inject:function(e,t,n){this.overlap=e,this.centroidx=t,this.centroidy=n},pre_dt:null,preStep:function(e,t){-1==this.pre_dt&&(this.pre_dt=t);var n=t/this.pre_dt;this.pre_dt=t,this.r1x=this.centroidx-this.b1.posx,this.r1y=this.centroidy-this.b1.posy,this.r2x=this.centroidx-this.b2.posx,this.r2y=this.centroidy-this.b2.posy;var i,r=0;i=this.ws1.fluidEnabled&&null!=this.ws1.fluidProperties.wrap_gravity?(r=this.ws1.fluidProperties.gravityx,this.ws1.fluidProperties.gravityy):(r=e.gravityx,e.gravityy);var a,s=0;a=this.ws2.fluidEnabled&&null!=this.ws2.fluidProperties.wrap_gravity?(s=this.ws2.fluidProperties.gravityx,this.ws2.fluidProperties.gravityy):(s=e.gravityx,e.gravityy);var l=0,o=0;if(this.ws1.fluidEnabled&&this.ws2.fluidEnabled){var _=this.overlap*this.ws1.fluidProperties.density,p=this.overlap*this.ws2.fluidProperties.density;if(p<_){var u=_+p;l-=r*u,o-=i*u}else if(_<p){var h=_+p;l+=s*h,o+=a*h}else{var c=0,d=0;if(c=r+s,d=i+a,c*=.5,d*=.5,this.ws1.worldCOMx*c+this.ws1.worldCOMy*d>this.ws2.worldCOMx*c+this.ws2.worldCOMy*d){var m=_+p;l-=c*m,o-=d*m}else{var f=_+p;l+=c*f,o+=d*f}}}else if(this.ws1.fluidEnabled){var g=this.overlap*this.ws1.fluidProperties.density;l-=r*g,o-=i*g}else if(this.ws2.fluidEnabled){var v=this.overlap*this.ws2.fluidProperties.density;l+=s*v,o+=a*v}if(l*=t,o*=t,this.buoyx=l,this.buoyy=o,this.b1.isDynamic()){var b=this.b1.imass;this.b1.velx-=l*b,this.b1.vely-=o*b,this.b1.angvel-=(o*this.r1x-l*this.r1y)*this.b1.iinertia}if(this.b2.isDynamic()){var y=this.b2.imass;this.b2.velx+=l*y,this.b2.vely+=o*y,this.b2.angvel+=(o*this.r2x-l*this.r2y)*this.b2.iinertia}if(this.ws1.fluidEnabled&&0!=this.ws1.fluidProperties.viscosity||this.ws2.fluidEnabled&&0!=this.ws2.fluidProperties.viscosity){this.nodrag=!1;var x=0;if(this.ws1.fluidEnabled&&(this.ws2.validate_angDrag(),x+=this.ws1.fluidProperties.viscosity*this.ws2.angDrag*this.overlap/this.ws2.area),this.ws2.fluidEnabled&&(this.ws1.validate_angDrag(),x+=this.ws2.fluidProperties.viscosity*this.ws1.angDrag*this.overlap/this.ws1.area),0!=x){var z=this.b1.sinertia+this.b2.sinertia;this.wMass=0!=z?1/z:0,x*=4e-4;var w=2*Math.PI*x;this.agamma=1/(t*w*(2+w*t));var k=1/(1+this.agamma);this.agamma,this.agamma*=k,this.wMass*=k}else this.wMass=0,this.agamma=0;var S=this.b2.velx+this.b2.kinvelx-this.r2y*(this.b2.angvel+this.b2.kinangvel)-(this.b1.velx+this.b1.kinvelx-this.r1y*(this.b2.angvel+this.b2.kinangvel)),C=this.b2.vely+this.b2.kinvely+this.r2x*(this.b2.angvel+this.b2.kinangvel)-(this.b1.vely+this.b1.kinvely+this.r1x*(this.b1.angvel+this.b1.kinangvel));if(!(S*S+C*C<lo.epsilon*lo.epsilon)){var N=S*S+C*C,P=oc.invsqrt(N);S*=P,C*=P,this.nx=S,this.ny=C}var M=0;if(this.ws1.fluidEnabled){var I=-this.ws1.fluidProperties.viscosity*this.overlap/this.ws2.area;if(0==this.ws2.type)M-=I*this.ws2.circle.radius*lo.fluidLinearDrag/(2*this.ws2.circle.radius*Math.PI);else{for(var A=0,T=0,D=this.ws2.polygon.edges.begin();null!=D;){var E=D.elem();A+=E.length;var O=I*E.length*(E.gnormx*this.nx+E.gnormy*this.ny);0<O&&(O=O*=-lo.fluidVacuumDrag),T-=.5*O*lo.fluidLinearDrag,D=D.next}M+=T/A}}if(this.ws2.fluidEnabled){var B=-this.ws2.fluidProperties.viscosity*this.overlap/this.ws1.area;if(0==this.ws1.type)M-=B*this.ws1.circle.radius*lo.fluidLinearDrag/(2*this.ws1.circle.radius*Math.PI);else{for(var L=0,j=0,F=this.ws1.polygon.edges.begin();null!=F;){var R=F.elem();L+=R.length;var G=B*R.length*(R.gnormx*this.nx+R.gnormy*this.ny);0<G&&(G=G*=-lo.fluidVacuumDrag),j-=.5*G*lo.fluidLinearDrag,F=F.next}M+=j/L}}if(0!=M){var Z=0,U=0,V=0;if(V=Z=this.b1.smass+this.b2.smass,(U=0)!=this.b1.sinertia){var q=this.r1x*this.b1.sinertia,W=this.r1y*this.b1.sinertia;Z+=W*this.r1y,U+=-W*this.r1x,V+=q*this.r1x}if(0!=this.b2.sinertia){var X=this.r2x*this.b2.sinertia,H=this.r2y*this.b2.sinertia;Z+=H*this.r2y,U+=-H*this.r2x,V+=X*this.r2x}var Y=Z*V-U*U;if(Y!=Y)Z=U=V=0;else if(0==Y)0!=Z?Z=1/Z:Z=0,0!=V?V=1/V:V=0,U=0;else{var J=V*(Y=1/Y);V=Z*Y,Z=J,U*=-Y}this.vMassa=Z,this.vMassb=U,this.vMassc=V;var K=2*Math.PI*M;this.lgamma=1/(t*K*(2+K*t));var Q=1/(1+this.lgamma);this.lgamma,this.lgamma*=Q;var $=Q;this.vMassa*=$,this.vMassb*=$,this.vMassc*=$}else this.vMassa=0,this.vMassb=0,this.vMassc=0,this.lgamma=0}else this.nodrag=!0,this.dampx=0,this.dampy=0,this.adamp=0;var ee=n;this.dampx*=ee,this.dampy*=ee,this.adamp*=n},warmStart:function(){var e=this.b1.imass;this.b1.velx-=this.dampx*e,this.b1.vely-=this.dampy*e;var t=this.b2.imass;this.b2.velx+=this.dampx*t,this.b2.vely+=this.dampy*t,this.b1.angvel-=this.b1.iinertia*(this.dampy*this.r1x-this.dampx*this.r1y),this.b2.angvel+=this.b2.iinertia*(this.dampy*this.r2x-this.dampx*this.r2y),this.b1.angvel-=this.adamp*this.b1.iinertia,this.b2.angvel+=this.adamp*this.b2.iinertia},applyImpulseVel:function(){if(!this.nodrag){var e=this.b1.angvel+this.b1.kinangvel,t=this.b2.angvel+this.b2.kinangvel,n=this.b1.velx+this.b1.kinvelx-this.r1y*e-(this.b2.velx+this.b2.kinvelx-this.r2y*t),i=this.b1.vely+this.b1.kinvely+this.r1x*e-(this.b2.vely+this.b2.kinvely+this.r2x*t),r=this.vMassa*n+this.vMassb*i;i=this.vMassb*n+this.vMassc*i,n=r;var a=this.lgamma;n-=this.dampx*a,i-=this.dampy*a,this.dampx+=1*n,this.dampy+=1*i;var s=this.b1.imass;this.b1.velx-=n*s,this.b1.vely-=i*s;var l=this.b2.imass;this.b2.velx+=n*l,this.b2.vely+=i*l,this.b1.angvel-=this.b1.iinertia*(i*this.r1x-n*this.r1y),this.b2.angvel+=this.b2.iinertia*(i*this.r2x-n*this.r2y);var o=(e-t)*this.wMass-this.adamp*this.agamma;this.adamp+=o,this.b1.angvel-=o*this.b1.iinertia,this.b2.angvel+=o*this.b2.iinertia}},__class__:Sp});var Cp=function(){this.pre_dt=0,this.mutable=!1,this.stat=!1,this.next=null,this.hpc2=!1,this.hc2=!1,this.oc2=null,this.c2=null,this.oc1=null,this.c1=null,this.__ref_vertex=0,this.__ref_edge2=null,this.__ref_edge1=null,this.biasCoef=0,this.rev=!1,this.radius=0,this.lproj=0,this.lnormy=0,this.lnormx=0,this.surfacey=0,this.surfacex=0,this.k2y=0,this.k2x=0,this.k1y=0,this.k1x=0,this.rt2b=0,this.rn2b=0,this.rt2a=0,this.rn2a=0,this.rt1b=0,this.rn1b=0,this.rt1a=0,this.rn1a=0,this.jrAcc=0,this.rMass=0,this.Kc=0,this.Kb=0,this.Ka=0,this.kMassc=0,this.kMassb=0,this.kMassa=0,this.wrap_normal=null,this.ny=0,this.nx=0,this.innards=null,this.wrap_contacts=null,this.contacts=null,this.s2=null,this.s1=null,this.userdef_rfric=!1,this.userdef_restitution=!1,this.userdef_stat_fric=!1,this.userdef_dyn_fric=!1,this.rfric=0,this.restitution=0,this.stat_fric=0,this.dyn_fric=0,this.outer_zn=null,wp.call(this),this.pre_dt=-1,this.contacts=new Np,this.innards=new Pp,this.type=wp.COL,this.colarb=this};(n["zpp_nape.dynamics.ZPP_ColArbiter"]=Cp).__name__=["zpp_nape","dynamics","ZPP_ColArbiter"],Cp.__super__=wp,Cp.prototype=r(wp.prototype,{outer_zn:null,dyn_fric:null,stat_fric:null,restitution:null,rfric:null,userdef_dyn_fric:null,userdef_stat_fric:null,userdef_restitution:null,userdef_rfric:null,s1:null,s2:null,contacts:null,wrap_contacts:null,innards:null,nx:null,ny:null,normal_validate:function(){if(this.cleared)throw new $l("Error: Arbiter not currently in use");this.wrap_normal.zpp_inner.x=this.nx,this.wrap_normal.zpp_inner.y=this.ny,this.ws1.id>this.ws2.id&&(this.wrap_normal.zpp_inner.x=-this.wrap_normal.zpp_inner.x,this.wrap_normal.zpp_inner.y=-this.wrap_normal.zpp_inner.y)},wrap_normal:null,getnormal:function(){this.wrap_normal=d_.get(0,0),this.wrap_normal.zpp_inner._immutable=!0,this.wrap_normal.zpp_inner._inuse=!0,this.wrap_normal.zpp_inner._validate=yc(this,this.normal_validate)},kMassa:null,kMassb:null,kMassc:null,Ka:null,Kb:null,Kc:null,rMass:null,jrAcc:null,rn1a:null,rt1a:null,rn1b:null,rt1b:null,rn2a:null,rt2a:null,rn2b:null,rt2b:null,k1x:null,k1y:null,k2x:null,k2y:null,surfacex:null,surfacey:null,ptype:null,lnormx:null,lnormy:null,lproj:null,radius:null,rev:null,biasCoef:null,__ref_edge1:null,__ref_edge2:null,__ref_vertex:null,c1:null,oc1:null,c2:null,oc2:null,hc2:null,hpc2:null,next:null,alloc:function(){},free:function(){this.userdef_dyn_fric=!1,this.userdef_stat_fric=!1,this.userdef_restitution=!1,this.userdef_rfric=!1,this.__ref_edge1=this.__ref_edge2=null},stat:null,injectContact:function(e,t,n,i,r,a,s){null==s&&(s=!1);for(var l=null,o=this.contacts.begin();null!=o;){var _=o.elem();if(a==_.hash){l=_;break}o=o.next}if(null==l){null==Np.zpp_pool?l=new Np:(l=Np.zpp_pool,Np.zpp_pool=l.next,l.next=null),l.alloc();var p=l.inner;p.jnAcc=p.jtAcc=0,l.hash=a,l.fresh=!0,(l.arbiter=this).jrAcc=0,this.contacts.inlined_add(l),this.innards.add(p)}else l.fresh=!1;return l.px=e,l.py=t,this.nx=n,this.ny=i,l.dist=r,l.stamp=this.stamp,l.posOnly=s,l},assign:function(e,t,n,i){this.sup_assign(e,t,n,i),this.s1=e,this.s2=t,this.calcProperties()},calcProperties:function(){this.userdef_restitution||(this.s1.material.elasticity<=X_.NEGINF()||this.s2.material.elasticity<=X_.NEGINF()?this.restitution=0:this.s1.material.elasticity>=X_.POSINF()||this.s2.material.elasticity>=X_.POSINF()?this.restitution=1:this.restitution=(this.s1.material.elasticity+this.s2.material.elasticity)/2,this.restitution<0&&(this.restitution=0),1<this.restitution&&(this.restitution=1)),this.userdef_dyn_fric||(this.dyn_fric=oc.sqrt(this.s1.material.dynamicFriction*this.s2.material.dynamicFriction)),this.userdef_stat_fric||(this.stat_fric=oc.sqrt(this.s1.material.staticFriction*this.s2.material.staticFriction)),this.userdef_rfric||(this.rfric=oc.sqrt(this.s1.material.rollingFriction*this.s2.material.rollingFriction))},validate_props:function(){this.invalidated&&(this.invalidated=!1,this.calcProperties())},retire:function(){for(this.sup_retire();!this.contacts.empty();){var e=this.contacts.inlined_pop_unsafe();e.free(),e.next=Np.zpp_pool,Np.zpp_pool=e,this.innards.inlined_pop()}this.free(),this.next=Cp.zpp_pool,(Cp.zpp_pool=this).pre_dt=-1},mutable:null,makemutable:function(){this.mutable=!0,null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!1),null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!1)},makeimmutable:function(){this.mutable=!1,null!=this.wrap_normal&&(this.wrap_normal.zpp_inner._immutable=!0),null!=this.wrap_contacts&&(this.wrap_contacts.zpp_inner.immutable=!0)},contacts_adder:function(e){return!1},contacts_subber:function(e){for(var t=null,n=null,i=this.innards.begin(),r=this.contacts.begin();null!=r;){var a=r.elem();if(a==e.zpp_inner){this.contacts.erase(t),this.innards.erase(n);var s=a;s.free(),s.next=Np.zpp_pool,Np.zpp_pool=s;break}t=r,i=(n=i).next,r=r.next}},setupcontacts:function(){this.wrap_contacts=lc.get(this.contacts,!0),this.wrap_contacts.zpp_inner.immutable=!this.mutable,this.wrap_contacts.zpp_inner.adder=yc(this,this.contacts_adder),this.wrap_contacts.zpp_inner.dontremove=!0,this.wrap_contacts.zpp_inner.subber=yc(this,this.contacts_subber)},cleanupContacts:function(){var e=!0,t=null,n=null,i=this.innards.begin();this.hc2=!1;for(var r=this.contacts.begin();null!=r;){var a=r.elem();if(a.stamp+lo.arbiterExpirationDelay<this.stamp){r=this.contacts.inlined_erase(t),i=this.innards.inlined_erase(n);var s=a;s.free(),s.next=Np.zpp_pool,Np.zpp_pool=s}else{var l=a.inner,o=a.active;a.active=a.stamp==this.stamp,a.active&&(e?(e=!1,this.c1=l,this.oc1=a):(this.hc2=!0,this.c2=l,this.oc2=a)),o!=a.active&&(this.contacts.modified=!0),t=r,i=(n=i).next,r=r.next}}if(this.hc2){if(this.hpc2=!0,this.oc1.posOnly){var _=this.c1;this.c1=this.c2,this.c2=_;var p=this.oc1;this.oc1=this.oc2,this.oc2=p,this.hc2=!1}else this.oc2.posOnly&&(this.hc2=!1);this.oc1.posOnly&&(e=!0)}else this.hpc2=!1;return e},pre_dt:null,preStep:function(e){this.validate_props(),-1==this.pre_dt&&(this.pre_dt=e);var t=e/this.pre_dt;this.pre_dt=e;var n=this.b1.smass+this.b2.smass,i=!(this.hc2=!1),r=this.b1.isDynamic()&&this.b2.isDynamic()?this.continuous?lo.contactContinuousBiasCoef:lo.contactBiasCoef:this.continuous?lo.contactContinuousStaticBiasCoef:lo.contactStaticBiasCoef;this.biasCoef=r,this.continuous=!1;for(var a=null,s=null,l=this.innards.begin(),o=this.contacts.begin();null!=o;){var _=o.elem();if(_.stamp+lo.arbiterExpirationDelay<this.stamp){o=this.contacts.inlined_erase(a),l=this.innards.inlined_erase(s);var p=_;p.free(),p.next=Np.zpp_pool,Np.zpp_pool=p}else{var u=_.inner,h=_.active;if(_.active=_.stamp==this.stamp,_.active){i?(i=!1,this.c1=u,this.oc1=_):(this.hc2=!0,this.c2=u,this.oc2=_),u.r2x=_.px-this.b2.posx,u.r2y=_.py-this.b2.posy,u.r1x=_.px-this.b1.posx,u.r1y=_.py-this.b1.posy;var c=n+this.b2.sinertia*oc.sqr(u.r2x*this.nx+u.r2y*this.ny);c+=this.b1.sinertia*oc.sqr(u.r1x*this.nx+u.r1y*this.ny),u.tMass=c<lo.epsilon*lo.epsilon?0:1/c;var d=n+this.b2.sinertia*oc.sqr(this.ny*u.r2x-this.nx*u.r2y);d+=this.b1.sinertia*oc.sqr(this.ny*u.r1x-this.nx*u.r1y),u.nMass=d<lo.epsilon*lo.epsilon?0:1/d;var m=0,f=0,g=this.b2.angvel+this.b2.kinangvel;m=this.b2.velx+this.b2.kinvelx-u.r2y*g,f=this.b2.vely+this.b2.kinvely+u.r2x*g,g=this.b1.angvel+this.b1.kinangvel,m-=this.b1.velx+this.b1.kinvelx-u.r1y*g,f-=this.b1.vely+this.b1.kinvely+u.r1x*g;var v=this.nx*m+this.ny*f;_.elasticity=this.restitution,u.bounce=v*_.elasticity,u.bounce>-lo.elasticThreshold&&(u.bounce=0),v=f*this.nx-m*this.ny;var b=lo.staticFrictionThreshold;u.friction=b*b<v*v?this.dyn_fric:this.stat_fric,u.jnAcc*=t,u.jtAcc*=t}h!=_.active&&(this.contacts.modified=!0),a=o,l=(s=l).next,o=o.next}}if(this.hc2){if(this.hpc2=!0,this.oc1.posOnly){var y=this.c1;this.c1=this.c2,this.c2=y;var x=this.oc1;this.oc1=this.oc2,this.oc2=x,this.hc2=!1}else this.oc2.posOnly&&(this.hc2=!1);this.oc1.posOnly&&(i=!0)}else this.hpc2=!1;if(this.jrAcc*=t,i||(this.rn1a=this.ny*this.c1.r1x-this.nx*this.c1.r1y,this.rt1a=this.c1.r1x*this.nx+this.c1.r1y*this.ny,this.rn1b=this.ny*this.c1.r2x-this.nx*this.c1.r2y,this.rt1b=this.c1.r2x*this.nx+this.c1.r2y*this.ny,this.k1x=this.b2.kinvelx-this.c1.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c1.r1y*this.b1.kinangvel),this.k1y=this.b2.kinvely+this.c1.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c1.r1x*this.b1.kinangvel)),this.hc2)if(this.rn2a=this.ny*this.c2.r1x-this.nx*this.c2.r1y,this.rt2a=this.c2.r1x*this.nx+this.c2.r1y*this.ny,this.rn2b=this.ny*this.c2.r2x-this.nx*this.c2.r2y,this.rt2b=this.c2.r2x*this.nx+this.c2.r2y*this.ny,this.k2x=this.b2.kinvelx-this.c2.r2y*this.b2.kinangvel-(this.b1.kinvelx-this.c2.r1y*this.b1.kinangvel),this.k2y=this.b2.kinvely+this.c2.r2x*this.b2.kinangvel-(this.b1.kinvely+this.c2.r1x*this.b1.kinangvel),this.kMassa=n+this.b1.sinertia*this.rn1a*this.rn1a+this.b2.sinertia*this.rn1b*this.rn1b,this.kMassb=n+this.b1.sinertia*this.rn1a*this.rn2a+this.b2.sinertia*this.rn1b*this.rn2b,this.kMassc=n+this.b1.sinertia*this.rn2a*this.rn2a+this.b2.sinertia*this.rn2b*this.rn2b,this.kMassa*this.kMassa+2*this.kMassb*this.kMassb+this.kMassc*this.kMassc<lo.illConditionedThreshold*(this.kMassa*this.kMassc-this.kMassb*this.kMassb)){this.Ka=this.kMassa,this.Kb=this.kMassb,this.Kc=this.kMassc;var z=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(z!=z)this.kMassa=this.kMassb=this.kMassc=0;else if(0==z)0!=this.kMassa?this.kMassa=1/this.kMassa:this.kMassa=0,0!=this.kMassc?this.kMassc=1/this.kMassc:this.kMassc=0,this.kMassb=0;else{z=1/z;var w=this.kMassc*z;this.kMassc=this.kMassa*z,this.kMassa=w,this.kMassb*=-z}}else{if(this.hc2=!1,this.oc2.dist<this.oc1.dist){var k=this.c1;this.c1=this.c2,this.c2=k}this.oc2.active=!1,this.contacts.modified=!0}return this.surfacex=this.b2.svelx,this.surfacey=this.b2.svely,this.surfacex+=1*this.b1.svelx,this.surfacey+=1*this.b1.svely,this.surfacex=-this.surfacex,this.surfacey=-this.surfacey,this.rMass=this.b1.sinertia+this.b2.sinertia,0!=this.rMass&&(this.rMass=1/this.rMass),i},warmStart:function(){var e=this.nx*this.c1.jnAcc-this.ny*this.c1.jtAcc,t=this.ny*this.c1.jnAcc+this.nx*this.c1.jtAcc,n=this.b1.imass;this.b1.velx-=e*n,this.b1.vely-=t*n,this.b1.angvel-=this.b1.iinertia*(t*this.c1.r1x-e*this.c1.r1y);var i=this.b2.imass;if(this.b2.velx+=e*i,this.b2.vely+=t*i,this.b2.angvel+=this.b2.iinertia*(t*this.c1.r2x-e*this.c1.r2y),this.hc2){var r=this.nx*this.c2.jnAcc-this.ny*this.c2.jtAcc,a=this.ny*this.c2.jnAcc+this.nx*this.c2.jtAcc,s=this.b1.imass;this.b1.velx-=r*s,this.b1.vely-=a*s,this.b1.angvel-=this.b1.iinertia*(a*this.c2.r1x-r*this.c2.r1y);var l=this.b2.imass;this.b2.velx+=r*l,this.b2.vely+=a*l,this.b2.angvel+=this.b2.iinertia*(a*this.c2.r2x-r*this.c2.r2y)}this.b2.angvel+=this.jrAcc*this.b2.iinertia,this.b1.angvel-=this.jrAcc*this.b1.iinertia},applyImpulseVel:function(){var e,t,n,i,r,a,s=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),l=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel);if(n=(l*this.nx-s*this.ny+this.surfacex)*this.c1.tMass,(i=this.c1.friction*this.c1.jnAcc)<(a=(r=this.c1.jtAcc)-n)?a=i:a<-i&&(a=-i),n=a-r,this.c1.jtAcc=a,e=-this.ny*n,t=this.nx*n,this.b2.velx+=e*this.b2.imass,this.b2.vely+=t*this.b2.imass,this.b1.velx-=e*this.b1.imass,this.b1.vely-=t*this.b1.imass,this.b2.angvel+=this.rt1b*n*this.b2.iinertia,this.b1.angvel-=this.rt1a*n*this.b1.iinertia,this.hc2){var o=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),_=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel);n=(_*this.nx-o*this.ny+this.surfacex)*this.c2.tMass,(i=this.c2.friction*this.c2.jnAcc)<(a=(r=this.c2.jtAcc)-n)?a=i:a<-i&&(a=-i),n=a-r,this.c2.jtAcc=a,e=-this.ny*n,t=this.nx*n,this.b2.velx+=e*this.b2.imass,this.b2.vely+=t*this.b2.imass,this.b1.velx-=e*this.b1.imass,this.b1.vely-=t*this.b1.imass,this.b2.angvel+=this.rt2b*n*this.b2.iinertia,this.b1.angvel-=this.rt2a*n*this.b1.iinertia,s=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),l=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),o=this.k2x+this.b2.velx-this.c2.r2y*this.b2.angvel-(this.b1.velx-this.c2.r1y*this.b1.angvel),_=this.k2y+this.b2.vely+this.c2.r2x*this.b2.angvel-(this.b1.vely+this.c2.r1x*this.b1.angvel);var p=this.c1.jnAcc,u=this.c2.jnAcc,h=s*this.nx+l*this.ny+this.surfacey+this.c1.bounce-(this.Ka*p+this.Kb*u),c=o*this.nx+_*this.ny+this.surfacey+this.c2.bounce-(this.Kb*p+this.Kc*u),d=-(this.kMassa*h+this.kMassb*c),m=-(this.kMassb*h+this.kMassc*c);0<=d&&0<=m?(h=d-p,c=m-u,this.c1.jnAcc=d,this.c2.jnAcc=m):0<=(d=-this.c1.nMass*h)&&0<=this.Kb*d+c?(h=d-p,c=-u,this.c1.jnAcc=d,this.c2.jnAcc=0):0<=(m=-this.c2.nMass*c)&&0<=this.Kb*m+h?(h=-p,c=m-u,this.c1.jnAcc=0,this.c2.jnAcc=m):0<=h&&0<=c?(h=-p,c=-u,this.c1.jnAcc=this.c2.jnAcc=0):c=h=0,n=h+c,e=this.nx*n,t=this.ny*n,this.b2.velx+=e*this.b2.imass,this.b2.vely+=t*this.b2.imass,this.b1.velx-=e*this.b1.imass,this.b1.vely-=t*this.b1.imass,this.b2.angvel+=(this.rn1b*h+this.rn2b*c)*this.b2.iinertia,this.b1.angvel-=(this.rn1a*h+this.rn2a*c)*this.b1.iinertia}else 0!=this.radius&&(n=(this.b2.angvel-this.b1.angvel)*this.rMass,i=this.rfric*this.c1.jnAcc,r=this.jrAcc,this.jrAcc-=n,this.jrAcc>i?this.jrAcc=i:this.jrAcc<-i&&(this.jrAcc=-i),n=this.jrAcc-r,this.b2.angvel+=n*this.b2.iinertia,this.b1.angvel-=n*this.b1.iinertia),s=this.k1x+this.b2.velx-this.c1.r2y*this.b2.angvel-(this.b1.velx-this.c1.r1y*this.b1.angvel),l=this.k1y+this.b2.vely+this.c1.r2x*this.b2.angvel-(this.b1.vely+this.c1.r1x*this.b1.angvel),n=(this.c1.bounce+(this.nx*s+this.ny*l)+this.surfacey)*this.c1.nMass,(a=(r=this.c1.jnAcc)-n)<0&&(a=0),n=a-r,this.c1.jnAcc=a,e=this.nx*n,t=this.ny*n,this.b2.velx+=e*this.b2.imass,this.b2.vely+=t*this.b2.imass,this.b1.velx-=e*this.b1.imass,this.b1.vely-=t*this.b1.imass,this.b2.angvel+=this.rn1b*n*this.b2.iinertia,this.b1.angvel-=this.rn1a*n*this.b1.iinertia},applyImpulsePos:function(){if(2==this.ptype){var e=this.c1,t=0,n=0;t=this.b2.axisy*e.lr2x-this.b2.axisx*e.lr2y,n=e.lr2x*this.b2.axisx+e.lr2y*this.b2.axisy,t+=1*this.b2.posx,n+=1*this.b2.posy;var i=0,r=0;i=this.b1.axisy*e.lr1x-this.b1.axisx*e.lr1y,r=e.lr1x*this.b1.axisx+e.lr1y*this.b1.axisy;var a=0,s=0;a=t-(i+=1*this.b1.posx),s=n-(r+=1*this.b1.posy);var l=oc.sqrt(a*a+s*s),o=this.radius-lo.collisionSlop,_=l-o;if(a*this.nx+s*this.ny<0&&(a=-a,s=-s,_-=this.radius),_<0)if(l<lo.epsilon)0!=this.b1.smass?this.b1.posx+=10*lo.epsilon:this.b2.posx+=10*lo.epsilon;else{var p=1/l;a*=p;var u=.5*(i+t),h=.5*(r+n),c=l-o,d=(s*=p)*(i=u-this.b1.posx)-a*(r=h-this.b1.posy),m=s*(t=u-this.b2.posx)-a*(n=h-this.b2.posy),f=this.b2.smass+m*m*this.b2.sinertia+this.b1.smass+d*d*this.b1.sinertia;if(0!=f){var g,v,b=-this.biasCoef*c/f;g=a*b,v=s*b;var y=this.b1.imass;this.b1.posx-=g*y,this.b1.posy-=v*y,this.b1.delta_rot(-d*this.b1.iinertia*b);var x=this.b2.imass;this.b2.posx+=g*x,this.b2.posy+=v*x,this.b2.delta_rot(m*this.b2.iinertia*b)}}}else{var z,w=0,k=0,S=0,C=0,N=0,P=0;0==this.ptype?(w=this.b1.axisy*this.lnormx-this.b1.axisx*this.lnormy,k=this.lnormx*this.b1.axisx+this.lnormy*this.b1.axisy,z=this.lproj+(w*this.b1.posx+k*this.b1.posy),S=this.b2.axisy*this.c1.lr1x-this.b2.axisx*this.c1.lr1y,C=this.c1.lr1x*this.b2.axisx+this.c1.lr1y*this.b2.axisy,S+=1*this.b2.posx,C+=1*this.b2.posy,this.hpc2&&(N=this.b2.axisy*this.c2.lr1x-this.b2.axisx*this.c2.lr1y,P=this.c2.lr1x*this.b2.axisx+this.c2.lr1y*this.b2.axisy,N+=1*this.b2.posx,P+=1*this.b2.posy)):(w=this.b2.axisy*this.lnormx-this.b2.axisx*this.lnormy,k=this.lnormx*this.b2.axisx+this.lnormy*this.b2.axisy,z=this.lproj+(w*this.b2.posx+k*this.b2.posy),S=this.b1.axisy*this.c1.lr1x-this.b1.axisx*this.c1.lr1y,C=this.c1.lr1x*this.b1.axisx+this.c1.lr1y*this.b1.axisy,S+=1*this.b1.posx,C+=1*this.b1.posy,this.hpc2&&(N=this.b1.axisy*this.c2.lr1x-this.b1.axisx*this.c2.lr1y,P=this.c2.lr1x*this.b1.axisx+this.c2.lr1y*this.b1.axisy,N+=1*this.b1.posx,P+=1*this.b1.posy));var M=S*w+C*k-z-this.radius;M+=lo.collisionSlop;var I,A,T,D,E=0;if(this.hpc2&&(E=N*w+P*k-z-this.radius,E+=lo.collisionSlop),M<0||E<0)if(this.rev&&(w=-w,k=-k),I=S-this.b1.posx,A=C-this.b1.posy,T=S-this.b2.posx,D=C-this.b2.posy,this.hpc2){var O,B,L,j=k*I-w*A,F=k*T-w*D,R=k*(N-this.b1.posx)-w*(P-this.b1.posy),G=k*(N-this.b2.posx)-w*(P-this.b2.posy),Z=this.b1.smass+this.b2.smass;this.kMassa=Z+this.b1.sinertia*j*j+this.b2.sinertia*F*F,this.kMassb=Z+this.b1.sinertia*j*R+this.b2.sinertia*F*G,this.kMassc=Z+this.b1.sinertia*R*R+this.b2.sinertia*G*G,O=this.kMassa,B=this.kMassb,L=this.kMassc;for(var U=M*this.biasCoef,V=E*this.biasCoef;;){var q=0,W=0;q=-(q=U),W=-(W=V);var X=this.kMassa*this.kMassc-this.kMassb*this.kMassb;if(X!=X)q=W=0;else if(0==X)0!=this.kMassa?q/=this.kMassa:q=0,0!=this.kMassc?W/=this.kMassc:W=0;else{var H=(X=1/X)*(this.kMassc*q-this.kMassb*W);W=X*(this.kMassa*W-this.kMassb*q),q=H}if(0<=q&&0<=W){var Y=(q+W)*this.b1.imass;this.b1.posx-=w*Y,this.b1.posy-=k*Y,this.b1.delta_rot(-this.b1.iinertia*(j*q+R*W));var J=(q+W)*this.b2.imass;this.b2.posx+=w*J,this.b2.posy+=k*J,this.b2.delta_rot(this.b2.iinertia*(F*q+G*W));break}if((W=0)<=(q=-U/O)&&0<=B*q+V){var K=(q+W)*this.b1.imass;this.b1.posx-=w*K,this.b1.posy-=k*K,this.b1.delta_rot(-this.b1.iinertia*(j*q+R*W));var Q=(q+W)*this.b2.imass;this.b2.posx+=w*Q,this.b2.posy+=k*Q,this.b2.delta_rot(this.b2.iinertia*(F*q+G*W));break}if((q=0)<=(W=-V/L)&&0<=B*W+U){var $=(q+W)*this.b1.imass;this.b1.posx-=w*$,this.b1.posy-=k*$,this.b1.delta_rot(-this.b1.iinertia*(j*q+R*W));var ee=(q+W)*this.b2.imass;this.b2.posx+=w*ee,this.b2.posy+=k*ee,this.b2.delta_rot(this.b2.iinertia*(F*q+G*W));break}break}}else{var te=k*I-w*A,ne=k*T-w*D,ie=this.b2.smass+ne*ne*this.b2.sinertia+this.b1.smass+te*te*this.b1.sinertia;if(0!=ie){var re,ae,se=-this.biasCoef*M/ie;re=w*se,ae=k*se;var le=this.b1.imass;this.b1.posx-=re*le,this.b1.posy-=ae*le,this.b1.delta_rot(-te*this.b1.iinertia*se);var oe=this.b2.imass;this.b2.posx+=re*oe,this.b2.posy+=ae*oe,this.b2.delta_rot(ne*this.b2.iinertia*se)}}}},__class__:Cp});var Np=function(){this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.elasticity=0,this.dist=0,this.fresh=!1,this.hash=0,this.stamp=0,this.posOnly=!1,this.active=!1,this.inner=null,this.arbiter=null,this.wrap_position=null,this.py=0,this.px=0,this.outer=null,this.inner=new Pp};(n["zpp_nape.dynamics.ZPP_Contact"]=Np).__name__=["zpp_nape","dynamics","ZPP_Contact"],Np.prototype={outer:null,wrapper:function(){return null==this.outer&&(Np.internal=!0,this.outer=new qo,Np.internal=!1,this.outer.zpp_inner=this),this.outer},px:null,py:null,position_validate:function(){this.wrap_position.zpp_inner.x=this.px,this.wrap_position.zpp_inner.y=this.py},wrap_position:null,getposition:function(){this.wrap_position=d_.get(),this.wrap_position.zpp_inner._inuse=!0,this.wrap_position.zpp_inner._immutable=!0,this.wrap_position.zpp_inner._validate=yc(this,this.position_validate)},inactiveme:function(){return!(this.active&&null!=this.arbiter&&!this.arbiter.inactiveme())},arbiter:null,inner:null,active:null,posOnly:null,stamp:null,hash:null,fresh:null,dist:null,elasticity:null,free:function(){this.arbiter=null},alloc:function(){},next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Np};var Pp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.lr2y=0,this.lr2x=0,this.lr1y=0,this.lr1x=0,this.jtAcc=0,this.jnAcc=0,this.friction=0,this.bounce=0,this.tMass=0,this.nMass=0,this.r2y=0,this.r2x=0,this.r1y=0,this.r1x=0};(n["zpp_nape.dynamics.ZPP_IContact"]=Pp).__name__=["zpp_nape","dynamics","ZPP_IContact"],Pp.prototype={r1x:null,r1y:null,r2x:null,r2y:null,nMass:null,tMass:null,bounce:null,friction:null,jnAcc:null,jtAcc:null,lr1x:null,lr1y:null,lr2x:null,lr2y:null,next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Pp};var Mp=function(){this.depth=0,this.wrap_interactors=null,this.interactors=null,this.wrap_groups=null,this.groups=null,this.group=null,this.ignore=!1,this.outer=null,this.depth=0,this.groups=new nh,this.interactors=new np};(n["zpp_nape.dynamics.ZPP_InteractionGroup"]=Mp).__name__=["zpp_nape","dynamics","ZPP_InteractionGroup"],Mp.prototype={outer:null,ignore:null,group:null,setGroup:function(e){this.group!=e&&(null!=this.group&&(this.group.remGroup(this),this.group.invalidate(!0)),null!=(this.group=e)?(e.addGroup(this),e.invalidate(!0)):this.invalidate(!0))},groups:null,wrap_groups:null,interactors:null,wrap_interactors:null,depth:null,invalidate:function(e){if(null==e&&(e=!1),e||this.ignore){for(var t=this.interactors.begin();null!=t;){var n=t.elem();n.isBody()?n.ibody.wake():n.isShape()?n.ishape.body.wake():n.icompound.wake(),t=t.next}for(var i=this.groups.begin();null!=i;)i.elem().invalidate(e),i=i.next}},addGroup:function(e){this.groups.add(e),e.depth=this.depth+1},remGroup:function(e){this.groups.remove(e),e.depth=0},addInteractor:function(e){this.interactors.add(e)},remInteractor:function(e,t){null==t&&(t=-1),this.interactors.remove(e)},__class__:Mp};var Ip=function(){this.at_index_3=0,this.at_index_2=0,this.at_index_1=0,this.at_index_0=0,this.ite_3=null,this.ite_2=null,this.ite_1=null,this.ite_0=null,this.lengths=null,this.zip_length=!1,this._length=0,this.space=null,Zo.call(this),this.at_index_0=0,this.at_index_1=0,this.at_index_2=0,this.at_index_3=0,this.zip_length=!0,this._length=0,this.lengths=[];for(var e=0;e<4;)e++,this.lengths.push(0)};(n["zpp_nape.dynamics.ZPP_SpaceArbiterList"]=Ip).__name__=["zpp_nape","dynamics","ZPP_SpaceArbiterList"],Ip.__super__=Zo,Ip.prototype=r(Zo.prototype,{space:null,_length:null,zip_length:null,zpp_gl:function(){if(this.zpp_vm(),this.zip_length){for(var e=this._length=0,t=0,n=this.space.c_arbiters_true.begin();null!=n;)n.elem().active&&++t,n=n.next;this.lengths[e++]=t,this._length+=t;for(var i=0,r=this.space.c_arbiters_false.begin();null!=r;)r.elem().active&&++i,r=r.next;this.lengths[e++]=i,this._length+=i;for(var a=0,s=this.space.f_arbiters.begin();null!=s;)s.elem().active&&++a,s=s.next;this.lengths[e++]=a,this._length+=a;for(var l=0,o=this.space.s_arbiters.begin();null!=o;)o.elem().active&&++l,o=o.next;this.lengths[e++]=l,this._length+=l,this.zip_length=!1}return this._length},lengths:null,ite_0:null,ite_1:null,ite_2:null,ite_3:null,at_index_0:null,at_index_1:null,at_index_2:null,at_index_3:null,zpp_vm:function(){var e=!1;this.space.c_arbiters_true.modified&&(e=!0,this.space.c_arbiters_true.modified=!1),this.space.c_arbiters_false.modified&&(e=!0,this.space.c_arbiters_false.modified=!1),this.space.f_arbiters.modified&&(e=!0,this.space.f_arbiters.modified=!1),this.space.s_arbiters.modified&&(e=!0,this.space.s_arbiters.modified=!1),e&&(this.zip_length=!0,this._length=0,this.ite_0=null,this.ite_1=null,this.ite_2=null,this.ite_3=null)},push:function(e){return!1},pop:function(){return null},unshift:function(e){return!1},shift:function(){return null},remove:function(e){return!1},clear:function(){},at:function(e){this.zpp_vm();var t=null,n=0;if(null==t)if(e<n+this.lengths[0]){var i=e-n;if(i<this.at_index_0||null==this.ite_0)for(this.at_index_0=0,this.ite_0=this.space.c_arbiters_true.begin();!this.ite_0.elem().active;)this.ite_0=this.ite_0.next;for(;this.at_index_0!=i;)for(this.at_index_0++,this.ite_0=this.ite_0.next;!this.ite_0.elem().active;)this.ite_0=this.ite_0.next;t=this.ite_0.elem().wrapper()}else n+=this.lengths[0];if(null==t)if(e<n+this.lengths[1]){var r=e-n;if(r<this.at_index_1||null==this.ite_1)for(this.at_index_1=0,this.ite_1=this.space.c_arbiters_false.begin();!this.ite_1.elem().active;)this.ite_1=this.ite_1.next;for(;this.at_index_1!=r;)for(this.at_index_1++,this.ite_1=this.ite_1.next;!this.ite_1.elem().active;)this.ite_1=this.ite_1.next;t=this.ite_1.elem().wrapper()}else n+=this.lengths[1];if(null==t)if(e<n+this.lengths[2]){var a=e-n;if(a<this.at_index_2||null==this.ite_2)for(this.at_index_2=0,this.ite_2=this.space.f_arbiters.begin();!this.ite_2.elem().active;)this.ite_2=this.ite_2.next;for(;this.at_index_2!=a;)for(this.at_index_2++,this.ite_2=this.ite_2.next;!this.ite_2.elem().active;)this.ite_2=this.ite_2.next;t=this.ite_2.elem().wrapper()}else n+=this.lengths[2];if(null==t)if(e<n+this.lengths[3]){var s=e-n;if(s<this.at_index_3||null==this.ite_3)for(this.at_index_3=0,this.ite_3=this.space.s_arbiters.begin();!this.ite_3.elem().active;)this.ite_3=this.ite_3.next;for(;this.at_index_3!=s;)for(this.at_index_3++,this.ite_3=this.ite_3.next;!this.ite_3.elem().active;)this.ite_3=this.ite_3.next;t=this.ite_3.elem().wrapper()}else n+=this.lengths[3];return t},__class__:Ip});var Ap=function(){this.wrap_max=null,this.maxy=0,this.maxx=0,this.wrap_min=null,this.miny=0,this.minx=0,this.next=null,this.outer=null,this._immutable=!1,this._validate=null,this._invalidate=null};(n["zpp_nape.geom.ZPP_AABB"]=Ap).__name__=["zpp_nape","geom","ZPP_AABB"],Ap.get=function(e,t,n,i){var r;return null==Ap.zpp_pool?r=new Ap:(r=Ap.zpp_pool,Ap.zpp_pool=r.next,r.next=null),r.alloc(),r.minx=e,r.miny=t,r.maxx=n,r.maxy=i,r},Ap.prototype={_invalidate:null,_validate:null,_immutable:null,validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},outer:null,wrapper:function(){if(null==this.outer){this.outer=new Qo;var e=this.outer.zpp_inner;e.free(),e.next=Ap.zpp_pool,Ap.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},next:null,alloc:function(){},free:function(){null!=this.outer&&(this.outer.zpp_inner=null,this.outer=null),this.wrap_min=this.wrap_max=null,this._invalidate=null,this._validate=null},copy:function(){return Ap.get(this.minx,this.miny,this.maxx,this.maxy)},width:function(){return this.maxx-this.minx},height:function(){return this.maxy-this.miny},perimeter:function(){return 2*(this.width()+this.height())},minx:null,miny:null,wrap_min:null,getmin:function(){return null==this.wrap_min&&(this.wrap_min=d_.get(this.minx,this.miny),this.wrap_min.zpp_inner._inuse=!0,this._immutable?this.wrap_min.zpp_inner._immutable=!0:this.wrap_min.zpp_inner._invalidate=yc(this,this.mod_min),this.wrap_min.zpp_inner._validate=yc(this,this.dom_min)),this.wrap_min},dom_min:function(){this.validate(),this.wrap_min.zpp_inner.x=this.minx,this.wrap_min.zpp_inner.y=this.miny},mod_min:function(e){e.x==this.minx&&e.y==this.miny||(this.minx=e.x,this.miny=e.y,this.invalidate())},maxx:null,maxy:null,wrap_max:null,getmax:function(){return null==this.wrap_max&&(this.wrap_max=d_.get(this.maxx,this.maxy),this.wrap_max.zpp_inner._inuse=!0,this._immutable?this.wrap_max.zpp_inner._immutable=!0:this.wrap_max.zpp_inner._invalidate=yc(this,this.mod_max),this.wrap_max.zpp_inner._validate=yc(this,this.dom_max)),this.wrap_max},dom_max:function(){this.validate(),this.wrap_max.zpp_inner.x=this.maxx,this.wrap_max.zpp_inner.y=this.maxy},mod_max:function(e){e.x==this.maxx&&e.y==this.maxy||(this.maxx=e.x,this.maxy=e.y,this.invalidate())},intersectX:function(e){return!(e.minx>this.maxx||this.minx>e.maxx)},intersectY:function(e){return!(e.miny>this.maxy||this.miny>e.maxy)},intersect:function(e){return e.miny<=this.maxy&&this.miny<=e.maxy&&e.minx<=this.maxx&&this.minx<=e.maxx},combine:function(e){e.minx<this.minx&&(this.minx=e.minx),e.maxx>this.maxx&&(this.maxx=e.maxx),e.miny<this.miny&&(this.miny=e.miny),e.maxy>this.maxy&&(this.maxy=e.maxy)},contains:function(e){return e.minx>=this.minx&&e.miny>=this.miny&&e.maxx<=this.maxx&&e.maxy<=this.maxy},containsPoint:function(e){return e.x>=this.minx&&e.x<=this.maxx&&e.y>=this.miny&&e.y<=this.maxy},setCombine:function(e,t){this.minx=e.minx<t.minx?e.minx:t.minx,this.miny=e.miny<t.miny?e.miny:t.miny,this.maxx=e.maxx>t.maxx?e.maxx:t.maxx,this.maxy=e.maxy>t.maxy?e.maxy:t.maxy},setExpand:function(e,t){this.minx=e.minx-t,this.miny=e.miny-t,this.maxx=e.maxx+t,this.maxy=e.maxy+t},setExpandPoint:function(e,t){e<this.minx&&(this.minx=e),e>this.maxx&&(this.maxx=e),t<this.miny&&(this.miny=t),t>this.maxy&&(this.maxy=t)},toString:function(){return"{ x: "+this.minx+" y: "+this.miny+" w: "+this.width()+" h: "+this.height()+" }"},__class__:Ap};var Tp=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Vec2"]=Tp).__name__=["zpp_nape","util","ZNPList_ZPP_Vec2"],Tp.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Eh.zpp_pool?t=new Eh:(t=Eh.zpp_pool,Eh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Eh.zpp_pool?n=new Eh:(n=Eh.zpp_pool,Eh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Eh.zpp_pool,Eh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Eh.zpp_pool,Eh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Tp};var Dp=function(){};(n["zpp_nape.geom.ZPP_Collide"]=Dp).__name__=["zpp_nape","geom","ZPP_Collide"],Dp.circleContains=function(e,t){var n,i;return(n=t.x-e.worldCOMx)*n+(i=t.y-e.worldCOMy)*i<e.radius*e.radius},Dp.polyContains=function(e,t){var n;n=!0;for(var i=e.edges.begin();null!=i;){var r=i.elem();if(!(r.gnormx*t.x+r.gnormy*t.y<=r.gprojection)){n=!1;break}i=i.next}return n},Dp.shapeContains=function(e,t){return e.isCircle()?Dp.circleContains(e.circle,t):Dp.polyContains(e.polygon,t)},Dp.bodyContains=function(e,t){var n;n=!1;for(var i=e.shapes.begin();null!=i;){var r=i.elem();if(Dp.shapeContains(r,t)){n=!0;break}i=i.next}return n},Dp.containTest=function(e,t){if(e.aabb.contains(t.aabb)){if(e.isCircle()){if(t.isCircle()){var n,i,r=e.circle.radius+-t.circle.radius;return(n=t.circle.worldCOMx-e.circle.worldCOMx)*n+(i=t.circle.worldCOMy-e.circle.worldCOMy)*i<=r*r}var a;a=!0;for(var s=t.polygon.gverts.begin();null!=s;){var l,o,_=s.elem(),p=e.circle.radius;if(!((l=_.x-e.circle.worldCOMx)*l+(o=_.y-e.circle.worldCOMy)*o<=p*p)){a=!1;break}s=s.next}return a}if(t.isCircle()){var u;u=!0;for(var h=e.polygon.edges.begin();null!=h;){var c=h.elem();if(!(c.gnormx*t.circle.worldCOMx+c.gnormy*t.circle.worldCOMy+t.circle.radius<=c.gprojection)){u=!1;break}h=h.next}return u}var d;d=!0;for(var m=e.polygon.edges.begin();null!=m;){for(var f=m.elem(),g=-X_.FMAX,v=t.polygon.gverts.begin();null!=v;){var b=v.elem(),y=f.gnormx*b.x+f.gnormy*b.y;g<y&&(g=y),v=v.next}if(!(g<=f.gprojection)){d=!1;break}m=m.next}return d}return!1},Dp.contactCollide=function(e,t,n,i){if(t.isPolygon()){if(e.isPolygon()){for(var r=!0,a=-X_.FMAX,s=(X_.FMAX,-1),l=null,o=null,_=e.polygon.edges.begin();null!=_;){for(var p=_.elem(),u=X_.FMAX,h=t.polygon.gverts.begin();null!=h;){var c=h.elem(),d=p.gnormx*c.x+p.gnormy*c.y;if(d<u&&(u=d),u-p.gprojection<=a)break;h=h.next}if(0<=(u-=p.gprojection)){r=!1;break}a<u&&(a=u,l=p,s=1),_=_.next}if(r){for(var m=t.polygon.edges.begin();null!=m;){for(var f=m.elem(),g=X_.FMAX,v=e.polygon.gverts.begin();null!=v;){var b=v.elem(),y=f.gnormx*b.x+f.gnormy*b.y;if(y<g&&(g=y),g-f.gprojection<=a)break;v=v.next}if(0<=(g-=f.gprojection)){r=!1;break}a<g&&(a=g,o=f,s=2),m=m.next}if(r){var x,z,w;w=1==s?(e.polygon,x=t.polygon,z=l,1):(t.polygon,x=e.polygon,z=o,-1);for(var k=null,S=X_.FMAX,C=x.edges.begin();null!=C;){var N=C.elem(),P=z.gnormx*N.gnormx+z.gnormy*N.gnormy;P<S&&(S=P,k=N),C=C.next}var M=0,I=0;M=k.gp0.x,I=k.gp0.y;var A,T,D=0,E=0;A=(D=k.gp1.x)-M,T=(E=k.gp1.y)-I;var O=z.gnormy*M-z.gnormx*I,B=z.gnormy*D-z.gnormx*E,L=1/(B-O),j=(-z.tp1-O)*L;lo.epsilon<j&&(M+=A*j,I+=T*j);var F=(-z.tp0-B)*L;F<-lo.epsilon&&(D+=A*F,E+=T*F);var R=0,G=0,Z=w;R=z.gnormx*Z,G=z.gnormy*Z,n.lnormx=z.lnormx,n.lnormy=z.lnormy,n.lproj=z.lprojection,n.radius=0,n.rev=i!=(-1==w),n.ptype=n.rev?1:0;var U=M*z.gnormx+I*z.gnormy-z.gprojection,V=D*z.gnormx+E*z.gnormy-z.gprojection;if(0<U&&0<V)return!1;i&&(R=-R,G=-G);var q=n.injectContact(M-z.gnormx*U*.5,I-z.gnormy*U*.5,R,G,U,n.rev?1:0,0<U);return M-=1*x.body.posx,I-=1*x.body.posy,q.inner.lr1x=M*x.body.axisy+I*x.body.axisx,q.inner.lr1y=I*x.body.axisy-M*x.body.axisx,q=n.injectContact(D-z.gnormx*V*.5,E-z.gnormy*V*.5,R,G,V,n.rev?0:1,0<V),D-=1*x.body.posx,E-=1*x.body.posy,q.inner.lr1x=D*x.body.axisy+E*x.body.axisx,q.inner.lr1y=E*x.body.axisy-D*x.body.axisx,1==s?(n.__ref_edge1=z,n.__ref_edge2=k):(n.__ref_edge2=z,n.__ref_edge1=k),!0}return!1}return!1}for(var W=-X_.FMAX,X=(X_.FMAX,!0),H=null,Y=null,J=t.polygon.gverts.begin(),K=t.polygon.edges.begin();null!=K;){var Q=K.elem(),$=Q.gnormx*e.circle.worldCOMx+Q.gnormy*e.circle.worldCOMy-Q.gprojection-e.circle.radius;if(0<$){X=!1;break}W<$&&(W=$,H=Q,Y=J),J=J.next,K=K.next}if(X){var ee=Y.elem(),te=null==Y.next?t.polygon.gverts.front():Y.next.elem(),ne=e.circle.worldCOMy*H.gnormx-e.circle.worldCOMx*H.gnormy;if(ne<=ee.y*H.gnormx-ee.x*H.gnormy){var ie,re,ae,se=e.circle.radius,le=(ie=ee.x-e.circle.worldCOMx)*ie+(re=ee.y-e.circle.worldCOMy)*re;if(se*se<le)ae=null;else if(le<lo.epsilon*lo.epsilon)ae=n.injectContact(e.circle.worldCOMx,e.circle.worldCOMy,1,0,-se,0);else{var oe=oc.invsqrt(le),_e=oe<lo.epsilon?X_.FMAX:1/oe,pe=.5+(e.circle.radius-.5*se)*oe;ae=i?n.injectContact(e.circle.worldCOMx+ie*pe,e.circle.worldCOMy+re*pe,-ie*oe,-re*oe,_e-se,0):n.injectContact(e.circle.worldCOMx+ie*pe,e.circle.worldCOMy+re*pe,ie*oe,re*oe,_e-se,0)}if(null!=ae){var ue,he,ce=ae.inner;n.ptype=2,ue=ee.x-t.polygon.body.posx,he=ee.y-t.polygon.body.posy,n.__ref_edge1=H,n.__ref_vertex=-1,i?(ce.lr1x=ue*t.polygon.body.axisy+he*t.polygon.body.axisx,ce.lr1y=he*t.polygon.body.axisy-ue*t.polygon.body.axisx,ce.lr2x=e.circle.localCOMx,ce.lr2y=e.circle.localCOMy):(ce.lr2x=ue*t.polygon.body.axisy+he*t.polygon.body.axisx,ce.lr2y=he*t.polygon.body.axisy-ue*t.polygon.body.axisx,ce.lr1x=e.circle.localCOMx,ce.lr1y=e.circle.localCOMy),n.radius=e.circle.radius}return null!=ae}if(ne>=te.y*H.gnormx-te.x*H.gnormy){var de,me,fe,ge=e.circle.radius,ve=(de=te.x-e.circle.worldCOMx)*de+(me=te.y-e.circle.worldCOMy)*me;if(ge*ge<ve)fe=null;else if(ve<lo.epsilon*lo.epsilon)fe=n.injectContact(e.circle.worldCOMx,e.circle.worldCOMy,1,0,-ge,0);else{var be=oc.invsqrt(ve),ye=be<lo.epsilon?X_.FMAX:1/be,xe=.5+(e.circle.radius-.5*ge)*be;fe=i?n.injectContact(e.circle.worldCOMx+de*xe,e.circle.worldCOMy+me*xe,-de*be,-me*be,ye-ge,0):n.injectContact(e.circle.worldCOMx+de*xe,e.circle.worldCOMy+me*xe,de*be,me*be,ye-ge,0)}if(null!=fe){var ze,we,ke=fe.inner;n.ptype=2,ze=te.x-t.polygon.body.posx,we=te.y-t.polygon.body.posy,n.__ref_edge1=H,n.__ref_vertex=1,i?(ke.lr1x=ze*t.polygon.body.axisy+we*t.polygon.body.axisx,ke.lr1y=we*t.polygon.body.axisy-ze*t.polygon.body.axisx,ke.lr2x=e.circle.localCOMx,ke.lr2y=e.circle.localCOMy):(ke.lr2x=ze*t.polygon.body.axisy+we*t.polygon.body.axisx,ke.lr2y=we*t.polygon.body.axisy-ze*t.polygon.body.axisx,ke.lr1x=e.circle.localCOMx,ke.lr1y=e.circle.localCOMy),n.radius=e.circle.radius}return null!=fe}var Se,Ce,Ne,Pe,Me=e.circle.radius+.5*W;Se=H.gnormx*Me,Ce=H.gnormy*Me,Ne=e.circle.worldCOMx-Se,Pe=e.circle.worldCOMy-Ce;var Ie=i?n.injectContact(Ne,Pe,H.gnormx,H.gnormy,W,0):n.injectContact(Ne,Pe,-H.gnormx,-H.gnormy,W,0);return n.ptype=i?0:1,n.lnormx=H.lnormx,n.lnormy=H.lnormy,n.rev=!i,n.lproj=H.lprojection,n.radius=e.circle.radius,Ie.inner.lr1x=e.circle.localCOMx,Ie.inner.lr1y=e.circle.localCOMy,n.__ref_edge1=H,!(n.__ref_vertex=0)}return!1}var Ae,Te,De,Ee=e.circle.radius+t.circle.radius,Oe=(Ae=t.circle.worldCOMx-e.circle.worldCOMx)*Ae+(Te=t.circle.worldCOMy-e.circle.worldCOMy)*Te;if(Ee*Ee<Oe)De=null;else if(Oe<lo.epsilon*lo.epsilon)De=n.injectContact(e.circle.worldCOMx,e.circle.worldCOMy,1,0,-Ee,0);else{var Be=oc.invsqrt(Oe),Le=Be<lo.epsilon?X_.FMAX:1/Be,je=.5+(e.circle.radius-.5*Ee)*Be;De=i?n.injectContact(e.circle.worldCOMx+Ae*je,e.circle.worldCOMy+Te*je,-Ae*Be,-Te*Be,Le-Ee,0):n.injectContact(e.circle.worldCOMx+Ae*je,e.circle.worldCOMy+Te*je,Ae*Be,Te*Be,Le-Ee,0)}if(null==De)return!1;var Fe=De.inner;return Fe.lr2y=i?(Fe.lr1x=t.circle.localCOMx,Fe.lr1y=t.circle.localCOMy,Fe.lr2x=e.circle.localCOMx,e.circle.localCOMy):(Fe.lr1x=e.circle.localCOMx,Fe.lr1y=e.circle.localCOMy,Fe.lr2x=t.circle.localCOMx,t.circle.localCOMy),n.radius=e.circle.radius+t.circle.radius,n.ptype=2,!0},Dp.testCollide_safe=function(e,t){if(t.isCircle()){var n=e;e=t,t=n}return Dp.testCollide(e,t)},Dp.testCollide=function(e,t){if(t.isPolygon()){if(e.isPolygon()){for(var n=!0,i=e.polygon.edges.begin();null!=i;){for(var r=i.elem(),a=X_.FMAX,s=t.polygon.gverts.begin();null!=s;){var l=s.elem(),o=r.gnormx*l.x+r.gnormy*l.y;o<a&&(a=o),s=s.next}if(0<(a-=r.gprojection)){n=!1;break}i=i.next}if(n){for(var _=t.polygon.edges.begin();null!=_;){for(var p=_.elem(),u=X_.FMAX,h=e.polygon.gverts.begin();null!=h;){var c=h.elem(),d=p.gnormx*c.x+p.gnormy*c.y;d<u&&(u=d),h=h.next}if(0<(u-=p.gprojection)){n=!1;break}_=_.next}return n}return!1}for(var m=null,f=null,g=!0,v=-X_.FMAX,b=t.polygon.gverts.begin(),y=t.polygon.edges.begin();null!=y;){var x=y.elem(),z=x.gnormx*e.circle.worldCOMx+x.gnormy*e.circle.worldCOMy-x.gprojection-e.circle.radius;if(0<z){g=!1;break}v<z&&(v=z,m=x,f=b),b=b.next,y=y.next}if(g){var w=f.elem(),k=null==f.next?t.polygon.gverts.front():f.next.elem(),S=e.circle.worldCOMy*m.gnormx-e.circle.worldCOMx*m.gnormy;if(S<=w.y*m.gnormx-w.x*m.gnormy){var C,N,P=e.circle.radius;return(C=w.x-e.circle.worldCOMx)*C+(N=w.y-e.circle.worldCOMy)*N<=P*P}if(S>=k.y*m.gnormx-k.x*m.gnormy){var M,I,A=e.circle.radius;return(M=k.x-e.circle.worldCOMx)*M+(I=k.y-e.circle.worldCOMy)*I<=A*A}return!0}return!1}var T,D,E=e.circle.radius+t.circle.radius;return(T=t.circle.worldCOMx-e.circle.worldCOMx)*T+(D=t.circle.worldCOMy-e.circle.worldCOMy)*D<=E*E},Dp.flowCollide=function(e,t,n){if(t.isPolygon()){if(e.isPolygon()){for(var i=[],r=[],a=!0,s=!0,l=e.polygon.edges.begin();null!=l;){for(var o=l.elem(),_=X_.FMAX,p=0,u=t.polygon.gverts.begin();null!=u;){var h=u.elem(),c=o.gnormx*h.x+o.gnormy*h.y;c<_&&(_=c),c>=o.gprojection+lo.epsilon&&(s=!(r[p]=!0)),++p,u=u.next}if(0<(_-=o.gprojection)){a=!1;break}l=l.next}if(s)return t.polygon.validate_worldCOM(),n.inject(t.polygon.area,t.polygon.worldCOMx,t.polygon.worldCOMy),!0;if(a){s=!0;for(var d=t.polygon.edges.begin();null!=d;){for(var m=d.elem(),f=X_.FMAX,g=0,v=e.polygon.gverts.begin();null!=v;){var b=v.elem(),y=m.gnormx*b.x+m.gnormy*b.y;y<f&&(f=y),y>=m.gprojection+lo.epsilon&&(s=!(i[g]=!0)),++g,v=v.next}if(0<(f-=m.gprojection)){a=!1;break}d=d.next}if(s)return e.polygon.validate_worldCOM(),n.inject(e.polygon.area,e.polygon.worldCOMx,e.polygon.worldCOMy),!0;if(a){for(;!Dp.flowpoly.empty();){var x=Dp.flowpoly.pop_unsafe();if(!x._inuse){var z=x;z.free(),z.next=pu.zpp_pool,pu.zpp_pool=z}}for(var w=null,k=!1,S=e.polygon.gverts.begin(),C=0,N=t.polygon.gverts.begin(),P=0,M=0,I=t.polygon.edgeCnt;M<I;){var A=M++;if(!r[A]){P=A;break}N=N.next}if(null==N){N=t.polygon.gverts.begin(),k=!0;for(var T=0,D=e.polygon.edgeCnt;T<D;){var E=T++;if(!i[E]){C=E;break}S=S.next}null==S?S=e.polygon.gverts.begin():(Dp.flowpoly.add(S.elem()),w=Dp.flowpoly.front())}else Dp.flowpoly.add(N.elem()),w=Dp.flowpoly.front();var O=1;if(Dp.flowpoly.empty()){for(var B=!0,L=e.polygon.gverts.begin(),j=L.elem(),F=L.next;null!=F;){for(var R=F.elem(),G=2,Z=t.polygon.gverts.begin(),U=Z.elem(),V=Z.next;null!=V;){var q,W,X,H,Y=V.elem(),J=0;q=j.x-U.x,W=j.y-U.y,X=R.x-j.x;var K,Q,$,ee=(H=R.y-j.y)*(K=Y.x-U.x)-X*(Q=Y.y-U.y);if(lo.epsilon*lo.epsilon<ee*ee){var te=(Q*q-K*W)*(ee=1/ee);if(lo.epsilon<te&&te<1-lo.epsilon){var ne=(H*q-X*W)*ee;$=lo.epsilon<ne&&ne<1-lo.epsilon&&(J=te,!0)}else $=!1}else $=!1;$&&J<G&&(G=J,N=Z),U=Y,V=(Z=V).next}for(;;){var ie,re,ae,se,le=(V=t.polygon.gverts.begin()).elem(),oe=0;ie=j.x-U.x,re=j.y-U.y,ae=R.x-j.x;var _e,pe,ue,he=(se=R.y-j.y)*(_e=le.x-U.x)-ae*(pe=le.y-U.y);if(lo.epsilon*lo.epsilon<he*he){var ce=(pe*ie-_e*re)*(he=1/he);if(lo.epsilon<ce&&ce<1-lo.epsilon){var de=(se*ie-ae*re)*he;ue=lo.epsilon<de&&de<1-lo.epsilon&&(oe=ce,!0)}else ue=!1}else ue=!1;ue&&oe<G&&(G=oe,N=Z);break}if(2!=G){var me,fe,ge=G;me=j.x+(R.x-j.x)*ge,fe=j.y+(R.y-j.y)*ge,w=pu.get(me,fe),Dp.flowpoly.add(w),S=L,B=!(k=!0);break}j=R,F=(L=F).next}if(B)for(;;){for(var ve=(F=e.polygon.gverts.begin()).elem(),be=2,ye=t.polygon.gverts.begin(),xe=ye.elem(),ze=ye.next;null!=ze;){var we,ke,Se,Ce,Ne=ze.elem(),Pe=0;we=j.x-xe.x,ke=j.y-xe.y,Se=ve.x-j.x;var Me,Ie,Ae,Te=(Ce=ve.y-j.y)*(Me=Ne.x-xe.x)-Se*(Ie=Ne.y-xe.y);if(lo.epsilon*lo.epsilon<Te*Te){var De=(Ie*we-Me*ke)*(Te=1/Te);if(lo.epsilon<De&&De<1-lo.epsilon){var Ee=(Ce*we-Se*ke)*Te;Ae=lo.epsilon<Ee&&Ee<1-lo.epsilon&&(Pe=De,!0)}else Ae=!1}else Ae=!1;Ae&&Pe<be&&(be=Pe,N=ye),xe=Ne,ze=(ye=ze).next}for(;;){var Oe,Be,Le,je,Fe=(ze=t.polygon.gverts.begin()).elem(),Re=0;Oe=j.x-xe.x,Be=j.y-xe.y,Le=ve.x-j.x;var Ge,Ze,Ue,Ve=(je=ve.y-j.y)*(Ge=Fe.x-xe.x)-Le*(Ze=Fe.y-xe.y);if(lo.epsilon*lo.epsilon<Ve*Ve){var qe=(Ze*Oe-Ge*Be)*(Ve=1/Ve);if(lo.epsilon<qe&&qe<1-lo.epsilon){var We=(je*Oe-Le*Be)*Ve;Ue=lo.epsilon<We&&We<1-lo.epsilon&&(Re=qe,!0)}else Ue=!1}else Ue=!1;Ue&&Re<be&&(be=Re,N=ye);break}if(2==be)break;var Xe,He,Ye=be;Xe=j.x+(ve.x-j.x)*Ye,He=j.y+(ve.y-j.y)*Ye,w=pu.get(Xe,He),Dp.flowpoly.add(w),k=!0,S=L;break}O=2}for(;;)if(k)if(++C,null==(S=S.next)&&(S=e.polygon.gverts.begin(),C=0),i[C]){var Je=Dp.flowpoly.front(),Ke=S.elem(),Qe=N.elem(),$e=N.next;null==$e&&($e=t.polygon.gverts.begin());for(var et=-1,tt=null,nt=0,it=0,rt=$e,at=$e;;){var st,lt,ot,_t,pt=at.elem(),ut=0;st=Qe.x-Je.x,lt=Qe.y-Je.y,ot=pt.x-Qe.x;var ht,ct,dt,mt=(_t=pt.y-Qe.y)*(ht=Ke.x-Je.x)-ot*(ct=Ke.y-Je.y);if(lo.epsilon*lo.epsilon<mt*mt){var ft=(ct*st-ht*lt)*(mt=1/mt);if(lo.epsilon<ft&&ft<1-lo.epsilon){var gt=(_t*st-ot*lt)*mt;dt=lo.epsilon<gt&&gt<1-lo.epsilon&&(ut=ft,!0)}else dt=!1}else dt=!1;if(dt&&et<=ut){if(tt=N,nt=P,++it==O){et=ut,at=rt;break}et=ut}Qe=pt,N=at,++P>=t.polygon.edgeCnt&&(P=0),null==(at=at.next)&&(at=t.polygon.gverts.begin());break}for(;at!=rt;){var vt,bt,yt,xt,zt=at.elem(),wt=0;vt=Qe.x-Je.x,bt=Qe.y-Je.y,yt=zt.x-Qe.x;var kt,St,Ct,Nt=(xt=zt.y-Qe.y)*(kt=Ke.x-Je.x)-yt*(St=Ke.y-Je.y);if(lo.epsilon*lo.epsilon<Nt*Nt){var Pt=(St*vt-kt*bt)*(Nt=1/Nt);if(lo.epsilon<Pt&&Pt<1-lo.epsilon){var Mt=(xt*vt-yt*bt)*Nt;Ct=lo.epsilon<Mt&&Mt<1-lo.epsilon&&(wt=Pt,!0)}else Ct=!1}else Ct=!1;if(Ct&&et<=wt){if(tt=N,nt=P,++it==O){et=wt,at=rt;break}et=wt}Qe=zt,N=at,++P>=t.polygon.edgeCnt&&(P=0),null==(at=at.next)&&(at=t.polygon.gverts.begin())}if(null==tt)break;var It=tt.elem(),At=tt.next;null==At&&(At=t.polygon.gverts.begin());var Tt,Dt,Et=At.elem(),Ot=et;if(Tt=It.x+(Et.x-It.x)*Ot,Dt=It.y+(Et.y-It.y)*Ot,null!=w&&hu.vec_dsq(Tt,Dt,w.x,w.y)<lo.epsilon)break;Dp.flowpoly.add(pu.get(Tt,Dt)),null==w&&(w=Dp.flowpoly.front()),N=tt,P=nt,k=!k,O=2}else{var Bt=S.elem();if(null!=w&&hu.vec_dsq(Bt.x,Bt.y,w.x,w.y)<lo.epsilon)break;Dp.flowpoly.add(Bt),null==w&&(w=Dp.flowpoly.front()),O=1}else if(++P,null==(N=N.next)&&(N=t.polygon.gverts.begin(),P=0),r[P]){var Lt=Dp.flowpoly.front(),jt=N.elem(),Ft=S.elem(),Rt=S.next;null==Rt&&(Rt=e.polygon.gverts.begin());for(var Gt=-1,Zt=null,Ut=0,Vt=0,qt=Rt,Wt=Rt;;){var Xt,Ht,Yt,Jt,Kt=Wt.elem(),Qt=0;Xt=Ft.x-Lt.x,Ht=Ft.y-Lt.y,Yt=Kt.x-Ft.x;var $t,en,tn,nn=(Jt=Kt.y-Ft.y)*($t=jt.x-Lt.x)-Yt*(en=jt.y-Lt.y);if(lo.epsilon*lo.epsilon<nn*nn){var rn=(en*Xt-$t*Ht)*(nn=1/nn);if(lo.epsilon<rn&&rn<1-lo.epsilon){var an=(Jt*Xt-Yt*Ht)*nn;tn=lo.epsilon<an&&an<1-lo.epsilon&&(Qt=rn,!0)}else tn=!1}else tn=!1;if(tn&&Gt<=Qt){if(Zt=S,Ut=C,++Vt==O){Gt=Qt,Wt=qt;break}Gt=Qt}Ft=Kt,S=Wt,++C>=e.polygon.edgeCnt&&(C=0),null==(Wt=Wt.next)&&(Wt=e.polygon.gverts.begin());break}for(;Wt!=qt;){var sn,ln,on,_n,pn=Wt.elem(),un=0;sn=Ft.x-Lt.x,ln=Ft.y-Lt.y,on=pn.x-Ft.x;var hn,cn,dn,mn=(_n=pn.y-Ft.y)*(hn=jt.x-Lt.x)-on*(cn=jt.y-Lt.y);if(lo.epsilon*lo.epsilon<mn*mn){var fn=(cn*sn-hn*ln)*(mn=1/mn);if(lo.epsilon<fn&&fn<1-lo.epsilon){var gn=(_n*sn-on*ln)*mn;dn=lo.epsilon<gn&&gn<1-lo.epsilon&&(un=fn,!0)}else dn=!1}else dn=!1;if(dn&&Gt<=un){if(Zt=S,Ut=C,++Vt==O){Gt=un,Wt=qt;break}Gt=un}Ft=pn,S=Wt,++C>=e.polygon.edgeCnt&&(C=0),null==(Wt=Wt.next)&&(Wt=e.polygon.gverts.begin())}if(null==Zt)break;var vn=Zt.elem(),bn=Zt.next;null==bn&&(bn=e.polygon.gverts.begin());var yn,xn,zn=bn.elem(),wn=Gt;if(yn=vn.x+(zn.x-vn.x)*wn,xn=vn.y+(zn.y-vn.y)*wn,null!=w&&hu.vec_dsq(yn,xn,w.x,w.y)<lo.epsilon)break;Dp.flowpoly.add(pu.get(yn,xn)),null==w&&(w=Dp.flowpoly.front()),S=Zt,C=Ut,k=!k,O=2}else{var kn=N.elem();if(null!=w&&hu.vec_dsq(kn.x,kn.y,w.x,w.y)<lo.epsilon)break;Dp.flowpoly.add(kn),null==w&&(w=Dp.flowpoly.front()),O=1}if(null==Dp.flowpoly.begin()||null==Dp.flowpoly.begin().next||null==Dp.flowpoly.begin().next.next)return!1;var Sn=0,Cn=0,Nn=0;Sn=Nn=Cn=0;var Pn=Dp.flowpoly.begin(),Mn=Pn.elem(),In=(Pn=Pn.next).elem();for(Pn=Pn.next;null!=Pn;){var An=Pn.elem();Sn+=In.x*(An.y-Mn.y);var Tn=An.y*In.x-An.x*In.y;Cn+=(In.x+An.x)*Tn,Nn+=(In.y+An.y)*Tn,Mn=In,In=An,Pn=Pn.next}var Dn=(Pn=Dp.flowpoly.begin()).elem();Sn+=In.x*(Dn.y-Mn.y);var En=Dn.y*In.x-Dn.x*In.y;Cn+=(In.x+Dn.x)*En,Nn+=(In.y+Dn.y)*En,Mn=In,In=Dn;var On=(Pn=Pn.next).elem();Sn+=In.x*(On.y-Mn.y);var Bn=On.y*In.x-On.x*In.y;Cn+=(In.x+On.x)*Bn,Nn+=(In.y+On.y)*Bn;var Ln=1/(6*(Sn*=.5));return Cn*=Ln,Nn*=Ln,n.inject(-Sn,Cn,Nn),!0}return!1}return!1}for(var jn=[],Fn=!0,Rn=null,Gn=null,Zn=-X_.FMAX,Un=!0,Vn=t.polygon.gverts.begin(),qn=0,Wn=t.polygon.edges.begin();null!=Wn;){var Xn=Wn.elem(),Hn=Xn.gnormx*e.circle.worldCOMx+Xn.gnormy*e.circle.worldCOMy;if(Hn>Xn.gprojection+e.circle.radius){Un=!1;break}Hn+e.circle.radius>Xn.gprojection+lo.epsilon&&(Fn=!1,jn[qn]=!0),Zn<(Hn-=Xn.gprojection+e.circle.radius)&&(Zn=Hn,Rn=Xn,Gn=Vn),Vn=Vn.next,++qn,Wn=Wn.next}if(Un){if(Fn)return n.inject(e.circle.area,e.circle.worldCOMx,e.circle.worldCOMy),!0;var Yn,Jn=Gn.elem(),Kn=null==Gn.next?t.polygon.gverts.front():Gn.next.elem(),Qn=e.circle.worldCOMy*Rn.gnormx-e.circle.worldCOMx*Rn.gnormy;if(Qn<=Jn.y*Rn.gnormx-Jn.x*Rn.gnormy){var $n,ei,ti=e.circle.radius;Yn=($n=Jn.x-e.circle.worldCOMx)*$n+(ei=Jn.y-e.circle.worldCOMy)*ei<=ti*ti}else if(Qn>=Kn.y*Rn.gnormx-Kn.x*Rn.gnormy){var ni,ii,ri=e.circle.radius;Yn=(ni=Kn.x-e.circle.worldCOMx)*ni+(ii=Kn.y-e.circle.worldCOMy)*ii<=ri*ri}else Yn=!0;if(Yn){for(var ai=[],si=0,li=!0,oi=null,_i=0,pi=t.polygon.gverts.begin();null!=pi;){var ui=pi.elem(),hi=hu.vec_dsq(ui.x,ui.y,e.circle.worldCOMx,e.circle.worldCOMy);(ai[si]=hi<=e.circle.radius*e.circle.radius)?(_i=si,oi=pi):li=!1,++si,pi=pi.next}if(li)return t.polygon.validate_worldCOM(),n.inject(t.polygon.area,t.polygon.worldCOMx,t.polygon.worldCOMy),!0;for(;!Dp.flowpoly.empty();){var ci=Dp.flowpoly.pop_unsafe();if(!ci._inuse){var di=ci;di.free(),di.next=pu.zpp_pool,pu.zpp_pool=di}}Dp.flowsegs.clear();var mi=null,fi=1;if(null==oi)oi=t.polygon.gverts.begin(),fi=2;else{var gi=Dp.flowpoly;mi=oi.elem(),gi.add(mi)}for(;0!=fi;)if(1==fi)if(null==(oi=oi.next)&&(oi=t.polygon.gverts.begin()),++_i>=t.polygon.edgeCnt&&(_i=0),ai[_i]){if(hu.vec_dsq(mi.x,mi.y,oi.elem().x,oi.elem().y)<lo.epsilon)break;Dp.flowpoly.add(oi.elem())}else{var vi,bi,yi,xi,zi,wi,ki=Dp.flowpoly.front(),Si=oi.elem(),Ci=(vi=Si.x-ki.x)*vi+(bi=Si.y-ki.y)*bi,Ni=2*((yi=ki.x-e.circle.worldCOMx)*vi+(xi=ki.y-e.circle.worldCOMy)*bi),Pi=yi*yi+xi*xi-e.circle.radius*e.circle.radius,Mi=Math.sqrt(Ni*Ni-4*Ci*Pi),Ii=(-Ni-Mi)*(Ci=1/(2*Ci)),Ai=Ii<lo.epsilon?(-Ni+Mi)*Ci:Ii;if(zi=ki.x+(Si.x-ki.x)*Ai,wi=ki.y+(Si.y-ki.y)*Ai,hu.vec_dsq(mi.x,mi.y,zi,wi)<lo.epsilon)break;Dp.flowpoly.add(pu.get(zi,wi)),fi=2}else if(2==fi){var Ti=oi.next;null==Ti&&(Ti=t.polygon.gverts.begin());var Di=oi.elem();fi=0;for(var Ei=Ti,Oi=Ti;;){var Bi=Oi.elem(),Li=_i+1;if(Li==t.polygon.edgeCnt&&(Li=0),jn[_i]){if(ai[Li]){var ji,Fi,Ri,Gi,Zi,Ui,Vi=(ji=Bi.x-Di.x)*ji+(Fi=Bi.y-Di.y)*Fi,qi=2*((Ri=Di.x-e.circle.worldCOMx)*ji+(Gi=Di.y-e.circle.worldCOMy)*Fi),Wi=Ri*Ri+Gi*Gi-e.circle.radius*e.circle.radius,Xi=Math.sqrt(qi*qi-4*Vi*Wi),Hi=(-qi-Xi)*(Vi=1/(2*Vi)),Yi=Hi<lo.epsilon?(-qi+Xi)*Vi:Hi;if(Zi=Di.x+(Bi.x-Di.x)*Yi,Ui=Di.y+(Bi.y-Di.y)*Yi,hu.vec_dsq(mi.x,mi.y,Zi,Ui)<lo.epsilon){fi=0,Oi=Ei;break}var Ji=pu.get(Zi,Ui);Dp.flowsegs.add(Dp.flowpoly.front()),Dp.flowsegs.add(Ji),Dp.flowpoly.add(Ji),fi=1,Oi=Ei;break}var Ki,Qi,$i,er,tr,nr=0,ir=0,rr=(Ki=Bi.x-Di.x)*Ki+(Qi=Bi.y-Di.y)*Qi,ar=2*(($i=Di.x-e.circle.worldCOMx)*Ki+(er=Di.y-e.circle.worldCOMy)*Qi),sr=ar*ar-4*rr*($i*$i+er*er-e.circle.radius*e.circle.radius);if(tr=sr*sr<lo.epsilon?(nr=sr<0?10:ir=-ar/(2*rr),!1):(nr=(-ar-(sr=Math.sqrt(sr)))*(rr=1/(2*rr)),ir=(-ar+sr)*rr,!0),nr<1-lo.epsilon&&lo.epsilon<ir){var lr,or,_r=nr;if(lr=Di.x+(Bi.x-Di.x)*_r,or=Di.y+(Bi.y-Di.y)*_r,null!=mi&&hu.vec_dsq(mi.x,mi.y,lr,or)<lo.epsilon){fi=0,Oi=Ei;break}var pr=pu.get(lr,or);if(Dp.flowpoly.empty()||(Dp.flowsegs.add(Dp.flowpoly.front()),Dp.flowsegs.add(pr)),Dp.flowpoly.add(pr),null==mi&&(mi=Dp.flowpoly.front()),tr){var ur,hr,cr=ir;ur=Di.x+(Bi.x-Di.x)*cr,hr=Di.y+(Bi.y-Di.y)*cr,Dp.flowpoly.add(pu.get(ur,hr))}}}Di=Bi,_i=Li,null==(Oi=(oi=Oi).next)&&(Oi=t.polygon.gverts.begin());break}for(;Oi!=Ei;){var dr=Oi.elem(),mr=_i+1;if(mr==t.polygon.edgeCnt&&(mr=0),jn[_i]){if(ai[mr]){var fr,gr,vr,br,yr,xr,zr=(fr=dr.x-Di.x)*fr+(gr=dr.y-Di.y)*gr,wr=2*((vr=Di.x-e.circle.worldCOMx)*fr+(br=Di.y-e.circle.worldCOMy)*gr),kr=vr*vr+br*br-e.circle.radius*e.circle.radius,Sr=Math.sqrt(wr*wr-4*zr*kr),Cr=(-wr-Sr)*(zr=1/(2*zr)),Nr=Cr<lo.epsilon?(-wr+Sr)*zr:Cr;if(yr=Di.x+(dr.x-Di.x)*Nr,xr=Di.y+(dr.y-Di.y)*Nr,hu.vec_dsq(mi.x,mi.y,yr,xr)<lo.epsilon){fi=0,Oi=Ei;break}var Pr=pu.get(yr,xr);Dp.flowsegs.add(Dp.flowpoly.front()),Dp.flowsegs.add(Pr),Dp.flowpoly.add(Pr),fi=1,Oi=Ei;break}var Mr,Ir,Ar,Tr,Dr,Er=0,Or=0,Br=(Mr=dr.x-Di.x)*Mr+(Ir=dr.y-Di.y)*Ir,Lr=2*((Ar=Di.x-e.circle.worldCOMx)*Mr+(Tr=Di.y-e.circle.worldCOMy)*Ir),jr=Lr*Lr-4*Br*(Ar*Ar+Tr*Tr-e.circle.radius*e.circle.radius);if(Dr=jr*jr<lo.epsilon?(Er=jr<0?10:Or=-Lr/(2*Br),!1):(Er=(-Lr-(jr=Math.sqrt(jr)))*(Br=1/(2*Br)),Or=(-Lr+jr)*Br,!0),Er<1-lo.epsilon&&lo.epsilon<Or){var Fr,Rr,Gr=Er;if(Fr=Di.x+(dr.x-Di.x)*Gr,Rr=Di.y+(dr.y-Di.y)*Gr,null!=mi&&hu.vec_dsq(mi.x,mi.y,Fr,Rr)<lo.epsilon){fi=0,Oi=Ei;break}var Zr=pu.get(Fr,Rr);if(Dp.flowpoly.empty()||(Dp.flowsegs.add(Dp.flowpoly.front()),Dp.flowsegs.add(Zr)),Dp.flowpoly.add(Zr),null==mi&&(mi=Dp.flowpoly.front()),Dr){var Ur,Vr,qr=Or;Ur=Di.x+(dr.x-Di.x)*qr,Vr=Di.y+(dr.y-Di.y)*qr,Dp.flowpoly.add(pu.get(Ur,Vr))}}}Di=dr,_i=mr,null==(Oi=(oi=Oi).next)&&(Oi=t.polygon.gverts.begin())}}if(null==Dp.flowpoly.begin())return!1;if(null==Dp.flowpoly.begin().next){for(var Wr=!0,Xr=t.polygon.edges.begin();null!=Xr;){var Hr=Xr.elem();if(Hr.gnormx*e.circle.worldCOMx+Hr.gnormy*e.circle.worldCOMy>Hr.gprojection){Wr=!1;break}Xr=Xr.next}return!!Wr&&(n.inject(e.circle.area,e.circle.worldCOMx,e.circle.worldCOMy),!0)}var Yr=0,Jr=0,Kr=0;if(null!=Dp.flowpoly.begin().next.next){var Qr=0,$r=0,ea=0;Qr=ea=$r=0;var ta=Dp.flowpoly.begin(),na=ta.elem(),ia=(ta=ta.next).elem();for(ta=ta.next;null!=ta;){var ra=ta.elem();Qr+=ia.x*(ra.y-na.y);var aa=ra.y*ia.x-ra.x*ia.y;$r+=(ia.x+ra.x)*aa,ea+=(ia.y+ra.y)*aa,na=ia,ia=ra,ta=ta.next}var sa=(ta=Dp.flowpoly.begin()).elem();Qr+=ia.x*(sa.y-na.y);var la=sa.y*ia.x-sa.x*ia.y;$r+=(ia.x+sa.x)*la,ea+=(ia.y+sa.y)*la,na=ia,ia=sa;var oa=(ta=ta.next).elem();Qr+=ia.x*(oa.y-na.y);var _a=oa.y*ia.x-oa.x*ia.y;$r+=(ia.x+oa.x)*_a,ea+=(ia.y+oa.y)*_a;var pa=1/(6*(Qr*=.5)),ua=-Qr;Yr+=($r*=pa)*ua,Jr+=(ea*=pa)*ua,Kr-=Qr}else Dp.flowsegs.add(Dp.flowpoly.front()),Dp.flowsegs.add(Dp.flowpoly.begin().next.elem());for(;!Dp.flowsegs.empty();){var ha=Dp.flowsegs.pop_unsafe(),ca=Dp.flowsegs.pop_unsafe(),da=0,ma=0,fa=(da=ca.x-ha.x)*da+(ma=ca.y-ha.y)*ma,ga=oc.invsqrt(fa),va=da*=ga;da=-(ma*=ga),ma=va;var ba=0,ya=0;ba=ha.x+ca.x,ya=ha.y+ca.y,ba*=.5,ya*=.5;var xa,za,wa=da*(ba-=1*e.circle.worldCOMx)+ma*(ya-=1*e.circle.worldCOMy),ka=wa/e.circle.radius,Sa=Math.sqrt(1-ka*ka),Ca=Math.acos(ka);xa=e.circle.radius*(e.circle.radius*Ca-wa*Sa),za=.6666666666666666*e.circle.radius*Sa*Sa*Sa/(Ca-ka*Sa),ba=e.circle.worldCOMx,ya=e.circle.worldCOMy,Yr+=(ba+=da*za)*xa,Jr+=(ya+=ma*za)*xa,Kr+=xa}var Na=1/Kr;return Yr*=Na,Jr*=Na,n.inject(Kr,Yr,Jr),!0}return!1}return!1}var Pa,Ma,Ia=e.circle,Aa=t.circle;Pa=Aa.worldCOMx-Ia.worldCOMx,Ma=Aa.worldCOMy-Ia.worldCOMy;var Ta=Ia.radius+Aa.radius,Da=Pa*Pa+Ma*Ma;if(Ta*Ta<Da)return!1;if(Da<lo.epsilon*lo.epsilon)return Ia.radius<Aa.radius?n.inject(Ia.area,Ia.worldCOMx,Ia.worldCOMy):n.inject(Aa.area,Aa.worldCOMx,Aa.worldCOMy),!0;var Ea=Math.sqrt(Da),Oa=1/Ea,Ba=.5*(Ea-(Aa.radius*Aa.radius-Ia.radius*Ia.radius)*Oa);if(Ba<=-Ia.radius)n.inject(Ia.area,Ia.worldCOMx,Ia.worldCOMy);else{var La=Ea-Ba;if(La<=-Aa.radius)n.inject(Aa.area,Aa.worldCOMx,Aa.worldCOMy);else{var ja,Fa,Ra,Ga=Ba,Za=Ga/Ia.radius,Ua=Math.sqrt(1-Za*Za),Va=Math.acos(Za);ja=Ia.radius*(Ia.radius*Va-Ga*Ua),Fa=.6666666666666666*Ia.radius*Ua*Ua*Ua/(Va-Za*Ua);var qa=La,Wa=qa/Aa.radius,Xa=Math.sqrt(1-Wa*Wa),Ha=Math.acos(Wa),Ya=ja+(Ra=Aa.radius*(Aa.radius*Ha-qa*Xa)),Ja=(Fa*ja+(Ea-.6666666666666666*Aa.radius*Xa*Xa*Xa/(Ha-Wa*Xa))*Ra)/Ya*Oa;n.inject(Ya,Ia.worldCOMx+Pa*Ja,Ia.worldCOMy+Ma*Ja)}}return!0};var Ep=function(){};(n["zpp_nape.geom.ZPP_Convex"]=Ep).__name__=["zpp_nape","geom","ZPP_Convex"],Ep.isinner=function(e,t,n){var i,r,a;return i=e.x-t.x,r=e.y-t.y,a=n.x-t.x,0<=(n.y-t.y)*i-a*r},Ep.optimise=function(e){var t=e.vertices,n=e.vertices;if(null!=t)for(var i=t;i.sort(),(i=i.next)!=n;);var r=e.vertices,a=e.vertices;if(null!=r)for(var s=r;;){for(var l=s,o=l.prev,_=null,p=l.diagonals.begin();null!=p;){var u=p.elem(),h=null==p.next?l.next:p.next.elem();if(Ep.isinner(h,l,o)){for(var c=!0,d=u,m=d.prev,f=null,g=d.diagonals.begin();null!=g;){var v=g.elem();if(v==l){var b=null==g.next?d.next:g.next.elem();c=Ep.isinner(b,d,m);break}m=v,g=(f=g).next}c?(p=l.diagonals.erase(_),d.diagonals.erase(f)):(o=u,p=(_=p).next)}else o=u,p=(_=p).next}if((s=s.next)==a)break}};var Op=function(){this.toiDistance=0,this.next=null,this.inner=!1,this.ray=null,this.position=null,this.convex=null,this.shape=null,this.normal=null};(n["zpp_nape.geom.ZPP_ConvexRayResult"]=Op).__name__=["zpp_nape","geom","ZPP_ConvexRayResult"],Op.getRay=function(e,t,n,i){var r;null==Op.rayPool?(Op.internal=!0,(r=new u_).zpp_inner=new Op,r.zpp_inner.ray=r,Op.internal=!1):(r=Op.rayPool.ray,Op.rayPool=Op.rayPool.next,r.zpp_inner.next=null);var a=r.zpp_inner;return(a.normal=e).zpp_inner._immutable=!0,a.toiDistance=t,a.inner=n,a.shape=i,r},Op.getConvex=function(e,t,n,i){var r;null==Op.convexPool?(Op.internal=!0,(r=new $o).zpp_inner=new Op,r.zpp_inner.convex=r,Op.internal=!1):(r=Op.convexPool.convex,Op.convexPool=Op.convexPool.next,r.zpp_inner.next=null);var a=r.zpp_inner;return a.normal=e,a.position=t,e.zpp_inner._immutable=!0,t.zpp_inner._immutable=!0,a.toiDistance=n,a.shape=i,r},Op.prototype={normal:null,shape:null,convex:null,position:null,ray:null,inner:null,next:null,toiDistance:null,disposed:function(){},free:function(){this.normal.zpp_inner._immutable=!1,this.normal.dispose(),null!=this.position&&(this.position.zpp_inner._immutable=!1,this.position.dispose()),this.shape=null,this.toiDistance=0,null!=this.convex?(this.next=Op.convexPool,Op.convexPool=this):(this.next=Op.rayPool,Op.rayPool=this)},__class__:Op};var Bp=function(){this.used=!1,this.rank=0,this.parent=null,this.positive=!1,this.value=0,this.vert=null,this.posy=0,this.posx=0,this.next=null,this.prev=null};(n["zpp_nape.geom.ZPP_CutVert"]=Bp).__name__=["zpp_nape","geom","ZPP_CutVert"],Bp.path=function(e){var t;return null==Bp.zpp_pool?t=new Bp:(t=Bp.zpp_pool,Bp.zpp_pool=t.next,t.next=null),t.alloc(),t.vert=e,(t.parent=t).rank=0,t.used=!1,t},Bp.prototype={prev:null,next:null,posx:null,posy:null,vert:null,value:null,positive:null,parent:null,rank:null,used:null,alloc:function(){},free:function(){this.vert=null,this.parent=null},__class__:Bp};var Lp=function(){this.path1=null,this.start=null,this.end=null,this.path0=null,this.vertex=!1,this.virtualint=!1,this.time=0,this.next=null};(n["zpp_nape.geom.ZPP_CutInt"]=Lp).__name__=["zpp_nape","geom","ZPP_CutInt"],Lp.get=function(e,t,n,i,r,a,s){var l;return null==s&&(s=!1),null==a&&(a=!1),null==Lp.zpp_pool?l=new Lp:(l=Lp.zpp_pool,Lp.zpp_pool=l.next,l.next=null),l.alloc(),l.virtualint=a,l.end=t,l.start=n,l.path0=i,l.path1=r,l.time=e,l.vertex=s,l},Lp.prototype={next:null,time:null,virtualint:null,vertex:null,path0:null,end:null,start:null,path1:null,alloc:function(){},free:function(){this.end=this.start=null,this.path0=this.path1=null},__class__:Lp};var jp=function(){};(n["zpp_nape.geom.ZPP_Cutter"]=jp).__name__=["zpp_nape","geom","ZPP_Cutter"],jp.run=function(e,t,n,i,r,a){var s,l,o,_;s=t.get_x(),l=t.get_y(),o=n.get_x()-s,_=n.get_y()-l;for(var p=i?0:X_.NEGINF(),u=r?1:X_.POSINF(),h=-(l*o-s*_),c=null,d=!1,m=e;;){var f;null==Bp.zpp_pool?f=new Bp:(f=Bp.zpp_pool,Bp.zpp_pool=f.next,f.next=null),f.alloc(),f.vert=m,f.posx=f.vert.x,f.posy=f.vert.y,f.value=f.posy*o-f.posx*_+h,f.positive=0<f.value,0==f.value&&(d=!0);var g=f;if(null==c?c=g.prev=g.next=g:(g.prev=c,g.next=c.next,c.next.prev=g,c.next=g),c=g,(m=m.next)==e)break}if(d){var v=null,b=c;if(null!=c)for(var y=c;;){var x=y;if(0!=x.value){v=x;break}if((y=y.next)==b)break}var z=0,w=0,k=(z=o)*z+(w=_)*w,S=oc.invsqrt(k),C=z*=S;z=-(w*=S),w=C;for(var N=null,P=v;;)if(0==P.value||null!=N&&P!=N.next){var M=N.value*P.value;if(0!=M){var I,A=N.next;if(0<M)I=N.positive;else{var T=A.next,D=0,E=0;D=A.posx+T.posx,E=A.posy+T.posy;var O=(D*=.5)+1e-8*z,B=(E*=.5)+1e-8*w,L=!1,j=e;if(null!=e)for(var F=e;;){var R=F,G=R.prev;if((R.y<B&&G.y>=B||G.y<B&&R.y>=B)&&(R.x<=O||G.x<=O)&&R.x+(B-R.y)/(G.y-R.y)*(G.x-R.x)<O&&(L=!L),(F=F.next)==j)break}I=L}var Z=P;if(null!=A)for(var U=A;U.positive=I,(U=U.next)!=Z;);if((P=(N=P).next)==v)break}else if((P=P.next)==v)break}else if((P=(N=P).next)==v)break;for(;;){if(0!=P.value&&(null==N||P==N.next)){P=(N=P).next;break}var V=N.value*P.value;if(0==V){P=P.next;break}var q,W=N.next;if(0<V)q=N.positive;else{var X=W.next,H=0,Y=0;H=W.posx+X.posx,Y=W.posy+X.posy;var J=(H*=.5)+1e-8*z,K=(Y*=.5)+1e-8*w,Q=!1,$=e;if(null!=e)for(var ee=e;;){var te=ee,ne=te.prev;if((te.y<K&&ne.y>=K||ne.y<K&&te.y>=K)&&(te.x<=J||ne.x<=J)&&te.x+(K-te.y)/(ne.y-te.y)*(ne.x-te.x)<J&&(Q=!Q),(ee=ee.next)==$)break}q=Q}var ie=P;if(null!=W)for(var re=W;re.positive=q,(re=re.next)!=ie;);P=(N=P).next;break}}null==jp.ints&&(jp.ints=new Vu),null==jp.paths&&(jp.paths=new qu);var ae=null,se=Rp.get(c.posx,c.posy);null==ae?ae=se.prev=se.next=se:(se.next=ae,se.prev=ae.prev,ae.prev.next=se,ae.prev=se);var le=ae,oe=Bp.path(ae);jp.paths.add(oe);for(var _e=c;;){var pe=_e.next,ue=Rp.get(pe.posx,pe.posy);if(_e.positive==pe.positive){var he=ue;null==ae?ae=he.prev=he.next=he:(he.next=ae,he.prev=ae.prev,ae.prev.next=he,ae.prev=he)}else{var ce,de,me=_*(ce=pe.posx-_e.posx)-o*(de=pe.posy-_e.posy);me=1/me;var fe,ge,ve=(de*(fe=s-_e.posx)-ce*(ge=l-_e.posy))*me;if(ve<p||u<ve){jp.ints.add(Lp.get(ve,null,null,null,null,!0));var be=ue;null==ae?ae=be.prev=be.next=be:(be.next=ae,be.prev=ae.prev,ae.prev.next=be,ae.prev=be)}else if(0==_e.value){var ye=ae.prev;ae=null;var xe=Rp.get(ye.x,ye.y);null==ae?ae=xe.prev=xe.next=xe:(xe.next=ae,xe.prev=ae.prev,ae.prev.next=xe,ae.prev=xe);var ze=ue;null==ae?ae=ze.prev=ze.next=ze:(ze.next=ae,ze.prev=ae.prev,ae.prev.next=ze,ae.prev=ze);var we=jp.paths.begin().elem();jp.paths.add(Bp.path(ae));var ke=jp.paths.begin().elem();jp.ints.add(Lp.get(ve,ye,ae,we,ke,!0))}else if(0==pe.value){var Se=ue;null==ae?ae=Se.prev=Se.next=Se:(Se.next=ae,Se.prev=ae.prev,ae.prev.next=Se,ae.prev=Se);var Ce=ae.prev;ae=null;var Ne=Rp.get(pe.posx,pe.posy);null==ae?ae=Ne.prev=Ne.next=Ne:(Ne.next=ae,Ne.prev=ae.prev,ae.prev.next=Ne,ae.prev=Ne);var Pe=jp.paths.begin().elem();jp.paths.add(Bp.path(ae));var Me=jp.paths.begin().elem();jp.ints.add(Lp.get(ve,Ce,ae,Pe,Me,!0))}else{var Ie=(_*fe-o*ge)*me,Ae=0,Te=0;Ae=_e.posx,Te=_e.posy,Ae+=ce*Ie,Te+=de*Ie;var De=Rp.get(Ae,Te);null==ae?ae=De.prev=De.next=De:(De.next=ae,De.prev=ae.prev,ae.prev.next=De,ae.prev=De);var Ee=ae.prev;ae=null;var Oe=Rp.get(Ae,Te);null==ae?ae=Oe.prev=Oe.next=Oe:(Oe.next=ae,Oe.prev=ae.prev,ae.prev.next=Oe,ae.prev=Oe);var Be=ue;null==ae?ae=Be.prev=Be.next=Be:(Be.next=ae,Be.prev=ae.prev,ae.prev.next=Be,ae.prev=Be);var Le=jp.paths.begin().elem();jp.paths.add(Bp.path(ae));var je=jp.paths.begin().elem();jp.ints.add(Lp.get(ve,Ee,ae,Le,je,!1))}}if((_e=_e.next)==c)break}var Fe=ae.prev;Fe.next.prev=le.prev,le.prev.next=Fe.next,(Fe.next=le).prev=Fe;var Re,Ge,Ze=jp.paths.begin().elem();if(oe==oe.parent)Re=oe;else{for(var Ue=oe,Ve=null;Ue!=Ue.parent;){var qe=Ue.parent;Ue.parent=Ve,Ve=Ue,Ue=qe}for(;null!=Ve;){var We=Ve.parent;Ve.parent=Ue,Ve=We}Re=Ue}if(Ze==Ze.parent)Ge=Ze;else{for(var Xe=Ze,He=null;Xe!=Xe.parent;){var Ye=Xe.parent;Xe.parent=He,He=Xe,Xe=Ye}for(;null!=He;){var Je=He.parent;He.parent=Xe,He=Je}Ge=Xe}Re!=Ge&&(Re.rank<Ge.rank?Re.parent=Ge:Re.rank>Ge.rank?Ge.parent=Re:(Ge.parent=Re).rank++);var Ke=jp.ints;if(!Ke.empty()&&null!=Ke.begin().next){for(var Qe,$e,et,tt=Ke.begin(),nt=null,it=null,rt=null,at=null,st=1;;){for(Qe=0,it=tt,nt=tt=null;null!=it;){for(++Qe,rt=it,$e=0,et=st;null!=rt&&$e<st;)++$e,rt=rt.next;for(;0<$e||0<et&&null!=rt;)0==$e?(rt=(at=rt).next,--et):0==et||null==rt||it.elem().time<rt.elem().time?(it=(at=it).next,--$e):(rt=(at=rt).next,--et),null!=nt?nt.next=at:tt=at,nt=at;it=rt}if(nt.next=null,st<<=1,!(1<Qe))break}Ke.setbegin(tt)}for(;!jp.ints.empty();){var lt=jp.ints.pop_unsafe(),ot=jp.ints.pop_unsafe();if(lt.virtualint||ot.virtualint){if(lt.virtualint&&!ot.virtualint){var _t,pt,ut;if(null!=ot.end&&ot.end.prev==ot.end){ot.end.next=ot.end.prev=null;var ht=ot.end;ht.free(),ht.next=Rp.zpp_pool,Rp.zpp_pool=ht,_t=null}else{var ct=ot.end.prev;ot.end.prev.next=ot.end.next,ot.end.next.prev=ot.end.prev,ot.end.next=ot.end.prev=null;var dt=ot.end;dt.free(),dt.next=Rp.zpp_pool,Rp.zpp_pool=dt,ot.end=null,_t=ct}if(ot.end=_t,!ot.vertex)if(ot.end!=ot.path0.vert){var mt;if(ot.start.x=ot.end.x,ot.start.y=ot.end.y,null!=ot.end&&ot.end.prev==ot.end){ot.end.next=ot.end.prev=null;var ft=ot.end;ft.free(),ft.next=Rp.zpp_pool,Rp.zpp_pool=ft,mt=null}else{var gt=ot.end.prev;ot.end.prev.next=ot.end.next,ot.end.next.prev=ot.end.prev,ot.end.next=ot.end.prev=null;var vt=ot.end;vt.free(),vt.next=Rp.zpp_pool,Rp.zpp_pool=vt,ot.end=null,mt=gt}ot.end=mt}else{var bt=ot.start.next;if(ot.start.x=bt.x,ot.start.y=bt.y,null!=bt&&bt.prev==bt){bt.next=bt.prev=null;var yt=bt;yt.free(),yt.next=Rp.zpp_pool,Rp.zpp_pool=yt,bt=null}else{bt.prev.next=bt.next,bt.next.prev=bt.prev,bt.next=bt.prev=null;var xt=bt;xt.free(),xt.next=Rp.zpp_pool,Rp.zpp_pool=xt}}if(ot.end.next.prev=ot.start.prev,ot.start.prev.next=ot.end.next,ot.end.next=ot.start,ot.start.prev=ot.end,ot.path0==ot.path0.parent)pt=ot.path0;else{for(var zt=ot.path0,wt=null;zt!=zt.parent;){var kt=zt.parent;zt.parent=wt,wt=zt,zt=kt}for(;null!=wt;){var St=wt.parent;wt.parent=zt,wt=St}pt=zt}if(ot.path1==ot.path1.parent)ut=ot.path1;else{for(var Ct=ot.path1,Nt=null;Ct!=Ct.parent;){var Pt=Ct.parent;Ct.parent=Nt,Nt=Ct,Ct=Pt}for(;null!=Nt;){var Mt=Nt.parent;Nt.parent=Ct,Nt=Mt}ut=Ct}pt!=ut&&(pt.rank<ut.rank?pt.parent=ut:pt.rank>ut.rank?ut.parent=pt:(ut.parent=pt).rank++)}else if(ot.virtualint&&!lt.virtualint){var It,At,Tt;if(null!=lt.end&&lt.end.prev==lt.end){lt.end.next=lt.end.prev=null;var Dt=lt.end;Dt.free(),Dt.next=Rp.zpp_pool,Rp.zpp_pool=Dt,It=null}else{var Et=lt.end.prev;lt.end.prev.next=lt.end.next,lt.end.next.prev=lt.end.prev,lt.end.next=lt.end.prev=null;var Ot=lt.end;Ot.free(),Ot.next=Rp.zpp_pool,Rp.zpp_pool=Ot,lt.end=null,It=Et}if(lt.end=It,!lt.vertex)if(lt.end!=lt.path0.vert){var Bt;if(lt.start.x=lt.end.x,lt.start.y=lt.end.y,null!=lt.end&&lt.end.prev==lt.end){lt.end.next=lt.end.prev=null;var Lt=lt.end;Lt.free(),Lt.next=Rp.zpp_pool,Rp.zpp_pool=Lt,Bt=null}else{var jt=lt.end.prev;lt.end.prev.next=lt.end.next,lt.end.next.prev=lt.end.prev,lt.end.next=lt.end.prev=null;var Ft=lt.end;Ft.free(),Ft.next=Rp.zpp_pool,Rp.zpp_pool=Ft,lt.end=null,Bt=jt}lt.end=Bt}else{var Rt=lt.start.next;if(lt.start.x=Rt.x,lt.start.y=Rt.y,null!=Rt&&Rt.prev==Rt){Rt.next=Rt.prev=null;var Gt=Rt;Gt.free(),Gt.next=Rp.zpp_pool,Rp.zpp_pool=Gt,Rt=null}else{Rt.prev.next=Rt.next,Rt.next.prev=Rt.prev,Rt.next=Rt.prev=null;var Zt=Rt;Zt.free(),Zt.next=Rp.zpp_pool,Rp.zpp_pool=Zt}}if(lt.end.next.prev=lt.start.prev,lt.start.prev.next=lt.end.next,lt.end.next=lt.start,lt.start.prev=lt.end,lt.path0==lt.path0.parent)At=lt.path0;else{for(var Ut=lt.path0,Vt=null;Ut!=Ut.parent;){var qt=Ut.parent;Ut.parent=Vt,Vt=Ut,Ut=qt}for(;null!=Vt;){var Wt=Vt.parent;Vt.parent=Ut,Vt=Wt}At=Ut}if(lt.path1==lt.path1.parent)Tt=lt.path1;else{for(var Xt=lt.path1,Ht=null;Xt!=Xt.parent;){var Yt=Xt.parent;Xt.parent=Ht,Ht=Xt,Xt=Yt}for(;null!=Ht;){var Jt=Ht.parent;Ht.parent=Xt,Ht=Jt}Tt=Xt}At!=Tt&&(At.rank<Tt.rank?At.parent=Tt:At.rank>Tt.rank?Tt.parent=At:(Tt.parent=At).rank++)}}else{var Kt,Qt,$t,en;if(lt.end.next.prev=ot.start.prev,ot.start.prev.next=lt.end.next,lt.end.next=ot.start,ot.start.prev=lt.end,ot.end.next.prev=lt.start.prev,lt.start.prev.next=ot.end.next,ot.end.next=lt.start,lt.start.prev=ot.end,lt.path0==lt.path0.parent)Kt=lt.path0;else{for(var tn=lt.path0,nn=null;tn!=tn.parent;){var rn=tn.parent;tn.parent=nn,nn=tn,tn=rn}for(;null!=nn;){var an=nn.parent;nn.parent=tn,nn=an}Kt=tn}if(ot.path1==ot.path1.parent)Qt=ot.path1;else{for(var sn=ot.path1,ln=null;sn!=sn.parent;){var on=sn.parent;sn.parent=ln,ln=sn,sn=on}for(;null!=ln;){var _n=ln.parent;ln.parent=sn,ln=_n}Qt=sn}if(Kt!=Qt&&(Kt.rank<Qt.rank?Kt.parent=Qt:Kt.rank>Qt.rank?Qt.parent=Kt:(Qt.parent=Kt).rank++),lt.path1==lt.path1.parent)$t=lt.path1;else{for(var pn=lt.path1,un=null;pn!=pn.parent;){var hn=pn.parent;pn.parent=un,un=pn,pn=hn}for(;null!=un;){var cn=un.parent;un.parent=pn,un=cn}$t=pn}if(ot.path0==ot.path0.parent)en=ot.path0;else{for(var dn=ot.path0,mn=null;dn!=dn.parent;){var fn=dn.parent;dn.parent=mn,mn=dn,dn=fn}for(;null!=mn;){var gn=mn.parent;mn.parent=dn,mn=gn}en=dn}$t!=en&&($t.rank<en.rank?$t.parent=en:$t.rank>en.rank?en.parent=$t:(en.parent=$t).rank++)}var vn=lt;vn.free(),vn.next=Lp.zpp_pool,Lp.zpp_pool=vn;var bn=ot;bn.free(),bn.next=Lp.zpp_pool,Lp.zpp_pool=bn}for(var yn=null==a?new a_:a,xn=jp.paths.begin();null!=xn;){var zn,wn=xn.elem();if(wn==wn.parent)zn=wn;else{for(var kn=wn,Sn=null;kn!=kn.parent;){var Cn=kn.parent;kn.parent=Sn,Sn=kn,kn=Cn}for(;null!=Sn;){var Nn=Sn.parent;Sn.parent=kn,Sn=Nn}zn=kn}if(zn.used)xn=xn.next;else{zn.used=!0;for(var Pn=zn.vert,Mn=!0;null!=zn.vert&&(Mn||Pn!=zn.vert);)if(Mn=!1,Pn.x==Pn.next.x&&Pn.y==Pn.next.y)if(Pn==zn.vert&&(zn.vert=Pn.next==Pn?null:Pn.next,Mn=!0),null!=Pn&&Pn.prev==Pn)Pn.next=Pn.prev=null,Pn=Pn=null;else{var In=Pn.next;Pn.prev.next=Pn.next,Pn.next.prev=Pn.prev,Pn.next=Pn.prev=null,Pn=null,Pn=In}else Pn=Pn.next;if(null!=zn.vert){var An=i_.get();An.zpp_inner.vertices=zn.vert,yn.add(An)}xn=xn.next}}for(;!jp.paths.empty();){var Tn=jp.paths.pop_unsafe();Tn.free(),Tn.next=Bp.zpp_pool,Bp.zpp_pool=Tn}for(;null!=c;)if(null!=c&&c.prev==c){c.next=c.prev=null;var Dn=c;Dn.free(),Dn.next=Bp.zpp_pool,Bp.zpp_pool=Dn,c=c=null}else{var En=c.next;c.prev.next=c.next,c.next.prev=c.prev,c.next=c.prev=null;var On=c;On.free(),On.next=Bp.zpp_pool,Bp.zpp_pool=On,c=null,c=En}return yn};var Fp=function(){};(n["zpp_nape.geom.ZPP_Geom"]=Fp).__name__=["zpp_nape","geom","ZPP_Geom"],Fp.validateShape=function(e){e.isPolygon()&&e.polygon.validate_gaxi(),e.validate_aabb(),e.validate_worldCOM()};var Rp=function(){this.forced=!1,this.wrap=null,this.next=null,this.prev=null,this.y=0,this.x=0};(n["zpp_nape.geom.ZPP_GeomVert"]=Rp).__name__=["zpp_nape","geom","ZPP_GeomVert"],Rp.get=function(e,t){var n;return null==Rp.zpp_pool?n=new Rp:(n=Rp.zpp_pool,Rp.zpp_pool=n.next,n.next=null),n.alloc(),n.x=e,n.y=t,n},Rp.prototype={x:null,y:null,prev:null,next:null,wrap:null,forced:null,free:function(){null!=this.wrap&&(this.wrap.zpp_inner._inuse=!1,this.wrap.dispose(),this.wrap=null),this.prev=this.next=null},alloc:function(){this.forced=!1},wrapper:function(){return null==this.wrap&&(this.wrap=d_.get(this.x,this.y),this.wrap.zpp_inner._inuse=!0,this.wrap.zpp_inner._invalidate=yc(this,this.modwrap),this.wrap.zpp_inner._validate=yc(this,this.getwrap)),this.wrap},modwrap:function(e){this.x=e.x,this.y=e.y},getwrap:function(){this.wrap.zpp_inner.x=this.x,this.wrap.zpp_inner.y=this.y},__class__:Rp};var Gp=function(e){this.vertices=null,this.outer=null,this.outer=e};(n["zpp_nape.geom.ZPP_GeomPoly"]=Gp).__name__=["zpp_nape","geom","ZPP_GeomPoly"],Gp.prototype={outer:null,vertices:null,__class__:Gp};var Zp=function(){this.next=null,this.outer=null,this.forward=!1,this.first=!1,this.start=null,this.ptr=null,this.outer=new s_};(n["zpp_nape.geom.ZPP_GeomVertexIterator"]=Zp).__name__=["zpp_nape","geom","ZPP_GeomVertexIterator"],Zp.get=function(e,t){var n;return null==Zp.zpp_pool?n=new Zp:(n=Zp.zpp_pool,Zp.zpp_pool=n.next,n.next=null),n.alloc(),(n.outer.zpp_inner=n).ptr=e,n.forward=t,n.start=e,n.first=null!=e,n.outer},Zp.prototype={ptr:null,start:null,first:null,forward:null,outer:null,next:null,free:function(){this.outer.zpp_inner=null,this.ptr=this.start=null},alloc:function(){},__class__:Zp};var Up=function(){this.next=null,this.out=!1,this.rank=0,this.parent=null,this.parent=this};(n["zpp_nape.geom.ZPP_MarchSpan"]=Up).__name__=["zpp_nape","geom","ZPP_MarchSpan"],Up.prototype={parent:null,rank:null,out:null,next:null,free:function(){this.parent=this},alloc:function(){this.out=!1,this.rank=0},__class__:Up};var Vp=function(){this.next=null,this.spanr=null,this.span2=null,this.span1=null,this.pd=null,this.okeyr=0,this.keyr=0,this.pr=null,this.okey2=0,this.key2=0,this.p2=null,this.okey1=0,this.key1=0,this.p1=null};(n["zpp_nape.geom.ZPP_MarchPair"]=Vp).__name__=["zpp_nape","geom","ZPP_MarchPair"],Vp.prototype={p1:null,key1:null,okey1:null,p2:null,key2:null,okey2:null,pr:null,keyr:null,okeyr:null,pd:null,span1:null,span2:null,spanr:null,next:null,free:function(){this.p1=this.p2=this.pr=this.pd=null,this.span1=this.span2=this.spanr=null},alloc:function(){},__class__:Vp};var qp=function(){};(n["zpp_nape.geom.ZPP_MarchingSquares"]=qp).__name__=["zpp_nape","geom","ZPP_MarchingSquares"],qp.run=function(e,t,n,i,r,a,s,l,o){var _=(i-t)/a.get_x(),u=p.int(_),h=(r-n)/a.get_y(),c=p.int(h);_!=u&&++u,h!=c&&++c,l&&(null==qp.map?qp.map=new Ou(u,c):qp.map.resize(u,c,null)),null==qp.isos?qp.isos=new Du(u+1,c+1):qp.isos.resize(u+1,c+1,0);for(var d=0,m=c+1;d<m;)for(var f=d++,g=0==f?n:f<=c?n+a.get_y()*f:r,v=0,b=u+1;v<b;){var y=v++,x=0==y?t:y<=u?t+a.get_x()*y:i;qp.isos.set(y,f,qp.ISO(e,x,g))}null==qp.ints?qp.ints=new Eu(u+1,1+(c<<1)):qp.ints.resize(u+1,1+(c<<1),null);var z=null;l&&(null==Up.zpp_pool?z=new Up:(z=Up.zpp_pool,Up.zpp_pool=z.next,z.next=null),z.alloc());for(var w=n,k=0,S=c;k<S;){var C=k++,N=w,P=C==c-1?r:n+a.get_y()*(C+1);w=P;for(var M=t,I=null,A=0,T=u;A<T;){var D=A++,E=M,O=D==u-1?i:t+a.get_x()*(D+1);M=O;var B=0==D||!l,L=0==C||!l,j=D==u-1||!l,F=C==c-1||!l,R=qp.me.marchSquare(e,qp.isos,qp.ints,E,N,O,P,D,C,B,L,j,F,s);if(null!=R)if(l){var G=null!=R.p2&&14!=R.okey2?R.p2:R.p1;R.pd=qp.me.linkdown(G,G==R.p2?R.okey2:R.okey1),qp.map.set(D,C,R),null!=I&&qp.me.combLeft(R.key1)?(qp.me.combLR(I,R),R.span1=I.spanr):(null==Up.zpp_pool?R.span1=new Up:(R.span1=Up.zpp_pool,Up.zpp_pool=R.span1.next,R.span1.next=null),R.span1.alloc(),R.span1.next=z,z=R.span1),null!=R.p2?(null==Up.zpp_pool?R.span2=new Up:(R.span2=Up.zpp_pool,Up.zpp_pool=R.span2.next,R.span2.next=null),R.span2.alloc(),R.span2.next=z,z=R.span2,R.spanr=R.span2):R.spanr=R.span1,I=qp.me.combRight(R.keyr)?R:null}else{qp.me.output(o,R.p1),null!=R.p2&&qp.me.output(o,R.p2);var Z=R;Z.free(),Z.next=Vp.zpp_pool,Vp.zpp_pool=Z}else I=null}}if(l){for(var U=1,V=c;U<V;)for(var q=U++,W=null,X=0,H=u;X<H;){var Y=X++,J=qp.map.get(Y,q);if(null!=J){var K=null!=J.p2&&14==J.okey2?J.okey2:J.okey1;if(qp.me.combUp(K)){var Q=qp.map.get(Y,q-1);if(null!=Q){var $=null!=Q.p2&&56==Q.okey2?Q.okey2:Q.okey1;if(qp.me.combDown($)){var ee,te,ne=null!=Q.p2&&56==Q.okey2?Q.span2:Q.span1,ie=null!=J.p2&&14==J.okey2?J.span2:J.span1;if(ne==ne.parent)ee=ne;else{for(var re=ne,ae=null;re!=re.parent;){var se=re.parent;re.parent=ae,ae=re,re=se}for(;null!=ae;){var le=ae.parent;ae.parent=re,ae=le}ee=re}if(ie==ie.parent)te=ie;else{for(var oe=ie,_e=null;oe!=oe.parent;){var pe=oe.parent;oe.parent=_e,_e=oe,oe=pe}for(;null!=_e;){var ue=_e.parent;_e.parent=oe,_e=ue}te=oe}if(ee==te)W!=ie&&qp.me.combUD_virtual(Q,J);else{var he,ce;if(ne==ne.parent)he=ne;else{for(var de=ne,me=null;de!=de.parent;){var fe=de.parent;de.parent=me,me=de,de=fe}for(;null!=me;){var ge=me.parent;me.parent=de,me=ge}he=de}if(ie==ie.parent)ce=ie;else{for(var ve=ie,be=null;ve!=ve.parent;){var ye=ve.parent;ve.parent=be,be=ve,ve=ye}for(;null!=be;){var xe=be.parent;be.parent=ve,be=xe}ce=ve}he!=ce&&(he.rank<ce.rank?he.parent=ce:he.rank>ce.rank?ce.parent=he:(ce.parent=he).rank++),qp.me.combUD(Q,J)}W=0!=(4&(ie==J.span2?J.okey2:J.okey1))?ie:null}else W=null}else W=null}else W=null}else W=null}for(var ze=0,we=c;ze<we;)for(var ke=ze++,Se=0,Ce=u;Se<Ce;){var Ne=Se++,Pe=qp.map.get(Ne,ke);if(null!=Pe){var Me;if(Pe.span1==Pe.span1.parent)Me=Pe.span1;else{for(var Ie=Pe.span1,Ae=null;Ie!=Ie.parent;){var Te=Ie.parent;Ie.parent=Ae,Ae=Ie,Ie=Te}for(;null!=Ae;){var De=Ae.parent;Ae.parent=Ie,Ae=De}Me=Ie}if(Me.out||(Me.out=!0,qp.me.output(o,Pe.p1)),null!=Pe.p2){if(Pe.span2==Pe.span2.parent)Me=Pe.span2;else{for(var Ee=Pe.span2,Oe=null;Ee!=Ee.parent;){var Be=Ee.parent;Ee.parent=Oe,Oe=Ee,Ee=Be}for(;null!=Oe;){var Le=Oe.parent;Oe.parent=Ee,Oe=Le}Me=Ee}Me.out||(Me.out=!0,qp.me.output(o,Pe.p2))}var je=Pe;je.free(),je.next=Vp.zpp_pool,Vp.zpp_pool=je,qp.map.set(Ne,ke,null)}}for(;null!=z;){var Fe=z;z=Fe.next;var Re=Fe;Re.free(),Re.next=Up.zpp_pool,Up.zpp_pool=Re}}},qp.ISO=function(e,t,n){return e(t,n)},qp.prototype={output:function(e,t){var n;if(null==t||t.next==t||t.next==t.prev)n=!0;else{var i=0,r=t;if(null!=t)for(var a=t;;){var s=a;if(i+=s.x*(s.next.y-s.prev.y),(a=a.next)==r)break}var l=.5*i;n=l*l<lo.epsilon*lo.epsilon}if(n)for(;null!=t;)if(null!=t&&t.prev==t)t.next=t.prev=null,t=t=null;else{var o=t.next;t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null,t=null,t=o}else{var _=i_.get();_.zpp_inner.vertices=t,e.add(_)}},linkright:function(e,t){var n=7&t;return 0==n?e:3==n?e.next.next:e.next},linkleft:function(e,t){return 0==(1&t)?e.prev:e},linkdown:function(e,t){return 0==(128&t)?e.prev:e.prev.prev},linkup:function(e,t){return e},combLR:function(e,t){var n=this.linkright(e.pr,e.okeyr),i=this.linkleft(t.p1,t.okey1),r=n.next,a=i.prev;if(0!=(4&e.keyr)){t.pr==t.p1&&(t.pr=n.prev),t.p1=n.prev,n.prev.next=i.next,i.next.prev=n.prev;var s=n;s.free(),s.next=Rp.zpp_pool,Rp.zpp_pool=s}else n.next=i.next,i.next.prev=n;var l=i;if(l.free(),l.next=Rp.zpp_pool,Rp.zpp_pool=l,0!=(16&e.keyr)){t.pd=r.next,r.next.prev=a.prev,a.prev.next=r.next;var o=r;o.free(),o.next=Rp.zpp_pool,Rp.zpp_pool=o}else r.prev=a.prev,a.prev.next=r;var _=a;_.free(),_.next=Rp.zpp_pool,Rp.zpp_pool=_},combUD:function(e,t){null!=e.p2&&56==e.key2?e.p2:e.p1;var n=null!=t.p2&&14==t.key2?t.p2:t.p1,i=e.pd,r=this.linkup(n,n==t.p2?t.okey2:t.okey1),a=i.prev,s=r.next;r.next=i.next,i.next.prev=r;var l=i;l.free(),l.next=Rp.zpp_pool,Rp.zpp_pool=l,s.prev=a.prev,a.prev.next=s,a==e.p1&&(e.p1=s);var o=a;o.free(),o.next=Rp.zpp_pool,Rp.zpp_pool=o},combUD_virtual:function(e,t){null!=e.p2&&56==e.key2?e.p2:e.p1;var n=null!=t.p2&&14==t.key2?t.p2:t.p1,i=e.pd,r=this.linkup(n,n==t.p2?t.key2:t.key1),a=i.prev,s=r.next;i.forced=r.forced=a.forced=s.forced=!0},combLeft:function(e){var t=1&e|(192&e)>>5;return this.comb(t)},combRight:function(e){var t=(28&e)>>2;return this.comb(t)},combUp:function(e){var t=7&e;return this.comb(t)},combDown:function(e){var t=(112&e)>>4;return this.comb(t)},comb:function(e){var t=0;return 0!=(1&e)&&++t,0!=(2&e)&&++t,0!=(4&e)&&++t,2<=t},marchSquare:function(e,t,n,i,r,a,s,l,o,_,p,u,h,c){var d=0,m=t.get(l,o);m<0&&(d|=8);var f=t.get(l+1,o);f<0&&(d|=4);var g=t.get(l+1,o+1);g<0&&(d|=2);var v,b=t.get(l,o+1);if(b<0&&(d|=1),0==d)return null;if(null==Vp.zpp_pool?v=new Vp:(v=Vp.zpp_pool,Vp.zpp_pool=v.next,v.next=null),v.alloc(),10!=d&&5!=d){var y=qp.look_march[d];v.okey1=y;for(var x=0;x<8;){var z=x++;if(0!=(y&1<<z)){var w=null;0==z?(w=Rp.get(i,r),(_||p)&&(w.forced=!0)):2==z?(w=Rp.get(a,r),(u||p)&&(w.forced=!0)):4==z?(w=Rp.get(a,s),(u||h)&&(w.forced=!0)):6==z?(w=Rp.get(i,s),(_||h)&&(w.forced=!0)):1==z?(null==(w=n.get(l,o<<1))?(w=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,w)):w=Rp.get(w.x,w.y),p&&(w.forced=!0),w.x!=i&&w.x!=a||(w.x==i&&0!=(1&y)||w.x==a&&0!=(4&y))&&(y^=2)):5==z?(null==(w=n.get(l,2+(o<<1)))?(w=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),w)):w=Rp.get(w.x,w.y),h&&(w.forced=!0),w.x!=i&&w.x!=a||(w.x==i&&0!=(64&y)||w.x==a&&0!=(16&y))&&(y^=32)):3==z?(null==(w=n.get(l+1,1+(o<<1)))?(w=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),w)):w=Rp.get(w.x,w.y),u&&(w.forced=!0),w.y!=r&&w.y!=s||(w.y==r&&0!=(4&y)||w.y==s&&0!=(16&y))&&(y^=8)):(null==(w=n.get(l,1+(o<<1)))?(w=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),w)):w=Rp.get(w.x,w.y),_&&(w.forced=!0),w.y!=r&&w.y!=s||(w.y==r&&0!=(1&y)||w.y==s&&0!=(64&y))&&(y^=128));var k=w;null==v.p1?v.p1=k.prev=k.next=k:(k.prev=v.p1,k.next=v.p1.next,v.p1.next.prev=k,v.p1.next=k),v.p1=k}}v.p1=v.p1.next,1!=(v.key1=y)&&4!=y&&16!=y&&64!=y&&3!=y&&12!=y&&48!=y&&192!=y&&129!=y&&6!=y&&24!=y&&96!=y&&5!=y&&20!=y&&80!=y&&65!=y&&17!=y&&68!=y||(y=0,v.key1=0,v.p1=null),0==y?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else{var S=qp.ISO(e,.5*(i+a),.5*(r+s))<0;if(10==d)if(S){var C=187;v.okey1=C;for(var N=0;N<8;){var P=N++;if(0!=(C&1<<P)){var M=null;0==P?(M=Rp.get(i,r),(_||p)&&(M.forced=!0)):2==P?(M=Rp.get(a,r),(u||p)&&(M.forced=!0)):4==P?(M=Rp.get(a,s),(u||h)&&(M.forced=!0)):6==P?(M=Rp.get(i,s),(_||h)&&(M.forced=!0)):1==P?(null==(M=n.get(l,o<<1))?(M=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,M)):M=Rp.get(M.x,M.y),p&&(M.forced=!0),M.x!=i&&M.x!=a||(M.x==i&&0!=(1&C)||M.x==a&&0!=(4&C))&&(C^=2)):5==P?(null==(M=n.get(l,2+(o<<1)))?(M=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),M)):M=Rp.get(M.x,M.y),h&&(M.forced=!0),M.x!=i&&M.x!=a||(M.x==i&&0!=(64&C)||M.x==a&&0!=(16&C))&&(C^=32)):3==P?(null==(M=n.get(l+1,1+(o<<1)))?(M=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),M)):M=Rp.get(M.x,M.y),u&&(M.forced=!0),M.y!=r&&M.y!=s||(M.y==r&&0!=(4&C)||M.y==s&&0!=(16&C))&&(C^=8)):(null==(M=n.get(l,1+(o<<1)))?(M=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),M)):M=Rp.get(M.x,M.y),_&&(M.forced=!0),M.y!=r&&M.y!=s||(M.y==r&&0!=(1&C)||M.y==s&&0!=(64&C))&&(C^=128));var I=M;null==v.p1?v.p1=I.prev=I.next=I:(I.prev=v.p1,I.next=v.p1.next,v.p1.next.prev=I,v.p1.next=I),v.p1=I}}v.p1=v.p1.next,1!=(v.key1=C)&&4!=C&&16!=C&&64!=C&&3!=C&&12!=C&&48!=C&&192!=C&&129!=C&&6!=C&&24!=C&&96!=C&&5!=C&&20!=C&&80!=C&&65!=C&&17!=C&&68!=C||(C=0,v.key1=0,v.p1=null),0==C?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else{var A=131;v.okey1=A;for(var T=0;T<8;){var D=T++;if(0!=(A&1<<D)){var E=null;0==D?(E=Rp.get(i,r),(_||p)&&(E.forced=!0)):2==D?(E=Rp.get(a,r),(u||p)&&(E.forced=!0)):4==D?(E=Rp.get(a,s),(u||h)&&(E.forced=!0)):6==D?(E=Rp.get(i,s),(_||h)&&(E.forced=!0)):1==D?(null==(E=n.get(l,o<<1))?(E=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,E)):E=Rp.get(E.x,E.y),p&&(E.forced=!0),E.x!=i&&E.x!=a||(E.x==i&&0!=(1&A)||E.x==a&&0!=(4&A))&&(A^=2)):5==D?(null==(E=n.get(l,2+(o<<1)))?(E=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),E)):E=Rp.get(E.x,E.y),h&&(E.forced=!0),E.x!=i&&E.x!=a||(E.x==i&&0!=(64&A)||E.x==a&&0!=(16&A))&&(A^=32)):3==D?(null==(E=n.get(l+1,1+(o<<1)))?(E=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),E)):E=Rp.get(E.x,E.y),u&&(E.forced=!0),E.y!=r&&E.y!=s||(E.y==r&&0!=(4&A)||E.y==s&&0!=(16&A))&&(A^=8)):(null==(E=n.get(l,1+(o<<1)))?(E=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),E)):E=Rp.get(E.x,E.y),_&&(E.forced=!0),E.y!=r&&E.y!=s||(E.y==r&&0!=(1&A)||E.y==s&&0!=(64&A))&&(A^=128));var O=E;null==v.p1?v.p1=O.prev=O.next=O:(O.prev=v.p1,O.next=v.p1.next,v.p1.next.prev=O,v.p1.next=O),v.p1=O}}if(v.p1=v.p1.next,1!=(v.key1=A)&&4!=A&&16!=A&&64!=A&&3!=A&&12!=A&&48!=A&&192!=A&&129!=A&&6!=A&&24!=A&&96!=A&&5!=A&&20!=A&&80!=A&&65!=A&&17!=A&&68!=A||(A=0,v.key1=0,v.p1=null),0!=A){var B=56;v.okey2=B;for(var L=0;L<8;){var j=L++;if(0!=(B&1<<j)){var F=null;0==j?(F=Rp.get(i,r),(_||p)&&(F.forced=!0)):2==j?(F=Rp.get(a,r),(u||p)&&(F.forced=!0)):4==j?(F=Rp.get(a,s),(u||h)&&(F.forced=!0)):6==j?(F=Rp.get(i,s),(_||h)&&(F.forced=!0)):1==j?(null==(F=n.get(l,o<<1))?(F=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,F)):F=Rp.get(F.x,F.y),p&&(F.forced=!0),F.x!=i&&F.x!=a||(F.x==i&&0!=(1&B)||F.x==a&&0!=(4&B))&&(B^=2)):5==j?(null==(F=n.get(l,2+(o<<1)))?(F=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),F)):F=Rp.get(F.x,F.y),h&&(F.forced=!0),F.x!=i&&F.x!=a||(F.x==i&&0!=(64&B)||F.x==a&&0!=(16&B))&&(B^=32)):3==j?(null==(F=n.get(l+1,1+(o<<1)))?(F=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),F)):F=Rp.get(F.x,F.y),u&&(F.forced=!0),F.y!=r&&F.y!=s||(F.y==r&&0!=(4&B)||F.y==s&&0!=(16&B))&&(B^=8)):(null==(F=n.get(l,1+(o<<1)))?(F=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),F)):F=Rp.get(F.x,F.y),_&&(F.forced=!0),F.y!=r&&F.y!=s||(F.y==r&&0!=(1&B)||F.y==s&&0!=(64&B))&&(B^=128));var R=F;null==v.p2?v.p2=R.prev=R.next=R:(R.prev=v.p2,R.next=v.p2.next,v.p2.next.prev=R,v.p2.next=R),v.p2=R}}v.p2=v.p2.next,1!=(v.key2=B)&&4!=B&&16!=B&&64!=B&&3!=B&&12!=B&&48!=B&&192!=B&&129!=B&&6!=B&&24!=B&&96!=B&&5!=B&&20!=B&&80!=B&&65!=B&&17!=B&&68!=B||(B=0,v.key2=0,v.p2=null),v.keyr=0==B?(v.pr=v.p1,v.okeyr=v.okey1,v.key1):(v.pr=v.p2,v.okeyr=v.okey2,v.key2)}else{var G=56;v.okey1=G;for(var Z=0;Z<8;){var U=Z++;if(0!=(G&1<<U)){var V=null;0==U?(V=Rp.get(i,r),(_||p)&&(V.forced=!0)):2==U?(V=Rp.get(a,r),(u||p)&&(V.forced=!0)):4==U?(V=Rp.get(a,s),(u||h)&&(V.forced=!0)):6==U?(V=Rp.get(i,s),(_||h)&&(V.forced=!0)):1==U?(null==(V=n.get(l,o<<1))?(V=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,V)):V=Rp.get(V.x,V.y),p&&(V.forced=!0),V.x!=i&&V.x!=a||(V.x==i&&0!=(1&G)||V.x==a&&0!=(4&G))&&(G^=2)):5==U?(null==(V=n.get(l,2+(o<<1)))?(V=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),V)):V=Rp.get(V.x,V.y),h&&(V.forced=!0),V.x!=i&&V.x!=a||(V.x==i&&0!=(64&G)||V.x==a&&0!=(16&G))&&(G^=32)):3==U?(null==(V=n.get(l+1,1+(o<<1)))?(V=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),V)):V=Rp.get(V.x,V.y),u&&(V.forced=!0),V.y!=r&&V.y!=s||(V.y==r&&0!=(4&G)||V.y==s&&0!=(16&G))&&(G^=8)):(null==(V=n.get(l,1+(o<<1)))?(V=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),V)):V=Rp.get(V.x,V.y),_&&(V.forced=!0),V.y!=r&&V.y!=s||(V.y==r&&0!=(1&G)||V.y==s&&0!=(64&G))&&(G^=128));var q=V;null==v.p1?v.p1=q.prev=q.next=q:(q.prev=v.p1,q.next=v.p1.next,v.p1.next.prev=q,v.p1.next=q),v.p1=q}}v.p1=v.p1.next,1!=(v.key1=G)&&4!=G&&16!=G&&64!=G&&3!=G&&12!=G&&48!=G&&192!=G&&129!=G&&6!=G&&24!=G&&96!=G&&5!=G&&20!=G&&80!=G&&65!=G&&17!=G&&68!=G||(G=0,v.key1=0,v.p1=null),0==G?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}}else if(S){var W=238;v.okey1=W;for(var X=0;X<8;){var H=X++;if(0!=(W&1<<H)){var Y=null;0==H?(Y=Rp.get(i,r),(_||p)&&(Y.forced=!0)):2==H?(Y=Rp.get(a,r),(u||p)&&(Y.forced=!0)):4==H?(Y=Rp.get(a,s),(u||h)&&(Y.forced=!0)):6==H?(Y=Rp.get(i,s),(_||h)&&(Y.forced=!0)):1==H?(null==(Y=n.get(l,o<<1))?(Y=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,Y)):Y=Rp.get(Y.x,Y.y),p&&(Y.forced=!0),Y.x!=i&&Y.x!=a||(Y.x==i&&0!=(1&W)||Y.x==a&&0!=(4&W))&&(W^=2)):5==H?(null==(Y=n.get(l,2+(o<<1)))?(Y=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),Y)):Y=Rp.get(Y.x,Y.y),h&&(Y.forced=!0),Y.x!=i&&Y.x!=a||(Y.x==i&&0!=(64&W)||Y.x==a&&0!=(16&W))&&(W^=32)):3==H?(null==(Y=n.get(l+1,1+(o<<1)))?(Y=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),Y)):Y=Rp.get(Y.x,Y.y),u&&(Y.forced=!0),Y.y!=r&&Y.y!=s||(Y.y==r&&0!=(4&W)||Y.y==s&&0!=(16&W))&&(W^=8)):(null==(Y=n.get(l,1+(o<<1)))?(Y=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),Y)):Y=Rp.get(Y.x,Y.y),_&&(Y.forced=!0),Y.y!=r&&Y.y!=s||(Y.y==r&&0!=(1&W)||Y.y==s&&0!=(64&W))&&(W^=128));var J=Y;null==v.p1?v.p1=J.prev=J.next=J:(J.prev=v.p1,J.next=v.p1.next,v.p1.next.prev=J,v.p1.next=J),v.p1=J}}v.p1=v.p1.next,1!=(v.key1=W)&&4!=W&&16!=W&&64!=W&&3!=W&&12!=W&&48!=W&&192!=W&&129!=W&&6!=W&&24!=W&&96!=W&&5!=W&&20!=W&&80!=W&&65!=W&&17!=W&&68!=W||(W=0,v.key1=0,v.p1=null),0==W?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}else{var K=224;v.okey1=K;for(var Q=0;Q<8;){var $=Q++;if(0!=(K&1<<$)){var ee=null;0==$?(ee=Rp.get(i,r),(_||p)&&(ee.forced=!0)):2==$?(ee=Rp.get(a,r),(u||p)&&(ee.forced=!0)):4==$?(ee=Rp.get(a,s),(u||h)&&(ee.forced=!0)):6==$?(ee=Rp.get(i,s),(_||h)&&(ee.forced=!0)):1==$?(null==(ee=n.get(l,o<<1))?(ee=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,ee)):ee=Rp.get(ee.x,ee.y),p&&(ee.forced=!0),ee.x!=i&&ee.x!=a||(ee.x==i&&0!=(1&K)||ee.x==a&&0!=(4&K))&&(K^=2)):5==$?(null==(ee=n.get(l,2+(o<<1)))?(ee=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),ee)):ee=Rp.get(ee.x,ee.y),h&&(ee.forced=!0),ee.x!=i&&ee.x!=a||(ee.x==i&&0!=(64&K)||ee.x==a&&0!=(16&K))&&(K^=32)):3==$?(null==(ee=n.get(l+1,1+(o<<1)))?(ee=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),ee)):ee=Rp.get(ee.x,ee.y),u&&(ee.forced=!0),ee.y!=r&&ee.y!=s||(ee.y==r&&0!=(4&K)||ee.y==s&&0!=(16&K))&&(K^=8)):(null==(ee=n.get(l,1+(o<<1)))?(ee=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),ee)):ee=Rp.get(ee.x,ee.y),_&&(ee.forced=!0),ee.y!=r&&ee.y!=s||(ee.y==r&&0!=(1&K)||ee.y==s&&0!=(64&K))&&(K^=128));var te=ee;null==v.p1?v.p1=te.prev=te.next=te:(te.prev=v.p1,te.next=v.p1.next,v.p1.next.prev=te,v.p1.next=te),v.p1=te}}if(v.p1=v.p1.next,1!=(v.key1=K)&&4!=K&&16!=K&&64!=K&&3!=K&&12!=K&&48!=K&&192!=K&&129!=K&&6!=K&&24!=K&&96!=K&&5!=K&&20!=K&&80!=K&&65!=K&&17!=K&&68!=K||(K=0,v.key1=0,v.p1=null),0!=K){var ne=14;v.okey2=ne;for(var ie=0;ie<8;){var re=ie++;if(0!=(ne&1<<re)){var ae=null;0==re?(ae=Rp.get(i,r),(_||p)&&(ae.forced=!0)):2==re?(ae=Rp.get(a,r),(u||p)&&(ae.forced=!0)):4==re?(ae=Rp.get(a,s),(u||h)&&(ae.forced=!0)):6==re?(ae=Rp.get(i,s),(_||h)&&(ae.forced=!0)):1==re?(null==(ae=n.get(l,o<<1))?(ae=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,ae)):ae=Rp.get(ae.x,ae.y),p&&(ae.forced=!0),ae.x!=i&&ae.x!=a||(ae.x==i&&0!=(1&ne)||ae.x==a&&0!=(4&ne))&&(ne^=2)):5==re?(null==(ae=n.get(l,2+(o<<1)))?(ae=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),ae)):ae=Rp.get(ae.x,ae.y),h&&(ae.forced=!0),ae.x!=i&&ae.x!=a||(ae.x==i&&0!=(64&ne)||ae.x==a&&0!=(16&ne))&&(ne^=32)):3==re?(null==(ae=n.get(l+1,1+(o<<1)))?(ae=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),ae)):ae=Rp.get(ae.x,ae.y),u&&(ae.forced=!0),ae.y!=r&&ae.y!=s||(ae.y==r&&0!=(4&ne)||ae.y==s&&0!=(16&ne))&&(ne^=8)):(null==(ae=n.get(l,1+(o<<1)))?(ae=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),ae)):ae=Rp.get(ae.x,ae.y),_&&(ae.forced=!0),ae.y!=r&&ae.y!=s||(ae.y==r&&0!=(1&ne)||ae.y==s&&0!=(64&ne))&&(ne^=128));var se=ae;null==v.p2?v.p2=se.prev=se.next=se:(se.prev=v.p2,se.next=v.p2.next,v.p2.next.prev=se,v.p2.next=se),v.p2=se}}v.p2=v.p2.next,1!=(v.key2=ne)&&4!=ne&&16!=ne&&64!=ne&&3!=ne&&12!=ne&&48!=ne&&192!=ne&&129!=ne&&6!=ne&&24!=ne&&96!=ne&&5!=ne&&20!=ne&&80!=ne&&65!=ne&&17!=ne&&68!=ne||(ne=0,v.key2=0,v.p2=null),v.keyr=0==ne?(v.pr=v.p1,v.okeyr=v.okey1,v.key1):(v.pr=v.p2,v.okeyr=v.okey2,v.key2)}else{var le=14;v.okey1=le;for(var oe=0;oe<8;){var _e=oe++;if(0!=(le&1<<_e)){var pe=null;0==_e?(pe=Rp.get(i,r),(_||p)&&(pe.forced=!0)):2==_e?(pe=Rp.get(a,r),(u||p)&&(pe.forced=!0)):4==_e?(pe=Rp.get(a,s),(u||h)&&(pe.forced=!0)):6==_e?(pe=Rp.get(i,s),(_||h)&&(pe.forced=!0)):1==_e?(null==(pe=n.get(l,o<<1))?(pe=Rp.get(this.xlerp(i,a,r,m,f,e,c),r),n.set(l,o<<1,pe)):pe=Rp.get(pe.x,pe.y),p&&(pe.forced=!0),pe.x!=i&&pe.x!=a||(pe.x==i&&0!=(1&le)||pe.x==a&&0!=(4&le))&&(le^=2)):5==_e?(null==(pe=n.get(l,2+(o<<1)))?(pe=Rp.get(this.xlerp(i,a,s,b,g,e,c),s),n.set(l,2+(o<<1),pe)):pe=Rp.get(pe.x,pe.y),h&&(pe.forced=!0),pe.x!=i&&pe.x!=a||(pe.x==i&&0!=(64&le)||pe.x==a&&0!=(16&le))&&(le^=32)):3==_e?(null==(pe=n.get(l+1,1+(o<<1)))?(pe=Rp.get(a,this.ylerp(r,s,a,f,g,e,c)),n.set(l+1,1+(o<<1),pe)):pe=Rp.get(pe.x,pe.y),u&&(pe.forced=!0),pe.y!=r&&pe.y!=s||(pe.y==r&&0!=(4&le)||pe.y==s&&0!=(16&le))&&(le^=8)):(null==(pe=n.get(l,1+(o<<1)))?(pe=Rp.get(i,this.ylerp(r,s,i,m,b,e,c)),n.set(l,1+(o<<1),pe)):pe=Rp.get(pe.x,pe.y),_&&(pe.forced=!0),pe.y!=r&&pe.y!=s||(pe.y==r&&0!=(1&le)||pe.y==s&&0!=(64&le))&&(le^=128));var ue=pe;null==v.p1?v.p1=ue.prev=ue.next=ue:(ue.prev=v.p1,ue.next=v.p1.next,v.p1.next.prev=ue,v.p1.next=ue),v.p1=ue}}v.p1=v.p1.next,1!=(v.key1=le)&&4!=le&&16!=le&&64!=le&&3!=le&&12!=le&&48!=le&&192!=le&&129!=le&&6!=le&&24!=le&&96!=le&&5!=le&&20!=le&&80!=le&&65!=le&&17!=le&&68!=le||(le=0,v.key1=0,v.p1=null),0==le?v=null:(v.pr=v.p1,v.okeyr=v.okey1,v.keyr=v.key1)}}}return v},lerp:function(e,t,n,i){if(0==n)return e;if(0==i)return t;var r=n-i,a=r*r<lo.epsilon*lo.epsilon?.5:n/r;return a<0?a=0:1<a&&(a=1),e+a*(t-e)},xlerp:function(e,t,n,i,r,a,s){for(var l=this.lerp(e,t,i,r);0!=s--&&e<l&&l<t;){var o=qp.ISO(a,l,n);if(0==o)break;i*o<0?(t=l,r=o):(e=l,i=o),l=this.lerp(e,t,i,r)}return l},ylerp:function(e,t,n,i,r,a,s){for(var l=this.lerp(e,t,i,r);0!=s--&&e<l&&l<t;){var o=qp.ISO(a,n,l);if(0==o)break;i*o<0?(t=l,r=o):(e=l,i=o),l=this.lerp(e,t,i,r)}return l},__class__:qp};var Wp=function(){this.next=null,this._invalidate=null,this.ty=0,this.tx=0,this.d=0,this.c=0,this.b=0,this.a=0,this.outer=null};(n["zpp_nape.geom.ZPP_Mat23"]=Wp).__name__=["zpp_nape","geom","ZPP_Mat23"],Wp.get=function(){var e;return null==Wp.zpp_pool?e=new Wp:(e=Wp.zpp_pool,Wp.zpp_pool=e.next,e.next=null),e.alloc(),e},Wp.identity=function(){var e=Wp.get();return e.setas(1,0,0,1,0,0),e},Wp.prototype={outer:null,wrapper:function(){if(null==this.outer){this.outer=new o_;var e=this.outer.zpp_inner;e.free(),e.next=Wp.zpp_pool,Wp.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},a:null,b:null,c:null,d:null,tx:null,ty:null,_invalidate:null,invalidate:function(){null!=this._invalidate&&this._invalidate()},set:function(e){this.setas(e.a,e.b,e.c,e.d,e.tx,e.ty)},setas:function(e,t,n,i,r,a){this.tx=r,this.ty=a,this.a=e,this.b=t,this.c=n,this.d=i},next:null,free:function(){},alloc:function(){},__class__:Wp};var Xp=function(e,t){this.x=null,this.n=0,this.m=0,this.outer=null,this.m=e,this.n=t,this.x=[];for(var n=0,i=e*t;n<i;)n++,this.x.push(0)};(n["zpp_nape.geom.ZPP_MatMN"]=Xp).__name__=["zpp_nape","geom","ZPP_MatMN"],Xp.prototype={outer:null,m:null,n:null,x:null,__class__:Xp};var Hp=function(){};(n["zpp_nape.geom.ZPP_Monotone"]=Hp).__name__=["zpp_nape","geom","ZPP_Monotone"],Hp.bisector=function(e){var t,n,i,r,a=e.prev,s=e.next;t=e.x-a.x,n=e.y-a.y,i=s.x-e.x,r=s.y-e.y;var l=pu.get(-n-r,t+i),o=l.x*l.x+l.y*l.y,_=oc.invsqrt(o);return l.x*=_,l.y*=_,r*t-i*n<0&&(l.x=-l.x,l.y=-l.y),l},Hp.below=function(e,t){if(e.y<t.y)return!0;if(e.y>t.y)return!1;if(e.x<t.x)return!0;if(e.x>t.x)return!1;var n=Hp.bisector(e),i=Hp.bisector(t);n.x+=1*e.x,n.y+=1*e.y,i.x+=1*t.x,i.y+=1*t.y;var r=n.x<i.x||n.x==i.x&&n.y<i.y,a=n;a.free(),a.next=pu.zpp_pool,pu.zpp_pool=a;var s=i;return s.free(),s.next=pu.zpp_pool,pu.zpp_pool=s,r},Hp.above=function(e,t){return Hp.below(t,e)},Hp.left_vertex=function(e){var t=e.prev;return t.y>e.y||t.y==e.y&&e.next.y<e.y},Hp.isMonotone=function(e){var t=e,n=e,i=e.next,r=e;if(null!=i)for(var a=i;;){var s=a;if(s.y<t.y&&(t=s),s.y>n.y&&(n=s),(a=a.next)==r)break}var l=!0,o=t;if(n!=t.next){var _=t.next,p=n;if(null!=_)for(var u=_;;){var h=u;if(h.y<o.y){l=!1;break}if(o=h,(u=u.next)==p)break}}if(!l)return!1;if(n!=(o=t).prev){var c=t.prev,d=n;if(null!=c)for(var m=c;;){var f=m;if(f.y<o.y){l=!1;break}if(o=f,(m=m.prev)==d)break}}return l},Hp.getShared=function(){return null==Hp.sharedPPoly&&(Hp.sharedPPoly=new Jp),Hp.sharedPPoly},Hp.decompose=function(e,t){if(null==t?t=new Jp(e):t.init(e),null==t.vertices)return t;null==Hp.queue&&(Hp.queue=new Wu);var n=t.vertices,i=t.vertices;if(null!=n)for(var r=n;;){var a,s,l,o=r;Hp.queue.add(o),a=o.next.x-o.x,s=o.next.y-o.y,l=o.prev.x-o.x;var _=0<(o.prev.y-o.y)*a-l*s;if(o.type=Hp.below(o.prev,o)?Hp.below(o.next,o)?_?0:3:4:Hp.below(o,o.next)?_?1:2:4,(r=r.next)==i)break}var p=Hp.queue;if(!p.empty()&&null!=p.begin().next){for(var u,h,c,d=p.begin(),m=null,f=null,g=null,v=null,b=1;;){for(u=0,f=d,m=d=null;null!=f;){for(++u,g=f,h=0,c=b;null!=g&&h<b;)++h,g=g.next;for(;0<h||0<c&&null!=g;)0==h?(g=(v=g).next,--c):0==c||null==g||Hp.above(f.elem(),g.elem())?(f=(v=f).next,--h):(g=(v=g).next,--c),null!=m?m.next=v:d=v,m=v;f=g}if(m.next=null,b<<=1,!(1<u))break}p.setbegin(d)}for(null==Hp.edges&&(null==hc.zpp_pool?Hp.edges=new hc:(Hp.edges=hc.zpp_pool,hc.zpp_pool=Hp.edges.next,Hp.edges.next=null),Hp.edges.alloc(),Hp.edges.lt=Yp.edge_lt,Hp.edges.swapped=Yp.edge_swap);!Hp.queue.empty();){var y=Hp.queue.pop_unsafe();switch(y.type){case 0:(y.helper=y).node=Hp.edges.insert(y);break;case 1:var x=y.prev;2==x.helper.type&&t.add_diagonal(y,x.helper),Hp.edges.remove_node(x.node);break;case 2:var z=y.prev;2==z.helper.type&&t.add_diagonal(y,z.helper),Hp.edges.remove_node(z.node);var w=null;if(!Hp.edges.empty()){for(var k=Hp.edges.parent;null!=k.prev;)k=k.prev;for(;null!=k;){var S=k.data;if(!Yp.vert_lt(S,y)){w=S;break}if(null!=k.next)for(k=k.next;null!=k.prev;)k=k.prev;else{for(;null!=k.parent&&k==k.parent.next;)k=k.parent;k=k.parent}}}var C=w;null!=C&&(2==C.helper.type&&t.add_diagonal(y,C.helper),C.helper=y);break;case 3:var N=null;if(!Hp.edges.empty()){for(var P=Hp.edges.parent;null!=P.prev;)P=P.prev;for(;null!=P;){var M=P.data;if(!Yp.vert_lt(M,y)){N=M;break}if(null!=P.next)for(P=P.next;null!=P.prev;)P=P.prev;else{for(;null!=P.parent&&P==P.parent.next;)P=P.parent;P=P.parent}}}var I=N;null!=I&&(t.add_diagonal(y,I.helper),I.helper=y),y.node=Hp.edges.insert(y),y.helper=y;break;case 4:var A=y.prev;if(Hp.left_vertex(y))2==A.helper.type&&t.add_diagonal(y,A.helper),Hp.edges.remove_node(A.node),y.node=Hp.edges.insert(y),y.helper=y;else{var T=null;if(!Hp.edges.empty()){for(var D=Hp.edges.parent;null!=D.prev;)D=D.prev;for(;null!=D;){var E=D.data;if(!Yp.vert_lt(E,y)){T=E;break}if(null!=D.next)for(D=D.next;null!=D.prev;)D=D.prev;else{for(;null!=D.parent&&D==D.parent.next;)D=D.parent;D=D.parent}}}var O=T;2==O.helper.type&&t.add_diagonal(y,O.helper),O.helper=y}}}return t};var Yp=function(){this.node=null,this.prev=null,this.next=null,this.rightchain=!1,this.helper=null,this.type=0,this.diagonals=null,this.forced=!1,this.y=0,this.x=0,this.mag=0,this.id=0,this.id=Yp.nextId++,this.diagonals=new Wu};(n["zpp_nape.geom.ZPP_PartitionVertex"]=Yp).__name__=["zpp_nape","geom","ZPP_PartitionVertex"],Yp.get=function(e){var t;return null==Yp.zpp_pool?t=new Yp:(t=Yp.zpp_pool,Yp.zpp_pool=t.next,t.next=null),t.alloc(),t.x=e.x,t.y=e.y,t},Yp.rightdistance=function(e,t){var n,i,r,a=e.next.y>e.y;return n=e.next.x-e.x,i=e.next.y-e.y,r=t.x-e.x,(a?-1:1)*((t.y-e.y)*n-r*i)},Yp.vert_lt=function(e,t){if(t==e||t==e.next)return!0;if(e.y!=e.next.y)return Yp.rightdistance(e,t)<=0;var n=e.x,i=e.next.x;return(n<i?n:i)<=t.x},Yp.edge_swap=function(e,t){var n=e.node;e.node=t.node,t.node=n},Yp.edge_lt=function(e,t){if(e==t&&e.next==t.next)return!1;if(e==t.next)return!Yp.vert_lt(e,t);if(t==e.next)return Yp.vert_lt(t,e);if(e.y==e.next.y){if(t.y!=t.next.y)return 0<Yp.rightdistance(t,e)||0<Yp.rightdistance(t,e.next);var n=e.x,i=e.next.x,r=t.x,a=t.next.x;return(a<r?r:a)<(i<n?n:i)}var s=Yp.rightdistance(e,t),l=Yp.rightdistance(e,t.next);if(0==s&&0==l){var o=e.x,_=e.next.x,p=t.x,u=t.next.x;return(u<p?p:u)<(_<o?o:_)}if(0<=s*l)return s<0||l<0;var h=Yp.rightdistance(t,e),c=Yp.rightdistance(t,e.next);return 0<=h*c&&(0<h||0<c)},Yp.prototype={id:null,mag:null,x:null,y:null,forced:null,diagonals:null,type:null,helper:null,rightchain:null,next:null,prev:null,alloc:function(){},free:function(){this.helper=null},copy:function(){var e;return null==Yp.zpp_pool?e=new Yp:(e=Yp.zpp_pool,Yp.zpp_pool=e.next,e.next=null),e.alloc(),e.x=this.x,e.y=this.y,e.forced=this.forced,e},sort:function(){var e=0,t=0,n=0;e=this.prev.x-this.x,t=this.prev.y-this.y,n=this.next.x-this.x;var i=(this.next.y-this.y)*e-n*t,r=0<i?-1:0==i?0:1,a=this.diagonals;if(!a.empty()&&null!=a.begin().next){for(var s,l,o,_=a.begin(),p=null,u=null,h=null,c=null,d=1;;){for(s=0,u=_,p=_=null;null!=u;){for(++s,h=u,l=0,o=d;null!=h&&l<d;)++l,h=h.next;for(;0<l||0<o&&null!=h;){if(0==l)h=(c=h).next,--o;else if(0==o||null==h)u=(c=u).next,--l;else{var m;if(1==r){e=u.elem().x-this.x,t=u.elem().y-this.y,n=h.elem().x-this.x;var f=(h.elem().y-this.y)*e-n*t;m=1==(0<f?-1:0==f?0:1)}else{e=this.prev.x-this.x,t=this.prev.y-this.y,n=u.elem().x-this.x;var g=(u.elem().y-this.y)*e-n*t,v=0<g?-1:0==g?0:1;e=this.prev.x-this.x,t=this.prev.y-this.y,n=h.elem().x-this.x;var b=(h.elem().y-this.y)*e-n*t,y=0<b?-1:0==b?0:1;if(v*y==1||v*y==0&&(1==v||1==y)){e=u.elem().x-this.x,t=u.elem().y-this.y,n=h.elem().x-this.x;var x=(h.elem().y-this.y)*e-n*t;m=1==(0<x?-1:0==x?0:1)}else if(-1==v||-1==y)m=-1==y;else if(0==v&&0==y){e=this.x-this.prev.x,t=this.y-this.prev.y;var z=e*(n=u.elem().x-this.x)+t*(u.elem().y-this.y),w=e*(n=h.elem().x-this.x)+t*(h.elem().y-this.y);m=z<0&&0<w||!(w<0&&0<z)}else m=!0}m?(u=(c=u).next,--l):(h=(c=h).next,--o)}null!=p?p.next=c:_=c,p=c}u=h}if(p.next=null,d<<=1,!(1<s))break}a.setbegin(_)}},node:null,__class__:Yp};var Jp=function(e){this.next=null,this.vertices=null,this.init(e)};(n["zpp_nape.geom.ZPP_PartitionedPoly"]=Jp).__name__=["zpp_nape","geom","ZPP_PartitionedPoly"],Jp.getSharedPP=function(){return null==Jp.sharedPPList&&(Jp.sharedPPList=new Xu),Jp.sharedPPList},Jp.getShared=function(){return null==Jp.sharedGVList&&(Jp.sharedGVList=new Hu),Jp.sharedGVList},Jp.prototype={vertices:null,eq:function(e,t){return hu.vec_dsq(e.x,e.y,t.x,t.y)<lo.epsilon*lo.epsilon},next:null,alloc:function(){},free:function(){},init:function(e){if(null!=e){var t=0,n=e;if(null!=e)for(var i=e;;){var r=i;if(t+=r.x*(r.next.y-r.prev.y),(i=i.next)==n)break}for(var a=0<.5*t,s=e;;){var l;if(a){var o=Yp.get(s);null==this.vertices?this.vertices=o.prev=o.next=o:(o.prev=this.vertices,o.next=this.vertices.next,this.vertices.next.prev=o,this.vertices.next=o),l=o}else{var _=Yp.get(s);null==this.vertices?this.vertices=_.prev=_.next=_:(_.next=this.vertices,_.prev=this.vertices.prev,this.vertices.prev.next=_,this.vertices.prev=_),l=_}if(this.vertices=l,this.vertices.forced=s.forced,(s=s.next)==e)break}this.remove_collinear_vertices()}},remove_collinear_vertices:function(){for(var e,t=this.vertices,n=!0;n||t!=this.vertices;)if(n=!1,this.eq(t,t.next)){if(t==this.vertices&&(this.vertices=t.next,n=!0),t.forced&&(t.next.forced=!0),null!=t&&t.prev==t){t.next=t.prev=null;var i=t;i.free(),i.next=Yp.zpp_pool,Yp.zpp_pool=i,t=t=null}else{var r=t.next;t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null;var a=t;a.free(),a.next=Yp.zpp_pool,Yp.zpp_pool=a,t=null,t=r}if(null==t){this.vertices=null;break}}else t=t.next;if(null==this.vertices)return!0;for(;;){for(e=!1,t=this.vertices,n=!0;n||t!=this.vertices;){n=!1;var s,l,o,_=t.prev;s=t.x-_.x,l=t.y-_.y,o=t.next.x-t.x;var p=(t.next.y-t.y)*s-o*l;if(lo.epsilon*lo.epsilon<=p*p)t=t.next;else{if(t==this.vertices&&(this.vertices=t.next,n=!0),null!=t&&t.prev==t){t.next=t.prev=null;var u=t;u.free(),u.next=Yp.zpp_pool,Yp.zpp_pool=u,t=t=null}else{var h=t.next;t.prev.next=t.next,t.next.prev=t.prev,t.next=t.prev=null;var c=t;c.free(),c.next=Yp.zpp_pool,Yp.zpp_pool=c,t=null,t=h}if(e=!0,null==t){e=!1,this.vertices=null;break}}}if(!e)break}return null==this.vertices},add_diagonal:function(e,t){e.diagonals.add(t),t.diagonals.add(e),e.forced=t.forced=!0},extract_partitions:function(e){if(null==e&&(e=new Xu),null!=this.vertices){var t=this.vertices,n=this.vertices;if(null!=t)for(var i=t;i.sort(),(i=i.next)!=n;);for(this.pull_partitions(this.vertices,e);null!=this.vertices;){var r;if(null!=this.vertices&&this.vertices.prev==this.vertices){this.vertices.next=this.vertices.prev=null;var a=this.vertices;a.free(),a.next=Yp.zpp_pool,Yp.zpp_pool=a,r=this.vertices=null}else{var s=this.vertices.next;this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null;var l=this.vertices;l.free(),l.next=Yp.zpp_pool,Yp.zpp_pool=l,this.vertices=null,r=s}this.vertices=r}for(var o=null,_=e.begin();null!=_;)_.elem().remove_collinear_vertices()?e.erase(o):_=(o=_).next}return e},pull_partitions:function(e,t){var n;null==Jp.zpp_pool?n=new Jp:(n=Jp.zpp_pool,Jp.zpp_pool=n.next,n.next=null),n.alloc();for(var i=e;;){var r=i.copy();if(null==n.vertices?n.vertices=r.prev=r.next=r:(r.prev=n.vertices,r.next=n.vertices.next,n.vertices.next.prev=r,n.vertices.next=r),n.vertices=r,n.vertices.forced=i.forced,i.diagonals.empty())i=i.next;else{if(i.diagonals.inlined_pop_unsafe()==e)break;i=this.pull_partitions(i,t)}if(i==e)break}var a=0,s=n.vertices,l=n.vertices;if(null!=s)for(var o=s;;){var _=o;if(a+=_.x*(_.next.y-_.prev.y),(o=o.next)==l)break}return.5*a!=0&&t.add(n),i},extract:function(e){if(null==e&&(e=new Hu),null!=this.vertices){var t=this.vertices,n=this.vertices;if(null!=t)for(var i=t;i.sort(),(i=i.next)!=n;);for(this.pull(this.vertices,e);null!=this.vertices;){var r;if(null!=this.vertices&&this.vertices.prev==this.vertices){this.vertices.next=this.vertices.prev=null;var a=this.vertices;a.free(),a.next=Yp.zpp_pool,Yp.zpp_pool=a,r=this.vertices=null}else{var s=this.vertices.next;this.vertices.prev.next=this.vertices.next,this.vertices.next.prev=this.vertices.prev,this.vertices.next=this.vertices.prev=null;var l=this.vertices;l.free(),l.next=Yp.zpp_pool,Yp.zpp_pool=l,this.vertices=null,r=s}this.vertices=r}}return e},pull:function(e,t){for(var n=null,i=e;;){var r=Rp.get(i.x,i.y);if(null==n?n=r.prev=r.next=r:(r.prev=n,r.next=n.next,n.next.prev=r,n.next=r),(n=r).forced=i.forced,i.diagonals.empty())i=i.next;else{if(i.diagonals.inlined_pop_unsafe()==e)break;i=this.pull(i,t)}if(i==e)break}var a=0,s=n;if(null!=n)for(var l=n;;){var o=l;if(a+=o.x*(o.next.y-o.prev.y),(l=l.next)==s)break}var _=.5*a;if(lo.epsilon*lo.epsilon<=_*_){for(var p=n,u=!0;u||p!=n;)if(u=!1,hu.vec_dsq(p.x,p.y,p.next.x,p.next.y)<lo.epsilon*lo.epsilon){if(p==n&&(n=p.next,u=!0),p.forced&&(p.next.forced=!0),null!=p&&p.prev==p)p.next=p.prev=null,p=p=null;else{var h=p.next;p.prev.next=p.next,p.next.prev=p.prev,p.next=p.prev=null,p=null,p=h}if(null==p){n=null;break}}else p=p.next;if(null!=n)for(var c;;){for(p=n,u=!(c=!1);u||p!=n;){u=!1;var d,m,f,g=p.prev;d=p.x-g.x,m=p.y-g.y,f=p.next.x-p.x;var v=(p.next.y-p.y)*d-f*m;if(lo.epsilon*lo.epsilon<=v*v)p=p.next;else{if(p==n&&(n=p.next,u=!0),null!=p&&p.prev==p)p.next=p.prev=null,p=p=null;else{var b=p.next;p.prev.next=p.next,p.next.prev=p.prev,p.next=p.prev=null,p=null,p=b}if(c=!0,null==p){c=!1,n=null;break}}}if(!c)break}null!=n&&t.add(n)}return i},__class__:Jp};var Kp=function(){this.zip_dir=!1,this.absnormaly=0,this.absnormalx=0,this.normaly=0,this.normalx=0,this.idiry=0,this.idirx=0,this.diry=0,this.dirx=0,this.originy=0,this.originx=0,this.userData=null,this.maxdist=0,this.direction=null,this.origin=null,this.origin=d_.get(),this.origin.zpp_inner._invalidate=yc(this,this.origin_invalidate),this.direction=d_.get(),this.direction.zpp_inner._invalidate=yc(this,this.direction_invalidate),this.originx=0,this.originy=0,this.dirx=0,this.diry=0,this.zip_dir=!1};(n["zpp_nape.geom.ZPP_Ray"]=Kp).__name__=["zpp_nape","geom","ZPP_Ray"],Kp.prototype={origin:null,direction:null,maxdist:null,userData:null,originx:null,originy:null,dirx:null,diry:null,idirx:null,idiry:null,normalx:null,normaly:null,absnormalx:null,absnormaly:null,origin_invalidate:function(e){this.originx=e.x,this.originy=e.y},direction_invalidate:function(e){this.dirx=e.x,this.diry=e.y,this.invalidate_dir()},zip_dir:null,invalidate_dir:function(){this.zip_dir=!0},validate_dir:function(){if(this.zip_dir){this.zip_dir=!1;var e=this.dirx*this.dirx+this.diry*this.diry,t=1/Math.sqrt(e);this.dirx*=t,this.diry*=t,this.idirx=1/this.dirx,this.idiry=1/this.diry,this.normalx=-this.diry,this.normaly=this.dirx;var n=this.normalx;this.absnormalx=n<0?-n:n;var i=this.normaly;this.absnormaly=i<0?-i:i}},rayAABB:function(){var e=this.originx,t=e,n=this.originy,i=n;if(this.maxdist>=X_.POSINF()?(0<this.dirx?t=X_.POSINF():this.dirx<0&&(t=X_.NEGINF()),0<this.diry?i=X_.POSINF():this.diry<0&&(i=X_.NEGINF())):(t+=this.maxdist*this.dirx,i+=this.maxdist*this.diry),t<e){var r=e;e=t,t=r}if(i<n){var a=n;n=i,i=a}return Ap.get(e,n,t,i)},aabbtest:function(e){var t=this.normalx*(this.originx-.5*(e.minx+e.maxx))+this.normaly*(this.originy-.5*(e.miny+e.maxy));return(t<0?-t:t)<.5*this.absnormalx*(e.maxx-e.minx)+.5*this.absnormaly*(e.maxy-e.miny)},aabbsect:function(e){var t=this.originx>=e.minx&&this.originx<=e.maxx,n=this.originy>=e.miny&&this.originy<=e.maxy;if(t&&n)return 0;for(var i=-1;!(0<=this.dirx&&this.originx>=e.maxx||this.dirx<=0&&this.originx<=e.minx||0<=this.diry&&this.originy>=e.maxy||this.diry<=0&&this.originy<=e.miny);){if(0<this.dirx){var r=(e.minx-this.originx)*this.idirx;if(0<=r&&r<=this.maxdist){var a=this.originy+r*this.diry;if(a>=e.miny&&a<=e.maxy){i=r;break}}}else if(this.dirx<0){var s=(e.maxx-this.originx)*this.idirx;if(0<=s&&s<=this.maxdist){var l=this.originy+s*this.diry;if(l>=e.miny&&l<=e.maxy){i=s;break}}}if(0<this.diry){var o=(e.miny-this.originy)*this.idiry;if(0<=o&&o<=this.maxdist){var _=this.originx+o*this.dirx;if(_>=e.minx&&_<=e.maxx){i=o;break}}}else if(this.diry<0){var p=(e.maxy-this.originy)*this.idiry;if(0<=p&&p<=this.maxdist){var u=this.originx+p*this.dirx;if(u>=e.minx&&u<=e.maxx){i=p;break}}}break}return i},circlesect:function(e,t,n){var i,r;e.validate_worldCOM(),i=this.originx-e.worldCOMx,r=this.originy-e.worldCOMy;var a=this.dirx*this.dirx+this.diry*this.diry,s=2*(i*this.dirx+r*this.diry),l=i*i+r*r-e.radius*e.radius,o=s*s-4*a*l;if(0==o){var _=-s/2*a;if((!t||0<l)&&0<_&&_<n&&_<=this.maxdist){var p=0,u=0;p=this.originx,u=this.originy;var h=_;p+=this.dirx*h,u+=this.diry*h;var c=(p-=1*e.worldCOMx)*p+(u-=1*e.worldCOMy)*u,d=1/Math.sqrt(c);return p*=d,u*=d,l<=0&&(p=-p,u=-u),Op.getRay(d_.get(p,u),_,l<=0,e.outer)}return null}var m=(-s-(o=Math.sqrt(o)))*(a=1/(2*a)),f=(-s+o)*a;if(0<m){if(m<n&&m<=this.maxdist){var g=0,v=0;g=this.originx,v=this.originy;var b=m;g+=this.dirx*b,v+=this.diry*b;var y=(g-=1*e.worldCOMx)*g+(v-=1*e.worldCOMy)*v,x=1/Math.sqrt(y);return g*=x,v*=x,Op.getRay(d_.get(g,v),m,!1,e.outer)}return null}if(0<f&&t){if(f<n&&f<=this.maxdist){var z=0,w=0;z=this.originx,w=this.originy;var k=f;z+=this.dirx*k,w+=this.diry*k;var S=(z-=1*e.worldCOMx)*z+(w-=1*e.worldCOMy)*w,C=1/Math.sqrt(S);return z=-(z*=C),w=-(w*=C),Op.getRay(d_.get(z,w),f,!0,e.outer)}return null}return null},circlesect2:function(e,t,n){var i,r;e.validate_worldCOM(),i=this.originx-e.worldCOMx,r=this.originy-e.worldCOMy;var a=this.dirx*this.dirx+this.diry*this.diry,s=2*(i*this.dirx+r*this.diry),l=i*i+r*r-e.radius*e.radius,o=s*s-4*a*l;if(0==o){var _=-s/2*a;if((!t||0<l)&&0<_&&_<=this.maxdist){var p=0,u=0;p=this.originx,u=this.originy;var h=_;p+=this.dirx*h,u+=this.diry*h;var c=(p-=1*e.worldCOMx)*p+(u-=1*e.worldCOMy)*u,d=1/Math.sqrt(c);p*=d,u*=d,l<=0&&(p=-p,u=-u);for(var m=Op.getRay(d_.get(p,u),_,l<=0,e.outer),f=null,g=n.zpp_inner.inner.begin();null!=g;){var v=g.elem();if(m.get_distance()<v.get_distance())break;g=(f=g).next}n.zpp_inner.inner.inlined_insert(f,m)}}else{var b=(-s-(o=Math.sqrt(o)))*(a=1/(2*a)),y=(-s+o)*a;if(0<b&&b<=this.maxdist){var x=0,z=0;x=this.originx,z=this.originy;var w=b;x+=this.dirx*w,z+=this.diry*w;var k=(x-=1*e.worldCOMx)*x+(z-=1*e.worldCOMy)*z,S=1/Math.sqrt(k);x*=S,z*=S;for(var C=Op.getRay(d_.get(x,z),b,!1,e.outer),N=null,P=n.zpp_inner.inner.begin();null!=P;){var M=P.elem();if(C.get_distance()<M.get_distance())break;P=(N=P).next}n.zpp_inner.inner.inlined_insert(N,C)}if(0<y&&y<=this.maxdist&&t){var I=0,A=0;I=this.originx,A=this.originy;var T=y;I+=this.dirx*T,A+=this.diry*T;var D=(I-=1*e.worldCOMx)*I+(A-=1*e.worldCOMy)*A,E=1/Math.sqrt(D);I=-(I*=E),A=-(A*=E);for(var O=Op.getRay(d_.get(I,A),y,!0,e.outer),B=null,L=n.zpp_inner.inner.begin();null!=L;){var j=L.elem();if(O.get_distance()<j.get_distance())break;L=(B=L).next}n.zpp_inner.inner.inlined_insert(B,O)}}},polysect:function(e,t,n){for(var i=n,r=null,a=e.edges.begin(),s=e.gverts.begin(),l=s.elem(),o=s.next;null!=o;){var _=o.elem(),p=a.elem();if(t||p.gnormx*this.dirx+p.gnormy*this.diry<0){var u,h,c,d;u=_.x-l.x,h=_.y-l.y,c=l.x-this.originx,d=l.y-this.originy;var m=h*this.dirx-u*this.diry;if(lo.epsilon<m*m){var f=(h*c-u*d)*(m=1/m);if(0<f&&f<i&&f<=this.maxdist){var g=(this.diry*c-this.dirx*d)*m;-lo.epsilon<g&&g<1+lo.epsilon&&(i=f,r=a.elem())}}}a=a.next,l=_,o=(s=o).next}for(;;){var v=(o=e.gverts.begin()).elem(),b=a.elem();if(t||b.gnormx*this.dirx+b.gnormy*this.diry<0){var y,x,z,w;y=v.x-l.x,x=v.y-l.y,z=l.x-this.originx,w=l.y-this.originy;var k=x*this.dirx-y*this.diry;if(lo.epsilon<k*k){var S=(x*z-y*w)*(k=1/k);if(0<S&&S<i&&S<=this.maxdist){var C=(this.diry*z-this.dirx*w)*k;-lo.epsilon<C&&C<1+lo.epsilon&&(i=S,r=a.elem())}}}a=a.next;break}if(null==r)return null;var N=0,P=0;N=r.gnormx,P=r.gnormy;var M=0<N*this.dirx+P*this.diry;return M&&(N=-N,P=-P),Op.getRay(d_.get(N,P),i,M,e.outer)},polysect2:function(e,t,n){for(var i=X_.POSINF(),r=-1,a=null,s=null,l=e.edges.begin(),o=e.gverts.begin(),_=o.elem(),p=o.next;null!=p;){var u=p.elem(),h=l.elem();if(t||h.gnormx*this.dirx+h.gnormy*this.diry<0){var c,d,m,f;c=u.x-_.x,d=u.y-_.y,m=_.x-this.originx,f=_.y-this.originy;var g=d*this.dirx-c*this.diry;if(lo.epsilon<g*g){var v=(d*m-c*f)*(g=1/g);if(0<v&&v<=this.maxdist&&(v<i||r<v)){var b=(this.diry*m-this.dirx*f)*g;-lo.epsilon<b&&b<1+lo.epsilon&&(v<i&&(i=v,a=l.elem()),r<v&&(r=v,s=l.elem()))}}}l=l.next,_=u,p=(o=p).next}for(;;){var y=(p=e.gverts.begin()).elem(),x=l.elem();if(t||x.gnormx*this.dirx+x.gnormy*this.diry<0){var z,w,k,S;z=y.x-_.x,w=y.y-_.y,k=_.x-this.originx,S=_.y-this.originy;var C=w*this.dirx-z*this.diry;if(lo.epsilon<C*C){var N=(w*k-z*S)*(C=1/C);if(0<N&&N<=this.maxdist&&(N<i||r<N)){var P=(this.diry*k-this.dirx*S)*C;-lo.epsilon<P&&P<1+lo.epsilon&&(N<i&&(i=N,a=l.elem()),r<N&&(r=N,s=l.elem()))}}}l=l.next;break}if(null!=a){var M=0,I=0;M=a.gnormx,I=a.gnormy;var A=0<M*this.dirx+I*this.diry;A&&(M=-M,I=-I);for(var T=Op.getRay(d_.get(M,I),i,A,e.outer),D=null,E=n.zpp_inner.inner.begin();null!=E;){var O=E.elem();if(T.get_distance()<O.get_distance())break;E=(D=E).next}n.zpp_inner.inner.inlined_insert(D,T)}if(null!=s&&a!=s){var B=0,L=0;B=s.gnormx,L=s.gnormy;var j=0<B*this.dirx+L*this.diry;j&&(B=-B,L=-L);for(var F=Op.getRay(d_.get(B,L),r,j,e.outer),R=null,G=n.zpp_inner.inner.begin();null!=G;){var Z=G.elem();if(F.get_distance()<Z.get_distance())break;G=(R=G).next}n.zpp_inner.inner.inlined_insert(R,F)}},__class__:Kp};var Qp=function(){this.node=null,this.next=null,this.id=0,this.links=null,this.y=0,this.x=0,this.forced=!1,this.id=H_.ZPP_SimpleVert(),null==dc.zpp_pool?this.links=new dc:(this.links=dc.zpp_pool,dc.zpp_pool=this.links.next,this.links.next=null),this.links.alloc(),this.links.lt=Qp.less_xy};(n["zpp_nape.geom.ZPP_SimpleVert"]=Qp).__name__=["zpp_nape","geom","ZPP_SimpleVert"],Qp.less_xy=function(e,t){return e.y<t.y||e.y==t.y&&e.x<t.x},Qp.swap_nodes=function(e,t){var n=e.node;e.node=t.node,t.node=n},Qp.get=function(e,t){var n;return null==Qp.zpp_pool?n=new Qp:(n=Qp.zpp_pool,Qp.zpp_pool=n.next,n.next=null),n.alloc(),n.x=e,n.y=t,n},Qp.prototype={forced:null,x:null,y:null,links:null,id:null,next:null,node:null,free:function(){this.links.clear(),this.node=null,this.forced=!1},alloc:function(){},__class__:Qp};var $p=function(){this.node=null,this.prev=null,this.next=null,this.id=0,this.vertices=null,this.right=null,this.left=null,this.id=H_.ZPP_SimpleSeg(),null==dc.zpp_pool?this.vertices=new dc:(this.vertices=dc.zpp_pool,dc.zpp_pool=this.vertices.next,this.vertices.next=null),this.vertices.alloc(),this.vertices.lt=yc(this,this.less_xy)};(n["zpp_nape.geom.ZPP_SimpleSeg"]=$p).__name__=["zpp_nape","geom","ZPP_SimpleSeg"],$p.get=function(e,t){var n;return null==$p.zpp_pool?n=new $p:(n=$p.zpp_pool,$p.zpp_pool=n.next,n.next=null),n.alloc(),n.left=e,n.right=t,n.vertices.insert(e),n.vertices.insert(t),n},$p.prototype={left:null,right:null,vertices:null,id:null,next:null,free:function(){this.left=this.right=null,this.prev=null,this.node=null,this.vertices.clear()},alloc:function(){},prev:null,node:null,less_xy:function(e,t){return e.x<t.x||e.x==t.x&&e.y<t.y},__class__:$p};var eu=function(){this.next=null,this.node=null,this.segment2=null,this.segment=null,this.vertex=null,this.type=0};(n["zpp_nape.geom.ZPP_SimpleEvent"]=eu).__name__=["zpp_nape","geom","ZPP_SimpleEvent"],eu.swap_nodes=function(e,t){var n=e.node;e.node=t.node,t.node=n},eu.less_xy=function(e,t){return e.vertex.x<t.vertex.x||!(e.vertex.x>t.vertex.x)&&(e.vertex.y<t.vertex.y||!(e.vertex.y>t.vertex.y)&&e.type<t.type)},eu.get=function(e){var t;return null==eu.zpp_pool?t=new eu:(t=eu.zpp_pool,eu.zpp_pool=t.next,t.next=null),t.alloc(),t.vertex=e,t},eu.prototype={type:null,vertex:null,segment:null,segment2:null,node:null,next:null,free:function(){this.vertex=null,this.segment=this.segment2=null,this.node=null},alloc:function(){},__class__:eu};var tu=function(){this.tree=null,this.sweepx=0,null==mc.zpp_pool?this.tree=new mc:(this.tree=mc.zpp_pool,mc.zpp_pool=this.tree.next,this.tree.next=null),this.tree.alloc(),this.tree.lt=yc(this,this.edge_lt),this.tree.swapped=yc(this,this.swap_nodes)};(n["zpp_nape.geom.ZPP_SimpleSweep"]=tu).__name__=["zpp_nape","geom","ZPP_SimpleSweep"],tu.prototype={sweepx:null,tree:null,swap_nodes:function(e,t){var n=e.node;e.node=t.node,t.node=n},edge_lt:function(e,t){var n,i=0,r=0,a=0,s=0;if(e.left==t.left&&e.right==t.right)return!1;if(e.left==t.right)return e.left.x==e.right.x?e.left.y<e.right.y?e.left.y>t.left.y:e.right.y>t.left.y:(n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.left.x-e.left.x,s=t.left.y-e.left.y,(n?r*a-i*s:s*i-a*r)<0);if(e.right==t.left)return!(t.left.x==t.right.x?t.left.y<t.right.y?t.left.y>e.left.y:t.right.y>e.left.y:(n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.left.x-t.left.x,s=e.left.y-t.left.y,(n?r*a-i*s:s*i-a*r)<0));if(e.left==t.left)return e.left.x==e.right.x?e.left.y<e.right.y?e.left.y>t.right.y:e.right.y>t.right.y:(n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.right.x-e.left.x,s=t.right.y-e.left.y,(n?r*a-i*s:s*i-a*r)<0);if(e.right==t.right)return e.left.x==e.right.x?e.left.y<e.right.y?e.left.y>t.left.y:e.right.y>t.left.y:(n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.left.x-e.left.x,s=t.left.y-e.left.y,(n?r*a-i*s:s*i-a*r)<0);if(e.left.x==e.right.x){if(t.left.x==t.right.x){var l=e.left.y<e.right.y?e.right:e.left,o=t.left.y<t.right.y?t.right:t.left;return l.y>o.y}n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.left.x-t.left.x,s=e.left.y-t.left.y;var _=n?r*a-i*s:s*i-a*r;return n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.right.x-t.left.x,s=e.right.y-t.left.y,0<=_*(n?r*a-i*s:s*i-a*r)?0<=_:this.sweepx>=e.left.x}if(t.left.x==t.right.x){n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.left.x-e.left.x,s=t.left.y-e.left.y;var p=n?r*a-i*s:s*i-a*r;return n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.right.x-e.left.x,s=t.right.y-e.left.y,0<=p*(n?r*a-i*s:s*i-a*r)?p<0:this.sweepx<t.left.x}n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.left.x-e.left.x,s=t.left.y-e.left.y;var u=(n?r*a-i*s:s*i-a*r)<0;if(n=e.right.x<e.left.x,i=e.right.x-e.left.x,r=e.right.y-e.left.y,a=t.right.x-e.left.x,s=t.right.y-e.left.y,u==(n?r*a-i*s:s*i-a*r)<0)return u;n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.left.x-t.left.x,s=e.left.y-t.left.y;var h=0<=(n?r*a-i*s:s*i-a*r);if(n=t.right.x<t.left.x,i=t.right.x-t.left.x,r=t.right.y-t.left.y,a=e.right.x-t.left.x,s=e.right.y-t.left.y,h==0<=(n?r*a-i*s:s*i-a*r))return h;var c=(this.sweepx-e.left.x)/(e.right.x-e.left.x)*(e.right.y-e.left.y)+e.left.y;return(this.sweepx-t.left.x)/(t.right.x-t.left.x)*(t.right.y-t.left.y)+t.left.y<c},clear:function(){this.tree.clear()},add:function(e){e.node=this.tree.insert(e);var t=this.tree.successor_node(e.node),n=this.tree.predecessor_node(e.node);return null!=t&&(e.next=t.data,t.data.prev=e),null!=n&&(e.prev=n.data,n.data.next=e),e},remove:function(e){var t=this.tree.successor_node(e.node),n=this.tree.predecessor_node(e.node);null!=t&&(t.data.prev=e.prev),null!=n&&(n.data.next=e.next),this.tree.remove_node(e.node),e.node=null},intersect:function(e,t){return null!=e&&null!=t&&(e.left!=t.left&&e.left!=t.right&&e.right!=t.left&&e.right!=t.right&&(!(0<((t.left.x-e.left.x)*(e.right.y-e.left.y)-(e.right.x-e.left.x)*(t.left.y-e.left.y))*((t.right.x-e.left.x)*(e.right.y-e.left.y)-(e.right.x-e.left.x)*(t.right.y-e.left.y)))&&!(0<((e.left.x-t.left.x)*(t.right.y-t.left.y)-(t.right.x-t.left.x)*(e.left.y-t.left.y))*((e.right.x-t.left.x)*(t.right.y-t.left.y)-(t.right.x-t.left.x)*(e.right.y-t.left.y)))))},intersection:function(e,t){if(null==e||null==t)return null;if(e.left==t.left||e.left==t.right||e.right==t.left||e.right==t.right)return null;var n,i,r,a;n=e.right.x-e.left.x,i=e.right.y-e.left.y,r=t.right.x-t.left.x;var s=(a=t.right.y-t.left.y)*n-r*i;if(0==s)return null;s=1/s;var l,o,_=(a*(l=t.left.x-e.left.x)-r*(o=t.left.y-e.left.y))*s;if(_<0||1<_)return null;var p,u=(i*l-n*o)*s;if(u<0||1<u)return null;p=0==u||1==u||0==_||1==_?0==u?t.left:1==u?t.right:0==_?e.left:e.right:Qp.get(.5*(e.left.x+n*_+t.left.x+r*u),.5*(e.left.y+i*_+t.left.y+a*u));var h=eu.get(p);return h.type=0,h.segment=e,h.segment2=t,h},__class__:tu};var nu=function(){};(n["zpp_nape.geom.ZPP_Simple"]=nu).__name__=["zpp_nape","geom","ZPP_Simple"],nu.decompose=function(e,t){null==nu.sweep&&(nu.sweep=new tu,nu.inthash=new Lu),null==nu.vertices&&(null==dc.zpp_pool?nu.vertices=new dc:(nu.vertices=dc.zpp_pool,dc.zpp_pool=nu.vertices.next,nu.vertices.next=null),nu.vertices.alloc(),nu.vertices.lt=Qp.less_xy,nu.vertices.swapped=Qp.swap_nodes),null==nu.queue&&(null==fc.zpp_pool?nu.queue=new fc:(nu.queue=fc.zpp_pool,fc.zpp_pool=nu.queue.next,nu.queue.next=null),nu.queue.alloc(),nu.queue.lt=eu.less_xy,nu.queue.swapped=eu.swap_nodes);var n=null,i=null,r=e;if(null!=e)for(var a=e;;){for(var s=a,l=Qp.get(s.x,s.y),o=nu.vertices.parent;null!=o;)if(nu.vertices.lt(l,o.data))o=o.prev;else{if(!nu.vertices.lt(o.data,l))break;o=o.next}var _=o;if(null!=_){var p=l;p.free(),p.next=Qp.zpp_pool,Qp.zpp_pool=p,l=_.data}else l.node=nu.vertices.insert(l);if(null!=i){var u,h=eu.get(i),c=eu.get(l);u=eu.less_xy(h,c)?(h.type=1,c.type=2,$p.get(i,l)):(h.type=2,c.type=1,$p.get(l,i)),h.segment=c.segment=u,nu.queue.insert(h),nu.queue.insert(c),i.links.insert(l),l.links.insert(i)}if(i=l,null==n&&(n=l),(a=a.next)==r)break}var d,m=eu.get(i),f=eu.get(n);for(d=eu.less_xy(m,f)?(m.type=1,f.type=2,$p.get(i,n)):(m.type=2,f.type=1,$p.get(n,i)),m.segment=f.segment=d,nu.queue.insert(m),nu.queue.insert(f),i.links.insert(n),n.links.insert(i),null==nu.ints&&(null==fc.zpp_pool?nu.ints=new fc:(nu.ints=fc.zpp_pool,fc.zpp_pool=nu.ints.next,nu.ints.next=null),nu.ints.alloc(),nu.ints.lt=eu.less_xy);!nu.queue.empty();){var g=nu.queue.pop_front();if(nu.sweep.sweepx=g.vertex.x,1==g.type){var v=g.segment;if(nu.sweep.add(v),null!=v.next&&null!=v&&!(v.next.id<v.id?nu.inthash.has(v.next.id,v.id):nu.inthash.has(v.id,v.next.id))){var b=nu.sweep.intersection(v.next,v);if(null!=b)if(b.vertex.x>=nu.sweep.sweepx){for(var y=nu.queue.parent;null!=y;)if(nu.queue.lt(b,y.data))y=y.prev;else{if(!nu.queue.lt(y.data,b))break;y=y.next}var x=y;if(null==x){for(var z=nu.ints.parent;null!=z;)if(nu.ints.lt(b,z.data))z=z.prev;else{if(!nu.ints.lt(z.data,b))break;z=z.next}var w=z;if(null!=w){var k=b.vertex;k.free(),k.next=Qp.zpp_pool,Qp.zpp_pool=k,b.vertex=w.data.vertex,w.data=b,nu.queue.insert(b)}else nu.queue.insert(b),nu.ints.insert(b);v.next.id<v.id?nu.inthash.add(Bu.get(v.next.id,v.id,!0)):nu.inthash.add(Bu.get(v.id,v.next.id,!0))}else{x.data;var S=b.vertex;S.free(),S.next=Qp.zpp_pool,Qp.zpp_pool=S;var C=b;C.free(),C.next=eu.zpp_pool,eu.zpp_pool=C}}else{var N=b.vertex;N.free(),N.next=Qp.zpp_pool,Qp.zpp_pool=N;var P=b;P.free(),P.next=eu.zpp_pool,eu.zpp_pool=P}}if(null!=v&&null!=v.prev&&!(v.id<v.prev.id?nu.inthash.has(v.id,v.prev.id):nu.inthash.has(v.prev.id,v.id))){var M=nu.sweep.intersection(v,v.prev);if(null!=M)if(M.vertex.x>=nu.sweep.sweepx){for(var I=nu.queue.parent;null!=I;)if(nu.queue.lt(M,I.data))I=I.prev;else{if(!nu.queue.lt(I.data,M))break;I=I.next}var A=I;if(null==A){for(var T=nu.ints.parent;null!=T;)if(nu.ints.lt(M,T.data))T=T.prev;else{if(!nu.ints.lt(T.data,M))break;T=T.next}var D=T;if(null!=D){var E=M.vertex;E.free(),E.next=Qp.zpp_pool,Qp.zpp_pool=E,M.vertex=D.data.vertex,D.data=M,nu.queue.insert(M)}else nu.queue.insert(M),nu.ints.insert(M);v.id<v.prev.id?nu.inthash.add(Bu.get(v.id,v.prev.id,!0)):nu.inthash.add(Bu.get(v.prev.id,v.id,!0))}else{A.data;var O=M.vertex;O.free(),O.next=Qp.zpp_pool,Qp.zpp_pool=O;var B=M;B.free(),B.next=eu.zpp_pool,eu.zpp_pool=B}}else{var L=M.vertex;L.free(),L.next=Qp.zpp_pool,Qp.zpp_pool=L;var j=M;j.free(),j.next=eu.zpp_pool,eu.zpp_pool=j}}}else if(2==g.type){var F=g.segment;if(null!=F.node){var R=F.next,G=F.prev;nu.sweep.remove(F);var Z=F;if(Z.free(),Z.next=$p.zpp_pool,$p.zpp_pool=Z,null!=R&&null!=G&&!(R.id<G.id?nu.inthash.has(R.id,G.id):nu.inthash.has(G.id,R.id))){var U=nu.sweep.intersection(R,G);if(null!=U)if(U.vertex.x>=nu.sweep.sweepx){for(var V=nu.queue.parent;null!=V;)if(nu.queue.lt(U,V.data))V=V.prev;else{if(!nu.queue.lt(V.data,U))break;V=V.next}var q=V;if(null==q){for(var W=nu.ints.parent;null!=W;)if(nu.ints.lt(U,W.data))W=W.prev;else{if(!nu.ints.lt(W.data,U))break;W=W.next}var X=W;if(null!=X){var H=U.vertex;H.free(),H.next=Qp.zpp_pool,Qp.zpp_pool=H,U.vertex=X.data.vertex,X.data=U,nu.queue.insert(U)}else nu.queue.insert(U),nu.ints.insert(U);R.id<G.id?nu.inthash.add(Bu.get(R.id,G.id,!0)):nu.inthash.add(Bu.get(G.id,R.id,!0))}else{q.data;var Y=U.vertex;Y.free(),Y.next=Qp.zpp_pool,Qp.zpp_pool=Y;var J=U;J.free(),J.next=eu.zpp_pool,eu.zpp_pool=J}}else{var K=U.vertex;K.free(),K.next=Qp.zpp_pool,Qp.zpp_pool=K;var Q=U;Q.free(),Q.next=eu.zpp_pool,eu.zpp_pool=Q}}}}else{var $=g.vertex,ee=null==$.node,te=g.segment,ne=g.segment2;if(ne.next!=te){var ie=te;te=ne,ne=ie}for(var re=te.vertices.parent;null!=re;)if(te.vertices.lt($,re.data))re=re.prev;else{if(!te.vertices.lt(re.data,$))break;re=re.next}for(var ae=null==re,se=ne.vertices.parent;null!=se;)if(ne.vertices.lt($,se.data))se=se.prev;else{if(!ne.vertices.lt(se.data,$))break;se=se.next}var le=null==se;if(ae){var oe=te.vertices.insert($),_e=$==te.left?$:te.vertices.predecessor_node(oe).data,pe=$==te.right?$:te.vertices.successor_node(oe).data;_e.links.remove(pe),$!=_e&&_e.links.insert($),pe.links.remove(_e),$!=pe&&pe.links.insert($),$!=_e&&$.links.insert(_e),$!=pe&&$.links.insert(pe)}if(le){var ue=ne.vertices.insert($),he=$==ne.left?$:ne.vertices.predecessor_node(ue).data,ce=$==ne.right?$:ne.vertices.successor_node(ue).data;he.links.remove(ce),$!=he&&he.links.insert($),ce.links.remove(he),$!=ce&&ce.links.insert($),$!=he&&$.links.insert(he),$!=ce&&$.links.insert(ce)}if(ee&&($.node=nu.vertices.insert($)),$.forced=!0,ee){var de=te.node,me=ne.node;de.data=ne,(me.data=te).node=me,ne.node=de,ne.next=te.next,te.next=ne,te.prev=ne.prev,null!=(ne.prev=te).prev&&(te.prev.next=te),null!=ne.next&&(ne.next.prev=ne)}if(null!=ne.next&&null!=ne&&!(ne.next.id<ne.id?nu.inthash.has(ne.next.id,ne.id):nu.inthash.has(ne.id,ne.next.id))){var fe=nu.sweep.intersection(ne.next,ne);if(null!=fe)if(fe.vertex.x>=nu.sweep.sweepx){for(var ge=nu.queue.parent;null!=ge;)if(nu.queue.lt(fe,ge.data))ge=ge.prev;else{if(!nu.queue.lt(ge.data,fe))break;ge=ge.next}var ve=ge;if(null==ve){for(var be=nu.ints.parent;null!=be;)if(nu.ints.lt(fe,be.data))be=be.prev;else{if(!nu.ints.lt(be.data,fe))break;be=be.next}var ye=be;if(null!=ye){var xe=fe.vertex;xe.free(),xe.next=Qp.zpp_pool,Qp.zpp_pool=xe,fe.vertex=ye.data.vertex,ye.data=fe,nu.queue.insert(fe)}else nu.queue.insert(fe),nu.ints.insert(fe);ne.next.id<ne.id?nu.inthash.add(Bu.get(ne.next.id,ne.id,!0)):nu.inthash.add(Bu.get(ne.id,ne.next.id,!0))}else{ve.data;var ze=fe.vertex;ze.free(),ze.next=Qp.zpp_pool,Qp.zpp_pool=ze;var we=fe;we.free(),we.next=eu.zpp_pool,eu.zpp_pool=we}}else{var ke=fe.vertex;ke.free(),ke.next=Qp.zpp_pool,Qp.zpp_pool=ke;var Se=fe;Se.free(),Se.next=eu.zpp_pool,eu.zpp_pool=Se}}if(null!=te&&null!=te.prev&&!(te.id<te.prev.id?nu.inthash.has(te.id,te.prev.id):nu.inthash.has(te.prev.id,te.id))){var Ce=nu.sweep.intersection(te,te.prev);if(null!=Ce)if(Ce.vertex.x>=nu.sweep.sweepx){for(var Ne=nu.queue.parent;null!=Ne;)if(nu.queue.lt(Ce,Ne.data))Ne=Ne.prev;else{if(!nu.queue.lt(Ne.data,Ce))break;Ne=Ne.next}var Pe=Ne;if(null==Pe){for(var Me=nu.ints.parent;null!=Me;)if(nu.ints.lt(Ce,Me.data))Me=Me.prev;else{if(!nu.ints.lt(Me.data,Ce))break;Me=Me.next}var Ie=Me;if(null!=Ie){var Ae=Ce.vertex;Ae.free(),Ae.next=Qp.zpp_pool,Qp.zpp_pool=Ae,Ce.vertex=Ie.data.vertex,Ie.data=Ce,nu.queue.insert(Ce)}else nu.queue.insert(Ce),nu.ints.insert(Ce);te.id<te.prev.id?nu.inthash.add(Bu.get(te.id,te.prev.id,!0)):nu.inthash.add(Bu.get(te.prev.id,te.id,!0))}else{Pe.data;var Te=Ce.vertex;Te.free(),Te.next=Qp.zpp_pool,Qp.zpp_pool=Te;var De=Ce;De.free(),De.next=eu.zpp_pool,eu.zpp_pool=De}}else{var Ee=Ce.vertex;Ee.free(),Ee.next=Qp.zpp_pool,Qp.zpp_pool=Ee;var Oe=Ce;Oe.free(),Oe.next=eu.zpp_pool,eu.zpp_pool=Oe}}nu.ints.remove(g)}var Be=g;Be.free(),Be.next=eu.zpp_pool,eu.zpp_pool=Be}for(var Le=0,je=nu.inthash.table.length;Le<je;){var Fe=Le++,Re=nu.inthash.table[Fe];if(null!=Re){for(;null!=Re;){var Ge=Re.hnext;Re.hnext=null;var Ze=Re;Ze.free(),Ze.next=Bu.zpp_pool,Bu.zpp_pool=Ze,Re=Ge}nu.inthash.table[Fe]=null}}for(null==t&&(t=new Hu);!nu.vertices.empty();)nu.clip_polygon(nu.vertices,t);return t},nu.clip_polygon=function(e,t){var n,i,r,a=null,s=e.first(),l=s,o=s.links.parent,_=null==o.prev?o.next:o.prev,p=o.data,u=_.data;n=s.x-p.x,i=s.y-p.y,r=u.x-s.x,(u.y-s.y)*n-r*i<0&&(u=p);var h=Rp.get(s.x,s.y);for(null==a?a=h.prev=h.next=h:(h.prev=a,h.next=a.next,a.next.prev=h,a.next=h),(a=h).forced=s.forced;;){if(s.links.remove(u),u.links.remove(s),u==l){if(s.links.empty()){e.remove(s);var c=s;c.free(),c.next=Qp.zpp_pool,Qp.zpp_pool=c}break}var d=Rp.get(u.x,u.y);if(null==a?a=d.prev=d.next=d:(d.prev=a,d.next=a.next,a.next.prev=d,a.next=d),(a=d).forced=u.forced,u.links.singular()){if(s.links.empty()){e.remove(s);var m=s;m.free(),m.next=Qp.zpp_pool,Qp.zpp_pool=m}u=(s=u).links.parent.data}else{var f=null,g=0;if(!u.links.empty()){for(var v=u.links.parent;null!=v.prev;)v=v.prev;for(;null!=v;){var b=v.data;if(null==f){var y,x,z;f=b,y=u.x-s.x,x=u.y-s.y,z=b.x-u.x,g=(b.y-u.y)*y-z*x}else{var w,k,S;w=u.x-s.x,k=u.y-s.y,S=b.x-u.x;var C=(b.y-u.y)*w-S*k;if(0<C&&g<=0)f=b,g=C;else if(0<=g*C){var N,P,M;N=u.x-b.x,P=u.y-b.y,M=f.x-u.x,0<(f.y-u.y)*N-M*P&&(f=b,g=C)}}if(null!=v.next)for(v=v.next;null!=v.prev;)v=v.prev;else{for(;null!=v.parent&&v==v.parent.next;)v=v.parent;v=v.parent}}}if(s.links.empty()){e.remove(s);var I=s;I.free(),I.next=Qp.zpp_pool,Qp.zpp_pool=I}s=u,u=f}}e.remove(l);var A=l;A.free(),A.next=Qp.zpp_pool,Qp.zpp_pool=A,t.add(a)},nu.isSimple=function(e){null==nu.sweep&&(nu.sweep=new tu,nu.inthash=new Lu);var t=nu.list_vertices;null==t&&(t=nu.list_vertices=new Ju);var n=e;if(null!=e)for(var i=e;;){var r=i;if(t.add(Qp.get(r.x,r.y)),(i=i.next)==n)break}var a=nu.list_queue;null==a&&(a=nu.list_queue=new Ku);var s=t.begin(),l=s.elem();for(s=s.next;null!=s;){var o,_=s.elem(),p=a.add(eu.get(l)),u=a.add(eu.get(_));o=eu.less_xy(p,u)?(p.type=1,u.type=2,$p.get(l,_)):(p.type=2,u.type=1,$p.get(_,l)),p.segment=u.segment=o,l=_,s=s.next}var h,c=t.front(),d=a.add(eu.get(l)),m=a.add(eu.get(c));h=eu.less_xy(d,m)?(d.type=1,m.type=2,$p.get(l,c)):(d.type=2,m.type=1,$p.get(c,l)),d.segment=m.segment=h;var f=a;if(!f.empty()&&null!=f.begin().next){for(var g,v,b,y=f.begin(),x=null,z=null,w=null,k=null,S=1;;){for(g=0,z=y,x=y=null;null!=z;){for(++g,w=z,v=0,b=S;null!=w&&v<S;)++v,w=w.next;for(;0<v||0<b&&null!=w;)0==v?(w=(k=w).next,--b):0==b||null==w||eu.less_xy(z.elem(),w.elem())?(z=(k=z).next,--v):(w=(k=w).next,--b),null!=x?x.next=k:y=k,x=k;z=w}if(x.next=null,S<<=1,!(1<g))break}f.setbegin(y)}for(var C=!0;!a.empty();){var N=a.pop_unsafe(),P=N.segment;if(1==N.type){if(nu.sweep.add(P),nu.sweep.intersect(P,P.next)||nu.sweep.intersect(P,P.prev)){C=!1;break}}else if(2==N.type){if(nu.sweep.intersect(P.prev,P.next)){C=!1;break}nu.sweep.remove(P);var M=P;M.free(),M.next=$p.zpp_pool,$p.zpp_pool=M}var I=N;I.free(),I.next=eu.zpp_pool,eu.zpp_pool=I}for(;!a.empty();){var A=a.pop_unsafe();if(2==A.type){var T=A.segment;T.free(),T.next=$p.zpp_pool,$p.zpp_pool=T}var D=A;D.free(),D.next=eu.zpp_pool,eu.zpp_pool=D}for(nu.sweep.clear();!t.empty();){var E=t.pop_unsafe();E.free(),E.next=Qp.zpp_pool,Qp.zpp_pool=E}return C};var iu=function(){this.forced=!1,this.flag=!1,this.prev=null,this.next=null,this.y=0,this.x=0};(n["zpp_nape.geom.ZPP_SimplifyV"]=iu).__name__=["zpp_nape","geom","ZPP_SimplifyV"],iu.get=function(e){var t;return null==iu.zpp_pool?t=new iu:(t=iu.zpp_pool,iu.zpp_pool=t.next,t.next=null),t.alloc(),t.x=e.x,t.y=e.y,t.flag=!1,t},iu.prototype={x:null,y:null,next:null,prev:null,flag:null,forced:null,free:function(){},alloc:function(){},__class__:iu};var ru=function(){this.max=null,this.min=null,this.next=null};(n["zpp_nape.geom.ZPP_SimplifyP"]=ru).__name__=["zpp_nape","geom","ZPP_SimplifyP"],ru.get=function(e,t){var n;return null==ru.zpp_pool?n=new ru:(n=ru.zpp_pool,ru.zpp_pool=n.next,n.next=null),n.alloc(),n.min=e,n.max=t,n},ru.prototype={next:null,min:null,max:null,free:function(){this.min=this.max=null},alloc:function(){},__class__:ru};var au=function(){};(n["zpp_nape.geom.ZPP_Simplify"]=au).__name__=["zpp_nape","geom","ZPP_Simplify"],au.lessval=function(e,t){return e.x-t.x+(e.y-t.y)},au.less=function(e,t){return au.lessval(e,t)<0},au.distance=function(e,t,n){var i,r;i=n.x-t.x,r=n.y-t.y;var a=0,s=0;if(a=e.x-t.x,s=e.y-t.y,0==i*i+r*r)return a*a+s*s;var l=(a*i+s*r)/(i*i+r*r);return l<=0?a*a+s*s:1<=l?hu.vec_dsq(e.x,e.y,n.x,n.y):(a-=i*l)*a+(s-=r*l)*s},au.simplify=function(e,t){var n=null,i=null,r=null;t*=t,null==au.stack&&(au.stack=new Yu);for(var a=null,s=null,l=e;;){var o=iu.get(l);o.forced=l.forced,o.forced&&(o.flag=!0,null!=a?au.stack.add(ru.get(a,o)):s=o,a=o);var _=o;if(null==n?n=_.prev=_.next=_:(_.prev=n,_.next=n.next,n.next.prev=_,n.next=_),n=_,null==i?r=i=n:(au.less(n,i)&&(i=n),au.less(r,n)&&(r=n)),(l=l.next)==e)break}if(au.stack.empty())if(null==s)i.flag=r.flag=!0,au.stack.add(ru.get(i,r)),au.stack.add(ru.get(r,i));else{var p=au.lessval(i,s);p<0&&(p=-p);var u=au.lessval(r,s);u<0&&(u=-u),u<p?(i.flag=s.flag=!0,au.stack.add(ru.get(i,s)),au.stack.add(ru.get(s,i))):(r.flag=s.flag=!0,au.stack.add(ru.get(r,s)),au.stack.add(ru.get(s,r)))}else au.stack.add(ru.get(a,s));for(;!au.stack.empty();){var h=au.stack.pop_unsafe(),c=h.min,d=h.max,m=h;m.free(),m.next=ru.zpp_pool,ru.zpp_pool=m;for(var f=t,g=null,v=c.next;v!=d;){var b=au.distance(v,c,d);f<b&&(f=b,g=v),v=v.next}null!=g&&(g.flag=!0,au.stack.add(ru.get(c,g)),au.stack.add(ru.get(g,d)))}for(var y=null;null!=n;){if(n.flag){var x=Rp.get(n.x,n.y);null==y?y=x.prev=x.next=x:(x.prev=y,x.next=y.next,y.next.prev=x,y.next=x),(y=x).forced=n.forced}if(null!=n&&n.prev==n){n.next=n.prev=null;var z=n;z.free(),z.next=iu.zpp_pool,iu.zpp_pool=z,n=n=null}else{var w=n.next;n.prev.next=n.next,n.next.prev=n.prev,n.next=n.prev=null;var k=n;k.free(),k.next=iu.zpp_pool,iu.zpp_pool=k,n=null,n=w}}return y};var su=function(){this.kinematic=!1,this.failed=!1,this.slipped=!1,this.axis=null,this.c2=null,this.c1=null,this.frozen2=!1,this.frozen1=!1,this.arbiter=null,this.s2=null,this.s1=null,this.toi=0,this.next=null,this.c1=new pu,this.c2=new pu,this.axis=new pu};(n["zpp_nape.geom.ZPP_ToiEvent"]=su).__name__=["zpp_nape","geom","ZPP_ToiEvent"],su.prototype={next:null,alloc:function(){this.failed=!1,this.s1=this.s2=null,this.arbiter=null},free:function(){},toi:null,s1:null,s2:null,arbiter:null,frozen1:null,frozen2:null,c1:null,c2:null,axis:null,slipped:null,failed:null,kinematic:null,__class__:su};var lu=function(){};(n["zpp_nape.geom.ZPP_SweepDistance"]=lu).__name__=["zpp_nape","geom","ZPP_SweepDistance"],lu.dynamicSweep=function(e,t,n,i,r){null==r&&(r=!1);var a,s,l=e.s1,o=e.s2,_=l.body,p=o.body;a=p.velx-_.velx,s=p.vely-_.vely;var u=_.angvel;u<0&&(u=-u);var h=p.angvel;h<0&&(h=-h);var c=l.sweepCoef*u+o.sweepCoef*h;if(!r&&!e.kinematic&&a*a+s*s<lo.dynamicSweepLinearThreshold*lo.dynamicSweepLinearThreshold&&c<lo.dynamicSweepAngularThreshold)return e.toi=-1,void(e.failed=!0);for(var d=e.c1,m=e.c2,f=e.axis,g=n,v=0;;){_.sweepIntegrate(g*t),_.sweepValidate(l),p.sweepIntegrate(g*t),p.sweepValidate(o);var b=lu.distance(l,o,d,m,f)+i,y=a*f.x+s*f.y;if(b<lo.distanceThresholdCCD){if(r)break;var x,z,w,k;x=d.x-_.posx,z=d.y-_.posy,w=m.x-p.posx,k=m.y-p.posy;var S=y-_.sweep_angvel*(f.y*x-f.x*z)+p.sweep_angvel*(f.y*w-f.x*k);if(0<S&&(e.slipped=!0),S<=0||b<.5*lo.distanceThresholdCCD)break}var C=(c-y)*t;if(C<=0){g=-1;break}var N=b/C;if(N<1e-6&&(N=1e-6),1<=(g+=N)){g=1,_.sweepIntegrate(g*t),_.sweepValidate(l),p.sweepIntegrate(g*t),p.sweepValidate(o);var P=lu.distance(l,o,d,m,f)+i,M=a*f.x+s*f.y;if(P<lo.distanceThresholdCCD){if(r)break;var I,A,T,D;I=d.x-_.posx,A=d.y-_.posy,T=m.x-p.posx,D=m.y-p.posy;var E=M-_.sweep_angvel*(f.y*I-f.x*A)+p.sweep_angvel*(f.y*T-f.x*D);if(0<E&&(e.slipped=!0),E<=0||P<.5*lo.distanceThresholdCCD)break}g=-1;break}if(40<=++v){i<b&&(e.failed=!0);break}}e.toi=g},lu.staticSweep=function(e,t,n,i){var r,a,s=e.s1,l=e.s2,o=s.body;l.body,r=-o.velx,a=-o.vely;var _=o.sweep_angvel;_<0&&(_=-_);for(var p=s.sweepCoef*_,u=e.c1,h=e.c2,c=e.axis,d=n,m=0;;){o.sweepIntegrate(d*t),o.sweepValidate(s);var f=lu.distance(s,l,u,h,c)+i,g=r*c.x+a*c.y;if(f<lo.distanceThresholdCCD){var v,b;v=u.x-o.posx,b=u.y-o.posy;var y=g-o.sweep_angvel*(c.y*v-c.x*b);if(0<y&&(e.slipped=!0),y<=0||f<.5*lo.distanceThresholdCCD)break}var x=(p-g)*t;if(x<=0){d=-1;break}var z=f/x;if(z<1e-6&&(z=1e-6),1<=(d+=z)){d=1,o.sweepIntegrate(d*t),o.sweepValidate(s);var w=lu.distance(s,l,u,h,c)+i,k=r*c.x+a*c.y;if(w<lo.distanceThresholdCCD){var S,C;S=u.x-o.posx,C=u.y-o.posy;var N=k-o.sweep_angvel*(c.y*S-c.x*C);if(0<N&&(e.slipped=!0),N<=0||w<.5*lo.distanceThresholdCCD)break}d=-1;break}if(40<=++m){i<f&&(e.failed=!0);break}}e.toi=d},lu.distanceBody=function(e,t,n,i){var r,a,s;null==pu.zpp_pool?r=new pu:(r=pu.zpp_pool,pu.zpp_pool=r.next,r.next=null),r.alloc(),null==pu.zpp_pool?a=new pu:(a=pu.zpp_pool,pu.zpp_pool=a.next,a.next=null),a.alloc(),null==pu.zpp_pool?s=new pu:(s=pu.zpp_pool,pu.zpp_pool=s.next,s.next=null),s.alloc();for(var l=X_.FMAX,o=e.shapes.begin();null!=o;){for(var _=o.elem(),p=t.shapes.begin();null!=p;){var u=p.elem(),h=lu.distance(_,u,r,a,s,l);h<l&&(l=h,n.x=r.x,n.y=r.y,i.x=a.x,i.y=a.y),p=p.next}o=o.next}var c=r;c.free(),c.next=pu.zpp_pool,pu.zpp_pool=c;var d=a;d.free(),d.next=pu.zpp_pool,pu.zpp_pool=d;var m=s;return m.free(),m.next=pu.zpp_pool,pu.zpp_pool=m,l},lu.distance=function(e,t,n,i,r,a){if(null==a&&(a=1e100),e.isCircle()&&t.isCircle()){var s,l=e.circle,o=t.circle,_=0,p=0;_=o.worldCOMx-l.worldCOMx,p=o.worldCOMy-l.worldCOMy;var u=oc.sqrt(_*_+p*p);if((s=u-(l.radius+o.radius))<a){if(0==u)_=1,p=0;else{var h=1/u;_*=h,p*=h}var c=l.radius;n.x=l.worldCOMx+_*c,n.y=l.worldCOMy+p*c;var d=-o.radius;i.x=o.worldCOMx+_*d,i.y=o.worldCOMy+p*d,r.x=_,r.y=p}return s}var m=!1;if(e.isCircle()&&t.isPolygon()){var f=e;e=t,t=f;var g=n;n=i,i=g,m=!0}if(e.isPolygon()&&t.isCircle()){for(var v=e.polygon,b=t.circle,y=-X_.FMAX,x=null,z=v.edges.begin();null!=z;){var w=z.elem(),k=w.gnormx*b.worldCOMx+w.gnormy*b.worldCOMy-w.gprojection-b.radius;if(a<k){y=k;break}0<k?y<k&&(y=k,x=w):y<0&&y<k&&(y=k,x=w),z=z.next}if(y<a){var S=x.gp0,C=x.gp1,N=b.worldCOMy*x.gnormx-b.worldCOMx*x.gnormy;if(N<=S.y*x.gnormx-S.x*x.gnormy){var P=0,M=0;P=b.worldCOMx-S.x,M=b.worldCOMy-S.y;var I=oc.sqrt(P*P+M*M);if((y=I-b.radius)<a){if(0==I)P=1,M=0;else{var A=1/I;P*=A,M*=A}n.x=S.x+0*P,n.y=S.y+0*M;var T=-b.radius;i.x=b.worldCOMx+P*T,i.y=b.worldCOMy+M*T,r.x=P,r.y=M}}else if(N>=C.y*x.gnormx-C.x*x.gnormy){var D=0,E=0;D=b.worldCOMx-C.x,E=b.worldCOMy-C.y;var O=oc.sqrt(D*D+E*E);if((y=O-b.radius)<a){if(0==O)D=1,E=0;else{var B=1/O;D*=B,E*=B}n.x=C.x+0*D,n.y=C.y+0*E;var L=-b.radius;i.x=b.worldCOMx+D*L,i.y=b.worldCOMy+E*L,r.x=D,r.y=E}}else{var j=-b.radius;i.x=b.worldCOMx+x.gnormx*j,i.y=b.worldCOMy+x.gnormy*j;var F=-y;n.x=i.x+x.gnormx*F,n.y=i.y+x.gnormy*F,r.x=x.gnormx,r.y=x.gnormy}}return m&&(r.x=-r.x,r.y=-r.y),y}for(var R=e.polygon,G=t.polygon,Z=-X_.FMAX,U=null,V=null,q=0,W=R.edges.begin();null!=W;){for(var X=W.elem(),H=X_.FMAX,Y=G.gverts.begin();null!=Y;){var J=Y.elem(),K=X.gnormx*J.x+X.gnormy*J.y;K<H&&(H=K),Y=Y.next}if(a<(H-=X.gprojection)){Z=H;break}0<H?Z<H&&(Z=H,U=X,q=1):Z<0&&Z<H&&(Z=H,U=X,q=1),W=W.next}if(Z<a){for(var Q=G.edges.begin();null!=Q;){for(var $=Q.elem(),ee=X_.FMAX,te=R.gverts.begin();null!=te;){var ne=te.elem(),ie=$.gnormx*ne.x+$.gnormy*ne.y;ie<ee&&(ee=ie),te=te.next}if(a<(ee-=$.gprojection)){Z=ee;break}0<ee?Z<ee&&(Z=ee,V=$,q=2):Z<0&&Z<ee&&(Z=ee,V=$,q=2),Q=Q.next}if(Z<a){var re,ae;if(1==q)re=G,ae=U;else{re=R,ae=V;var se=n;n=i,i=se,m=!m}for(var le=null,oe=X_.FMAX,_e=re.edges.begin();null!=_e;){var pe=_e.elem(),ue=ae.gnormx*pe.gnormx+ae.gnormy*pe.gnormy;ue<oe&&(oe=ue,le=pe),_e=_e.next}if(r.y=m?(r.x=-ae.gnormx,-ae.gnormy):(r.x=ae.gnormx,ae.gnormy),0<=Z){var he,ce,de,me,fe=ae.gp0,ge=ae.gp1,ve=le.gp0,be=le.gp1,ye=1/((he=ge.x-fe.x)*he+(ce=ge.y-fe.y)*ce),xe=1/((de=be.x-ve.x)*de+(me=be.y-ve.y)*me),ze=-(he*(fe.x-ve.x)+ce*(fe.y-ve.y))*ye,we=-(he*(fe.x-be.x)+ce*(fe.y-be.y))*ye,ke=-(de*(ve.x-fe.x)+me*(ve.y-fe.y))*xe,Se=-(de*(ve.x-ge.x)+me*(ve.y-ge.y))*xe;ze<0?ze=0:1<ze&&(ze=1),we<0?we=0:1<we&&(we=1),ke<0?ke=0:1<ke&&(ke=1),Se<0?Se=0:1<Se&&(Se=1);var Ce,Ne,Pe=ze;Ce=fe.x+he*Pe,Ne=fe.y+ce*Pe;var Me,Ie,Ae=we;Me=fe.x+he*Ae,Ie=fe.y+ce*Ae;var Te,De,Ee=ke;Te=ve.x+de*Ee,De=ve.y+me*Ee;var Oe,Be,Le=Se;Oe=ve.x+de*Le,Be=ve.y+me*Le;var je=hu.vec_dsq(Ce,Ne,ve.x,ve.y),Fe=hu.vec_dsq(Me,Ie,be.x,be.y),Re=hu.vec_dsq(Te,De,fe.x,fe.y),Ge=hu.vec_dsq(Oe,Be,ge.x,ge.y),Ze=0,Ue=0,Ve=null;je<Fe?(Ze=Ce,Ue=Ne,Ve=ve):(Ze=Me,Ue=Ie,Ve=be,je=Fe);var qe=0,We=0,Xe=null;if(Re<Ge?(qe=Te,We=De,Xe=fe):(qe=Oe,We=Be,Xe=ge,Re=Ge),0!=(Z=je<Re?(n.x=Ze,n.y=Ue,i.x=Ve.x,i.y=Ve.y,Math.sqrt(je)):(i.x=qe,i.y=We,n.x=Xe.x,n.y=Xe.y,Math.sqrt(Re)))){r.x=i.x-n.x,r.y=i.y-n.y;var He=1/Z;r.x*=He,r.y*=He,m&&(r.x=-r.x,r.y=-r.y)}return Z}var Ye=0,Je=0;Ye=le.gp0.x,Je=le.gp0.y;var Ke,Qe,$e=0,et=0;Ke=($e=le.gp1.x)-Ye,Qe=(et=le.gp1.y)-Je;var tt=ae.gnormy*Ye-ae.gnormx*Je,nt=ae.gnormy*$e-ae.gnormx*et,it=1/(nt-tt),rt=(-ae.tp1-tt)*it;lo.epsilon<rt&&(Ye+=Ke*rt,Je+=Qe*rt);var at=(-ae.tp0-nt)*it;at<-lo.epsilon&&($e+=Ke*at,et+=Qe*at);var st=Ye*ae.gnormx+Je*ae.gnormy-ae.gprojection,lt=$e*ae.gnormx+et*ae.gnormy-ae.gprojection;if(st<lt){i.x=Ye,i.y=Je;var ot=-st;return n.x=i.x+ae.gnormx*ot,n.y=i.y+ae.gnormy*ot,st}i.x=$e,i.y=et;var _t=-lt;return n.x=i.x+ae.gnormx*_t,n.y=i.y+ae.gnormy*_t,lt}return a}return a};var ou=function(){this.node=null,this.di=0,this.id=0,this.b=null,this.a=null,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null};(n["zpp_nape.geom.ZPP_PartitionPair"]=ou).__name__=["zpp_nape","geom","ZPP_PartitionPair"],ou.get=function(e,t){var n;return null==ou.zpp_pool?n=new ou:(n=ou.zpp_pool,ou.zpp_pool=n.next,n.next=null),n.alloc(),n.a=e,n.b=t,e.id<t.id?(n.id=e.id,n.di=t.id):(n.id=t.id,n.di=e.id),n},ou.edge_swap=function(e,t){var n=e.node;e.node=t.node,t.node=n},ou.edge_lt=function(e,t){return!(e.id>=t.id)||e.id==t.id&&e.di<t.di},ou.prototype={next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},free:function(){this.a=this.b=null,this.node=null},alloc:function(){},a:null,b:null,id:null,di:null,node:null,__class__:ou};var _u=function(){};(n["zpp_nape.geom.ZPP_Triangular"]=_u).__name__=["zpp_nape","geom","ZPP_Triangular"],_u.lt=function(e,t){return e.y<t.y||e.y==t.y&&e.x<t.x},_u.right_turn=function(e,t,n){var i,r,a;return i=n.x-t.x,r=n.y-t.y,a=t.x-e.x,(t.y-e.y)*i-a*r},_u.delaunay=function(e,t,n,i){var r=0,a=0,s=0;return r=n.x-t.x,a=n.y-t.y,s=t.x-e.x,!!(0<=(t.y-e.y)*r-s*a||(r=i.x-n.x,a=i.y-n.y,s=n.x-t.x,0<=(n.y-t.y)*r-s*a)||(r=e.x-i.x,a=e.y-i.y,s=i.x-n.x,0<=(i.y-n.y)*r-s*a)||(r=t.x-e.x,a=t.y-e.y,s=e.x-i.x,0<=(e.y-i.y)*r-s*a))||0<t.x*(n.y*i.mag-n.mag*i.y)-n.x*(t.y*i.mag-t.mag*i.y)+i.x*(t.y*n.mag-t.mag*n.y)-(e.x*(n.y*i.mag-n.mag*i.y)-n.x*(e.y*i.mag-e.mag*i.y)+i.x*(e.y*n.mag-e.mag*n.y))+(e.x*(t.y*i.mag-t.mag*i.y)-t.x*(e.y*i.mag-e.mag*i.y)+i.x*(e.y*t.mag-e.mag*t.y))-(e.x*(t.y*n.mag-t.mag*n.y)-t.x*(e.y*n.mag-e.mag*n.y)+n.x*(e.y*t.mag-e.mag*t.y))},_u.optimise=function(e){var t,n=e.vertices,i=e.vertices;if(null!=n)for(var r=n;;){var a=r;if(a.sort(),a.mag=a.x*a.x+a.y*a.y,(r=r.next)==i)break}null==_u.edgeSet&&(null==cc.zpp_pool?_u.edgeSet=new cc:(_u.edgeSet=cc.zpp_pool,cc.zpp_pool=_u.edgeSet.next,_u.edgeSet.next=null),_u.edgeSet.alloc(),_u.edgeSet.lt=ou.edge_lt,_u.edgeSet.swapped=ou.edge_swap),null==ou.zpp_pool?t=new ou:(t=ou.zpp_pool,ou.zpp_pool=t.next,t.next=null),t.alloc();var s=e.vertices,l=e.vertices;if(null!=s)for(var o=s;;){var _=o,p=_.next;_.diagonals.reverse();for(var u=_.diagonals.begin();null!=u;){var h=u.elem();if(h.id<_.id)p=h,u=u.next;else{var c=null==u.next?_.prev:u.next.elem();if(!_u.delaunay(_,p,h,c)){var d=ou.get(_,h);t.add(d),d.node=_u.edgeSet.insert(d)}p=h,u=u.next}}if((o=o.next)==l)break}for(;!t.empty();){for(var m=t.pop_unsafe(),f=m.a,g=m.b,v=f.next,b=null,y=f.diagonals.begin();null!=y;){var x=y.elem();if(x==g){b=null==(y=y.next)?f.prev:y.elem();break}v=x,y=y.next}if(f.diagonals.remove(g),g.diagonals.remove(f),g==v.next)v.diagonals.add(b);else for(var z=v.diagonals.begin();null!=z;){if(z.elem()==g){v.diagonals.insert(z,b);break}z=z.next}if(f==b.next)b.diagonals.add(v);else for(var w=b.diagonals.begin();null!=w;){if(w.elem()==f){b.diagonals.insert(w,v);break}w=w.next}_u.edgeSet.remove_node(m.node);var k=m;k.free(),k.next=ou.zpp_pool,ou.zpp_pool=k}var S=t;S.free(),S.next=ou.zpp_pool,ou.zpp_pool=S},_u.triangulate=function(e){var t=e.vertices,n=e.vertices,i=e.vertices.next,r=e.vertices;if(null!=i)for(var a=i;;){var s=a;if(_u.lt(s,t)&&(t=s),_u.lt(n,s)&&(n=s),(a=a.next)==r)break}null==_u.queue&&(_u.queue=new Wu);var l=n.prev,o=n.next;for(_u.queue.add(n);l!=t||o!=t;)l==t||o!=t&&_u.lt(l,o)?(_u.queue.add(o),o.rightchain=!1,o=o.next):(_u.queue.add(l),l.rightchain=!0,l=l.prev);_u.queue.add(t),null==_u.stack&&(_u.stack=new Wu),_u.stack.add(_u.queue.pop_unsafe());var _=_u.queue.pop_unsafe();for(_u.stack.add(_);;){var p=_u.queue.pop_unsafe();if(_u.queue.empty())break;if(p.rightchain!=_u.stack.front().rightchain){for(;;){var u=_u.stack.pop_unsafe();if(_u.stack.empty())break;e.add_diagonal(u,p)}_u.stack.add(_)}else{for(var h=_u.stack.pop_unsafe();!_u.stack.empty();){var c=_u.stack.front(),d=_u.right_turn(c,h,p);if(p.rightchain&&0<=d||!p.rightchain&&d<=0)break;e.add_diagonal(c,p),h=c,_u.stack.pop()}_u.stack.add(h)}_u.stack.add(p),_=p}if(!_u.stack.empty())for(_u.stack.pop();!_u.stack.empty();){var m=_u.stack.pop_unsafe();if(_u.stack.empty())break;e.add_diagonal(n,m)}return e};var pu=function(){this.y=0,this.x=0,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.weak=!1,this.outer=null,this._isimmutable=null,this._immutable=!1,this._validate=null,this._invalidate=null};(n["zpp_nape.geom.ZPP_Vec2"]=pu).__name__=["zpp_nape","geom","ZPP_Vec2"],pu.get=function(e,t,n){var i;return null==n&&(n=!1),null==pu.zpp_pool?i=new pu:(i=pu.zpp_pool,pu.zpp_pool=i.next,i.next=null),i.alloc(),i._immutable=n,i.x=e,i.y=t,i},pu.prototype={_invalidate:null,_validate:null,validate:function(){null!=this._validate&&this._validate()},invalidate:function(){null!=this._invalidate&&this._invalidate(this)},_immutable:null,_isimmutable:null,immutable:function(){},outer:null,wrapper:function(){if(null==this.outer){this.outer=new d_;var e=this.outer.zpp_inner;e.free(),e.next=pu.zpp_pool,pu.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},weak:null,free:function(){null!=this.outer&&(this.outer.zpp_inner=null,this.outer=null),this._isimmutable=null,this._validate=null,this._invalidate=null},alloc:function(){this.weak=!1},next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},x:null,y:null,copy:function(){return pu.get(this.x,this.y)},toString:function(){return"{ x: "+this.x+" y: "+this.y+" }"},__class__:pu};var uu=function(){this._validate=null,this.immutable=!1,this.z=0,this.y=0,this.x=0,this.outer=null,this.immutable=!1,this._validate=null};(n["zpp_nape.geom.ZPP_Vec3"]=uu).__name__=["zpp_nape","geom","ZPP_Vec3"],uu.prototype={outer:null,x:null,y:null,z:null,immutable:null,_validate:null,validate:function(){null!=this._validate&&this._validate()},__class__:uu};var hu=function(){};(n["zpp_nape.geom.ZPP_VecMath"]=hu).__name__=["zpp_nape","geom","ZPP_VecMath"],hu.vec_dsq=function(e,t,n,i){var r,a;return(r=e-n)*r+(a=t-i)*a},hu.vec_distance=function(e,t,n,i){var r,a;return r=e-n,a=t-i,oc.sqrt(r*r+a*a)};var cu=function(){this.wrap_cbTypes=null,this.cbSet=null,this.cbTypes=null,this.group=null,this.cbsets=null,this.icompound=null,this.ibody=null,this.ishape=null,this.userData=null,this.id=0,this.outer_i=null,this.id=H_.Interactor(),this.cbsets=new ju,this.cbTypes=new _p};(n["zpp_nape.phys.ZPP_Interactor"]=cu).__name__=["zpp_nape","phys","ZPP_Interactor"],cu.get=function(e,t){for(var n=e.id<t.id?e.id:t.id,i=e.id<t.id?t.id:e.id,r=null,a=(e.cbsets.length<t.cbsets.length?e.cbsets:t.cbsets).begin();null!=a;){var s=a.elem();if(s.id==n&&s.di==i){r=s;break}a=a.next}return r},cu.int_callback=function(e,t,n){var i=e.int1,r=e.int2;t.options1.compatible(i.cbTypes)&&t.options2.compatible(r.cbTypes)?(n.int1=i,n.int2=r):(n.int1=r,n.int2=i)},cu.prototype={outer_i:null,id:null,userData:null,ishape:null,ibody:null,icompound:null,isShape:function(){return null!=this.ishape},isBody:function(){return null!=this.ibody},isCompound:function(){return null!=this.icompound},__iaddedToSpace:function(){null!=this.group&&this.group.addInteractor(this);for(var e=this.cbTypes.begin();null!=e;)e.elem().addInteractor(this),e=e.next;this.alloc_cbSet()},__iremovedFromSpace:function(){null!=this.group&&this.group.remInteractor(this);for(var e=this.cbTypes.begin();null!=e;)e.elem().remInteractor(this),e=e.next;this.dealloc_cbSet()},wake:function(){if(this.isShape()){var e=this.ishape.body;null!=e&&null!=e.space&&e.space.non_inlined_wake(e)}else this.isBody()?null!=this.ibody.space&&this.ibody.space.non_inlined_wake(this.ibody):null!=this.icompound.space&&this.icompound.space.wakeCompound(this.icompound)},cbsets:null,getSpace:function(){return this.isShape()?null==this.ishape.body?null:this.ishape.body.space:this.isBody()?this.ibody.space:this.icompound.space},group:null,cbTypes:null,cbSet:null,wrap_cbTypes:null,setupcbTypes:function(){this.wrap_cbTypes=Qh.get(this.cbTypes),this.wrap_cbTypes.zpp_inner.adder=yc(this,this.wrap_cbTypes_adder),this.wrap_cbTypes.zpp_inner.subber=yc(this,this.wrap_cbTypes_subber),this.wrap_cbTypes.zpp_inner.dontremove=!0},wrap_cbTypes_subber:function(e){var t=e.zpp_inner;if(this.cbTypes.has(t)){var n=this.getSpace();null!=n&&(this.dealloc_cbSet(),t.remInteractor(this)),this.cbTypes.remove(t),null!=n&&(this.alloc_cbSet(),this.wake())}},wrap_cbTypes_adder:function(e){return this.insert_cbtype(e.zpp_inner),!1},insert_cbtype:function(e){if(!this.cbTypes.has(e)){var t=this.getSpace();null!=t&&(this.dealloc_cbSet(),e.addInteractor(this));for(var n=null,i=this.cbTypes.begin();null!=i;){var r=i.elem();if(rp.setlt(e,r))break;i=(n=i).next}this.cbTypes.inlined_insert(n,e),null!=t&&(this.alloc_cbSet(),this.wake())}},alloc_cbSet:function(){var e=this.getSpace();null!=(this.cbSet=e.cbsets.get(this.cbTypes))&&(this.cbSet.increment(),this.cbSet.addInteractor(this),this.cbSet.validate(),e.freshInteractorType(this))},dealloc_cbSet:function(){var e=this.getSpace();if(null!=this.cbSet){if(this.cbSet.remInteractor(this),e.nullInteractorType(this),this.cbSet.decrement()){e.cbsets.remove(this.cbSet);var t=this.cbSet;t.free(),t.next=J_.zpp_pool,J_.zpp_pool=t}this.cbSet=null}},setGroup:function(e){if(this.group!=e){var t=null!=this.getSpace();t&&null!=this.group&&this.group.remInteractor(this),this.group=e,t&&null!=e&&e.addInteractor(this),t&&(this.isShape()?this.ishape.body.wake():this.isBody()?this.ibody.wake():this.icompound.wake())}},immutable_midstep:function(e){this.isBody()?this.ibody.__immutable_midstep(e):this.isShape()?this.ishape.__immutable_midstep(e):this.icompound.__imutable_midstep(e)},lookup_group:function(){for(var e=this;null!=e&&null==e.group;)e=e.isShape()?e.ishape.body:e.isCompound()?e.icompound.compound:e.ibody.compound;return null==e?null:e.group},copyto:function(e){e.zpp_inner_i.group=this.group;for(var t=this.outer_i.get_cbTypes().iterator();t.hasNext();){var n=t.next();e.get_cbTypes().add(n)}null!=this.userData&&(e.zpp_inner_i.userData=_.copy(this.userData))},__class__:cu};var du=function(){this.wrap_worldCOM=null,this.wrap_localCOM=null,this.zip_worldCOM=!1,this.worldCOMy=0,this.worldCOMx=0,this.zip_localCOM=!1,this.localCOMy=0,this.localCOMx=0,this.zip_aabb=!1,this.aabb=null,this.norotate=!1,this.sinertia=0,this.iinertia=0,this.cinertia=0,this.zip_inertia=!1,this.inertia=0,this.inertiaMode=0,this.zip_gravMassScale=!1,this.gravMassScale=0,this.gravMassMode=0,this.zip_gravMass=!1,this.gravMass=0,this.nomove=!1,this.cmass=0,this.smass=0,this.imass=0,this.massMode=0,this.zip_mass=!1,this.mass=0,this.zip_axis=!1,this.axisy=0,this.axisx=0,this.rot=0,this.pre_rot=0,this.kinangvel=0,this.torque=0,this.angvel=0,this.wrapcvel=null,this.wrap_svel=null,this.svely=0,this.svelx=0,this.wrap_kinvel=null,this.kinvely=0,this.kinvelx=0,this.wrap_force=null,this.forcey=0,this.forcex=0,this.wrap_vel=null,this.vely=0,this.velx=0,this.wrap_pos=null,this.posy=0,this.posx=0,this.pre_posy=0,this.pre_posx=0,this.disableCCD=!1,this.bulletEnabled=!1,this.bullet=!1,this.sweepRadius=0,this.sweepFrozen=!1,this.sweep_angvel=0,this.sweepTime=0,this.graph_depth=0,this.component=null,this.wrap_constraints=null,this.constraints=null,this.wrap_arbiters=null,this.arbiters=null,this.space=null,this.wrap_shapes=null,this.shapes=null,this.compound=null,this.type=0,this.world=!1,this.outer=null,cu.call(this),(this.ibody=this).world=!1,this.bulletEnabled=!1,this.sweepTime=0,this.sweep_angvel=0,this.norotate=this.nomove=!1,this.disableCCD=!1,this.posx=0,this.posy=0,this.rot=0,this.axisx=0,this.axisy=1,this.svelx=0,this.svely=0,this.velx=0,this.vely=0,this.kinvelx=0,this.kinvely=0,this.forcex=0,this.forcey=0,this.torque=this.angvel=this.kinangvel=0,this.pre_posx=X_.POSINF(),this.pre_posy=X_.POSINF(),this.pre_rot=X_.POSINF(),this.localCOMx=0,this.localCOMy=0,this.worldCOMx=0,this.worldCOMy=0,this.zip_aabb=!0,this.aabb=Ap.get(0,0,0,0),this.aabb._immutable=!0,this.aabb._validate=yc(this,this.aabb_validate),this.massMode=0,this.gravMassMode=0,this.gravMassScale=1,this.inertiaMode=0,this.arbiters=new Zu,this.constraints=new tp,this.shapes=new Fu,this.wrap_shapes=rc.get(this.shapes),this.wrap_shapes.zpp_inner.adder=yc(this,this.shapes_adder),this.wrap_shapes.zpp_inner.subber=yc(this,this.shapes_subber),this.wrap_shapes.zpp_inner._invalidate=yc(this,this.shapes_invalidate),this.kinematicDelaySleep=!1};(n["zpp_nape.phys.ZPP_Body"]=du).__name__=["zpp_nape","phys","ZPP_Body"],du.bodysetlt=function(e,t){return e.id<t.id},du.__static=function(){var e=new y_(w_.get_STATIC()),t=e.zpp_inner;return t.world=!0,t.wrap_shapes.zpp_inner.immutable=!0,t.smass=t.imass=t.cmass=t.mass=t.gravMass=0,t.sinertia=t.iinertia=t.cinertia=t.inertia=0,t.cbTypes.clear(),e},du.__super__=cu,du.prototype=r(cu.prototype,{outer:null,world:null,type:null,isStatic:function(){return 1==this.type},isDynamic:function(){return 2==this.type},isKinematic:function(){return 3==this.type},invalidate_type:function(){this.invalidate_mass(),this.invalidate_inertia()},compound:null,shapes:null,wrap_shapes:null,invalidate_shapes:function(){this.invalidate_aabb(),this.invalidate_localCOM(),this.invalidate_mass(),this.invalidate_inertia()},space:null,arbiters:null,wrap_arbiters:null,constraints:null,wrap_constraints:null,component:null,graph_depth:null,init_bodysetlist:function(){null==du.bodyset&&(du.bodyset=new pc,du.bodyset.lt=du.bodysetlt,du.bodystack=new Ru)},connectedBodies_cont:function(e){du.bodyset.try_insert_bool(e.zpp_inner)&&(du.bodystack.add(e.zpp_inner),e.zpp_inner.graph_depth=du.cur_graph_depth+1)},connectedBodies:function(e,t){var n=this;this.init_bodysetlist();var i=null==t?new z_:t;for(du.bodystack.add(this),du.bodyset.insert(this),this.graph_depth=0;!du.bodystack.empty();){var r=du.bodystack.pop_unsafe();if(r.graph_depth!=e){du.cur_graph_depth=r.graph_depth;for(var a=r.constraints.begin();null!=a;)a.elem().outer.visitBodies(yc(this,this.connectedBodies_cont)),a=a.next}}return du.bodyset.clear_with((function(e){e!=n&&i.add(e.outer)})),i},interactingBodies:function(e,t,n){var i=this;this.init_bodysetlist();var r=null==n?new z_:n;for(du.bodyset.insert(this),du.bodystack.add(this),this.graph_depth=0;!du.bodystack.empty();){var a=du.bodystack.pop_unsafe();if(a.graph_depth!=t)for(var s=a.arbiters.begin();null!=s;){var l=s.elem();if(0!=(l.type&e)){var o=l.b1==a?l.b2:l.b1;du.bodyset.try_insert_bool(o)&&(du.bodystack.add(o),o.graph_depth=a.graph_depth+1)}s=s.next}}return du.bodyset.clear_with((function(e){e!=i&&r.add(e.outer)})),r},atRest:function(e){if(this.isDynamic()){var t,n=lo.linearSleepThreshold;if(n*=n,this.velx*this.velx+this.vely*this.vely>n)t=!1;else if(hu.vec_dsq(this.posx,this.posy,this.pre_posx,this.pre_posy)>.25*n*e*e)t=!1;else{var i,r,a=(i=this.aabb.maxx-this.aabb.minx)*i+(r=this.aabb.maxy-this.aabb.miny)*r,s=lo.angularSleepThreshold;if(s*=s,4*this.angvel*this.angvel*a>s)t=!1;else{var l=this.rot-this.pre_rot;t=!(s*e*e<l*l*a)}}return t||(this.component.waket=this.space.stamp),this.component.waket+lo.sleepDelay<this.space.stamp}return this.component.sleeping},refreshArbiters:function(){for(var e=this.arbiters.begin();null!=e;)e.elem().invalidated=!0,e=e.next},sweepTime:null,sweep_angvel:null,sweepFrozen:null,sweepRadius:null,bullet:null,bulletEnabled:null,disableCCD:null,sweepIntegrate:function(e){var t=e-this.sweepTime;if(0!=t){this.sweepTime=e;var n=t;this.posx+=this.velx*n,this.posy+=this.vely*n,0!=this.angvel&&this.delta_rot(this.sweep_angvel*t)}},sweepValidate:function(e){if(e.isCircle())e.worldCOMx=this.posx+(this.axisy*e.localCOMx-this.axisx*e.localCOMy),e.worldCOMy=this.posy+(e.localCOMx*this.axisx+e.localCOMy*this.axisy);else{for(var t=e.polygon,n=t.lverts.begin(),i=t.gverts.begin();null!=i;){var r=i.elem(),a=n.elem();n=n.next,r.x=this.posx+(this.axisy*a.x-this.axisx*a.y),r.y=this.posy+(a.x*this.axisx+a.y*this.axisy),i=i.next}var s=t.edges.begin(),l=t.gverts.begin(),o=l.elem();for(l=l.next;null!=l;){var _=l.elem(),p=s.elem();s=s.next,p.gnormx=this.axisy*p.lnormx-this.axisx*p.lnormy,p.gnormy=p.lnormx*this.axisx+p.lnormy*this.axisy,p.gprojection=this.posx*p.gnormx+this.posy*p.gnormy+p.lprojection,p.tp0=o.y*p.gnormx-o.x*p.gnormy,p.tp1=_.y*p.gnormx-_.x*p.gnormy,o=_,l=l.next}var u=t.gverts.front(),h=s.elem();s=s.next,h.gnormx=this.axisy*h.lnormx-this.axisx*h.lnormy,h.gnormy=h.lnormx*this.axisx+h.lnormy*this.axisy,h.gprojection=this.posx*h.gnormx+this.posy*h.gnormy+h.lprojection,h.tp0=o.y*h.gnormx-o.x*h.gnormy,h.tp1=u.y*h.gnormx-u.x*h.gnormy}},pre_posx:null,pre_posy:null,posx:null,posy:null,wrap_pos:null,velx:null,vely:null,wrap_vel:null,forcex:null,forcey:null,wrap_force:null,kinvelx:null,kinvely:null,wrap_kinvel:null,svelx:null,svely:null,wrap_svel:null,invalidate_pos:function(){for(var e=this.shapes.begin();null!=e;){var t=e.elem();1==t.type&&(t.polygon.invalidate_gverts(),t.polygon.invalidate_gaxi()),t.invalidate_worldCOM(),e=e.next}this.invalidate_worldCOM()},pos_invalidate:function(e){this.immutable_midstep("Body::position"),this.posx==e.x&&this.posy==e.y||(this.posx=e.x,this.posy=e.y,this.invalidate_pos(),this.wake())},pos_validate:function(){this.wrap_pos.zpp_inner.x=this.posx,this.wrap_pos.zpp_inner.y=this.posy},vel_invalidate:function(e){this.velx=e.x,this.vely=e.y,this.invalidate_wake()},vel_validate:function(){this.wrap_vel.zpp_inner.x=this.velx,this.wrap_vel.zpp_inner.y=this.vely},kinvel_invalidate:function(e){this.kinvelx=e.x,this.kinvely=e.y,this.invalidate_wake()},kinvel_validate:function(){this.wrap_kinvel.zpp_inner.x=this.kinvelx,this.wrap_kinvel.zpp_inner.y=this.kinvely},svel_invalidate:function(e){this.svelx=e.x,this.svely=e.y,this.invalidate_wake()},svel_validate:function(){this.wrap_svel.zpp_inner.x=this.svelx,this.wrap_svel.zpp_inner.y=this.svely},force_invalidate:function(e){this.forcex=e.x,this.forcey=e.y,this.invalidate_wake()},force_validate:function(){this.wrap_force.zpp_inner.x=this.forcex,this.wrap_force.zpp_inner.y=this.forcey},setupPosition:function(){this.wrap_pos=d_.get(this.posx,this.posy),this.wrap_pos.zpp_inner._inuse=!0,this.world?this.wrap_pos.zpp_inner._immutable=!0:(this.wrap_pos.zpp_inner._invalidate=yc(this,this.pos_invalidate),this.wrap_pos.zpp_inner._validate=yc(this,this.pos_validate))},setupVelocity:function(){this.wrap_vel=d_.get(this.velx,this.vely),this.wrap_vel.zpp_inner._inuse=!0,this.world?this.wrap_vel.zpp_inner._immutable=!0:(this.wrap_vel.zpp_inner._invalidate=yc(this,this.vel_invalidate),this.wrap_vel.zpp_inner._validate=yc(this,this.vel_validate))},setupkinvel:function(){this.wrap_kinvel=d_.get(this.kinvelx,this.kinvely),this.wrap_kinvel.zpp_inner._inuse=!0,this.world?this.wrap_kinvel.zpp_inner._immutable=!0:(this.wrap_kinvel.zpp_inner._invalidate=yc(this,this.kinvel_invalidate),this.wrap_kinvel.zpp_inner._validate=yc(this,this.kinvel_validate))},setupsvel:function(){this.wrap_svel=d_.get(this.svelx,this.svely),this.wrap_svel.zpp_inner._inuse=!0,this.world?this.wrap_svel.zpp_inner._immutable=!0:(this.wrap_svel.zpp_inner._invalidate=yc(this,this.svel_invalidate),this.wrap_svel.zpp_inner._validate=yc(this,this.svel_validate))},setupForce:function(){this.wrap_force=d_.get(this.forcex,this.forcey),this.wrap_force.zpp_inner._inuse=!0,this.world?this.wrap_force.zpp_inner._immutable=!0:(this.wrap_force.zpp_inner._invalidate=yc(this,this.force_invalidate),this.wrap_force.zpp_inner._validate=yc(this,this.force_validate))},cvel_validate:function(){this.wrapcvel.zpp_inner.x=this.velx+this.kinvelx,this.wrapcvel.zpp_inner.y=this.vely+this.kinvely,this.wrapcvel.zpp_inner.z=this.angvel+this.kinangvel},wrapcvel:null,setup_cvel:function(){this.wrapcvel=g_.get(),this.wrapcvel.zpp_inner.immutable=!0,this.wrapcvel.zpp_inner._validate=yc(this,this.cvel_validate)},angvel:null,torque:null,kinangvel:null,pre_rot:null,rot:null,invalidate_rot:function(){this.zip_axis=!0;for(var e=this.shapes.begin();null!=e;){var t=e.elem();1==t.type&&(t.polygon.invalidate_gverts(),t.polygon.invalidate_gaxi()),t.invalidate_worldCOM(),e=e.next}this.invalidate_worldCOM()},axisx:null,axisy:null,zip_axis:null,validate_axis:function(){this.zip_axis&&(this.zip_axis=!1,this.quick_validate_axis())},quick_validate_axis:function(){this.axisx=Math.sin(this.rot),this.axisy=Math.cos(this.rot)},delta_rot:function(e){if(this.rot+=e,1e-4<e*e)this.quick_validate_axis();else{var t=e*e,n=1-.5*t,i=1-t*t/8,r=(n*this.axisx+e*this.axisy)*i;this.axisy=(n*this.axisy-e*this.axisx)*i,this.axisx=r}},kinematicDelaySleep:null,mass:null,zip_mass:null,massMode:null,imass:null,smass:null,cmass:null,nomove:null,invalidate_mass:function(){this.zip_mass=!0,this.invalidate_gravMass()},validate_mass:function(){if(this.zip_mass||(this.massMode,0)){if(this.zip_mass=!1,0==this.massMode){this.cmass=0;for(var e=this.shapes.begin();null!=e;){var t=e.elem();t.refmaterial.density=t.material.density,t.validate_area_inertia(),this.cmass+=t.area*t.material.density,e=e.next}}this.isDynamic()&&!this.nomove?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=X_.POSINF(),this.imass=this.smass=0)}},gravMass:null,zip_gravMass:null,gravMassMode:null,gravMassScale:null,zip_gravMassScale:null,invalidate_gravMass:function(){1!=this.gravMassMode&&(this.zip_gravMass=!0),2!=this.gravMassMode&&(this.zip_gravMassScale=!0),this.wake()},validate_gravMass:function(){this.zip_gravMass&&(this.zip_gravMass=!1,this.validate_mass(),0==this.gravMassMode?(this.validate_mass(),this.gravMass=this.cmass):2==this.gravMassMode&&(this.validate_mass(),this.gravMass=this.cmass*this.gravMassScale))},invalidate_gravMassScale:function(){2!=this.gravMassMode?this.zip_gravMassScale=!0:this.invalidate_gravMass()},validate_gravMassScale:function(){this.zip_gravMassScale&&(this.zip_gravMassScale=!1,0==this.gravMassMode?this.gravMassScale=1:1==this.gravMassMode&&(this.validate_mass(),this.gravMassScale=this.gravMass/this.cmass))},inertiaMode:null,inertia:null,zip_inertia:null,cinertia:null,iinertia:null,sinertia:null,norotate:null,invalidate_inertia:function(){this.zip_inertia=!0,this.wake()},validate_inertia:function(){if(this.zip_inertia||(this.inertiaMode,0)){if(this.zip_inertia=!1,0==this.inertiaMode){this.cinertia=0;for(var e=this.shapes.begin();null!=e;){var t=e.elem();t.refmaterial.density=t.material.density,t.validate_area_inertia(),this.cinertia+=t.inertia*t.area*t.material.density,e=e.next}}this.isDynamic()&&!this.norotate?(this.inertia=this.cinertia,this.sinertia=this.iinertia=1/this.inertia):(this.inertia=X_.POSINF(),this.sinertia=this.iinertia=0)}},invalidate_wake:function(){this.wake()},aabb:null,zip_aabb:null,validate_aabb:function(){if(this.zip_aabb){this.zip_aabb=!1,this.aabb.minx=X_.POSINF(),this.aabb.miny=X_.POSINF(),this.aabb.maxx=X_.NEGINF(),this.aabb.maxy=X_.NEGINF();for(var e=this.shapes.begin();null!=e;){var t=e.elem();t.validate_aabb(),this.aabb.combine(t.aabb),e=e.next}}},invalidate_aabb:function(){this.zip_aabb=!0},localCOMx:null,localCOMy:null,zip_localCOM:null,worldCOMx:null,worldCOMy:null,zip_worldCOM:null,wrap_localCOM:null,wrap_worldCOM:null,invalidate_localCOM:function(){this.zip_localCOM=!0,this.invalidate_worldCOM()},invalidate_worldCOM:function(){this.zip_worldCOM=!0},validate_localCOM:function(){if(this.zip_localCOM){this.zip_localCOM=!1;for(var e=0,t=0,n=0,i=this.shapes.begin();null!=i;){var r=i.elem();r.validate_localCOM(),r.validate_area_inertia();var a=r.area*r.material.density;e+=r.localCOMx*a,t+=r.localCOMy*a,n+=r.area*r.material.density,i=i.next}if(0!=n){var s=1/n;this.localCOMx=e*s,this.localCOMy=t*s}null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy),this.zip_mass&&0==this.massMode&&(this.zip_mass=!1,this.cmass=n,this.isDynamic()?(this.mass=this.cmass,this.imass=this.smass=1/this.mass):(this.mass=X_.POSINF(),this.imass=this.smass=0))}},validate_worldCOM:function(){this.zip_worldCOM&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.validate_axis(),this.worldCOMx=this.posx+(this.axisy*this.localCOMx-this.axisx*this.localCOMy),this.worldCOMy=this.posy+(this.localCOMx*this.axisx+this.localCOMy*this.axisy),null!=this.wrap_worldCOM&&(this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy))},getlocalCOM:function(){this.validate_localCOM()},getworldCOM:function(){this.validate_worldCOM()},__immutable_midstep:function(e){},clear:function(){for(;!this.shapes.empty();){var e=this.shapes.pop_unsafe();e.removedFromBody(),e.body=null}this.invalidate_shapes(),this.pre_posx=0,this.pre_posy=0,this.posx=0,this.posy=0,this.velx=0,this.vely=0,this.forcex=0,this.forcey=0,this.kinvelx=0,this.kinvely=0,this.svelx=0,this.svely=0,this.angvel=this.torque=this.kinangvel=this.pre_rot=this.rot=0,this.invalidate_pos(),this.invalidate_rot(),this.axisx=0,this.axisy=1,this.zip_axis=!1,this.massMode=0,this.gravMassMode=0,this.gravMassScale=1,this.inertiaMode=0,this.norotate=!1,this.nomove=!1},aabb_validate:function(){this.validate_aabb()},shapes_adder:function(e){return e.zpp_inner.body!=this&&(null!=e.zpp_inner.body&&e.zpp_inner.body.wrap_shapes.remove(e),e.zpp_inner.body=this,e.zpp_inner.addedToBody(),null!=this.space&&this.space.added_shape(e.zpp_inner),e.zpp_inner.isPolygon()&&(e.zpp_inner.polygon.invalidate_gaxi(),e.zpp_inner.polygon.invalidate_gverts()),!0)},shapes_subber:function(e){null!=this.space&&this.space.removed_shape(e.zpp_inner),e.zpp_inner.body=null,e.zpp_inner.removedFromBody()},shapes_invalidate:function(e){this.invalidate_shapes()},addedToSpace:function(){null==Nu.zpp_pool?this.component=new Nu:(this.component=Nu.zpp_pool,Nu.zpp_pool=this.component.next,this.component.next=null),this.component.alloc(),this.component.isBody=!0,(this.component.body=this).__iaddedToSpace()},removedFromSpace:function(){for(;!this.arbiters.empty();)this.arbiters.pop_unsafe().lazyRetire(this.space,this);var e=this.component;e.free(),e.next=Nu.zpp_pool,Nu.zpp_pool=e,this.component=null,this.__iremovedFromSpace()},copy:function(){var e=(new y_).zpp_inner;e.type=this.type,e.bulletEnabled=this.bulletEnabled,e.disableCCD=this.disableCCD;for(var t=this.shapes.begin();null!=t;){var n=t.elem();e.outer.get_shapes().add(n.outer.copy()),t=t.next}return e.posx=this.posx,e.posy=this.posy,e.velx=this.velx,e.vely=this.vely,e.forcex=this.forcex,e.forcey=this.forcey,e.rot=this.rot,e.angvel=this.angvel,e.torque=this.torque,e.kinvelx=this.kinvelx,e.kinvely=this.kinvely,e.kinangvel=this.kinangvel,e.svelx=this.svelx,e.svely=this.svely,this.zip_axis?e.invalidate_rot():(e.axisx=this.axisx,e.axisy=this.axisy),e.rot=this.rot,e.massMode=this.massMode,e.gravMassMode=this.gravMassMode,e.inertiaMode=this.inertiaMode,e.norotate=this.norotate,e.nomove=this.nomove,e.cmass=this.cmass,e.cinertia=this.cinertia,this.zip_mass?e.invalidate_mass():e.mass=this.mass,this.zip_gravMass?e.invalidate_gravMass():e.gravMass=this.gravMass,this.zip_gravMassScale?e.invalidate_gravMassScale():e.gravMassScale=this.gravMassScale,this.zip_inertia?e.invalidate_inertia():e.inertia=this.inertia,this.zip_aabb?e.invalidate_aabb():(e.aabb.minx=this.aabb.minx,e.aabb.miny=this.aabb.miny,e.aabb.maxx=this.aabb.maxx,e.aabb.maxy=this.aabb.maxy),this.zip_localCOM?e.invalidate_localCOM():(e.localCOMx=this.localCOMx,e.localCOMy=this.localCOMy),this.zip_worldCOM?e.invalidate_worldCOM():(e.worldCOMx=this.worldCOMx,e.worldCOMy=this.worldCOMy),this.copyto(e.outer),e.outer},__class__:du});var mu=function(){this.space=null,this.compound=null,this.depth=0,this.wrap_compounds=null,this.wrap_constraints=null,this.wrap_bodies=null,this.compounds=null,this.constraints=null,this.bodies=null,this.outer=null,cu.call(this),(this.icompound=this).depth=1,this.bodies=new Ru,this.wrap_bodies=Hh.get(this.bodies),this.wrap_bodies.zpp_inner.adder=yc(this,this.bodies_adder),this.wrap_bodies.zpp_inner.subber=yc(this,this.bodies_subber),this.constraints=new tp,this.wrap_constraints=Xh.get(this.constraints),this.wrap_constraints.zpp_inner.adder=yc(this,this.constraints_adder),this.wrap_constraints.zpp_inner.subber=yc(this,this.constraints_subber),this.compounds=new Gu,this.wrap_compounds=Jh.get(this.compounds),this.wrap_compounds.zpp_inner.adder=yc(this,this.compounds_adder),this.wrap_compounds.zpp_inner.subber=yc(this,this.compounds_subber)};(n["zpp_nape.phys.ZPP_Compound"]=mu).__name__=["zpp_nape","phys","ZPP_Compound"],mu.__super__=cu,mu.prototype=r(cu.prototype,{outer:null,bodies:null,constraints:null,compounds:null,wrap_bodies:null,wrap_constraints:null,wrap_compounds:null,depth:null,compound:null,space:null,__imutable_midstep:function(e){},addedToSpace:function(){this.__iaddedToSpace()},removedFromSpace:function(){this.__iremovedFromSpace()},breakApart:function(){for(null!=this.space&&(this.__iremovedFromSpace(),this.space.nullInteractorType(this)),null!=this.compound?this.compound.compounds.remove(this):null!=this.space&&this.space.compounds.remove(this);!this.bodies.empty();){var e=this.bodies.pop_unsafe();null!=(e.compound=this.compound)?this.compound.bodies.add(e):null!=this.space&&this.space.bodies.add(e),null!=this.space&&this.space.freshInteractorType(e)}for(;!this.constraints.empty();){var t=this.constraints.pop_unsafe();null!=(t.compound=this.compound)?this.compound.constraints.add(t):null!=this.space&&this.space.constraints.add(t)}for(;!this.compounds.empty();){var n=this.compounds.pop_unsafe();null!=(n.compound=this.compound)?this.compound.compounds.add(n):null!=this.space&&this.space.compounds.add(n),null!=this.space&&this.space.freshInteractorType(n)}this.compound=null,this.space=null},bodies_adder:function(e){return e.zpp_inner.compound!=this&&(null!=e.zpp_inner.compound?e.zpp_inner.compound.wrap_bodies.remove(e):null!=e.zpp_inner.space&&e.zpp_inner.space.wrap_bodies.remove(e),null!=(e.zpp_inner.compound=this).space&&this.space.addBody(e.zpp_inner),!0)},bodies_subber:function(e){(e.zpp_inner.compound=null)!=this.space&&this.space.remBody(e.zpp_inner)},constraints_adder:function(e){return e.zpp_inner.compound!=this&&(null!=e.zpp_inner.compound?e.zpp_inner.compound.wrap_constraints.remove(e):null!=e.zpp_inner.space&&e.zpp_inner.space.wrap_constraints.remove(e),null!=(e.zpp_inner.compound=this).space&&this.space.addConstraint(e.zpp_inner),!0)},constraints_subber:function(e){(e.zpp_inner.compound=null)!=this.space&&this.space.remConstraint(e.zpp_inner)},compounds_adder:function(e){return e.zpp_inner.compound!=this&&(null!=e.zpp_inner.compound?e.zpp_inner.compound.wrap_compounds.remove(e):null!=e.zpp_inner.space&&e.zpp_inner.space.wrap_compounds.remove(e),e.zpp_inner.compound=this,e.zpp_inner.depth=this.depth+1,null!=this.space&&this.space.addCompound(e.zpp_inner),!0)},compounds_subber:function(e){e.zpp_inner.compound=null,e.zpp_inner.depth=1,null!=this.space&&this.space.remCompound(e.zpp_inner)},copy:function(e,t){var n=null==e;null==e&&(e=[]),null==t&&(t=[]);for(var i=new k_,r=this.compounds.begin();null!=r;)r.elem().copy(e,t).set_compound(i),r=r.next;for(var a=this.bodies.begin();null!=a;){var s=a.elem(),l=s.outer.copy();e.push(dp.dict(s.id,l)),l.set_compound(i),a=a.next}for(var o=this.constraints.begin();null!=o;)o.elem().copy(e,t).set_compound(i),o=o.next;if(n)for(;0<t.length;)for(var _=t.pop(),p=0;p<e.length;){var u=e[p];if(++p,u.id==_.id){_.cb(u.bc);break}}return this.copyto(i),i},__class__:mu});var fu=function(){this.wrap_gravity=null,this.gravityy=0,this.gravityx=0,this.density=0,this.viscosity=0,this.wrap_shapes=null,this.shapes=null,this.outer=null,this.userData=null,this.next=null,this.feature_cons(),this.density=this.viscosity=1,this.wrap_gravity=null,this.gravityx=0,this.gravityy=0};(n["zpp_nape.phys.ZPP_FluidProperties"]=fu).__name__=["zpp_nape","phys","ZPP_FluidProperties"],fu.prototype={next:null,userData:null,outer:null,wrapper:function(){if(null==this.outer){this.outer=new N_;var e=this.outer.zpp_inner;e.free(),e.next=fu.zpp_pool,fu.zpp_pool=e,this.outer.zpp_inner=this}return this.outer},free:function(){this.outer=null},alloc:function(){},shapes:null,wrap_shapes:null,feature_cons:function(){this.shapes=new Fu},addShape:function(e){this.shapes.add(e)},remShape:function(e){this.shapes.remove(e)},copy:function(){var e;return null==fu.zpp_pool?e=new fu:(e=fu.zpp_pool,fu.zpp_pool=e.next,e.next=null),e.alloc(),e.viscosity=this.viscosity,e.density=this.density,e},viscosity:null,density:null,gravityx:null,gravityy:null,wrap_gravity:null,gravity_invalidate:function(e){this.gravityx=e.x,this.gravityy=e.y,this.invalidate()},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx,this.wrap_gravity.zpp_inner.y=this.gravityy},getgravity:function(){this.wrap_gravity=d_.get(this.gravityx,this.gravityy),this.wrap_gravity.zpp_inner._inuse=!0,this.wrap_gravity.zpp_inner._invalidate=yc(this,this.gravity_invalidate),this.wrap_gravity.zpp_inner._validate=yc(this,this.gravity_validate)},invalidate:function(){for(var e=this.shapes.begin();null!=e;)e.elem().invalidate_fluidprops(),e=e.next},__class__:fu};var gu=function(e){this.zip_aabb=!1,this.aabb=null,this.pairs=null,this.node=null,this.sweep=null,this.sensorEnabled=!1,this.fluidEnabled=!1,this.fluidProperties=null,this.filter=null,this.material=null,this.refmaterial=null,this.polygon=null,this.circle=null,this.sweepCoef=0,this.zip_sweepRadius=!1,this.sweepRadius=0,this.wrap_worldCOM=null,this.wrap_localCOM=null,this.zip_worldCOM=!1,this.worldCOMy=0,this.worldCOMx=0,this.zip_localCOM=!1,this.localCOMy=0,this.localCOMx=0,this.zip_angDrag=!1,this.angDrag=0,this.inertia=0,this.zip_area_inertia=!1,this.area=0,this.type=0,this.body=null,this.outer=null,cu.call(this),this.pairs=new Qu,(this.ishape=this).type=e,this.aabb=Ap.get(0,0,0,0),this.aabb._immutable=!0,this.aabb._validate=yc(this,this.aabb_validate),this.zip_area_inertia=this.zip_angDrag=this.zip_localCOM=this.zip_sweepRadius=!0,this.localCOMx=0,this.localCOMy=0,this.worldCOMx=0,this.worldCOMy=0,this.fluidEnabled=!1,this.sensorEnabled=!1,this.fluidProperties=null,this.body=null,this.refmaterial=new Qi,this.sweepRadius=this.sweepCoef=0};(n["zpp_nape.shape.ZPP_Shape"]=gu).__name__=["zpp_nape","shape","ZPP_Shape"],gu.__super__=cu,gu.prototype=r(cu.prototype,{outer:null,body:null,type:null,isCircle:function(){return 0==this.type},isPolygon:function(){return 1==this.type},area:null,zip_area_inertia:null,inertia:null,angDrag:null,zip_angDrag:null,localCOMx:null,localCOMy:null,zip_localCOM:null,worldCOMx:null,worldCOMy:null,zip_worldCOM:null,wrap_localCOM:null,wrap_worldCOM:null,sweepRadius:null,zip_sweepRadius:null,sweepCoef:null,invalidate_sweepRadius:function(){this.zip_sweepRadius=!0},validate_sweepRadius:function(){this.zip_sweepRadius&&(this.zip_sweepRadius=!1,this.isCircle()?this.circle.__validate_sweepRadius():this.polygon.__validate_sweepRadius())},circle:null,polygon:null,refmaterial:null,material:null,filter:null,fluidProperties:null,fluidEnabled:null,sensorEnabled:null,sweep:null,node:null,pairs:null,clear:function(){this.isCircle()?this.circle.__clear():this.polygon.__clear()},aabb:null,zip_aabb:null,validate_aabb:function(){this.zip_aabb&&null!=this.body&&(this.zip_aabb=!1,this.isCircle()?this.circle.__validate_aabb():this.polygon.__validate_aabb())},force_validate_aabb:function(){this.isCircle()?this.circle._force_validate_aabb():this.polygon._force_validate_aabb()},invalidate_aabb:function(){this.zip_aabb=!0,null!=this.body&&this.body.invalidate_aabb()},validate_area_inertia:function(){this.zip_area_inertia&&(this.zip_area_inertia=!1,this.isCircle()?this.circle.__validate_area_inertia():this.polygon.__validate_area_inertia())},validate_angDrag:function(){(this.zip_angDrag||this.refmaterial.dynamicFriction!=this.material.dynamicFriction)&&(this.zip_angDrag=!1,this.refmaterial.dynamicFriction=this.material.dynamicFriction,this.isCircle()?this.circle.__validate_angDrag():this.polygon.__validate_angDrag())},validate_localCOM:function(){this.zip_localCOM&&(this.zip_localCOM=!1,this.isPolygon()&&this.polygon.__validate_localCOM(),null!=this.wrap_localCOM&&(this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy))},validate_worldCOM:function(){this.zip_worldCOM&&null!=this.body&&(this.zip_worldCOM=!1,this.validate_localCOM(),this.body.validate_axis(),this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy))},getworldCOM:function(){this.validate_worldCOM(),this.wrap_worldCOM.zpp_inner.x=this.worldCOMx,this.wrap_worldCOM.zpp_inner.y=this.worldCOMy},invalidate_area_inertia:function(){this.zip_area_inertia=!0,null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia())},invalidate_angDrag:function(){this.zip_angDrag=!0},invalidate_localCOM:function(){this.zip_localCOM=!0,this.invalidate_area_inertia(),this.isCircle()&&this.invalidate_sweepRadius(),this.invalidate_angDrag(),this.invalidate_worldCOM(),null!=this.body&&this.body.invalidate_localCOM()},invalidate_worldCOM:function(){this.zip_worldCOM=!0,this.invalidate_aabb()},invalidate_material:function(e){0!=(e&Qi.WAKE)&&this.wake(),0!=(e&Qi.ARBITERS)&&null!=this.body&&this.body.refreshArbiters(),0!=(e&Qi.PROPS)&&null!=this.body&&(this.body.invalidate_localCOM(),this.body.invalidate_mass(),this.body.invalidate_inertia()),0!=(e&Qi.ANGDRAG)&&this.invalidate_angDrag(),this.refmaterial.set(this.material)},invalidate_filter:function(){this.wake()},invalidate_fluidprops:function(){this.fluidEnabled&&this.wake()},aabb_validate:function(){this.validate_aabb()},setMaterial:function(e){this.material!=e&&(null!=this.body&&null!=this.body.space&&null!=this.material&&this.material.remShape(this),this.material=e,null!=this.body&&null!=this.body.space&&e.addShape(this),this.wake(),null!=this.body&&this.body.refreshArbiters())},setFilter:function(e){this.filter!=e&&(null!=this.body&&null!=this.body.space&&null!=this.filter&&this.filter.remShape(this),this.filter=e,null!=this.body&&null!=this.body.space&&e.addShape(this),this.wake())},setFluid:function(e){this.fluidProperties!=e&&(null!=this.body&&null!=this.body.space&&null!=this.fluidProperties&&this.fluidProperties.remShape(this),this.fluidProperties=e,null!=this.body&&null!=this.body.space&&e.addShape(this),this.fluidEnabled&&this.wake())},__immutable_midstep:function(e){},addedToBody:function(){this.invalidate_worldCOM(),this.invalidate_aabb()},removedFromBody:function(){},addedToSpace:function(){this.__iaddedToSpace(),this.material.addShape(this),this.filter.addShape(this),null!=this.fluidProperties&&this.fluidProperties.addShape(this)},removedFromSpace:function(){this.__iremovedFromSpace(),this.material.remShape(this),this.filter.remShape(this),null!=this.fluidProperties&&this.fluidProperties.remShape(this)},copy:function(){var e=null;e=this.isCircle()?this.circle.__copy():this.polygon.__copy(),this.zip_area_inertia?e.invalidate_area_inertia():(e.area=this.area,e.inertia=this.inertia),this.zip_sweepRadius?e.invalidate_sweepRadius():(e.sweepRadius=this.sweepRadius,e.sweepCoef=this.sweepCoef),this.zip_angDrag?e.invalidate_angDrag():e.angDrag=this.angDrag,this.zip_aabb?e.invalidate_aabb():(e.aabb.minx=this.aabb.minx,e.aabb.miny=this.aabb.miny,e.aabb.maxx=this.aabb.maxx,e.aabb.maxy=this.aabb.maxy);var t=e.material;t.free(),t.next=Qi.zpp_pool,Qi.zpp_pool=t;var n=e.filter;return n.free(),n.next=xi.zpp_pool,xi.zpp_pool=n,e.material=this.material,e.filter=this.filter,null!=this.fluidProperties&&(e.fluidProperties=this.fluidProperties),e.fluidEnabled=this.fluidEnabled,e.sensorEnabled=this.sensorEnabled,null!=this.userData&&(e.userData=_.copy(this.userData)),this.copyto(e.outer),e.outer},__class__:gu});var vu=function(){this.radius=0,this.outer_zn=null,gu.call(this,0),(this.circle=this).zip_localCOM=!1};(n["zpp_nape.shape.ZPP_Circle"]=vu).__name__=["zpp_nape","shape","ZPP_Circle"],vu.__super__=gu,vu.prototype=r(gu.prototype,{outer_zn:null,radius:null,__clear:function(){},invalidate_radius:function(){this.invalidate_area_inertia(),this.invalidate_angDrag(),this.invalidate_aabb(),null!=this.body&&this.body.wake()},localCOM_validate:function(){this.wrap_localCOM.zpp_inner.x=this.localCOMx,this.wrap_localCOM.zpp_inner.y=this.localCOMy},localCOM_invalidate:function(e){this.localCOMx=e.x,this.localCOMy=e.y,this.invalidate_localCOM(),null!=this.body&&this.body.wake()},setupLocalCOM:function(){this.wrap_localCOM=d_.get(this.localCOMx,this.localCOMy),this.wrap_localCOM.zpp_inner._inuse=!0,this.wrap_localCOM.zpp_inner._validate=yc(this,this.localCOM_validate),this.wrap_localCOM.zpp_inner._invalidate=yc(this,this.localCOM_invalidate)},__validate_aabb:function(){this.validate_worldCOM();var e=this.radius,t=this.radius;this.aabb.minx=this.worldCOMx-e,this.aabb.miny=this.worldCOMy-t,this.aabb.maxx=this.worldCOMx+e,this.aabb.maxy=this.worldCOMy+t},_force_validate_aabb:function(){this.worldCOMx=this.body.posx+(this.body.axisy*this.localCOMx-this.body.axisx*this.localCOMy),this.worldCOMy=this.body.posy+(this.localCOMx*this.body.axisx+this.localCOMy*this.body.axisy),this.aabb.minx=this.worldCOMx-this.radius,this.aabb.miny=this.worldCOMy-this.radius,this.aabb.maxx=this.worldCOMx+this.radius,this.aabb.maxy=this.worldCOMy+this.radius},__validate_sweepRadius:function(){this.sweepCoef=Math.sqrt(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy),this.sweepRadius=this.sweepCoef+this.radius},__validate_area_inertia:function(){var e=this.radius*this.radius;this.area=e*Math.PI,this.inertia=.5*e+(this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy)},__validate_angDrag:function(){var e=this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy,t=this.radius*this.radius,n=this.material.dynamicFriction*lo.fluidAngularDragFriction;this.angDrag=(e+2*t)*n+.5*lo.fluidAngularDrag*(1+lo.fluidVacuumDrag)*e,this.angDrag/=2*(e+.5*t)},__scale:function(e,t){var n=((e<0?-e:e)+(t<0?-t:t))/2;this.radius*=n<0?-n:n,this.invalidate_radius(),0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy&&(this.localCOMx*=e,this.localCOMy*=t,this.invalidate_localCOM())},__translate:function(e,t){this.localCOMx+=1*e,this.localCOMy+=1*t,this.invalidate_localCOM()},__rotate:function(e,t){var n,i;0<this.localCOMx*this.localCOMx+this.localCOMy*this.localCOMy&&(n=t*this.localCOMx-e*this.localCOMy,i=this.localCOMx*e+this.localCOMy*t,this.localCOMx=n,this.localCOMy=i,this.invalidate_localCOM())},__transform:function(e){var t=e.get_a()*e.get_d()-e.get_b()*e.get_c();t<0&&(t=-t),this.radius*=Math.sqrt(t);var n=e.get_a()*this.localCOMx+e.get_b()*this.localCOMy+e.get_tx();this.localCOMy=e.get_c()*this.localCOMx+e.get_d()*this.localCOMy+e.get_ty(),this.localCOMx=n,this.invalidate_radius(),this.invalidate_localCOM()},__copy:function(){var e=new E_(this.radius).zpp_inner_zn;return e.localCOMx=this.localCOMx,e.localCOMy=this.localCOMy,e.zip_localCOM=!1,e},__class__:vu});var bu=function(){this.tp1=0,this.tp0=0,this.gp1=null,this.lp1=null,this.gp0=null,this.lp0=null,this.gprojection=0,this.lprojection=0,this.length=0,this.wrap_gnorm=null,this.gnormy=0,this.gnormx=0,this.wrap_lnorm=null,this.lnormy=0,this.lnormx=0,this.outer=null,this.polygon=null,this.next=null,this.lnormx=0,this.lnormy=0,this.gnormx=0,this.gnormy=0,this.length=0,this.lprojection=0,this.gprojection=0};(n["zpp_nape.shape.ZPP_Edge"]=bu).__name__=["zpp_nape","shape","ZPP_Edge"],bu.prototype={next:null,free:function(){this.polygon=null},alloc:function(){},polygon:null,outer:null,wrapper:function(){return null==this.outer&&(bu.internal=!0,this.outer=new O_,bu.internal=!1,this.outer.zpp_inner=this),this.outer},lnormx:null,lnormy:null,wrap_lnorm:null,gnormx:null,gnormy:null,wrap_gnorm:null,length:null,lprojection:null,gprojection:null,lp0:null,gp0:null,lp1:null,gp1:null,tp0:null,tp1:null,lnorm_validate:function(){this.polygon.validate_laxi(),this.wrap_lnorm.zpp_inner.x=this.lnormx,this.wrap_lnorm.zpp_inner.y=this.lnormy},gnorm_validate:function(){this.polygon.validate_gaxi(),this.wrap_gnorm.zpp_inner.x=this.gnormx,this.wrap_gnorm.zpp_inner.y=this.gnormy},getlnorm:function(){this.wrap_lnorm=d_.get(this.lnormx,this.lnormy),this.wrap_lnorm.zpp_inner._immutable=!0,this.wrap_lnorm.zpp_inner._validate=yc(this,this.lnorm_validate)},getgnorm:function(){this.wrap_gnorm=d_.get(this.gnormx,this.gnormy),this.wrap_gnorm.zpp_inner._immutable=!0,this.wrap_gnorm.zpp_inner._validate=yc(this,this.gnorm_validate)},__class__:bu};var yu=function(){this.zip_sanitation=!1,this.zip_valid=!1,this.zip_gaxi=!1,this.zip_gverts=!1,this.zip_laxi=!1,this.zip_lverts=!1,this.reverse_flag=!1,this.edgeCnt=0,this.wrap_edges=null,this.edges=null,this.wrap_gverts=null,this.gverts=null,this.wrap_lverts=null,this.lverts=null,this.outer_zn=null,gu.call(this,1),(this.polygon=this).lverts=new pu,this.gverts=new pu,this.edges=new $u,this.edgeCnt=0};(n["zpp_nape.shape.ZPP_Polygon"]=yu).__name__=["zpp_nape","shape","ZPP_Polygon"],yu.__super__=gu,yu.prototype=r(gu.prototype,{outer_zn:null,lverts:null,wrap_lverts:null,gverts:null,wrap_gverts:null,edges:null,wrap_edges:null,edgeCnt:null,reverse_flag:null,__clear:function(){},lverts_pa_invalidate:function(e){this.invalidate_lverts()},gverts_pa_validate:function(){this.validate_gverts()},lverts_post_adder:function(e){e.zpp_inner._invalidate=yc(this,this.lverts_pa_invalidate);for(var t=null,n=null,i=this.lverts.begin();null!=i&&i.elem()!=e.zpp_inner;)t=null==t?this.gverts.begin():t.next,n=null==n?this.edges.begin():n.next,i=i.next;var r,a,s,l=pu.get(0,0,!0);this.gverts.insert(t,l),null!=this.lverts.begin().next&&(null==this.lverts.begin().next.next?(null==bu.zpp_pool?r=new bu:(r=bu.zpp_pool,bu.zpp_pool=r.next,r.next=null),r.alloc(),(r.polygon=this).edges.add(r),null==bu.zpp_pool?a=new bu:(a=bu.zpp_pool,bu.zpp_pool=a.next,a.next=null),a.alloc(),(a.polygon=this).edges.add(a),this.edgeCnt+=2):(null==bu.zpp_pool?s=new bu:(s=bu.zpp_pool,bu.zpp_pool=s.next,s.next=null),s.alloc(),(s.polygon=this).edges.insert(n,s),this.edgeCnt++)),l._validate=yc(this,this.gverts_pa_validate)},lverts_subber:function(e){this.cleanup_lvert(e.zpp_inner)},lverts_invalidate:function(e){this.invalidate_lverts()},lverts_validate:function(){this.validate_lverts()},gverts_validate:function(){this.validate_gverts()},edges_validate:function(){this.validate_lverts()},getlverts:function(){this.wrap_lverts=Wh.get(this.lverts),this.wrap_lverts.zpp_inner.post_adder=yc(this,this.lverts_post_adder),this.wrap_lverts.zpp_inner.subber=yc(this,this.lverts_subber),this.wrap_lverts.zpp_inner._invalidate=yc(this,this.lverts_invalidate),this.wrap_lverts.zpp_inner._validate=yc(this,this.lverts_validate),this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag},getgverts:function(){this.wrap_gverts=Wh.get(this.gverts,!0),this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag,this.wrap_gverts.zpp_inner._validate=yc(this,this.gverts_validate)},getedges:function(){this.wrap_edges=ic.get(this.edges,!0),this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag,this.wrap_edges.zpp_inner._validate=yc(this,this.edges_validate)},zip_lverts:null,invalidate_lverts:function(){this.invalidate_laxi(),this.invalidate_area_inertia(),this.invalidate_angDrag(),this.invalidate_localCOM(),this.invalidate_gverts(),this.zip_lverts=!0,this.zip_valid=!0,this.zip_sanitation=!0,null!=this.body&&this.body.wake()},zip_laxi:null,invalidate_laxi:function(){this.invalidate_gaxi(),this.invalidate_sweepRadius(),this.zip_laxi=!0},zip_gverts:null,invalidate_gverts:function(){this.invalidate_aabb(),this.zip_gverts=!0},zip_gaxi:null,invalidate_gaxi:function(){this.zip_gaxi=!0},zip_valid:null,validation:null,valid:function(){if(this.zip_valid){if(this.zip_valid=!1,this.splice_collinear(),this.lverts.size()<3)return this.validation=Z_.get_DEGENERATE();if(this.validate_lverts(),this.validate_area_inertia(),this.area<lo.epsilon)return this.validation=Z_.get_DEGENERATE();var e=!1,t=!1,n=!0,i=this.lverts.begin(),r=i.elem(),a=(i=i.next).elem();for(i=i.next;null!=i;){var s,l,o,_=i.elem();s=_.x-a.x,l=_.y-a.y,o=a.x-r.x;var p=(a.y-r.y)*s-o*l;if(lo.epsilon<p?t=!0:p<-lo.epsilon&&(e=!0),t&&e){n=!1;break}r=a,a=_,i=i.next}if(n){for(var u=(i=this.lverts.begin()).elem();;){var h,c,d;h=u.x-a.x,c=u.y-a.y,d=a.x-r.x;var m=(a.y-r.y)*h-d*c;if(lo.epsilon<m?t=!0:m<-lo.epsilon&&(e=!0),t&&e){n=!1;break}break}if(n){r=a,a=u;for(var f=(i=i.next).elem();;){var g,v,b;g=f.x-a.x,v=f.y-a.y,b=a.x-r.x;var y=(a.y-r.y)*g-b*v;if(lo.epsilon<y?t=!0:y<-lo.epsilon&&(e=!0),t&&e)break;break}}}if(t&&e)return this.validation=Z_.get_CONCAVE();var x=!0,z=!0,w=this.lverts.begin(),k=w.elem();for(w=w.next;null!=w;){var S=w.elem();if(!x){z=!1;break}var C=!0,N=this.lverts.begin(),P=N.elem();for(N=N.next;null!=N;){var M=N.elem();if(k!=P&&k!=M&&S!=P&&S!=M){var I,A,T,D;I=k.x-P.x,A=k.y-P.y,T=S.x-k.x;var E,O,B=(D=S.y-k.y)*(E=M.x-P.x)-T*(O=M.y-P.y);if(lo.epsilon<B*B){var L=(O*I-E*A)*(B=1/B);if(lo.epsilon<L&&L<1-lo.epsilon){var j=(D*I-T*A)*B;if(lo.epsilon<j&&j<1-lo.epsilon){C=x=!1;break}}}P=M,N=N.next}else P=M,N=N.next}if(C)for(;;){var F,R,G,Z,U=this.lverts.front();if(k==P||k==U||S==P||S==U)break;F=k.x-P.x,R=k.y-P.y,G=S.x-k.x;var V,q,W=(Z=S.y-k.y)*(V=U.x-P.x)-G*(q=U.y-P.y);if(lo.epsilon<W*W){var X=(q*F-V*R)*(W=1/W);if(lo.epsilon<X&&X<1-lo.epsilon){var H=(Z*F-G*R)*W;if(lo.epsilon<H&&H<1-lo.epsilon){x=!1;break}}}break}k=S,w=w.next}if(z)for(;;){var Y=this.lverts.front();if(!x)break;var J=!0,K=this.lverts.begin(),Q=K.elem();for(K=K.next;null!=K;){var $=K.elem();if(k!=Q&&k!=$&&Y!=Q&&Y!=$){var ee,te,ne,ie;ee=k.x-Q.x,te=k.y-Q.y,ne=Y.x-k.x;var re,ae,se=(ie=Y.y-k.y)*(re=$.x-Q.x)-ne*(ae=$.y-Q.y);if(lo.epsilon<se*se){var le=(ae*ee-re*te)*(se=1/se);if(lo.epsilon<le&&le<1-lo.epsilon){var oe=(ie*ee-ne*te)*se;if(lo.epsilon<oe&&oe<1-lo.epsilon){J=x=!1;break}}}Q=$,K=K.next}else Q=$,K=K.next}if(J)for(;;){var _e,pe,ue,he,ce=this.lverts.front();if(k==Q||k==ce||Y==Q||Y==ce)break;_e=k.x-Q.x,pe=k.y-Q.y,ue=Y.x-k.x;var de,me,fe=(he=Y.y-k.y)*(de=ce.x-Q.x)-ue*(me=ce.y-Q.y);if(lo.epsilon<fe*fe){var ge=(me*_e-de*pe)*(fe=1/fe);if(lo.epsilon<ge&&ge<1-lo.epsilon){var ve=(he*_e-ue*pe)*fe;if(lo.epsilon<ve&&ve<1-lo.epsilon){x=!1;break}}}break}break}return this.validation=x?Z_.get_VALID():Z_.get_SELF_INTERSECTING()}return this.validation},validate_lverts:function(){this.zip_lverts&&(this.zip_lverts=!1,2<this.lverts.size()&&(this.validate_area_inertia(),this.area<0&&(this.reverse_vertices(),this.area=-this.area)))},cleanup_lvert:function(e){for(var t=null,n=null,i=this.lverts.begin();null!=i&&i.elem()!=e;)t=null==t?this.gverts.begin():t.next,n=null==n?this.edges.begin():n.next,i=i.next;var r=null==t?this.gverts.front():t.next.elem();this.gverts.erase(t);var a=r;if(a.free(),a.next=pu.zpp_pool,pu.zpp_pool=a,2==this.edgeCnt){var s=this.edges.pop_unsafe(),l=s;l.free(),l.next=bu.zpp_pool,bu.zpp_pool=l;var o=s=this.edges.pop_unsafe();o.free(),o.next=bu.zpp_pool,bu.zpp_pool=o,this.edgeCnt=0}else if(0!=this.edgeCnt){var _=null==n?this.edges.front():n.next.elem();this.edges.erase(n);var p=_;p.free(),p.next=bu.zpp_pool,bu.zpp_pool=p,this.edgeCnt--}},zip_sanitation:null,splice_collinear:function(){this.zip_sanitation&&(this.zip_sanitation=!1,this.splice_collinear_real())},splice_collinear_real:function(){if(null!=this.lverts.begin()&&null!=this.lverts.begin().next&&null!=this.lverts.begin().next.next){for(var e=null,t=this.lverts.begin();null!=t;){var n=null==t.next?this.lverts.begin():t.next,i=t.elem(),r=n.elem();t=hu.vec_dsq(i.x,i.y,r.x,r.y)<lo.epsilon*lo.epsilon?(this.cleanup_lvert(t.elem()),this.lverts.erase(e)):(e=t).next}if(!this.lverts.empty())for(var a;;){a=!1;for(var s=this.lverts.begin();null!=s;){var l,o,_,p=null==s.next?this.lverts.begin():s.next,u=null==p.next?this.lverts.begin():p.next,h=s.elem(),c=p.elem(),d=u.elem();l=c.x-h.x,o=c.y-h.y,_=d.x-c.x;var m=(d.y-c.y)*l-_*o;lo.epsilon*lo.epsilon<=m*m||(this.cleanup_lvert(p.elem()),this.lverts.erase(null==s.next?null:s),a=!0),s=s.next}if(!a)break}}},reverse_vertices:function(){this.lverts.reverse(),this.gverts.reverse(),this.edges.reverse();var e=this.edges.iterator_at(this.edgeCnt-1),t=this.edges.pop_unsafe();this.edges.insert(e,t),this.reverse_flag=!this.reverse_flag,null!=this.wrap_lverts&&(this.wrap_lverts.zpp_inner.reverse_flag=this.reverse_flag),null!=this.wrap_gverts&&(this.wrap_gverts.zpp_inner.reverse_flag=this.reverse_flag),null!=this.wrap_edges&&(this.wrap_edges.zpp_inner.reverse_flag=this.reverse_flag)},validate_laxi:function(){if(this.zip_laxi){this.zip_laxi=!1,this.validate_lverts();var e=this.edges.begin(),t=this.lverts.begin(),n=t.elem();for(t=t.next;null!=t;){var i=t.elem(),r=e.elem();e=e.next,r.lp0=n,r.lp1=i;var a=0,s=0;a=n.x-i.x,s=n.y-i.y;var l=Math.sqrt(a*a+s*s),o=1/(r.length=l),_=a*=o;a=-(s*=o),s=_,r.lprojection=a*n.x+s*n.y,r.lnormx=a,r.lnormy=s,null!=r.wrap_lnorm&&(r.wrap_lnorm.zpp_inner.x=a,r.wrap_lnorm.zpp_inner.y=s),n=i,t=t.next}var p=this.lverts.front(),u=e.elem();e=e.next,u.lp0=n,u.lp1=p;var h=0,c=0;h=n.x-p.x,c=n.y-p.y;var d=Math.sqrt(h*h+c*c),m=1/(u.length=d),f=h*=m;h=-(c*=m),c=f,u.lprojection=h*n.x+c*n.y,u.lnormx=h,u.lnormy=c,null!=u.wrap_lnorm&&(u.wrap_lnorm.zpp_inner.x=h,u.wrap_lnorm.zpp_inner.y=c)}},validate_gverts:function(){if(this.zip_gverts&&null!=this.body){this.zip_gverts=!1,this.validate_lverts(),this.body.validate_axis();for(var e=this.lverts.begin(),t=this.gverts.begin();null!=t;){var n=t.elem(),i=e.elem();e=e.next,n.x=this.body.posx+(this.body.axisy*i.x-this.body.axisx*i.y),n.y=this.body.posy+(i.x*this.body.axisx+i.y*this.body.axisy),t=t.next}}},validate_gaxi:function(){if(this.zip_gaxi&&null!=this.body){this.zip_gaxi=!1,this.validate_laxi(),this.body.validate_axis(),this.validate_gverts();var e=this.edges.begin(),t=this.gverts.begin(),n=t.elem();for(t=t.next;null!=t;){var i=t.elem(),r=e.elem();e=e.next,r.gp0=n,r.gp1=i,r.gnormx=this.body.axisy*r.lnormx-this.body.axisx*r.lnormy,r.gnormy=r.lnormx*this.body.axisx+r.lnormy*this.body.axisy,r.gprojection=this.body.posx*r.gnormx+this.body.posy*r.gnormy+r.lprojection,null!=r.wrap_gnorm&&(r.wrap_gnorm.zpp_inner.x=r.gnormx,r.wrap_gnorm.zpp_inner.y=r.gnormy),r.tp0=r.gp0.y*r.gnormx-r.gp0.x*r.gnormy,r.tp1=r.gp1.y*r.gnormx-r.gp1.x*r.gnormy,n=i,t=t.next}var a=this.gverts.front(),s=e.elem();e=e.next,s.gp0=n,s.gp1=a,s.gnormx=this.body.axisy*s.lnormx-this.body.axisx*s.lnormy,s.gnormy=s.lnormx*this.body.axisx+s.lnormy*this.body.axisy,s.gprojection=this.body.posx*s.gnormx+this.body.posy*s.gnormy+s.lprojection,null!=s.wrap_gnorm&&(s.wrap_gnorm.zpp_inner.x=s.gnormx,s.wrap_gnorm.zpp_inner.y=s.gnormy),s.tp0=s.gp0.y*s.gnormx-s.gp0.x*s.gnormy,s.tp1=s.gp1.y*s.gnormx-s.gp1.x*s.gnormy}},__validate_aabb:function(){this.validate_gverts();var e=this.gverts.front();this.aabb.minx=e.x,this.aabb.miny=e.y,this.aabb.maxx=e.x,this.aabb.maxy=e.y;for(var t=this.gverts.begin().next;null!=t;){var n=t.elem();n.x<this.aabb.minx&&(this.aabb.minx=n.x),n.x>this.aabb.maxx&&(this.aabb.maxx=n.x),n.y<this.aabb.miny&&(this.aabb.miny=n.y),n.y>this.aabb.maxy&&(this.aabb.maxy=n.y),t=t.next}},_force_validate_aabb:function(){var e=this.lverts.begin(),t=this.gverts.front(),n=e.elem();e=e.next,t.x=this.body.posx+(this.body.axisy*n.x-this.body.axisx*n.y),t.y=this.body.posy+(n.x*this.body.axisx+n.y*this.body.axisy),this.aabb.minx=t.x,this.aabb.miny=t.y,this.aabb.maxx=t.x,this.aabb.maxy=t.y;for(var i=this.gverts.begin().next;null!=i;){var r=i.elem(),a=e.elem();e=e.next,r.x=this.body.posx+(this.body.axisy*a.x-this.body.axisx*a.y),r.y=this.body.posy+(a.x*this.body.axisx+a.y*this.body.axisy),r.x<this.aabb.minx&&(this.aabb.minx=r.x),r.x>this.aabb.maxx&&(this.aabb.maxx=r.x),r.y<this.aabb.miny&&(this.aabb.miny=r.y),r.y>this.aabb.maxy&&(this.aabb.maxy=r.y),i=i.next}},__validate_sweepRadius:function(){var e=0,t=0;this.validate_laxi();for(var n=this.lverts.begin();null!=n;){var i=n.elem(),r=i.x*i.x+i.y*i.y;e<r&&(e=r),n=n.next}for(var a=this.edges.begin();null!=a;){var s=a.elem();if(s.lprojection<t&&(t=s.lprojection)<0)break;a=a.next}t<0&&(t=0),this.sweepRadius=Math.sqrt(e),this.sweepCoef=this.sweepRadius-t},__validate_area_inertia:function(){if(null==this.lverts.begin()||null==this.lverts.begin().next||null==this.lverts.begin().next.next)this.area=0,this.inertia=0;else{var e=this.area=0,t=0,n=this.lverts.begin(),i=n.elem(),r=(n=n.next).elem();for(n=n.next;null!=n;){var a=n.elem(),s=r.y*i.x-r.x*i.y;e+=s*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),t+=s,this.area+=r.x*(a.y-i.y),i=r,r=a,n=n.next}var l=(n=this.lverts.begin()).elem(),o=r.y*i.x-r.x*i.y;e+=o*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),t+=o,this.area+=r.x*(l.y-i.y),i=r,r=l;var _=(n=n.next).elem(),p=r.y*i.x-r.x*i.y;e+=p*(r.x*r.x+r.y*r.y+(r.x*i.x+r.y*i.y)+(i.x*i.x+i.y*i.y)),t+=p,this.area+=r.x*(_.y-i.y),this.inertia=e/(6*t),this.area*=.5,this.area<0&&(this.area=-this.area,this.reverse_vertices())}},__validate_angDrag:function(){this.validate_area_inertia(),this.validate_laxi();for(var e=0,t=this.edges.begin(),n=0,i=this.lverts.begin(),r=i.elem(),a=i.next;null!=a;){var s,l,o=a.elem(),_=t.elem();t=t.next,n+=_.length,s=o.x-r.x,l=o.y-r.y,e+=_.length*lo.fluidAngularDragFriction*this.material.dynamicFriction*_.lprojection*_.lprojection;var p=-(r.y*_.lnormx-r.x*_.lnormy)/(l*_.lnormx-s*_.lnormy);if(0<p){var u=1<p?1:p,h=0,c=0;h=r.x,c=r.y,h+=s*u,c+=l*u;var d=_.lnormy*r.x-_.lnormx*r.y,m=_.lnormy*h-_.lnormx*c;e+=(m*m*m-d*d*d)/(3*(m-d))*u*_.length*lo.fluidAngularDrag}if(p<1){var f=p<0?0:p,g=0,v=0;g=r.x,v=r.y,g+=s*f,v+=l*f;var b=_.lnormy*g-_.lnormx*v,y=_.lnormy*o.x-_.lnormx*o.y;e+=(y*y*y-b*b*b)/(3*(y-b))*lo.fluidVacuumDrag*(1-f)*_.length*lo.fluidAngularDrag}r=o,a=(i=a).next}for(;;){var x,z,w=(a=this.lverts.begin()).elem(),k=t.elem();t=t.next,n+=k.length,x=w.x-r.x,z=w.y-r.y,e+=k.length*lo.fluidAngularDragFriction*this.material.dynamicFriction*k.lprojection*k.lprojection;var S=-(r.y*k.lnormx-r.x*k.lnormy)/(z*k.lnormx-x*k.lnormy);if(0<S){var C=1<S?1:S,N=0,P=0;N=r.x,P=r.y,N+=x*C,P+=z*C;var M=k.lnormy*r.x-k.lnormx*r.y,I=k.lnormy*N-k.lnormx*P;e+=(I*I*I-M*M*M)/(3*(I-M))*C*k.length*lo.fluidAngularDrag}if(S<1){var A=S<0?0:S,T=0,D=0;T=r.x,D=r.y,T+=x*A,D+=z*A;var E=k.lnormy*T-k.lnormx*D,O=k.lnormy*w.x-k.lnormx*w.y;e+=(O*O*O-E*E*E)/(3*(O-E))*lo.fluidVacuumDrag*(1-A)*k.length*lo.fluidAngularDrag}break}this.angDrag=e/(this.inertia*n)},__validate_localCOM:function(){if(null==this.lverts.begin().next)this.localCOMx=this.lverts.front().x,this.localCOMy=this.lverts.front().y;else if(null==this.lverts.begin().next.next)this.localCOMx=this.lverts.front().x,this.localCOMy=this.lverts.front().y,this.localCOMx+=1*this.lverts.begin().next.elem().x,this.localCOMy+=1*this.lverts.begin().next.elem().y,this.localCOMx*=.5,this.localCOMy*=.5;else{this.localCOMx=0;var e=this.localCOMy=0,t=this.lverts.begin(),n=t.elem(),i=(t=t.next).elem();for(t=t.next;null!=t;){var r=t.elem();e+=i.x*(r.y-n.y);var a=r.y*i.x-r.x*i.y;this.localCOMx+=(i.x+r.x)*a,this.localCOMy+=(i.y+r.y)*a,n=i,i=r,t=t.next}var s=(t=this.lverts.begin()).elem();e+=i.x*(s.y-n.y);var l=s.y*i.x-s.x*i.y;this.localCOMx+=(i.x+s.x)*l,this.localCOMy+=(i.y+s.y)*l,n=i,i=s;var o=(t=t.next).elem();e+=i.x*(o.y-n.y);var _=o.y*i.x-o.x*i.y;this.localCOMx+=(i.x+o.x)*_,this.localCOMy+=(i.y+o.y)*_;var p=e=1/(3*e);this.localCOMx*=p,this.localCOMy*=p}},localCOM_validate:function(){this.validate_localCOM()},localCOM_invalidate:function(e){var t,n;this.validate_localCOM(),t=e.x-this.localCOMx,n=e.y-this.localCOMy;for(var i=this.lverts.begin();null!=i;){var r=i.elem();r.x+=1*t,r.y+=1*n,i=i.next}this.invalidate_lverts()},setupLocalCOM:function(){this.wrap_localCOM=d_.get(this.localCOMx,this.localCOMy),this.wrap_localCOM.zpp_inner._inuse=!0,this.wrap_localCOM.zpp_inner._validate=yc(this,this.localCOM_validate),this.wrap_localCOM.zpp_inner._invalidate=yc(this,this.localCOM_invalidate)},__translate:function(e,t){for(var n=this.lverts.begin();null!=n;){var i=n.elem();i.x+=1*e,i.y+=1*t,n=n.next}this.invalidate_lverts()},__scale:function(e,t){for(var n=this.lverts.begin();null!=n;){var i=n.elem();i.x*=e,i.y*=t,n=n.next}this.invalidate_lverts()},__rotate:function(e,t){for(var n=this.lverts.begin();null!=n;){var i,r,a=n.elem();i=t*a.x-e*a.y,r=a.x*e+a.y*t,a.x=i,a.y=r,n=n.next}this.invalidate_lverts()},__transform:function(e){for(var t=this.lverts.begin();null!=t;){var n=t.elem(),i=e.get_a()*n.x+e.get_b()*n.y+e.get_tx();n.y=e.get_c()*n.x+e.get_d()*n.y+e.get_ty(),n.x=i,t=t.next}this.invalidate_lverts()},__copy:function(){return new j_(this.outer_zn.get_localVerts()).zpp_inner_zn},__class__:yu});var xu=function(){this.circShape=null,this.matrix=null,this.aabbShape=null,this.dynab=null,this.sweep=null,this.is_sweep=!1,this.space=null};(n["zpp_nape.space.ZPP_Broadphase"]=xu).__name__=["zpp_nape","space","ZPP_Broadphase"],xu.prototype={space:null,is_sweep:null,sweep:null,dynab:null,insert:function(e){this.is_sweep?this.sweep.__insert(e):this.dynab.__insert(e)},remove:function(e){this.is_sweep?this.sweep.__remove(e):this.dynab.__remove(e)},sync:function(e){this.is_sweep?this.sweep.__sync(e):this.dynab.__sync(e)},broadphase:function(e,t){},clear:function(){},shapesUnderPoint:function(e,t,n,i){return null},bodiesUnderPoint:function(e,t,n,i){return null},aabbShape:null,matrix:null,updateAABBShape:function(e){if(null==this.aabbShape)new y_(w_.get_STATIC()).get_shapes().add(this.aabbShape=new j_(j_.rect(e.minx,e.miny,e.width(),e.height())));else{var t=this.aabbShape.zpp_inner.aabb,n=e.width()/t.width(),i=e.height()/t.height();null==this.matrix&&(this.matrix=new o_),this.matrix.set_a(n),this.matrix.set_b(this.matrix.set_c(0)),this.matrix.set_d(i),this.matrix.set_tx(e.minx-n*t.minx),this.matrix.set_ty(e.miny-i*t.miny),this.aabbShape.transform(this.matrix)}this.aabbShape.zpp_inner.validate_aabb(),this.aabbShape.zpp_inner.polygon.validate_gaxi()},shapesInAABB:function(e,t,n,i,r){return null},bodiesInAABB:function(e,t,n,i,r){return null},circShape:null,updateCircShape:function(e,t,n){if(null==this.circShape)new y_(w_.get_STATIC()).get_shapes().add(this.circShape=new E_(n,d_.get(e,t)));else{var i=this.circShape.zpp_inner.circle,r=n/i.radius;null==this.matrix&&(this.matrix=new o_),this.matrix.set_a(this.matrix.set_d(r)),this.matrix.set_b(this.matrix.set_c(0)),this.matrix.set_tx(e-r*i.localCOMx),this.matrix.set_ty(t-r*i.localCOMy),this.circShape.transform(this.matrix)}this.circShape.zpp_inner.validate_aabb()},shapesInCircle:function(e,t,n,i,r,a){return null},bodiesInCircle:function(e,t,n,i,r,a){return null},validateShape:function(e){e.isPolygon()&&e.polygon.validate_gaxi(),e.validate_aabb(),e.validate_worldCOM()},shapesInShape:function(e,t,n,i){return null},bodiesInShape:function(e,t,n,i){return null},rayCast:function(e,t,n){return null},rayMultiCast:function(e,t,n,i){return null},__class__:xu};var zu=function(){this.first_sync=!1,this.synced=!1,this.snext=null,this.moved=!1,this.mnext=null,this.next=null,this.rayt=0,this.height=0,this.child2=null,this.child1=null,this.parent=null,this.dyn=!1,this.shape=null,this.aabb=null,this.height=-1};(n["zpp_nape.space.ZPP_AABBNode"]=zu).__name__=["zpp_nape","space","ZPP_AABBNode"],zu.prototype={aabb:null,shape:null,dyn:null,parent:null,child1:null,child2:null,height:null,rayt:null,next:null,alloc:function(){null==Ap.zpp_pool?this.aabb=new Ap:(this.aabb=Ap.zpp_pool,Ap.zpp_pool=this.aabb.next,this.aabb.next=null),this.aabb.alloc(),this.moved=!1,this.synced=!1,this.first_sync=!1},free:function(){this.height=-1;var e=this.aabb;e.free(),e.next=Ap.zpp_pool,Ap.zpp_pool=e,this.child1=this.child2=this.parent=null,this.next=null,this.snext=null,this.mnext=null},mnext:null,moved:null,snext:null,synced:null,first_sync:null,isLeaf:function(){return null==this.child1},__class__:zu};var wu=function(){this.next=null,this.arb=null,this.di=0,this.id=0,this.sleeping=!1,this.first=!1,this.n2=null,this.n1=null};(n["zpp_nape.space.ZPP_AABBPair"]=wu).__name__=["zpp_nape","space","ZPP_AABBPair"],wu.prototype={n1:null,n2:null,first:null,sleeping:null,id:null,di:null,arb:null,next:null,alloc:function(){},free:function(){this.n1=this.n2=null,this.sleeping=!1},__class__:wu};var ku=function(){this.root=null};(n["zpp_nape.space.ZPP_AABBTree"]=ku).__name__=["zpp_nape","space","ZPP_AABBTree"],ku.prototype={root:null,clear:function(){if(null!=this.root){var e=null;for(this.root.next=e,e=this.root;null!=e;){var t=e;e=t.next,t.next=null;var n=t;n.isLeaf()?(n.shape.node=null,n.shape.removedFromSpace(),n.shape=null):(null!=n.child1&&(n.child1.next=e,e=n.child1),null!=n.child2&&(n.child2.next=e,e=n.child2));var i=n;i.free(),i.next=zu.zpp_pool,zu.zpp_pool=i}this.root=null}},insertLeaf:function(e){this.inlined_insertLeaf(e)},inlined_insertLeaf:function(e){if(null==this.root)this.root=e,this.root.parent=null;else{for(var t=e.aabb,n=this.root;!n.isLeaf();){var i=n.child1,r=n.child2,a=n.aabb.perimeter();ku.tmpaabb.setCombine(n.aabb,t);var s,l,o=ku.tmpaabb.perimeter(),_=2*o,p=2*(o-a);if(ku.tmpaabb.setCombine(t,i.aabb),i.isLeaf())s=ku.tmpaabb.perimeter()+p;else{var u=i.aabb.perimeter();s=ku.tmpaabb.perimeter()-u+p}if(ku.tmpaabb.setCombine(t,r.aabb),r.isLeaf())l=ku.tmpaabb.perimeter()+p;else{var h=r.aabb.perimeter();l=ku.tmpaabb.perimeter()-h+p}if(_<s&&_<l)break;n=s<l?i:r}var c,d=n,m=d.parent;for(null==zu.zpp_pool?c=new zu:(c=zu.zpp_pool,zu.zpp_pool=c.next,c.next=null),c.alloc(),c.parent=m,c.aabb.setCombine(t,d.aabb),c.height=d.height+1,null!=m?(m.child1==d?m.child1=c:m.child2=c,c.child1=d,c.child2=e,d.parent=c,e.parent=c):(c.child1=d,c.child2=e,d.parent=c,e.parent=c,this.root=c),n=e.parent;null!=n;){var f=(n=this.balance(n)).child1,g=n.child2,v=f.height,b=g.height;n.height=1+(b<v?v:b),n.aabb.setCombine(f.aabb,g.aabb),n=n.parent}}},removeLeaf:function(e){this.inlined_removeLeaf(e)},inlined_removeLeaf:function(e){if(e!=this.root){var t=e.parent,n=t.parent,i=t.child1==e?t.child2:t.child1;if(null!=n){n.child1==t?n.child1=i:n.child2=i,i.parent=n;var r=t;r.free(),r.next=zu.zpp_pool,zu.zpp_pool=r;for(var a=n;null!=a;){var s=(a=this.balance(a)).child1,l=a.child2;a.aabb.setCombine(s.aabb,l.aabb);var o=s.height,_=l.height;a.height=1+(_<o?o:_),a=a.parent}}else{(this.root=i).parent=null;var p=t;p.free(),p.next=zu.zpp_pool,zu.zpp_pool=p}}else this.root=null},balance:function(e){if(e.isLeaf()||e.height<2)return e;var t=e.child1,n=e.child2,i=n.height-t.height;if(1<i){var r=n.child1,a=n.child2;if(n.child1=e,n.parent=e.parent,null!=(e.parent=n).parent?n.parent.child1==e?n.parent.child1=n:n.parent.child2=n:this.root=n,r.height>a.height){n.child2=r,((e.child2=a).parent=e).aabb.setCombine(t.aabb,a.aabb),n.aabb.setCombine(e.aabb,r.aabb);var s=t.height,l=a.height;e.height=1+(l<s?s:l);var o=e.height,_=r.height;n.height=1+(_<o?o:_)}else{n.child2=a,((e.child2=r).parent=e).aabb.setCombine(t.aabb,r.aabb),n.aabb.setCombine(e.aabb,a.aabb);var p=t.height,u=r.height;e.height=1+(u<p?p:u);var h=e.height,c=a.height;n.height=1+(c<h?h:c)}return n}if(i<-1){var d=t.child1,m=t.child2;if(t.child1=e,t.parent=e.parent,null!=(e.parent=t).parent?t.parent.child1==e?t.parent.child1=t:t.parent.child2=t:this.root=t,d.height>m.height){t.child2=d,((e.child1=m).parent=e).aabb.setCombine(n.aabb,m.aabb),t.aabb.setCombine(e.aabb,d.aabb);var f=n.height,g=m.height;e.height=1+(g<f?f:g);var v=e.height,b=d.height;t.height=1+(b<v?v:b)}else{t.child2=m,((e.child1=d).parent=e).aabb.setCombine(n.aabb,d.aabb),t.aabb.setCombine(e.aabb,m.aabb);var y=n.height,x=d.height;e.height=1+(x<y?y:x);var z=e.height,w=m.height;t.height=1+(w<z?z:w)}return t}return e},__class__:ku};var Su=function(e){this.openlist=null,this.failed=null,this.treeStack2=null,this.treeStack=null,this.moves=null,this.syncs=null,this.pairs=null,this.dtree=null,this.stree=null,xu.call(this),this.space=e,this.is_sweep=!1,(this.dynab=this).stree=new ku,this.dtree=new ku};(n["zpp_nape.space.ZPP_DynAABBPhase"]=Su).__name__=["zpp_nape","space","ZPP_DynAABBPhase"],Su.__super__=xu,Su.prototype=r(xu.prototype,{stree:null,dtree:null,pairs:null,syncs:null,moves:null,dyn:function(e){return!e.body.isStatic()&&!e.body.component.sleeping},__insert:function(e){var t;null==zu.zpp_pool?t=new zu:(t=zu.zpp_pool,zu.zpp_pool=t.next,t.next=null),t.alloc(),((t.shape=e).node=t).synced=!0,t.first_sync=!0,t.snext=this.syncs,this.syncs=t},__remove:function(e){var t=e.node;if(t.first_sync||(t.dyn?this.dtree.removeLeaf(t):this.stree.removeLeaf(t)),e.node=null,t.synced){for(var n=null,i=this.syncs;null!=i&&i!=t;)i=(n=i).snext;null==n?this.syncs=i.snext:n.snext=i.snext,i.snext=null,t.synced=!1}if(t.moved){for(var r=null,a=this.moves;null!=a&&a!=t;)a=(r=a).mnext;null==r?this.moves=a.mnext:r.mnext=a.mnext,a.mnext=null,t.moved=!1}for(var s=null,l=this.pairs;null!=l;){var o=l.next;if(l.n1!=t&&l.n2!=t)s=l,l=o;else{null==s?this.pairs=o:s.next=o,null!=l.arb&&(l.arb.pair=null),l.arb=null,l.n1.shape.pairs.remove(l),l.n2.shape.pairs.remove(l);var _=l;_.free(),_.next=wu.zpp_pool,wu.zpp_pool=_,l=o}}for(;!e.pairs.empty();){var p=e.pairs.pop_unsafe();p.n1==t?p.n2.shape.pairs.remove(p):p.n1.shape.pairs.remove(p),null!=p.arb&&(p.arb.pair=null),p.arb=null;var u=p;u.free(),u.next=wu.zpp_pool,wu.zpp_pool=u}var h=t;h.free(),h.next=zu.zpp_pool,zu.zpp_pool=h},__sync:function(e){var t=e.node;t.synced||(this.space.continuous||e.validate_aabb(),(t.dyn!=this.dyn(e)||!t.aabb.contains(e.aabb))&&(t.synced=!0,t.snext=this.syncs,this.syncs=t))},sync_broadphase:function(){if(this.space.validation(),null!=this.syncs)if(null==this.moves){for(var e=this.syncs;null!=e;){var t=e.shape;e.first_sync?e.first_sync=!1:(e.dyn?this.dtree:this.stree).inlined_removeLeaf(e);var n=e.aabb;this.space.continuous||t.validate_aabb(),n.setExpand(t.aabb,Su.FATTEN),((e.dyn=this.dyn(t))?this.dtree:this.stree).inlined_insertLeaf(e),e.synced=!1,e.moved=!0,e.mnext=e.snext,e.snext=null,e=e.mnext}var i=this.syncs;this.syncs=this.moves,this.moves=i}else for(;null!=this.syncs;){var r=this.syncs;this.syncs=r.snext,r.snext=null;var a=r,s=a.shape;a.first_sync?a.first_sync=!1:(a.dyn?this.dtree:this.stree).inlined_removeLeaf(a);var l=a.aabb;this.space.continuous||s.validate_aabb(),l.setExpand(s.aabb,Su.FATTEN),((a.dyn=this.dyn(s))?this.dtree:this.stree).inlined_insertLeaf(a),a.synced=!1,a.moved||(a.moved=!0,a.mnext=this.moves,this.moves=a)}},broadphase:function(e,t){for(var n=this.syncs;null!=n;){var i=n.shape;n.first_sync?n.first_sync=!1:(n.dyn?this.dtree:this.stree).inlined_removeLeaf(n);var r=n.aabb;e.continuous||i.validate_aabb(),r.setExpand(i.aabb,Su.FATTEN),((n.dyn=this.dyn(i))?this.dtree:this.stree).inlined_insertLeaf(n),n.synced=!1,n=n.snext}for(;null!=this.syncs;){var a=this.syncs;this.syncs=a.snext,a.snext=null;var s=a;if(!s.moved){s.moved=!1;var l=s.shape;if(!l.body.component.sleeping){var o=s.aabb,_=null;for(null!=this.dtree.root&&(this.dtree.root.next=_,_=this.dtree.root);null!=_;){var p=_;_=p.next,p.next=null;var u=p;if(u!=s)if(u.isLeaf()){var h=u.shape;if(!(h.body==l.body||h.body.isStatic()&&l.body.isStatic())&&o.intersect(u.aabb)){var c,d;d=l.id<h.id?(c=l.id,h.id):(c=h.id,l.id);for(var m=null,f=(l.pairs.length<h.pairs.length?l:h).pairs.begin();null!=f;){var g=f.elem();if(g.id==c&&g.di==d){m=g;break}f=f.next}if(null!=m){m.sleeping&&(m.sleeping=!1,m.next=this.pairs,(this.pairs=m).first=!0);continue}null==wu.zpp_pool?m=new wu:(m=wu.zpp_pool,wu.zpp_pool=m.next,m.next=null),m.alloc(),m.n1=s,m.n2=u,m.id=c,m.di=d,m.next=this.pairs,(this.pairs=m).first=!0,l.pairs.inlined_add(m),h.pairs.inlined_add(m)}}else o.intersect(u.aabb)&&(null!=u.child1&&(u.child1.next=_,_=u.child1),null!=u.child2&&(u.child2.next=_,_=u.child2))}for(null!=this.stree.root&&(this.stree.root.next=_,_=this.stree.root);null!=_;){var v=_;_=v.next,v.next=null;var b=v;if(b!=s)if(b.isLeaf()){var y=b.shape;if(!(y.body==l.body||y.body.isStatic()&&l.body.isStatic())&&o.intersect(b.aabb)){var x,z;z=l.id<y.id?(x=l.id,y.id):(x=y.id,l.id);for(var w=null,k=(l.pairs.length<y.pairs.length?l:y).pairs.begin();null!=k;){var S=k.elem();if(S.id==x&&S.di==z){w=S;break}k=k.next}if(null!=w){w.sleeping&&(w.sleeping=!1,w.next=this.pairs,(this.pairs=w).first=!0);continue}null==wu.zpp_pool?w=new wu:(w=wu.zpp_pool,wu.zpp_pool=w.next,w.next=null),w.alloc(),w.n1=s,w.n2=b,w.id=x,w.di=z,w.next=this.pairs,(this.pairs=w).first=!0,l.pairs.inlined_add(w),y.pairs.inlined_add(w)}}else o.intersect(b.aabb)&&(null!=b.child1&&(b.child1.next=_,_=b.child1),null!=b.child2&&(b.child2.next=_,_=b.child2))}}}}for(;null!=this.moves;){var C=this.moves;this.moves=C.mnext,C.mnext=null;var N=C;N.moved=!1;var P=N.shape;if(!P.body.component.sleeping){var M=N.aabb,I=null;for(null!=this.dtree.root&&(this.dtree.root.next=I,I=this.dtree.root);null!=I;){var A=I;I=A.next,A.next=null;var T=A;if(T!=N)if(T.isLeaf()){var D=T.shape;if(!(D.body==P.body||D.body.isStatic()&&P.body.isStatic())&&M.intersect(T.aabb)){var E,O;O=P.id<D.id?(E=P.id,D.id):(E=D.id,P.id);for(var B=null,L=(P.pairs.length<D.pairs.length?P:D).pairs.begin();null!=L;){var j=L.elem();if(j.id==E&&j.di==O){B=j;break}L=L.next}if(null!=B){B.sleeping&&(B.sleeping=!1,B.next=this.pairs,(this.pairs=B).first=!0);continue}null==wu.zpp_pool?B=new wu:(B=wu.zpp_pool,wu.zpp_pool=B.next,B.next=null),B.alloc(),B.n1=N,B.n2=T,B.id=E,B.di=O,B.next=this.pairs,(this.pairs=B).first=!0,P.pairs.inlined_add(B),D.pairs.inlined_add(B)}}else M.intersect(T.aabb)&&(null!=T.child1&&(T.child1.next=I,I=T.child1),null!=T.child2&&(T.child2.next=I,I=T.child2))}for(null!=this.stree.root&&(this.stree.root.next=I,I=this.stree.root);null!=I;){var F=I;I=F.next,F.next=null;var R=F;if(R!=N)if(R.isLeaf()){var G=R.shape;if(!(G.body==P.body||G.body.isStatic()&&P.body.isStatic())&&M.intersect(R.aabb)){var Z,U;U=P.id<G.id?(Z=P.id,G.id):(Z=G.id,P.id);for(var V=null,q=(P.pairs.length<G.pairs.length?P:G).pairs.begin();null!=q;){var W=q.elem();if(W.id==Z&&W.di==U){V=W;break}q=q.next}if(null!=V){V.sleeping&&(V.sleeping=!1,V.next=this.pairs,(this.pairs=V).first=!0);continue}null==wu.zpp_pool?V=new wu:(V=wu.zpp_pool,wu.zpp_pool=V.next,V.next=null),V.alloc(),V.n1=N,V.n2=R,V.id=Z,V.di=U,V.next=this.pairs,(this.pairs=V).first=!0,P.pairs.inlined_add(V),G.pairs.inlined_add(V)}}else M.intersect(R.aabb)&&(null!=R.child1&&(R.child1.next=I,I=R.child1),null!=R.child2&&(R.child2.next=I,I=R.child2))}}}for(var X=null,H=this.pairs;null!=H;)if(H.first||H.n1.aabb.intersect(H.n2.aabb)){var Y=H.n1.shape,J=Y.body,K=H.n2.shape,Q=K.body;if(H.first||!J.component.sleeping&&!J.isStatic()||!Q.component.sleeping&&!Q.isStatic()){if(H.first=!1,Y.aabb.intersect(K.aabb)){var $=H.arb;H.arb=t?e.narrowPhase(Y,K,!J.isDynamic()||!Q.isDynamic(),H.arb,!1):e.continuousEvent(Y,K,!J.isDynamic()||!Q.isDynamic(),H.arb,!1),null==H.arb?null!=$&&($.pair=null):H.arb.pair=H}H=(X=H).next}else H.sleeping=!0,null==X?this.pairs=H.next:X.next=H.next,H=H.next}else{null==X?this.pairs=H.next:X.next=H.next,H.n1.shape.pairs.inlined_remove(H),H.n2.shape.pairs.inlined_remove(H);var ee=H.next;null!=H.arb&&(H.arb.pair=null),H.arb=null;var te=H;te.free(),te.next=wu.zpp_pool,wu.zpp_pool=te,H=ee}},clear:function(){for(;null!=this.syncs;){var e=this.syncs.snext;this.syncs.snext=null,this.syncs.first_sync&&(this.syncs.shape.node=null,this.syncs.shape.removedFromSpace(),this.syncs.shape=null),this.syncs=e}for(;null!=this.moves;){var t=this.moves.mnext;this.moves.mnext=null,this.moves.first_sync&&(this.moves.shape.node=null,this.moves.shape.removedFromSpace(),this.moves.shape=null),this.moves=t}for(;null!=this.pairs;){var n=this.pairs.next;null!=this.pairs.arb&&(this.pairs.arb.pair=null),this.pairs.arb=null,this.pairs.n1.shape.pairs.inlined_remove(this.pairs),this.pairs.n2.shape.pairs.inlined_remove(this.pairs);var i=this.pairs;i.free(),i.next=wu.zpp_pool,wu.zpp_pool=i,this.pairs=n}this.dtree.clear(),this.stree.clear()},treeStack:null,shapesUnderPoint:function(e,t,n,i){this.sync_broadphase();var r=pu.get(e,t),a=null==i?new R_:i;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var s=this.treeStack.pop_unsafe();s.aabb.containsPoint(r)&&(s.isLeaf()?(null==n||s.shape.filter.shouldCollide(n))&&(s.shape.isCircle()?Dp.circleContains(s.shape.circle,r)&&a.push(s.shape.outer):Dp.polyContains(s.shape.polygon,r)&&a.push(s.shape.outer)):(null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var l=this.treeStack.pop_unsafe();l.aabb.containsPoint(r)&&(l.isLeaf()?(null==n||l.shape.filter.shouldCollide(n))&&(l.shape.isCircle()?Dp.circleContains(l.shape.circle,r)&&a.push(l.shape.outer):Dp.polyContains(l.shape.polygon,r)&&a.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}var o=r;return o.free(),o.next=pu.zpp_pool,pu.zpp_pool=o,a},bodiesUnderPoint:function(e,t,n,i){this.sync_broadphase();var r=pu.get(e,t),a=null==i?new z_:i;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var s=this.treeStack.pop_unsafe();if(s.aabb.containsPoint(r))if(s.isLeaf()){var l=s.shape.body.outer;a.has(l)||(null==n||s.shape.filter.shouldCollide(n))&&(s.shape.isCircle()?Dp.circleContains(s.shape.circle,r)&&a.push(l):Dp.polyContains(s.shape.polygon,r)&&a.push(l))}else null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var o=this.treeStack.pop_unsafe();if(o.aabb.containsPoint(r))if(o.isLeaf()){var _=o.shape.body.outer;a.has(_)||(null==n||o.shape.filter.shouldCollide(n))&&(o.shape.isCircle()?Dp.circleContains(o.shape.circle,r)&&a.push(_):Dp.polyContains(o.shape.polygon,r)&&a.push(_))}else null!=o.child1&&this.treeStack.add(o.child1),null!=o.child2&&this.treeStack.add(o.child2)}var p=r;return p.free(),p.next=pu.zpp_pool,pu.zpp_pool=p,a},treeStack2:null,shapesInAABB:function(e,t,n,i,r){this.sync_broadphase(),this.updateAABBShape(e);var a=this.aabbShape.zpp_inner.aabb,s=null==r?new R_:r;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var l=this.treeStack.pop_unsafe();if(a.contains(l.aabb))if(l.isLeaf())(null==i||l.shape.filter.shouldCollide(i))&&s.push(l.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new th),this.treeStack2.add(l);!this.treeStack2.empty();){var o=this.treeStack2.pop_unsafe();o.isLeaf()?(null==i||o.shape.filter.shouldCollide(i))&&s.push(o.shape.outer):(null!=o.child1&&this.treeStack2.add(o.child1),null!=o.child2&&this.treeStack2.add(o.child2))}else l.aabb.intersect(a)&&(l.isLeaf()?(null==i||l.shape.filter.shouldCollide(i))&&(t?n?Dp.containTest(this.aabbShape.zpp_inner,l.shape)&&s.push(l.shape.outer):(a.contains(l.shape.aabb)||Dp.testCollide_safe(l.shape,this.aabbShape.zpp_inner))&&s.push(l.shape.outer):n&&!a.contains(l.shape.aabb)||s.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var _=this.treeStack.pop_unsafe();if(a.contains(_.aabb))if(_.isLeaf())(null==i||_.shape.filter.shouldCollide(i))&&s.push(_.shape.outer);else for(null==this.treeStack2&&(this.treeStack2=new th),this.treeStack2.add(_);!this.treeStack2.empty();){var p=this.treeStack2.pop_unsafe();p.isLeaf()?(null==i||p.shape.filter.shouldCollide(i))&&s.push(p.shape.outer):(null!=p.child1&&this.treeStack2.add(p.child1),null!=p.child2&&this.treeStack2.add(p.child2))}else _.aabb.intersect(a)&&(_.isLeaf()?(null==i||_.shape.filter.shouldCollide(i))&&(t?n?Dp.containTest(this.aabbShape.zpp_inner,_.shape)&&s.push(_.shape.outer):(a.contains(_.shape.aabb)||Dp.testCollide_safe(_.shape,this.aabbShape.zpp_inner))&&s.push(_.shape.outer):n&&!a.contains(_.shape.aabb)||s.push(_.shape.outer)):(null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)))}return s},failed:null,bodiesInAABB:function(e,t,n,i,r){this.sync_broadphase(),this.updateAABBShape(e);var a=this.aabbShape.zpp_inner.aabb,s=null==r?new z_:r;if(null==this.failed&&(this.failed=new z_),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var l=this.treeStack.pop_unsafe();if(a.contains(l.aabb))if(l.isLeaf()){if(null==i||l.shape.filter.shouldCollide(i)){var o=l.shape.body.outer;s.has(o)||s.push(o)}}else for(null==this.treeStack2&&(this.treeStack2=new th),this.treeStack2.add(l);!this.treeStack2.empty();){var _=this.treeStack2.pop_unsafe();if(_.isLeaf()){if(null==i||_.shape.filter.shouldCollide(i)){var p=_.shape.body.outer;s.has(p)||s.push(p)}}else null!=_.child1&&this.treeStack2.add(_.child1),null!=_.child2&&this.treeStack2.add(_.child2)}else if(l.aabb.intersect(a))if(l.isLeaf()){var u=l.shape.body.outer;if(null==i||l.shape.filter.shouldCollide(i))if(t)if(n){if(!this.failed.has(u)){var h=Dp.containTest(this.aabbShape.zpp_inner,l.shape);!s.has(u)&&h?s.push(u):h||(s.remove(u),this.failed.push(u))}}else!s.has(u)&&Dp.testCollide_safe(l.shape,this.aabbShape.zpp_inner)&&s.push(u);else if(n){if(!this.failed.has(u)){var c=a.contains(l.shape.aabb);!s.has(u)&&c?s.push(u):c||(s.remove(u),this.failed.push(u))}}else!s.has(u)&&a.contains(l.shape.aabb)&&s.push(u)}else null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var d=this.treeStack.pop_unsafe();if(a.contains(d.aabb))if(d.isLeaf()){if(null==i||d.shape.filter.shouldCollide(i)){var m=d.shape.body.outer;s.has(m)||s.push(m)}}else for(null==this.treeStack2&&(this.treeStack2=new th),this.treeStack2.add(d);!this.treeStack2.empty();){var f=this.treeStack2.pop_unsafe();if(f.isLeaf()){if(null==i||f.shape.filter.shouldCollide(i)){var g=f.shape.body.outer;s.has(g)||s.push(g)}}else null!=f.child1&&this.treeStack2.add(f.child1),null!=f.child2&&this.treeStack2.add(f.child2)}else if(d.aabb.intersect(a))if(d.isLeaf()){var v=d.shape.body.outer;if(null==i||d.shape.filter.shouldCollide(i))if(t)if(n){if(!this.failed.has(v)){var b=Dp.containTest(this.aabbShape.zpp_inner,d.shape);!s.has(v)&&b?s.push(v):b||(s.remove(v),this.failed.push(v))}}else!s.has(v)&&Dp.testCollide_safe(d.shape,this.aabbShape.zpp_inner)&&s.push(v);else if(n){if(!this.failed.has(v)){var y=a.contains(d.shape.aabb);!s.has(v)&&y?s.push(v):y||(s.remove(v),this.failed.push(v))}}else!s.has(v)&&a.contains(d.shape.aabb)&&s.push(v)}else null!=d.child1&&this.treeStack.add(d.child1),null!=d.child2&&this.treeStack.add(d.child2)}return this.failed.clear(),s},shapesInCircle:function(e,t,n,i,r,a){this.sync_broadphase(),this.updateCircShape(e,t,n);var s=this.circShape.zpp_inner.aabb,l=null==a?new R_:a;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var o=this.treeStack.pop_unsafe();o.aabb.intersect(s)&&(o.isLeaf()?(null==r||o.shape.filter.shouldCollide(r))&&(i?Dp.containTest(this.circShape.zpp_inner,o.shape)&&l.push(o.shape.outer):Dp.testCollide_safe(o.shape,this.circShape.zpp_inner)&&l.push(o.shape.outer)):(null!=o.child1&&this.treeStack.add(o.child1),null!=o.child2&&this.treeStack.add(o.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var _=this.treeStack.pop_unsafe();_.aabb.intersect(s)&&(_.isLeaf()?(null==r||_.shape.filter.shouldCollide(r))&&(i?Dp.containTest(this.circShape.zpp_inner,_.shape)&&l.push(_.shape.outer):Dp.testCollide_safe(_.shape,this.circShape.zpp_inner)&&l.push(_.shape.outer)):(null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)))}return l},bodiesInCircle:function(e,t,n,i,r,a){this.sync_broadphase(),this.updateCircShape(e,t,n);var s=this.circShape.zpp_inner.aabb,l=null==a?new z_:a;if(null==this.failed&&(this.failed=new z_),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var o=this.treeStack.pop_unsafe();if(o.aabb.intersect(s))if(o.isLeaf()){var _=o.shape.body.outer;if(null==r||o.shape.filter.shouldCollide(r))if(i){if(!this.failed.has(_)){var p=Dp.containTest(this.circShape.zpp_inner,o.shape);!l.has(_)&&p?l.push(_):p||(l.remove(_),this.failed.push(_))}}else!l.has(_)&&Dp.testCollide_safe(o.shape,this.circShape.zpp_inner)&&l.push(_)}else null!=o.child1&&this.treeStack.add(o.child1),null!=o.child2&&this.treeStack.add(o.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var u=this.treeStack.pop_unsafe();if(u.aabb.intersect(s))if(u.isLeaf()){var h=u.shape.body.outer;if(null==r||u.shape.filter.shouldCollide(r))if(i){if(!this.failed.has(h)){var c=Dp.containTest(this.circShape.zpp_inner,u.shape);!l.has(h)&&c?l.push(h):c||(l.remove(h),this.failed.push(h))}}else!l.has(h)&&Dp.testCollide_safe(u.shape,this.circShape.zpp_inner)&&l.push(h)}else null!=u.child1&&this.treeStack.add(u.child1),null!=u.child2&&this.treeStack.add(u.child2)}return this.failed.clear(),l},shapesInShape:function(e,t,n,i){this.sync_broadphase(),this.validateShape(e);var r=e.aabb,a=null==i?new R_:i;if(null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var s=this.treeStack.pop_unsafe();s.aabb.intersect(r)&&(s.isLeaf()?(null==n||s.shape.filter.shouldCollide(n))&&(t?Dp.containTest(e,s.shape)&&a.push(s.shape.outer):Dp.testCollide_safe(s.shape,e)&&a.push(s.shape.outer)):(null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)))}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var l=this.treeStack.pop_unsafe();l.aabb.intersect(r)&&(l.isLeaf()?(null==n||l.shape.filter.shouldCollide(n))&&(t?Dp.containTest(e,l.shape)&&a.push(l.shape.outer):Dp.testCollide_safe(l.shape,e)&&a.push(l.shape.outer)):(null!=l.child1&&this.treeStack.add(l.child1),null!=l.child2&&this.treeStack.add(l.child2)))}return a},bodiesInShape:function(e,t,n,i){this.sync_broadphase(),this.validateShape(e);var r=e.aabb,a=null==i?new z_:i;if(null==this.failed&&(this.failed=new z_),null!=this.stree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.stree.root);!this.treeStack.empty();){var s=this.treeStack.pop_unsafe();if(s.aabb.intersect(r))if(s.isLeaf()){var l=s.shape.body.outer;if(null==n||s.shape.filter.shouldCollide(n))if(t){if(!this.failed.has(l)){var o=Dp.containTest(e,s.shape);!a.has(l)&&o?a.push(l):o||(a.remove(l),this.failed.push(l))}}else!a.has(l)&&Dp.testCollide_safe(s.shape,e)&&a.push(l)}else null!=s.child1&&this.treeStack.add(s.child1),null!=s.child2&&this.treeStack.add(s.child2)}if(null!=this.dtree.root)for(null==this.treeStack&&(this.treeStack=new th),this.treeStack.add(this.dtree.root);!this.treeStack.empty();){var _=this.treeStack.pop_unsafe();if(_.aabb.intersect(r))if(_.isLeaf()){var p=_.shape.body.outer;if(null==n||_.shape.filter.shouldCollide(n))if(t){if(!this.failed.has(p)){var u=Dp.containTest(e,_.shape);!a.has(p)&&u?a.push(p):u||(a.remove(p),this.failed.push(p))}}else!a.has(p)&&Dp.testCollide_safe(_.shape,e)&&a.push(p)}else null!=_.child1&&this.treeStack.add(_.child1),null!=_.child2&&this.treeStack.add(_.child2)}return this.failed.clear(),a},openlist:null,rayCast:function(e,t,n){null==this.openlist&&(this.openlist=new th),this.sync_broadphase(),e.validate_dir();var i=e.maxdist;if(null!=this.dtree.root&&e.aabbtest(this.dtree.root.aabb)){var r=e.aabbsect(this.dtree.root.aabb);if(0<=r&&r<i){this.dtree.root.rayt=r;for(var a=null,s=this.openlist.begin();null!=s;){var l=s.elem();if(this.dtree.root.rayt<l.rayt)break;s=(a=s).next}this.openlist.inlined_insert(a,this.dtree.root)}}if(null!=this.stree.root&&e.aabbtest(this.stree.root.aabb)){var o=e.aabbsect(this.stree.root.aabb);if(0<=o&&o<i){this.stree.root.rayt=o;for(var _=null,p=this.openlist.begin();null!=p;){var u=p.elem();if(this.stree.root.rayt<u.rayt)break;p=(_=p).next}this.openlist.inlined_insert(_,this.stree.root)}}for(var h=null;!this.openlist.empty();){var c=this.openlist.pop_unsafe();if(c.rayt>=i)break;if(c.isLeaf()){var d=c.shape;if(null==n||d.filter.shouldCollide(n)){var m=d.isCircle()?e.circlesect(d.circle,t,i):e.aabbtest(d.aabb)?e.polysect(d.polygon,t,i):null;null!=m&&(i=m.get_distance(),null!=h&&h.dispose(),h=m)}}else{if(null!=c.child1&&e.aabbtest(c.child1.aabb)){var f=e.aabbsect(c.child1.aabb);if(0<=f&&f<i){c.child1.rayt=f;for(var g=null,v=this.openlist.begin();null!=v;){var b=v.elem();if(c.child1.rayt<b.rayt)break;v=(g=v).next}this.openlist.inlined_insert(g,c.child1)}}if(null!=c.child2&&e.aabbtest(c.child2.aabb)){var y=e.aabbsect(c.child2.aabb);if(0<=y&&y<i){c.child2.rayt=y;for(var x=null,z=this.openlist.begin();null!=z;){var w=z.elem();if(c.child2.rayt<w.rayt)break;z=(x=z).next}this.openlist.inlined_insert(x,c.child2)}}}}return this.openlist.clear(),h},rayMultiCast:function(e,t,n,i){null==this.openlist&&(this.openlist=new th),this.sync_broadphase(),e.validate_dir();var r=e.maxdist>=X_.POSINF(),a=null==i?new c_:i;if(null!=this.dtree.root&&e.aabbtest(this.dtree.root.aabb))if(r)this.openlist.add(this.dtree.root);else{var s=e.aabbsect(this.dtree.root.aabb);0<=s&&s<e.maxdist&&this.openlist.add(this.dtree.root)}if(null!=this.stree.root&&e.aabbtest(this.stree.root.aabb))if(r)this.openlist.add(this.stree.root);else{var l=e.aabbsect(this.stree.root.aabb);0<=l&&l<e.maxdist&&this.openlist.add(this.stree.root)}for(;!this.openlist.empty();){var o=this.openlist.pop_unsafe();if(o.isLeaf()){var _=o.shape;(null==n||_.filter.shouldCollide(n))&&(_.isCircle()?e.circlesect2(_.circle,t,a):e.aabbtest(_.aabb)&&e.polysect2(_.polygon,t,a))}else{if(null!=o.child1&&e.aabbtest(o.child1.aabb))if(r)this.openlist.add(o.child1);else{var p=e.aabbsect(o.child1.aabb);0<=p&&p<e.maxdist&&this.openlist.add(o.child1)}if(null!=o.child2&&e.aabbtest(o.child2.aabb))if(r)this.openlist.add(o.child2);else{var u=e.aabbsect(o.child2.aabb);0<=u&&u<e.maxdist&&this.openlist.add(o.child2)}}}return this.openlist.clear(),a},__class__:Su});var Cu=function(){this.waket=0,this.sleep=!1,this.comps=null,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.comps=new eh};(n["zpp_nape.space.ZPP_Island"]=Cu).__name__=["zpp_nape","space","ZPP_Island"],Cu.prototype={next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},comps:null,sleep:null,waket:null,free:function(){},alloc:function(){this.waket=0},__class__:Cu};var Nu=function(){this.woken=!1,this.waket=0,this.sleeping=!1,this.island=null,this.constraint=null,this.body=null,this.isBody=!1,this.rank=0,this.parent=null,this.next=null,this.reset(),this.woken=!1};(n["zpp_nape.space.ZPP_Component"]=Nu).__name__=["zpp_nape","space","ZPP_Component"],Nu.prototype={next:null,parent:null,rank:null,isBody:null,body:null,constraint:null,island:null,sleeping:null,waket:null,woken:null,free:function(){this.body=null,this.constraint=null},alloc:function(){},reset:function(){this.sleeping=!1,this.island=null,(this.parent=this).rank=0},__class__:Nu};var Pu=function(){this.lazydel=!1,this.freed=!1,this.length=0,this.pushmod=!1,this.modified=!1,this._inuse=!1,this.next=null,this.int2=null,this.int1=null,this.di=0,this.id=0,this.arbiters=new Zu};(n["zpp_nape.space.ZPP_CallbackSet"]=Pu).__name__=["zpp_nape","space","ZPP_CallbackSet"],Pu.get=function(e,t){var n;return null==Pu.zpp_pool?n=new Pu:(n=Pu.zpp_pool,Pu.zpp_pool=n.next,n.next=null),n.alloc(),e.id<t.id?(n.int1=e,n.int2=t):(n.int1=t,n.int2=e),n.id=n.int1.id,n.di=n.int2.id,n},Pu.prototype={id:null,di:null,int1:null,int2:null,arbiters:null,COLLISIONstate:null,COLLISIONstamp:null,SENSORstate:null,SENSORstamp:null,FLUIDstate:null,FLUIDstamp:null,next:null,elem:function(){return this},begin:function(){return this.next},_inuse:null,modified:null,pushmod:null,length:null,setbegin:function(e){this.next=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){e._inuse=!0;var t=e;return t.next=this.begin(),this.next=t,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){t._inuse=!0;var n=t;return null==e?(n.next=this.begin(),this.next=n):(n.next=e.next,e.next=n),this.pushmod=this.modified=!0,this.length++,n},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.next=e.next,e.elem()._inuse=!1,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;return null==e?(n=(t=this.begin()).next,this.next=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0)),t.elem()._inuse=!1,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.next=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},freed:null,lazydel:null,free:function(){this.int1=this.int2=null,this.id=this.di=-1,this.freed=!0},alloc:function(){this.freed=!1,this.lazydel=!1,this.COLLISIONstate=1,this.COLLISIONstamp=0,this.SENSORstate=1,this.SENSORstamp=0,this.FLUIDstate=1,this.FLUIDstamp=0},add_arb:function(e){return!this.arbiters.inlined_has(e)&&(this.arbiters.inlined_add(e),!0)},try_remove_arb:function(e){return this.arbiters.inlined_try_remove(e)},remove_arb:function(e){this.arbiters.inlined_remove(e)},empty_arb:function(e){var t;t=!0;for(var n=this.arbiters.begin();null!=n;){if(0!=(n.elem().type&e)){t=!1;break}n=n.next}return t},really_empty:function(){return this.arbiters.empty()},sleeping:function(){var e;e=!0;for(var t=this.arbiters.begin();null!=t;){if(!t.elem().sleeping){e=!1;break}t=t.next}return e},__class__:Pu};var Mu=function(e){this.space=null,(this.cbsets=null)==gc.zpp_pool?this.cbsets=new gc:(this.cbsets=gc.zpp_pool,gc.zpp_pool=this.cbsets.next,this.cbsets.next=null),this.cbsets.alloc(),this.cbsets.lt=J_.setlt,this.space=e};(n["zpp_nape.space.ZPP_CbSetManager"]=Mu).__name__=["zpp_nape","space","ZPP_CbSetManager"],Mu.prototype={cbsets:null,space:null,get:function(e){if(e.empty())return null;var t;null==J_.zpp_pool?t=new J_:(t=J_.zpp_pool,J_.zpp_pool=t.next,t.next=null),t.alloc();var n=t.cbTypes;t.cbTypes=e;var i,r=this.cbsets.find_weak(t);if(null!=r)i=r.data;else{var a=J_.get(e);this.cbsets.insert(a),a.manager=this,i=a}t.cbTypes=n;var s=t;return s.free(),s.next=J_.zpp_pool,J_.zpp_pool=s,i},remove:function(e){for(this.cbsets.remove(e);!e.cbpairs.empty();){var t=e.cbpairs.pop_unsafe();t.a!=t.b&&(e==t.a?t.b.cbpairs.remove(t):t.a.cbpairs.remove(t));var n=t;n.free(),n.next=K_.zpp_pool,K_.zpp_pool=n}e.manager=null},clear:function(){},validate:function(){if(!this.cbsets.empty()){for(var e=this.cbsets.parent;null!=e.prev;)e=e.prev;for(;null!=e;)if(e.data.validate(),null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}},pair:function(e,t){for(var n=null,i=(e.cbpairs.length<t.cbpairs.length?e.cbpairs:t.cbpairs).begin();null!=i;){var r=i.elem();if(r.a==e&&r.b==t||r.a==t&&r.b==e){n=r;break}i=i.next}return null==n&&(n=K_.get(e,t),e.cbpairs.add(n),t!=e&&t.cbpairs.add(n)),n.validate(),n},valid_listener:function(e){return e.space==this.space},__class__:Mu};var Iu=function(e,t){this.prelisteners=null,this.precb=null,this.continuous=!1,this.toiEvents=null,this.pre_dt=0,this.convexShapeList=null,this.cbsets=null,this.callbackset_list=null,this.callbacks=null,this.wrap_listeners=null,this.listeners=null,this.islands=null,this.staticsleep=null,this.wrap_livecon=null,this.live_constraints=null,this.wrap_live=null,this.live=null,this.wrap_arbiters=null,this.s_arbiters=null,this.f_arbiters=null,this.c_arbiters_false=null,this.c_arbiters_true=null,this.sortcontacts=!1,this.time=0,this.midstep=!1,this.stamp=0,this.global_ang_drag=0,this.global_lin_drag=0,this.__static=null,this.bphase=null,this.kinematics=null,this.wrap_constraints=null,this.constraints=null,this.wrap_compounds=null,this.compounds=null,this.wrap_bodies=null,this.bodies=null,this.wrap_gravity=null,this.gravityy=0,this.gravityx=0,this.userData=null,this.outer=null,this.toiEvents=new lh,this.global_lin_drag=.015,this.global_ang_drag=.015,this.precb=new Co,this.precb.zpp_inner=new Y_,this.sortcontacts=!0,this.pre_dt=0,null==t||t==U_.get_DYNAMIC_AABB_TREE()?this.bphase=new Su(this):t==U_.get_SWEEP_AND_PRUNE()&&(this.bphase=new Tu(this)),this.time=0,this.gravityy=null!=e?(this.gravityx=e.x,e.y):this.gravityx=0,this.bodies=new Ru,this.wrap_bodies=Hh.get(this.bodies),this.wrap_bodies.zpp_inner.adder=yc(this,this.bodies_adder),this.wrap_bodies.zpp_inner.subber=yc(this,this.bodies_subber),this.compounds=new Gu,this.wrap_compounds=Jh.get(this.compounds),this.wrap_compounds.zpp_inner.adder=yc(this,this.compounds_adder),this.wrap_compounds.zpp_inner.subber=yc(this,this.compounds_subber),this.kinematics=new Ru,this.c_arbiters_true=new ah,this.c_arbiters_false=new ah,this.f_arbiters=new ih,this.s_arbiters=new rh,this.islands=new Cu,this.live=new Ru,this.wrap_live=Hh.get(this.live,!0),this.staticsleep=new Ru,this.constraints=new tp,this.wrap_constraints=Xh.get(this.constraints),this.wrap_constraints.zpp_inner.adder=yc(this,this.constraints_adder),this.wrap_constraints.zpp_inner.subber=yc(this,this.constraints_subber),this.live_constraints=new tp,this.wrap_livecon=Xh.get(this.live_constraints,!0),this.__static=du.__static(),(this.__static.zpp_inner.space=this).callbacks=new Y_,this.midstep=!1,this.listeners=new sh,this.wrap_listeners=Kh.get(this.listeners),this.wrap_listeners.zpp_inner.adder=yc(this,this.listeners_adder),this.wrap_listeners.zpp_inner.subber=yc(this,this.listeners_subber),this.callbackset_list=new Pu,this.mrca1=new np,this.mrca2=new np,this.prelisteners=new Q_,this.cbsets=new Mu(this)};(n["zpp_nape.space.ZPP_Space"]=Iu).__name__=["zpp_nape","space","ZPP_Space"],Iu.prototype={outer:null,userData:null,gravityx:null,gravityy:null,wrap_gravity:null,getgravity:function(){this.wrap_gravity=d_.get(this.gravityx,this.gravityy),this.wrap_gravity.zpp_inner._inuse=!0,this.wrap_gravity.zpp_inner._invalidate=yc(this,this.gravity_invalidate),this.wrap_gravity.zpp_inner._validate=yc(this,this.gravity_validate)},gravity_invalidate:function(e){this.gravityx=e.x,this.gravityy=e.y;for(var t=new Gu,n=this.bodies.begin();null!=n;){var i=n.elem();i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.isKinematic()&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!1)),n=n.next}for(var r=this.compounds.begin();null!=r;){var a=r.elem();t.add(a),r=r.next}for(;!t.empty();){for(var s=t.pop_unsafe(),l=s.bodies.begin();null!=l;){var o=l.elem();o.world||(o.component.waket=this.stamp+(this.midstep?0:1),o.isKinematic()&&(o.kinematicDelaySleep=!0),o.component.sleeping&&this.really_wake(o,!1)),l=l.next}for(var _=s.compounds.begin();null!=_;){var p=_.elem();t.add(p),_=_.next}}},gravity_validate:function(){this.wrap_gravity.zpp_inner.x=this.gravityx,this.wrap_gravity.zpp_inner.y=this.gravityy},bodies:null,wrap_bodies:null,compounds:null,wrap_compounds:null,constraints:null,wrap_constraints:null,kinematics:null,bphase:null,__static:null,global_lin_drag:null,global_ang_drag:null,stamp:null,midstep:null,time:null,sortcontacts:null,c_arbiters_true:null,c_arbiters_false:null,f_arbiters:null,s_arbiters:null,wrap_arbiters:null,live:null,wrap_live:null,live_constraints:null,wrap_livecon:null,staticsleep:null,islands:null,listeners:null,wrap_listeners:null,callbacks:null,callbackset_list:null,cbsets:null,clear:function(){for(;!this.listeners.empty();){var e=this.listeners.pop_unsafe();this.remListener(e)}for(;!this.callbackset_list.empty();){var t=this.callbackset_list.pop_unsafe();t.arbiters.clear();var n=t;n.free(),n.next=Pu.zpp_pool,Pu.zpp_pool=n}for(;!this.c_arbiters_true.empty();)this.c_arbiters_true.pop_unsafe().retire();for(;!this.c_arbiters_false.empty();)this.c_arbiters_false.pop_unsafe().retire();for(;!this.s_arbiters.empty();)this.s_arbiters.pop_unsafe().retire();for(;!this.f_arbiters.empty();)this.f_arbiters.pop_unsafe().retire();for(this.bphase.clear();!this.bodies.empty();){var i=this.bodies.pop_unsafe();if(null!=i.component){var r=i.component.island;if(null!=r){for(;!r.comps.empty();)r.comps.pop_unsafe().reset();var a=r;a.free(),a.next=Cu.zpp_pool,Cu.zpp_pool=a}}i.removedFromSpace(),i.space=null}for(;!this.constraints.empty();){var s=this.constraints.pop_unsafe();if(null!=s.component){var l=s.component.island;if(null!=l){for(;!l.comps.empty();)l.comps.pop_unsafe().reset();var o=l;o.free(),o.next=Cu.zpp_pool,Cu.zpp_pool=o}}s.removedFromSpace(),s.space=null}this.kinematics.clear();for(var _=new Gu;!this.compounds.empty();){var p=this.compounds.pop_unsafe();_.add(p)}for(;!_.empty();){var u=_.pop_unsafe();u.removedFromSpace(),u.space=null;for(var h=u.bodies.begin();null!=h;){var c=h.elem();if(null!=c.component){var d=c.component.island;if(null!=d){for(;!d.comps.empty();)d.comps.pop_unsafe().reset();var m=d;m.free(),m.next=Cu.zpp_pool,Cu.zpp_pool=m}}c.removedFromSpace(),c.space=null,h=h.next}for(var f=u.constraints.begin();null!=f;){var g=f.elem();if(null!=g.component){var v=g.component.island;if(null!=v){for(;!v.comps.empty();)v.comps.pop_unsafe().reset();var b=v;b.free(),b.next=Cu.zpp_pool,Cu.zpp_pool=b}}g.removedFromSpace(),g.space=null,f=f.next}for(var y=u.compounds.begin();null!=y;){var x=y.elem();_.add(x),y=y.next}}this.staticsleep.clear(),this.live.clear(),this.live_constraints.clear(),this.stamp=0,this.time=0,this.mrca1.clear(),this.mrca2.clear(),this.prelisteners.clear(),this.cbsets.clear()},bodies_adder:function(e){return e.zpp_inner.space!=this&&(null!=e.zpp_inner.space&&e.zpp_inner.space.outer.get_bodies().remove(e),this.addBody(e.zpp_inner),!0)},bodies_subber:function(e){this.remBody(e.zpp_inner)},compounds_adder:function(e){return e.zpp_inner.space!=this&&(null!=e.zpp_inner.space&&e.zpp_inner.space.wrap_compounds.remove(e),this.addCompound(e.zpp_inner),!0)},compounds_subber:function(e){this.remCompound(e.zpp_inner)},constraints_adder:function(e){return e.zpp_inner.space!=this&&(null!=e.zpp_inner.space&&e.zpp_inner.space.outer.get_constraints().remove(e),this.addConstraint(e.zpp_inner),!0)},constraints_subber:function(e){this.remConstraint(e.zpp_inner)},listeners_adder:function(e){return e.zpp_inner.space!=this&&(null!=e.zpp_inner.space&&e.zpp_inner.space.outer.get_listeners().remove(e),this.addListener(e.zpp_inner),!0)},listeners_subber:function(e){this.remListener(e.zpp_inner)},revoke_listener:function(e){},unrevoke_listener:function(e){},addListener:function(e){e.space=this,e.addedToSpace(),null!=e.interaction&&this.unrevoke_listener(e.interaction)},remListener:function(e){null!=e.interaction&&this.revoke_listener(e.interaction),e.removedFromSpace(),e.space=null},add_callbackset:function(e){e.int1.cbsets.inlined_add(e),e.int2.cbsets.inlined_add(e),this.callbackset_list.inlined_add(e)},remove_callbackset:function(e){e.lazydel=!0,e.int1.cbsets.inlined_remove(e),e.int2.cbsets.inlined_remove(e)},transmitType:function(e,t){var n=e;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!1)),2==e.type?this.live.remove(e):3==e.type?(this.kinematics.remove(e),this.staticsleep.remove(e)):1==e.type&&this.staticsleep.remove(e),e.type=t,3==e.type&&this.kinematics.add(e),1==e.type&&this.static_validation(e),e.component.sleeping=!0;var i=e;i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.isKinematic()&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!0))},added_shape:function(e,t){if(null==t&&(t=!1),!t){var n=e.body;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!1))}this.bphase.insert(e),e.addedToSpace()},removed_shape:function(e,t){null==t&&(t=!1);var n=this,i=e.body;t||i.wake();for(var r=null,a=i.arbiters.begin();null!=a;){var s=[a.elem()];if(s[0].ws1==e||s[0].ws2==e){if(0!=s[0].present){this.MRCA_chains(s[0].ws1,s[0].ws2);for(var l=this.mrca1.begin();null!=l;){for(var o=l.elem(),_=this.mrca2.begin();null!=_;){var p=_.elem(),u=o.cbSet,h=p.cbSet;if(u.validate(),h.validate(),J_.empty_intersection(u,h))_=_.next;else{var c=[cu.get(o,p)];c[0].remove_arb(s[0]),s[0].present--,J_.find_all(u,h,1,function(e,t){return function(i){if(0!=(i.itype&t[0].type)&&e[0].empty_arb(i.itype)){var r=n.push_callback(i);r.event=1,cu.int_callback(e[0],i,r),r.set=e[0]}}}(c,s)),c[0].really_empty()&&this.remove_callbackset(c[0]),_=_.next}}l=l.next}}if(s[0].b1!=i&&s[0].b1.isDynamic()){var d=s[0].b1;d.world||(d.component.waket=this.stamp+(this.midstep?0:1),d.isKinematic()&&(d.kinematicDelaySleep=!0),d.component.sleeping&&this.really_wake(d,!1))}if(s[0].b2!=i&&s[0].b2.isDynamic()){var m=s[0].b2;m.world||(m.component.waket=this.stamp+(this.midstep?0:1),m.isKinematic()&&(m.kinematicDelaySleep=!0),m.component.sleeping&&this.really_wake(m,!1))}s[0].lazyRetire(this,i),a=i.arbiters.erase(r)}else a=(r=a).next}this.bphase.remove(e),e.removedFromSpace()},addConstraint:function(e){e.space=this,e.addedToSpace(),e.active&&(e.component.sleeping=!0,this.wake_constraint(e,!0))},remConstraint:function(e){e.active&&(this.wake_constraint(e,!0),this.live_constraints.remove(e)),e.removedFromSpace(),e.space=null},addCompound:function(e){e.space=this,e.addedToSpace();for(var t=e.bodies.begin();null!=t;){var n=t.elem();this.addBody(n),t=t.next}for(var i=e.constraints.begin();null!=i;){var r=i.elem();this.addConstraint(r),i=i.next}for(var a=e.compounds.begin();null!=a;){var s=a.elem();this.addCompound(s),a=a.next}},remCompound:function(e){for(var t=e.bodies.begin();null!=t;){var n=t.elem();this.remBody(n),t=t.next}for(var i=e.constraints.begin();null!=i;){var r=i.elem();this.remConstraint(r),i=i.next}for(var a=e.compounds.begin();null!=a;){var s=a.elem();this.remCompound(s),a=a.next}e.removedFromSpace(),e.space=null},addBody:function(e,t){null==t&&(t=-1),e.space=this,e.addedToSpace(),e.component.sleeping=!0;var n=e;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!0));for(var i=e.shapes.begin();null!=i;){var r=i.elem();this.added_shape(r,!0),i=i.next}e.isStatic()?this.static_validation(e):e.isDynamic()||3!=t&&this.kinematics.add(e)},remBody:function(e,t){if(null==t&&(t=-1),e.isStatic()){var n=e;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!0)),this.staticsleep.remove(e)}else if(e.isDynamic()){var i=e;i.world||(i.component.waket=this.stamp+(this.midstep?0:1),i.isKinematic()&&(i.kinematicDelaySleep=!0),i.component.sleeping&&this.really_wake(i,!0)),this.live.remove(e)}else{3!=t&&this.kinematics.remove(e);var r=e;r.world||(r.component.waket=this.stamp+(this.midstep?0:1),r.isKinematic()&&(r.kinematicDelaySleep=!0),r.component.sleeping&&this.really_wake(r,!0)),this.staticsleep.remove(e)}for(var a=e.shapes.begin();null!=a;){var s=a.elem();this.removed_shape(s,!0),a=a.next}e.removedFromSpace(),e.space=null},shapesUnderPoint:function(e,t,n,i){return this.bphase.shapesUnderPoint(e,t,n,i)},bodiesUnderPoint:function(e,t,n,i){return this.bphase.bodiesUnderPoint(e,t,n,i)},shapesInAABB:function(e,t,n,i,r){return this.bphase.shapesInAABB(e.zpp_inner,t,n,i,r)},bodiesInAABB:function(e,t,n,i,r){return this.bphase.bodiesInAABB(e.zpp_inner,t,n,i,r)},shapesInCircle:function(e,t,n,i,r){return this.bphase.shapesInCircle(e.get_x(),e.get_y(),t,n,i,r)},bodiesInCircle:function(e,t,n,i,r){return this.bphase.bodiesInCircle(e.get_x(),e.get_y(),t,n,i,r)},shapesInShape:function(e,t,n,i){return this.bphase.shapesInShape(e,t,n,i)},bodiesInShape:function(e,t,n,i){return this.bphase.bodiesInShape(e,t,n,i)},rayCast:function(e,t,n){return this.bphase.rayCast(e.zpp_inner,t,null==n?null:n.zpp_inner)},rayMultiCast:function(e,t,n,i){return this.bphase.rayMultiCast(e.zpp_inner,t,null==n?null:n.zpp_inner,i)},convexShapeList:null,convexCast:function(e,t,n,i){var r;null==su.zpp_pool?r=new su:(r=su.zpp_pool,su.zpp_pool=r.next,r.next=null),r.alloc(),this.prepareCast(e);var a=e.body,s=a.posx,l=a.posy;a.sweepTime=0,a.sweep_angvel=a.angvel,a.sweepIntegrate(t);var o=a.posx,_=a.posy;e.validate_sweepRadius();var p,u=e.sweepRadius;null==Ap.zpp_pool?p=new Ap:(p=Ap.zpp_pool,Ap.zpp_pool=p.next,p.next=null),p.alloc();var h=s,c=o;p.minx=(h<c?h:c)-u;var d=s,m=o;p.maxx=(m<d?d:m)+u;var f=l,g=_;p.miny=(f<g?f:g)-u;var v=l,b=_;p.maxy=(b<v?v:b)+u;var y=this.convexShapeList=this.bphase.shapesInAABB(p,!1,!1,null==n?null:n.zpp_inner,this.convexShapeList),x=p;x.free(),x.next=Ap.zpp_pool,Ap.zpp_pool=x;var z=0,w=0,k=w=z=0,S=0;S=k=0;for(var C=null,N=t+1,P=y.iterator();P.hasNext();){var M=P.next();M!=e.outer&&M.get_body()!=a.outer&&(r.s1=e,r.s2=M.zpp_inner,i?(M.zpp_inner.validate_sweepRadius(),M.get_body().zpp_inner.sweep_angvel=M.get_body().zpp_inner.angvel,M.get_body().zpp_inner.sweepTime=0,lu.dynamicSweep(r,t,0,0,!0),M.get_body().zpp_inner.sweepIntegrate(0),M.get_body().zpp_inner.sweepValidate(M.zpp_inner)):lu.staticSweep(r,t,0,0),r.toi*=t,0<r.toi&&r.toi<N&&(N=r.toi,z=r.axis.x,w=r.axis.y,k=r.c2.x,S=r.c2.y,C=M))}y.clear();var I=r;return I.free(),I.next=su.zpp_pool,su.zpp_pool=I,a.sweepIntegrate(0),a.sweepValidate(e),N<=t?Op.getConvex(d_.get(-z,-w),d_.get(k,S),N,C):null},prepareCast:function(e){e.isCircle()?e.circle.validate_worldCOM():e.polygon.validate_gaxi()},convexMultiCast:function(e,t,n,i,r){var a;null==su.zpp_pool?a=new su:(a=su.zpp_pool,su.zpp_pool=a.next,a.next=null),a.alloc(),this.prepareCast(e);var s=e.body,l=s.posx,o=s.posy;s.sweepTime=0,s.sweep_angvel=s.angvel,s.sweepIntegrate(t);var _=s.posx,p=s.posy;e.validate_sweepRadius();var u,h=e.sweepRadius;null==Ap.zpp_pool?u=new Ap:(u=Ap.zpp_pool,Ap.zpp_pool=u.next,u.next=null),u.alloc();var c=l,d=_;u.minx=(c<d?c:d)-h;var m=l,f=_;u.maxx=(f<m?m:f)+h;var g=o,v=p;u.miny=(g<v?g:v)-h;var b=o,y=p;u.maxy=(y<b?b:y)+h;var x=this.convexShapeList=this.bphase.shapesInAABB(u,!1,!1,null==n?null:n.zpp_inner,this.convexShapeList),z=u;z.free(),z.next=Ap.zpp_pool,Ap.zpp_pool=z;for(var w=null==r?new t_:r,k=x.iterator();k.hasNext();){var S=k.next();if(S!=e.outer&&S.get_body()!=s.outer&&(a.s1=e,a.s2=S.zpp_inner,i?(S.zpp_inner.validate_sweepRadius(),S.get_body().zpp_inner.sweep_angvel=S.get_body().zpp_inner.angvel,S.get_body().zpp_inner.sweepTime=0,lu.dynamicSweep(a,t,0,0,!0),S.get_body().zpp_inner.sweepIntegrate(0),S.get_body().zpp_inner.sweepValidate(S.zpp_inner)):lu.staticSweep(a,t,0,0),a.toi*=t,0<a.toi)){for(var C=Op.getConvex(d_.get(-a.axis.x,-a.axis.y),d_.get(a.c2.x,a.c2.y),a.toi,S),N=null,P=w.zpp_inner.inner.begin();null!=P;){var M=P.elem();if(C.get_toi()<M.get_toi())break;P=(N=P).next}w.zpp_inner.inner.inlined_insert(N,C)}}x.clear();var I=a;return I.free(),I.next=su.zpp_pool,su.zpp_pool=I,s.sweepIntegrate(0),s.sweepValidate(e),w},push_callback:function(e){var t;return null==Y_.zpp_pool?t=new Y_:(t=Y_.zpp_pool,Y_.zpp_pool=t.next,t.next=null),t.alloc(),this.callbacks.push(t),t.listener=e,t},pre_dt:null,step:function(e,t,n){var i=this;if(this.time+=e,this.pre_dt=e,this.midstep=!0,this.stamp++,this.validation(),this.bphase.broadphase(this,!0),this.prestep(e),this.sortcontacts){var r=this.c_arbiters_false;if(!r.empty()&&null!=r.begin().next){for(var a,s,l,o=r.begin(),_=null,p=null,u=null,h=null,c=1;;){for(a=0,p=o,_=o=null;null!=p;){for(++a,u=p,s=0,l=c;null!=u&&s<c;)++s,u=u.next;for(;0<s||0<l&&null!=u;)0==s?(u=(h=u).next,--l):0==l||null==u||!p.elem().active||!u.elem().active||p.elem().oc1.dist<u.elem().oc1.dist?(p=(h=p).next,--s):(u=(h=u).next,--l),null!=_?_.next=h:o=h,_=h;p=u}if(_.next=null,c<<=1,!(1<a))break}r.setbegin(o)}}this.updateVel(e),this.warmStart(),this.iterateVel(t);for(var d=this.kinematics.begin();null!=d;){var m=d.elem();m.pre_posx=m.posx,m.pre_posy=m.posy,m.pre_rot=m.rot,d=d.next}for(var f=this.live.begin();null!=f;){var g=f.elem();g.pre_posx=g.posx,g.pre_posy=g.posy,g.pre_rot=g.rot,f=f.next}this.updatePos(e),this.continuous=!0,this.continuousCollisions(e),this.continuous=!1,this.iteratePos(n);for(var v=this.kinematics.begin();null!=v;){var b=v.elem(),y=!(b.posx==b.pre_posx&&b.posy==b.pre_posy),x=b.pre_rot!=b.rot;y&&b.invalidate_pos(),x&&b.invalidate_rot(),v=v.next}for(var z=this.live.begin();null!=z;){var w=z.elem(),k=!(w.posx==w.pre_posx&&w.posy==w.pre_posy),S=w.pre_rot!=w.rot;k&&w.invalidate_pos(),S&&w.invalidate_rot(),z=z.next}for(var C=null,N=this.staticsleep.begin();null!=N;){var P=N.elem();if(!P.isKinematic()||0==P.velx&&0==P.vely&&0==P.angvel){if(P.kinematicDelaySleep){P.kinematicDelaySleep=!1,N=N.next;continue}P.component.sleeping=!0,N=this.staticsleep.inlined_erase(C)}else N=(C=N).next}this.doForests(e),this.sleepArbiters(),this.midstep=!1;for(var M=null,I=this.callbackset_list.begin();null!=I;){var A=[I.elem()];if(A[0].really_empty()){I=this.callbackset_list.inlined_erase(M);var T=A[0];T.free(),T.next=Pu.zpp_pool,Pu.zpp_pool=T}else{var D=[A[0].sleeping()];J_.find_all(A[0].int1.cbSet,A[0].int2.cbSet,6,function(e,t){return function(n){if((!e[0]||n.allowSleepingCallbacks)&&!t[0].empty_arb(n.itype)){var r=i.push_callback(n);r.event=6,cu.int_callback(t[0],n,r),r.set=t[0]}}}(D,A)),I=(M=I).next}}for(;!this.callbacks.empty();){var E=this.callbacks.pop();0==E.listener.type?E.listener.body.handler(E.wrapper_body()):1==E.listener.type?E.listener.constraint.handler(E.wrapper_con()):2==E.listener.type&&E.listener.interaction.handleri(E.wrapper_int());var O=E;O.free(),O.next=Y_.zpp_pool,Y_.zpp_pool=O}},toiEvents:null,continuousCollisions:function(e){var t=2*Math.PI/e;this.bphase.broadphase(this,!1);for(var n=0;n<1&&!this.toiEvents.empty();){for(var i=null,r=2,a=!1,s=null,l=null,o=this.toiEvents.begin();null!=o;){var _=o.elem(),p=_.s1.body,u=_.s2.body;if(p.sweepFrozen&&u.sweepFrozen){if(0==_.toi||!Dp.testCollide_safe(_.s1,_.s2)){o=this.toiEvents.erase(l);var h=_;h.free(),h.next=su.zpp_pool,su.zpp_pool=h;continue}_.toi=0}if(_.frozen1!=p.sweepFrozen||_.frozen2!=u.sweepFrozen){if(_.kinematic){o=this.toiEvents.erase(l);var c=_;c.free(),c.next=su.zpp_pool,su.zpp_pool=c;continue}if(_.frozen1=p.sweepFrozen,_.frozen2=u.sweepFrozen,_.frozen1){var d=_.s1;_.s1=_.s2,_.s2=d,_.frozen1=!1,_.frozen2=!0}if(lu.staticSweep(_,e,0,lo.collisionSlopCCD),_.toi<0){o=this.toiEvents.erase(l);var m=_;m.free(),m.next=su.zpp_pool,su.zpp_pool=m;continue}}0<=_.toi&&(_.toi<r||!a&&_.kinematic)&&(r=(i=_).toi,a=_.kinematic,s=l),o=(l=o).next}if(null==i)break;this.toiEvents.erase(s),n=i.toi;var f=i.s1.body,g=i.s2.body;f.sweepFrozen||(f.sweepIntegrate(n*e),f.sweepValidate(i.s1)),g.sweepFrozen||(g.sweepIntegrate(n*e),g.sweepValidate(i.s2)),i.arbiter;var v=this.narrowPhase(i.s1,i.s2,!0,i.arbiter,!0);if(null==v?null!=i.arbiter&&null!=i.arbiter.pair&&(i.arbiter.pair.arb=null,i.arbiter.pair=null):this.presteparb(v,e,!0)||v.type==wp.COL&&v.acting()&&(v.colarb.warmStart(),v.colarb.applyImpulseVel(),v.colarb.applyImpulseVel(),v.colarb.applyImpulseVel(),v.colarb.applyImpulseVel(),f.sweep_angvel=f.angvel%t,g.sweep_angvel=g.angvel%t),null!=v&&v.acting()&&v.type==wp.COL){if(!f.sweepFrozen&&!f.isKinematic())if(f.sweepFrozen=!0,i.failed)f.angvel=f.sweep_angvel=0;else if(i.slipped){var b=f;b.sweep_angvel*=lo.angularCCDSlipScale,f.angvel=b.sweep_angvel}else f.angvel=f.sweep_angvel;if(!g.sweepFrozen&&!g.isKinematic())if(g.sweepFrozen=!0,i.failed)g.angvel=g.sweep_angvel=0;else if(i.slipped){var y=g;y.sweep_angvel*=lo.angularCCDSlipScale,g.angvel=y.sweep_angvel}else g.angvel=g.sweep_angvel}var x=i;x.free(),x.next=su.zpp_pool,su.zpp_pool=x}for(;!this.toiEvents.empty();){var z=this.toiEvents.pop_unsafe();z.free(),z.next=su.zpp_pool,su.zpp_pool=z}for(var w=this.kinematics.begin();null!=w;){var k=w.elem();k.sweepIntegrate(e),k.sweepTime=0,w=w.next}for(var S=this.live.begin();null!=S;){var C=S.elem();C.sweepFrozen||C.sweepIntegrate(e),C.sweepTime=0,S=S.next}},continuousEvent:function(e,t,n,i,r){if(e.body.sweepFrozen&&t.body.sweepFrozen)return i;if(e.body.disableCCD||t.body.disableCCD)return i;if(null!=i&&null==i.colarb||this.interactionType(e,t,e.body,t.body)<=0)return i;var a=e.body,s=t.body;if(n||a.bullet||s.bullet){var l;null==su.zpp_pool?l=new su:(l=su.zpp_pool,su.zpp_pool=l.next,l.next=null),l.alloc();var o=a.isKinematic()||s.isKinematic();if(n&&!o)e.body.isDynamic()?(l.s1=e,l.s2=t):(l.s2=e,l.s1=t),l.kinematic=!1,lu.staticSweep(l,this.pre_dt,0,lo.collisionSlopCCD);else if(l.s1=e,l.s2=t,l.kinematic=o,l.s1.body.sweepFrozen||l.s2.body.sweepFrozen){if(l.s1.body.sweepFrozen){var _=l.s1;l.s1=l.s2,l.s2=_,l.frozen1=!1,l.frozen2=!0}lu.staticSweep(l,this.pre_dt,0,lo.collisionSlopCCD)}else lu.dynamicSweep(l,this.pre_dt,0,lo.collisionSlopCCD);if(n&&l.toi<0||l.failed){var p=l;p.free(),p.next=su.zpp_pool,su.zpp_pool=p}else this.toiEvents.add(l),l.frozen1=l.s1.body.sweepFrozen,l.frozen2=l.s2.body.sweepFrozen,l.arbiter=null!=i?i.colarb:null}return i},bodyCbWake:function(e){if(e.isDynamic()&&null!=e.cbSet)if(this.midstep)for(var t=e.cbSet.bodylisteners.begin();null!=t;){var n=t.elem();if(2==n.event){var i=this.push_callback(n);i.event=2,i.body=e,t=t.next}else t=t.next}else e.component.woken=!0},bodyCbSleep:function(e){if(e.isDynamic()&&null!=e.cbSet)for(var t=e.cbSet.bodylisteners.begin();null!=t;){var n=t.elem();if(3==n.event){var i=this.push_callback(n);i.event=3,i.body=e,t=t.next}else t=t.next}},constraintCbWake:function(e){if(null!=e.cbSet)if(this.midstep)for(var t=e.cbSet.conlisteners.begin();null!=t;){var n=t.elem();if(2==n.event){var i=this.push_callback(n);i.event=2,i.constraint=e,t=t.next}else t=t.next}else e.component.woken=!0},constraintCbSleep:function(e){if(null!=e.cbSet)for(var t=e.cbSet.conlisteners.begin();null!=t;){var n=t.elem();if(3==n.event){var i=this.push_callback(n);i.event=3,i.constraint=e,t=t.next}else t=t.next}},constraintCbBreak:function(e){if(null!=e.cbSet)for(var t=e.cbSet.conlisteners.begin();null!=t;){var n=t.elem();if(4==n.event){var i=this.push_callback(n);i.event=4,i.constraint=e,t=t.next}else t=t.next}},nullListenerType:function(e,t){for(var n=new np,i=e.interactors.begin();null!=i;){var r=i.elem();n.add(r),i=i.next}if(e!=t)for(var a=t.interactors.begin();null!=a;){var s=a.elem();n.add(s),a=a.next}for(;!n.empty();){var l=n.pop_unsafe();if(l.isCompound()){for(var o=l.icompound,_=o.bodies.begin();null!=_;){var p=_.elem();n.add(p),_=_.next}for(var u=o.compounds.begin();null!=u;){var h=u.elem();n.add(h),u=u.next}}else for(var c=l.isBody()?l.ibody:l.ishape.body,d=l.isShape()?l.ishape:null,m=c.arbiters.begin();null!=m;){var f=m.elem();if(0!=f.present)if(null==d||f.ws1==d||f.ws2==d){this.MRCA_chains(f.ws1,f.ws2);for(var g=this.mrca1.begin();null!=g;){var v=g.elem();if(v.cbSet==e||v.cbSet==t){for(var b=this.mrca2.begin();null!=b;){var y=b.elem();if(v.cbSet==e&&y.cbSet!=t||v.cbSet==t&&y.cbSet!=e)b=b.next;else{var x=cu.get(v,y);if(null!=x){for(;!x.arbiters.empty();)x.arbiters.pop_unsafe().present--;this.remove_callbackset(x)}b=b.next}}g=g.next}else g=g.next}m=m.next}else m=m.next;else m=m.next}}},nullInteractorType:function(e,t){if(null==t&&(t=e),e.isCompound()){for(var n=e.icompound,i=n.bodies.begin();null!=i;){var r=i.elem();this.nullInteractorType(r,t),i=i.next}for(var a=n.compounds.begin();null!=a;){var s=a.elem();this.nullInteractorType(s,t),a=a.next}}else for(var l=e.isBody()?e.ibody:e.ishape.body,o=e.isShape()?e.ishape:null,_=l.arbiters.begin();null!=_;){var p=_.elem();if(0!=p.present)if(null==o||p.ws1==o||p.ws2==o){this.MRCA_chains(p.ws1,p.ws2);for(var u=this.mrca1.begin();null!=u;){for(var h=u.elem(),c=this.mrca2.begin();null!=c;){var d=c.elem();if(h==t||d==t){var m=cu.get(h,d);null!=m&&(p.present--,m.remove_arb(p),m.really_empty()&&this.remove_callbackset(m)),c=c.next}else c=c.next}u=u.next}_=_.next}else _=_.next;else _=_.next}},freshListenerType:function(e,t){for(var n=new np,i=e.interactors.begin();null!=i;){var r=i.elem();n.add(r),i=i.next}if(e!=t)for(var a=t.interactors.begin();null!=a;){var s=a.elem();n.add(s),a=a.next}for(;!n.empty();){var l=n.pop_unsafe();if(l.isCompound()){for(var o=l.icompound,_=o.bodies.begin();null!=_;){var p=_.elem();n.add(p),_=_.next}for(var u=o.compounds.begin();null!=u;){var h=u.elem();n.add(h),u=u.next}}else for(var c=l.isBody()?l.ibody:l.ishape.body,d=l.isShape()?l.ishape:null,m=c.arbiters.begin();null!=m;){var f=m.elem();if(f.presentable)if(null==d||f.ws1==d||f.ws2==d){this.MRCA_chains(f.ws1,f.ws2);for(var g=this.mrca1.begin();null!=g;){var v=g.elem();if(v.cbSet==e||v.cbSet==t){for(var b=this.mrca2.begin();null!=b;){var y=b.elem();if(v.cbSet==e&&y.cbSet!=t||v.cbSet==t&&y.cbSet!=e)b=b.next;else{var x=cu.get(v,y);null==x&&(x=Pu.get(v,y),this.add_callbackset(x)),x.add_arb(f)&&f.present++,b=b.next}}g=g.next}else g=g.next}m=m.next}else m=m.next;else m=m.next}}},freshInteractorType:function(e,t){if(null==t&&(t=e),e.isCompound()){for(var n=e.icompound,i=n.bodies.begin();null!=i;){var r=i.elem();this.freshInteractorType(r,t),i=i.next}for(var a=n.compounds.begin();null!=a;){var s=a.elem();this.freshInteractorType(s,t),a=a.next}}else for(var l=e.isBody()?e.ibody:e.ishape.body,o=e.isShape()?e.ishape:null,_=l.arbiters.begin();null!=_;){var p=_.elem();if(p.presentable)if(null==o||p.ws1==o||p.ws2==o){this.MRCA_chains(p.ws1,p.ws2);for(var u=this.mrca1.begin();null!=u;){for(var h=u.elem(),c=this.mrca2.begin();null!=c;){var d=c.elem();if(h==t||d==t){var m=h.cbSet,f=d.cbSet;if(m.validate(),f.validate(),!J_.empty_intersection(m,f)){var g=cu.get(h,d);null==g&&(g=Pu.get(h,d),this.add_callbackset(g)),g.add_arb(p)&&p.present++}c=c.next}else c=c.next}u=u.next}_=_.next}else _=_.next;else _=_.next}},wakeCompound:function(e){for(var t=e.bodies.begin();null!=t;){var n=t.elem();n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,!1)),t=t.next}for(var i=e.constraints.begin();null!=i;){var r=i.elem();this.wake_constraint(r),i=i.next}for(var a=e.compounds.begin();null!=a;){var s=a.elem();this.wakeCompound(s),a=a.next}},wakeIsland:function(e){for(;!e.comps.empty();){var t=e.comps.pop_unsafe();if(t.waket=this.stamp+(this.midstep?0:1),t.isBody){var n=t.body;this.live.add(n);for(var i=n.arbiters.begin();null!=i;){var r=i.elem();if(r.sleeping)if(r.sleeping=!1,r.up_stamp+=this.stamp-r.sleep_stamp,r.type==wp.COL){var a=r.colarb;a.stat?this.c_arbiters_true.inlined_add(a):this.c_arbiters_false.inlined_add(a)}else r.type==wp.FLUID?this.f_arbiters.inlined_add(r.fluidarb):this.s_arbiters.inlined_add(r.sensorarb);i=i.next}if(this.bodyCbWake(n),t.reset(),!n.isStatic())for(var s=n.shapes.begin();null!=s;){var l=s.elem();null!=l.node&&this.bphase.sync(l),s=s.next}}else{var o=t.constraint;this.live_constraints.inlined_add(o),this.constraintCbWake(o),t.reset()}}var _=e;_.free(),_.next=Cu.zpp_pool,Cu.zpp_pool=_},non_inlined_wake:function(e,t){null==t&&(t=!1);var n=e;n.world||(n.component.waket=this.stamp+(this.midstep?0:1),n.isKinematic()&&(n.kinematicDelaySleep=!0),n.component.sleeping&&this.really_wake(n,t))},really_wake:function(e,t){if(null==t&&(t=!1),null==e.component.island){e.component.sleeping=!1,e.isKinematic()||e.isStatic()?this.staticsleep.inlined_add(e):this.live.inlined_add(e);for(var n=e.constraints.begin();null!=n;){var i=n.elem();i.space==this&&this.wake_constraint(i),n=n.next}for(var r=e.arbiters.begin();null!=r;){var a=r.elem();if(a.sleeping)if(a.sleeping=!1,a.up_stamp+=this.stamp+(this.midstep?0:1)-a.sleep_stamp,a.type==wp.COL){var s=a.colarb;s.stat?this.c_arbiters_true.inlined_add(s):this.c_arbiters_false.inlined_add(s)}else a.type==wp.FLUID?this.f_arbiters.inlined_add(a.fluidarb):this.s_arbiters.inlined_add(a.sensorarb);if(a.type!=wp.SENSOR&&!a.cleared&&a.up_stamp>=this.stamp&&0!=(1&a.immState)){if(a.b1.isDynamic()&&a.b1.component.sleeping){var l=a.b1;l.world||(l.component.waket=this.stamp+(this.midstep?0:1),l.isKinematic()&&(l.kinematicDelaySleep=!0),l.component.sleeping&&this.really_wake(l,!1))}if(a.b2.isDynamic()&&a.b2.component.sleeping){var o=a.b2;o.world||(o.component.waket=this.stamp+(this.midstep?0:1),o.isKinematic()&&(o.kinematicDelaySleep=!0),o.component.sleeping&&this.really_wake(o,!1))}}r=r.next}if(!t&&e.isDynamic()&&this.bodyCbWake(e),!t&&!this.bphase.is_sweep&&!e.isStatic())for(var _=e.shapes.begin();null!=_;){var p=_.elem();null!=p.node&&this.bphase.sync(p),_=_.next}}else this.wakeIsland(e.component.island)},wake_constraint:function(e,t){return null==t&&(t=!1),!!e.active&&(e.component.waket=this.stamp+(this.midstep?0:1),!!e.component.sleeping&&(null==e.component.island?(e.component.sleeping=!1,this.live_constraints.inlined_add(e),e.wake_connected(),t||this.constraintCbWake(e)):this.wakeIsland(e.component.island),!0))},doForests:function(e){for(var t=this.c_arbiters_false.begin();null!=t;){var n=t.elem();if(!n.cleared&&n.up_stamp==this.stamp&&0!=(1&n.immState)&&n.b1.isDynamic()&&n.b2.isDynamic()){var i,r;if(n.b1.component==n.b1.component.parent)i=n.b1.component;else{for(var a=n.b1.component,s=null;a!=a.parent;){var l=a.parent;a.parent=s,s=a,a=l}for(;null!=s;){var o=s.parent;s.parent=a,s=o}i=a}if(n.b2.component==n.b2.component.parent)r=n.b2.component;else{for(var _=n.b2.component,p=null;_!=_.parent;){var u=_.parent;_.parent=p,p=_,_=u}for(;null!=p;){var h=p.parent;p.parent=_,p=h}r=_}i!=r&&(i.rank<r.rank?i.parent=r:i.rank>r.rank?r.parent=i:(r.parent=i).rank++)}t=t.next}for(var c=this.f_arbiters.begin();null!=c;){var d=c.elem();if(!d.cleared&&d.up_stamp==this.stamp&&0!=(1&d.immState)&&d.b1.isDynamic()&&d.b2.isDynamic()){var m,f;if(d.b1.component==d.b1.component.parent)m=d.b1.component;else{for(var g=d.b1.component,v=null;g!=g.parent;){var b=g.parent;g.parent=v,v=g,g=b}for(;null!=v;){var y=v.parent;v.parent=g,v=y}m=g}if(d.b2.component==d.b2.component.parent)f=d.b2.component;else{for(var x=d.b2.component,z=null;x!=x.parent;){var w=x.parent;x.parent=z,z=x,x=w}for(;null!=z;){var k=z.parent;z.parent=x,z=k}f=x}m!=f&&(m.rank<f.rank?m.parent=f:m.rank>f.rank?f.parent=m:(f.parent=m).rank++)}c=c.next}for(var S=this.live_constraints.begin();null!=S;)S.elem().forest(),S=S.next;for(;!this.live.empty();){var C,N=this.live.inlined_pop_unsafe(),P=N.component;if(P==P.parent)C=P;else{for(var M=P,I=null;M!=M.parent;){var A=M.parent;M.parent=I,I=M,M=A}for(;null!=I;){var T=I.parent;I.parent=M,I=T}C=M}null==C.island&&(null==Cu.zpp_pool?C.island=new Cu:(C.island=Cu.zpp_pool,Cu.zpp_pool=C.island.next,C.island.next=null),C.island.alloc(),this.islands.inlined_add(C.island),C.island.sleep=!0),P.island=C.island,P.island.comps.inlined_add(P);var D=N.atRest(e);P.island.sleep=P.island.sleep&&D,P.waket>P.island.waket&&(P.island.waket=P.waket)}for(;!this.live_constraints.empty();){var E,O=this.live_constraints.inlined_pop_unsafe().component;if(O==O.parent)E=O;else{for(var B=O,L=null;B!=B.parent;){var j=B.parent;B.parent=L,L=B,B=j}for(;null!=L;){var F=L.parent;L.parent=B,L=F}E=B}O.island=E.island,O.island.comps.inlined_add(O),O.waket>O.island.waket&&(O.island.waket=O.waket)}for(;!this.islands.empty();){var R=this.islands.inlined_pop_unsafe();if(R.sleep)for(var G=R.comps.begin();null!=G;){var Z=G.elem();if(Z.isBody){var U=Z.body;U.velx=0,U.vely=0,U.angvel=0,Z.sleeping=!0;for(var V=U.shapes.begin();null!=V;){var q=V.elem();this.bphase.sync(q),V=V.next}this.bodyCbSleep(U)}else{var W=Z.constraint;this.constraintCbSleep(W),Z.sleeping=!0}G=G.next}else{for(;!R.comps.empty();){var X=R.comps.inlined_pop_unsafe();X.waket=R.waket,X.isBody?this.live.inlined_add(X.body):this.live_constraints.inlined_add(X.constraint),X.reset()}var H=R;H.free(),H.next=Cu.zpp_pool,Cu.zpp_pool=H}}},sleepArbiters:function(){var e=null,t=this.c_arbiters_true,n=t.begin(),i=null!=this.c_arbiters_false;for(i&&null==n&&(i=!1,n=this.c_arbiters_false.begin(),t=this.c_arbiters_false,e=null);null!=n;){var r=n.elem();r.b1.component.sleeping&&r.b2.component.sleeping?(r.sleep_stamp=this.stamp,r.sleeping=!0,n=t.inlined_erase(e),i&&null==n&&(i=!1,n=this.c_arbiters_false.begin(),t=this.c_arbiters_false,e=null)):(n=(e=n).next,i&&null==n&&(i=!1,n=this.c_arbiters_false.begin(),t=this.c_arbiters_false,e=null))}var a=null,s=this.f_arbiters,l=s.begin(),o=!1;for(o&&null==l&&(o=!1,a=s=null);null!=l;){var _=l.elem();_.b1.component.sleeping&&_.b2.component.sleeping?(_.sleep_stamp=this.stamp,_.sleeping=!0,l=s.inlined_erase(a),o&&null==l&&(o=!1,a=s=null)):(l=(a=l).next,o&&null==l&&(o=!1,a=s=null))}var p=null,u=this.s_arbiters,h=u.begin(),c=!1;for(c&&null==h&&(c=!1,p=u=null);null!=h;){var d=h.elem();d.b1.component.sleeping&&d.b2.component.sleeping?(d.sleep_stamp=this.stamp,d.sleeping=!0,h=u.inlined_erase(p),c&&null==h&&(c=!1,p=u=null)):(h=(p=h).next,c&&null==h&&(c=!1,p=u=null))}},static_validation:function(e){e.shapes.empty()||e.validate_aabb(),e.validate_mass(),e.validate_inertia();for(var t=e.shapes.begin();null!=t;){var n=t.elem();n.isPolygon()&&(n.polygon.splice_collinear(),n.polygon.validate_gaxi()),t=t.next}e.sweepFrozen=!0},validation:function(){this.cbsets.validate();for(var e=this.live.begin();null!=e;){var t=e.elem();t.sweepRadius=0;for(var n=t.shapes.begin();null!=n;){var i=n.elem();i.isPolygon()&&(i.polygon.splice_collinear(),i.polygon.validate_gaxi()),i.validate_sweepRadius(),i.sweepRadius>t.sweepRadius&&(t.sweepRadius=i.sweepRadius),n=n.next}if(t.validate_mass(),t.validate_inertia(),t.shapes.empty()||(t.validate_aabb(),t.validate_worldCOM()),t.validate_gravMass(),t.validate_axis(),t.component.woken&&null!=t.cbSet)for(var r=t.cbSet.bodylisteners.begin();null!=r;){var a=r.elem();if(2==a.event){var s=this.push_callback(a);s.event=2,s.body=t,r=r.next}else r=r.next}t.component.woken=!1;for(var l=t.shapes.begin();null!=l;){var o=l.elem();this.bphase.sync(o),l=l.next}e=e.next}for(var _=this.kinematics.begin();null!=_;){var p=_.elem();p.sweepRadius=0;for(var u=p.shapes.begin();null!=u;){var h=u.elem();h.isPolygon()&&(h.polygon.splice_collinear(),h.polygon.validate_gaxi()),h.validate_sweepRadius(),h.sweepRadius>p.sweepRadius&&(p.sweepRadius=h.sweepRadius),u=u.next}p.validate_mass(),p.validate_inertia(),p.shapes.empty()||(p.validate_aabb(),p.validate_worldCOM()),p.validate_gravMass(),p.validate_axis();for(var c=p.shapes.begin();null!=c;){var d=c.elem();this.bphase.sync(d),c=c.next}_=_.next}for(var m=this.live_constraints.begin();null!=m;){var f=m.elem();if(f.active){if(f.component.woken&&null!=f.cbSet)for(var g=f.cbSet.conlisteners.begin();null!=g;){var v=g.elem();if(2==v.event){var b=this.push_callback(v);b.event=2,b.constraint=f,g=g.next}else g=g.next}f.component.woken=!1}m=m.next}},updateVel:function(e){for(var t=1-e*this.global_lin_drag,n=1-e*this.global_ang_drag,i=this.live.begin();null!=i;){var r=i.elem();if(0!=r.smass){var a=e*r.imass;r.velx=t*r.velx+(r.forcex+this.gravityx*r.gravMass)*a,r.vely=t*r.vely+(r.forcey+this.gravityy*r.gravMass)*a}if(0!=r.sinertia){var s,l;s=r.worldCOMx-r.posx,l=r.worldCOMy-r.posy;var o=r.torque+(this.gravityy*s-this.gravityx*l)*r.gravMass;r.angvel=n*r.angvel+o*e*r.iinertia}i=i.next}},updatePos:function(e){for(var t=2*Math.PI/e,n=this.live.begin();null!=n;){var i=n.elem();if(i.pre_posx=i.posx,i.pre_posy=i.posy,i.pre_rot=i.rot,i.sweepTime=0,i.sweep_angvel=i.angvel%t,i.sweepIntegrate(e),i.disableCCD)i.sweepFrozen=!0,i.bullet=!1;else{var r=lo.staticCCDLinearThreshold*i.sweepRadius,a=lo.staticCCDAngularThreshold;if((i.velx*i.velx+i.vely*i.vely)*e*e>r*r||i.angvel*i.angvel*e*e>a*a||i.isKinematic()){var s=i.sweep_angvel;s<0&&(s=-s);for(var l=1/s,o=i.shapes.begin();null!=o;){var _=o.elem(),u=_.aabb,h=u.minx,c=u.miny,d=u.maxx,m=u.maxy,f=p.int(s*e*_.sweepCoef*.008333333333333333);8<f&&(f=8);var g=s*e/f;i.sweepIntegrate(e),_.force_validate_aabb(),h<u.minx?u.minx=h:h=u.minx,c<u.miny?u.miny=c:c=u.miny,d>u.maxx?u.maxx=d:d=u.maxx,m>u.maxy?u.maxy=m:m=u.maxy;for(var v=1,b=f;v<b;){var y=v++;i.sweepIntegrate(g*y*l),_.force_validate_aabb(),h<u.minx?u.minx=h:h=u.minx,c<u.miny?u.miny=c:c=u.miny,d>u.maxx?u.maxx=d:d=u.maxx,m>u.maxy?u.maxy=m:m=u.maxy}this.bphase.sync(_),o=o.next}if(i.sweepFrozen=!1,i.isDynamic()&&i.bulletEnabled){var x=lo.bulletCCDLinearThreshold*i.sweepRadius,z=lo.bulletCCDAngularThreshold;((i.velx*i.velx+i.vely*i.vely)*e*e>x*x||i.angvel*i.angvel*e*e>z*z)&&(i.bullet=!0)}}else i.sweepFrozen=!0,i.bullet=!1}n=n.next}for(var w=this.kinematics.begin();null!=w;){var k=w.elem();if(k.pre_posx=k.posx,k.pre_posy=k.posy,k.pre_rot=k.rot,k.sweepTime=0,k.sweep_angvel=k.angvel%t,k.sweepIntegrate(e),k.disableCCD)k.sweepFrozen=!0,k.bullet=!1;else{var S=lo.staticCCDLinearThreshold*k.sweepRadius,C=lo.staticCCDAngularThreshold;if((k.velx*k.velx+k.vely*k.vely)*e*e>S*S||k.angvel*k.angvel*e*e>C*C||k.isKinematic()){var N=k.sweep_angvel;N<0&&(N=-N);for(var P=1/N,M=k.shapes.begin();null!=M;){var I=M.elem(),A=I.aabb,T=A.minx,D=A.miny,E=A.maxx,O=A.maxy,B=p.int(N*e*I.sweepCoef*.008333333333333333);8<B&&(B=8);var L=N*e/B;k.sweepIntegrate(e),I.force_validate_aabb(),T<A.minx?A.minx=T:T=A.minx,D<A.miny?A.miny=D:D=A.miny,E>A.maxx?A.maxx=E:E=A.maxx,O>A.maxy?A.maxy=O:O=A.maxy;for(var j=1,F=B;j<F;){var R=j++;k.sweepIntegrate(L*R*P),I.force_validate_aabb(),T<A.minx?A.minx=T:T=A.minx,D<A.miny?A.miny=D:D=A.miny,E>A.maxx?A.maxx=E:E=A.maxx,O>A.maxy?A.maxy=O:O=A.maxy}this.bphase.sync(I),M=M.next}if(k.sweepFrozen=!1,k.isDynamic()&&k.bulletEnabled){var G=lo.bulletCCDLinearThreshold*k.sweepRadius,Z=lo.bulletCCDAngularThreshold;((k.velx*k.velx+k.vely*k.vely)*e*e>G*G||k.angvel*k.angvel*e*e>Z*Z)&&(k.bullet=!0)}}else k.sweepFrozen=!0,k.bullet=!1}w=w.next}},continuous:null,presteparb:function(e,t,n){null==n&&(n=!1);var i=this;if(!e.cleared&&e.b1.component.sleeping&&e.b2.component.sleeping)return e.sleep_stamp=this.stamp,e.sleeping=!0;if(!e.cleared||0!=e.present||e.intchange){var r=!n&&e.up_stamp==this.stamp-1&&!e.cleared&&!e.intchange,a=e.fresh&&!e.cleared&&!e.intchange;if(r&&(e.endGenerated=this.stamp),a||r||e.cleared||e.intchange){this.inlined_MRCA_chains(e.ws1,e.ws2);for(var s=this.mrca1.begin();null!=s;){for(var l=s.elem(),o=this.mrca2.begin();null!=o;){var _=o.elem(),p=l.cbSet,u=_.cbSet;if(J_.empty_intersection(p,u))o=o.next;else{var h=[cu.get(l,_)];if(a||e.intchange){if(null==h[0]){var c=Pu.get(l,_);h[0]=c,this.add_callbackset(h[0])}J_.find_all(p,u,0,function(t){return function(n){if(0!=(n.itype&e.type)&&t[0].empty_arb(n.itype)){var r=i.push_callback(n);r.event=0,cu.int_callback(t[0],n,r),r.set=t[0]}}}(h)),h[0].add_arb(e)&&e.present++}else e.present--,h[0].remove_arb(e),J_.find_all(p,u,1,function(t){return function(n){if(0!=(n.itype&e.type)&&t[0].empty_arb(n.itype)){var r=i.push_callback(n);r.event=1,cu.int_callback(t[0],n,r),r.set=t[0]}}}(h)),h[0].really_empty()&&this.remove_callbackset(h[0]);o=o.next}}s=s.next}}e.fresh=!1,e.intchange=!1}if(e.cleared||e.up_stamp+(e.type==wp.COL?lo.arbiterExpirationDelay:0)<this.stamp)return e.type==wp.SENSOR?e.sensorarb.retire():e.type==wp.FLUID?e.fluidarb.retire():e.colarb.retire(),!0;var d=e.active;return e.active=e.presentable=e.up_stamp==this.stamp,0!=(1&e.immState)?e.active&&e.type!=wp.SENSOR&&(null!=e.colarb?e.colarb.preStep(t)&&(e.active=!1):e.fluidarb.preStep(this,t)):null!=e.colarb&&e.colarb.cleanupContacts()&&(e.active=!1),d!=e.active&&(e.b1.arbiters.modified=!0,e.b2.arbiters.modified=!0,this.c_arbiters_true.modified=this.c_arbiters_false.modified=!0,this.s_arbiters.modified=this.f_arbiters.modified=!0),!1},prestep:function(e){for(var t=null,n=this.live_constraints.begin();null!=n;){var i=n.elem();i.preStep(e)?(n=this.live_constraints.erase(t),i.broken(),this.constraintCbBreak(i),i.removeOnBreak?(i.component.sleeping=!0,this.midstep=!1,null!=i.compound?i.compound.wrap_constraints.remove(i.outer):this.wrap_constraints.remove(i.outer),this.midstep=!0):i.active=!1,i.clearcache()):n=(t=n).next}var r=null,a=this.c_arbiters_true,s=a.begin(),l=null!=this.c_arbiters_false;for(l&&null==s&&(l=!1,s=this.c_arbiters_false.begin(),a=this.c_arbiters_false,r=null);null!=s;){var o=s.elem();this.presteparb(o,e)?(s=a.inlined_erase(r),l&&null==s&&(l=!1,s=this.c_arbiters_false.begin(),a=this.c_arbiters_false,r=null)):(s=(r=s).next,l&&null==s&&(l=!1,s=this.c_arbiters_false.begin(),a=this.c_arbiters_false,r=null))}var _=null,p=this.f_arbiters,u=p.begin(),h=!1;for(h&&null==u&&(h=!1,_=p=null);null!=u;){var c=u.elem();this.presteparb(c,e)?(u=p.inlined_erase(_),h&&null==u&&(h=!1,_=p=null)):(u=(_=u).next,h&&null==u&&(h=!1,_=p=null))}var d=null,m=this.s_arbiters,f=m.begin(),g=!1;for(g&&null==f&&(g=!1,d=m=null);null!=f;){var v=f.elem();this.presteparb(v,e)?(f=m.inlined_erase(d),g&&null==f&&(g=!1,d=m=null)):(f=(d=f).next,g&&null==f&&(g=!1,d=m=null))}},warmStart:function(){for(var e=this.f_arbiters.begin();null!=e;){var t=e.elem();t.acting()&&t.warmStart(),e=e.next}var n=this.c_arbiters_false.begin(),i=!0;for(null==n&&(n=this.c_arbiters_true.begin(),i=!1);null!=n;){var r=n.elem();r.acting()&&r.warmStart(),n=n.next,i&&null==n&&(n=this.c_arbiters_true.begin(),i=!1)}for(var a=this.live_constraints.begin();null!=a;)a.elem().warmStart(),a=a.next},iterateVel:function(e){for(var t=0,n=e;t<n;){t++;for(var i=this.f_arbiters.begin();null!=i;){var r=i.elem();r.acting()&&r.applyImpulseVel(),i=i.next}for(var a=null,s=this.live_constraints.begin();null!=s;){var l=s.elem();l.applyImpulseVel()?(s=this.live_constraints.erase(a),l.broken(),this.constraintCbBreak(l),l.removeOnBreak?(l.component.sleeping=!0,this.midstep=!1,null!=l.compound?l.compound.wrap_constraints.remove(l.outer):this.wrap_constraints.remove(l.outer),this.midstep=!0):l.active=!1,l.clearcache()):s=(a=s).next}var o=this.c_arbiters_false.begin(),_=!0;for(null==o&&(o=this.c_arbiters_true.begin(),_=!1);null!=o;){var p=o.elem();p.acting()&&p.applyImpulseVel(),o=o.next,_&&null==o&&(o=this.c_arbiters_true.begin(),_=!1)}}},iteratePos:function(e){for(var t=0,n=e;t<n;){t++;for(var i=null,r=this.live_constraints.begin();null!=r;){var a=r.elem();!a.__velocity&&a.stiff&&a.applyImpulsePos()?(r=this.live_constraints.erase(i),a.broken(),this.constraintCbBreak(a),a.removeOnBreak?(a.component.sleeping=!0,this.midstep=!1,null!=a.compound?a.compound.wrap_constraints.remove(a.outer):this.wrap_constraints.remove(a.outer),this.midstep=!0):a.active=!1,a.clearcache()):r=(i=r).next}var s=this.c_arbiters_false.begin(),l=!0;for(null==s&&(s=this.c_arbiters_true.begin(),l=!1);null!=s;){var o=s.elem();o.acting()&&o.applyImpulsePos(),s=s.next,l&&null==s&&(s=this.c_arbiters_true.begin(),l=!1)}}},group_ignore:function(e,t){var n=e.lookup_group();if(null==n)return!1;var i=t.lookup_group();if(null==i)return!1;for(var r=!1;null!=n&&null!=i;){if(n==i){r=n.ignore;break}n.depth<i.depth?i=i.group:n=n.group}return r},interactionType:function(e,t,n,i){var r;r=!1;for(var a=n.constraints.begin();null!=a;){var s=a.elem();if(s.ignore&&s.pair_exists(n.id,i.id)){r=!0;break}a=a.next}return r||this.group_ignore(e,t)?-1:(e.sensorEnabled||t.sensorEnabled)&&e.filter.shouldSense(t.filter)?2:!e.fluidEnabled&&!t.fluidEnabled||!e.filter.shouldFlow(t.filter)||0==n.imass&&0==i.imass&&0==n.iinertia&&0==i.iinertia?!e.filter.shouldCollide(t.filter)||0==n.imass&&0==i.imass&&0==n.iinertia&&0==i.iinertia?-1:1:0},precb:null,prelisteners:null,narrowPhase:function(e,t,n,i,r){var a=this,s=null,l=e.body,o=t.body,_=this.interactionType(e,t,l,o);if(-1!=_){var p,u;e.type>t.type?(p=t,u=e):e.type==t.type?e.id<t.id?(p=e,u=t):(u=e,p=t):(p=e,u=t);var h=p==t;if(0==_){var c;if(null==i){for(var d=null,m=(l.arbiters.length<o.arbiters.length?l:o).arbiters.begin();null!=m;){var f=m.elem();if(f.id==p.id&&f.di==u.id){d=f;break}m=m.next}c=d}else c=i;var g,v=null==c,b=!1;if(v?(null==Sp.zpp_pool?g=new Sp:(g=Sp.zpp_pool,Sp.zpp_pool=g.next,g.next=null),g.alloc()):null==c.fluidarb?(c.lazyRetire(this,null),null==Sp.zpp_pool?g=new Sp:(g=Sp.zpp_pool,Sp.zpp_pool=g.next,g.next=null),g.alloc(),b=v=g.intchange=!0):g=c.fluidarb,v||g.stamp!=this.stamp||r)if(g.stamp=this.stamp,Dp.flowCollide(p,u,g)){if(g.fresh=v?(g.assign(e,t,p.id,u.id),this.f_arbiters.inlined_add(g),!b):g.up_stamp<this.stamp-1||g.endGenerated==this.stamp&&r,g.up_stamp=g.stamp,g.fresh||0==(4&g.immState)){var y=!(g.immState=1),x=g.ws1.id>g.ws2.id?g.ws2:g.ws1,z=g.ws1.id>g.ws2.id?g.ws1:g.ws2;this.inlined_MRCA_chains(x,z);for(var w=this.mrca1.begin();null!=w;){for(var k=w.elem(),S=this.mrca2.begin();null!=S;){var C=S.elem(),N=k.cbSet,P=C.cbSet;if(J_.empty_intersection(N,P))S=S.next;else{var M=null,I=null;if(this.prelisteners.inlined_clear(),J_.find_all(N,P,5,function(e){return function(t){if(0!=(4&t.itype)){var n=a.prelisteners.inlined_insert(e[0],t);e[0]=n,y=!!y||!t.pure}}}([null])),this.prelisteners.empty())S=S.next;else{if(null==(M=cu.get(k,C))&&(I=Pu.get(k,C),this.add_callbackset(I)),null==M||(M.FLUIDstamp!=this.stamp||r)&&0==(4&M.FLUIDstate)){if(null!=I&&(M=I),null!=M)for(var A=this.prelisteners.begin();null!=A;)7==A.elem().itype&&(M.COLLISIONstamp=this.stamp,M.SENSORstamp=this.stamp),M.FLUIDstamp=this.stamp,A=A.next;var T=g.active;g.active=!0,this.precb.zpp_inner.pre_arbiter=g,this.precb.zpp_inner.set=M;for(var D=this.prelisteners.begin();null!=D;){var E=D.elem();this.precb.zpp_inner.listener=E,cu.int_callback(M,E,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=k!=this.precb.zpp_inner.int1;var O=E.handlerp(this.precb);null!=O&&(g.immState=O==No.get_ACCEPT()?5:O==No.get_ACCEPT_ONCE()?1:O==No.get_IGNORE()?6:2),D=D.next}if(g.active=T,null!=M)for(var B=this.prelisteners.begin();null!=B;)7==B.elem().itype&&(M.COLLISIONstate=g.immState,M.SENSORstate=g.immState),M.FLUIDstate=g.immState,B=B.next}else null==M?0==(4&g.immState)&&(g.immState=1):g.immState=M.FLUIDstate;S=S.next}}}w=w.next}if(y&&0==(4&g.immState)){if(g.b1.isDynamic()){var L=g.b1;L.world||(L.component.waket=this.stamp+(this.midstep?0:1),L.isKinematic()&&(L.kinematicDelaySleep=!0),L.component.sleeping&&this.really_wake(L,!1))}if(g.b1.isDynamic()){var j=g.b2;j.world||(j.component.waket=this.stamp+(this.midstep?0:1),j.isKinematic()&&(j.kinematicDelaySleep=!0),j.component.sleeping&&this.really_wake(j,!1))}}}if(0!=(1&g.immState)){if(g.b1.isDynamic()&&g.b1.component.sleeping){var F=g.b1;F.world||(F.component.waket=this.stamp+(this.midstep?0:1),F.isKinematic()&&(F.kinematicDelaySleep=!0),F.component.sleeping&&this.really_wake(F,!1))}if(g.b2.isDynamic()&&g.b2.component.sleeping){var R=g.b2;R.world||(R.component.waket=this.stamp+(this.midstep?0:1),R.isKinematic()&&(R.kinematicDelaySleep=!0),R.component.sleeping&&this.really_wake(R,!1))}}g.sleeping&&(g.sleeping=!1,this.f_arbiters.inlined_add(g)),s=g}else if(v){var G=g;G.free(),G.next=Sp.zpp_pool,Sp.zpp_pool=G,s=null}else s=g;else s=g}else if(1==_){var Z,U=n?this.c_arbiters_true:this.c_arbiters_false;if(null==i){for(var V=null,q=(l.arbiters.length<o.arbiters.length?l:o).arbiters.begin();null!=q;){var W=q.elem();if(W.id==p.id&&W.di==u.id){V=W;break}q=q.next}Z=V}else Z=i;var X,H=null==Z,Y=!1;if(H?(null==Cp.zpp_pool?X=new Cp:(X=Cp.zpp_pool,Cp.zpp_pool=X.next,X.next=null),X.alloc(),X.stat=n):null==Z.colarb?(Z.lazyRetire(this,null),null==Cp.zpp_pool?X=new Cp:(X=Cp.zpp_pool,Cp.zpp_pool=X.next,X.next=null),X.alloc(),X.intchange=!0,X.stat=n,Y=H=!0):(h=p!=(X=Z.colarb).s1,X.stat!=n&&(X.stat=n,X.sleeping||((n?this.c_arbiters_false:this.c_arbiters_true).remove(X),U.add(X)))),H||X.stamp!=this.stamp||r)if(X.stamp=this.stamp,Dp.contactCollide(p,u,X,h)){if(X.fresh=H?(X.assign(e,t,p.id,u.id),U.inlined_add(X),!Y):X.up_stamp<this.stamp-1||X.endGenerated==this.stamp&&r,X.up_stamp=X.stamp,X.fresh||0==(4&X.immState)){var J=!(X.immState=1),K=X.ws1.id>X.ws2.id?X.ws2:X.ws1,Q=X.ws1.id>X.ws2.id?X.ws1:X.ws2;this.inlined_MRCA_chains(K,Q);for(var $=this.mrca1.begin();null!=$;){for(var ee=$.elem(),te=this.mrca2.begin();null!=te;){var ne=te.elem(),ie=ee.cbSet,re=ne.cbSet;if(J_.empty_intersection(ie,re))te=te.next;else{var ae=null,se=null;if(this.prelisteners.inlined_clear(),J_.find_all(ie,re,5,function(e){return function(t){if(0!=(1&t.itype)){var n=a.prelisteners.inlined_insert(e[0],t);e[0]=n,J=!!J||!t.pure}}}([null])),this.prelisteners.empty())te=te.next;else{if(null==(ae=cu.get(ee,ne))&&(se=Pu.get(ee,ne),this.add_callbackset(se)),null==ae||(ae.COLLISIONstamp!=this.stamp||r)&&0==(4&ae.COLLISIONstate)){if(null!=se&&(ae=se),null!=ae)for(var le=this.prelisteners.begin();null!=le;)7==le.elem().itype?(ae.COLLISIONstamp=this.stamp,ae.SENSORstamp=this.stamp,ae.FLUIDstamp=this.stamp):ae.COLLISIONstamp=this.stamp,le=le.next;var oe=X.active;X.active=!0,X.cleanupContacts(),this.precb.zpp_inner.pre_arbiter=X,this.precb.zpp_inner.set=ae;for(var _e=this.prelisteners.begin();null!=_e;){var pe=_e.elem();this.precb.zpp_inner.listener=pe,cu.int_callback(ae,pe,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=ee!=this.precb.zpp_inner.int1;var ue=pe.handlerp(this.precb);null!=ue&&(X.immState=ue==No.get_ACCEPT()?5:ue==No.get_ACCEPT_ONCE()?1:ue==No.get_IGNORE()?6:2),_e=_e.next}if(X.active=oe,null!=ae)for(var he=this.prelisteners.begin();null!=he;)7==he.elem().itype?(ae.COLLISIONstate=X.immState,ae.SENSORstate=X.immState,ae.FLUIDstate=X.immState):ae.COLLISIONstate=X.immState,he=he.next}else null==ae?0==(4&X.immState)&&(X.immState=1):X.immState=ae.COLLISIONstate;te=te.next}}}$=$.next}if(J&&0==(4&X.immState)){if(X.b1.isDynamic()){var ce=X.b1;ce.world||(ce.component.waket=this.stamp+(this.midstep?0:1),ce.isKinematic()&&(ce.kinematicDelaySleep=!0),ce.component.sleeping&&this.really_wake(ce,!1))}if(X.b1.isDynamic()){var de=X.b2;de.world||(de.component.waket=this.stamp+(this.midstep?0:1),de.isKinematic()&&(de.kinematicDelaySleep=!0),de.component.sleeping&&this.really_wake(de,!1))}}}if(0!=(1&X.immState)){if(X.b1.isDynamic()&&X.b1.component.sleeping){var me=X.b1;me.world||(me.component.waket=this.stamp+(this.midstep?0:1),me.isKinematic()&&(me.kinematicDelaySleep=!0),me.component.sleeping&&this.really_wake(me,!1))}if(X.b2.isDynamic()&&X.b2.component.sleeping){var fe=X.b2;fe.world||(fe.component.waket=this.stamp+(this.midstep?0:1),fe.isKinematic()&&(fe.kinematicDelaySleep=!0),fe.component.sleeping&&this.really_wake(fe,!1))}}X.sleeping&&(X.sleeping=!1,U.inlined_add(X)),s=X}else if(H){var ge=X;ge.free(),ge.next=Cp.zpp_pool,Cp.zpp_pool=ge,s=null}else s=X;else s=X}else{var ve;if(null==i){for(var be=null,ye=(l.arbiters.length<o.arbiters.length?l:o).arbiters.begin();null!=ye;){var xe=ye.elem();if(xe.id==p.id&&xe.di==u.id){be=xe;break}ye=ye.next}ve=be}else ve=i;var ze,we=null==ve,ke=!1;if(we?(null==kp.zpp_pool?ze=new kp:(ze=kp.zpp_pool,kp.zpp_pool=ze.next,ze.next=null),ze.alloc()):null==ve.sensorarb?(ve.lazyRetire(this,null),null==kp.zpp_pool?ze=new kp:(ze=kp.zpp_pool,kp.zpp_pool=ze.next,ze.next=null),ze.alloc(),ke=we=ze.intchange=!0):ze=ve.sensorarb,we||ze.stamp!=this.stamp||r)if(ze.stamp=this.stamp,Dp.testCollide(p,u)){if(ze.fresh=we?(ze.assign(e,t,p.id,u.id),this.s_arbiters.inlined_add(ze),!ke):ze.up_stamp<this.stamp-1||ze.endGenerated==this.stamp&&r,ze.up_stamp=ze.stamp,ze.fresh||0==(4&ze.immState)){var Se=!(ze.immState=1),Ce=ze.ws1.id>ze.ws2.id?ze.ws2:ze.ws1,Ne=ze.ws1.id>ze.ws2.id?ze.ws1:ze.ws2;this.inlined_MRCA_chains(Ce,Ne);for(var Pe=this.mrca1.begin();null!=Pe;){for(var Me=Pe.elem(),Ie=this.mrca2.begin();null!=Ie;){var Ae=Ie.elem(),Te=Me.cbSet,De=Ae.cbSet;if(J_.empty_intersection(Te,De))Ie=Ie.next;else{var Ee=null,Oe=null;if(this.prelisteners.inlined_clear(),J_.find_all(Te,De,5,function(e){return function(t){if(0!=(2&t.itype)){var n=a.prelisteners.inlined_insert(e[0],t);e[0]=n,Se=!!Se||!t.pure}}}([null])),this.prelisteners.empty())Ie=Ie.next;else{if(null==(Ee=cu.get(Me,Ae))&&(Oe=Pu.get(Me,Ae),this.add_callbackset(Oe)),null==Ee||(Ee.SENSORstamp!=this.stamp||r)&&0==(4&Ee.SENSORstate)){if(null!=Oe&&(Ee=Oe),null!=Ee)for(var Be=this.prelisteners.begin();null!=Be;)7==Be.elem().itype?(Ee.COLLISIONstamp=this.stamp,Ee.SENSORstamp=this.stamp,Ee.FLUIDstamp=this.stamp):Ee.SENSORstamp=this.stamp,Be=Be.next;var Le=ze.active;ze.active=!0,this.precb.zpp_inner.pre_arbiter=ze,this.precb.zpp_inner.set=Ee;for(var je=this.prelisteners.begin();null!=je;){var Fe=je.elem();this.precb.zpp_inner.listener=Fe,cu.int_callback(Ee,Fe,this.precb.zpp_inner),this.precb.zpp_inner.pre_swapped=Me!=this.precb.zpp_inner.int1;var Re=Fe.handlerp(this.precb);null!=Re&&(ze.immState=Re==No.get_ACCEPT()?5:Re==No.get_ACCEPT_ONCE()?1:Re==No.get_IGNORE()?6:2),je=je.next}if(ze.active=Le,null!=Ee)for(var Ge=this.prelisteners.begin();null!=Ge;)7==Ge.elem().itype?(Ee.COLLISIONstate=ze.immState,Ee.SENSORstate=ze.immState,Ee.FLUIDstate=ze.immState):Ee.SENSORstate=ze.immState,Ge=Ge.next}else null==Ee?0==(4&ze.immState)&&(ze.immState=1):ze.immState=Ee.SENSORstate;Ie=Ie.next}}}Pe=Pe.next}if(Se&&0==(4&ze.immState)){if(!ze.b1.isStatic()){var Ze=ze.b1;Ze.world||(Ze.component.waket=this.stamp+(this.midstep?0:1),Ze.isKinematic()&&(Ze.kinematicDelaySleep=!0),Ze.component.sleeping&&this.really_wake(Ze,!1))}if(!ze.b2.isStatic()){var Ue=ze.b2;Ue.world||(Ue.component.waket=this.stamp+(this.midstep?0:1),Ue.isKinematic()&&(Ue.kinematicDelaySleep=!0),Ue.component.sleeping&&this.really_wake(Ue,!1))}}}ze.sleeping&&(ze.sleeping=!1,this.s_arbiters.inlined_add(ze)),s=ze}else if(we){var Ve=ze;Ve.free(),Ve.next=kp.zpp_pool,kp.zpp_pool=Ve,s=null}else s=ze;else s=ze}}return s},mrca1:null,mrca2:null,MRCA_chains:function(e,t){this.inlined_MRCA_chains(e,t)},inlined_MRCA_chains:function(e,t){this.mrca1.inlined_clear(),this.mrca2.inlined_clear(),null!=e.cbSet&&this.mrca1.inlined_add(e),null!=e.body.cbSet&&this.mrca1.inlined_add(e.body),null!=t.cbSet&&this.mrca2.inlined_add(t),null!=t.body.cbSet&&this.mrca2.inlined_add(t.body);for(var n=e.body.compound,i=t.body.compound;n!=i;)(null==n?0:n.depth)<(null==i?0:i.depth)?(null!=i.cbSet&&this.mrca2.inlined_add(i),i=i.compound):(null!=n.cbSet&&this.mrca1.inlined_add(n),n=n.compound)},__class__:Iu};var Au=function(){this.aabb=null,this.shape=null,this.prev=null,this.next=null};(n["zpp_nape.space.ZPP_SweepData"]=Au).__name__=["zpp_nape","space","ZPP_SweepData"],Au.prototype={next:null,prev:null,shape:null,aabb:null,free:function(){this.prev=null,this.shape=null,this.aabb=null},alloc:function(){},gt:function(e){return this.aabb.minx>e.aabb.minx},__class__:Au};var Tu=function(e){this.failed=null,this.list=null,xu.call(this),this.space=e,this.is_sweep=!0,this.sweep=this};(n["zpp_nape.space.ZPP_SweepPhase"]=Tu).__name__=["zpp_nape","space","ZPP_SweepPhase"],Tu.__super__=xu,Tu.prototype=r(xu.prototype,{list:null,__insert:function(e){var t;null==Au.zpp_pool?t=new Au:(t=Au.zpp_pool,Au.zpp_pool=t.next,t.next=null),t.alloc(),(e.sweep=t).shape=e,t.aabb=e.aabb,t.next=this.list,null!=this.list&&(this.list.prev=t),this.list=t},__remove:function(e){var t=e.sweep;null==t.prev?this.list=t.next:t.prev.next=t.next,null!=t.next&&(t.next.prev=t.prev),e.sweep=null;var n=t;n.free(),n.next=Au.zpp_pool,Au.zpp_pool=n},__sync:function(e){this.space.continuous||e.validate_aabb()},sync_broadphase:function(){this.space.validation(),null!=this.list&&this.sync_broadphase_fast()},sync_broadphase_fast:function(){for(var e=this.list.next;null!=e;){var t=e.next,n=e.prev;if(e.gt(n))e=t;else{for(;null!=n.prev&&n.prev.gt(e);)n=n.prev;var i=e.prev;i.next=e.next,null!=e.next&&(e.next.prev=i),null==n.prev?(e.prev=null,((this.list=e).next=n).prev=e):(e.prev=n.prev,((n.prev=e).prev.next=e).next=n),e=t}}},broadphase:function(e,t){if(null!=this.list){this.sync_broadphase_fast();for(var n=this.list;null!=n;){for(var i=n.next,r=n.shape,a=r.body,s=n.aabb.maxx;null!=i&&!(i.aabb.minx>s);){var l=i.shape,o=l.body;o!=a&&(a.isStatic()&&o.isStatic()||a.component.sleeping&&o.component.sleeping||r.aabb.intersectY(l.aabb)&&(t?e.narrowPhase(r,l,!a.isDynamic()||!o.isDynamic(),null,!1):e.continuousEvent(r,l,!a.isDynamic()||!o.isDynamic(),null,!1))),i=i.next}n=n.next}}},clear:function(){for(;null!=this.list;)this.list.shape.removedFromSpace(),this.__remove(this.list.shape)},shapesUnderPoint:function(e,t,n,i){this.sync_broadphase();for(var r=pu.get(e,t),a=null==i?new R_:i,s=this.list;null!=s&&s.aabb.minx>e;)s=s.next;for(;null!=s&&s.aabb.minx<=e;){if(s.aabb.maxx>=e&&s.aabb.miny<=t&&s.aabb.maxy>=t){var l=s.shape;(null==n||l.filter.shouldCollide(n))&&(l.isCircle()?Dp.circleContains(l.circle,r)&&a.push(l.outer):Dp.polyContains(l.polygon,r)&&a.push(l.outer))}s=s.next}var o=r;return o.free(),o.next=pu.zpp_pool,pu.zpp_pool=o,a},bodiesUnderPoint:function(e,t,n,i){this.sync_broadphase();for(var r=pu.get(e,t),a=null==i?new z_:i,s=this.list;null!=s&&s.aabb.minx>e;)s=s.next;for(;null!=s&&s.aabb.minx<=e;){if(s.aabb.maxx>=e&&s.aabb.miny<=t&&s.aabb.maxy>=t){var l=s.shape,o=l.body.outer;a.has(o)||(null==n||l.filter.shouldCollide(n))&&(l.isCircle()?Dp.circleContains(l.circle,r)&&a.push(o):Dp.polyContains(l.polygon,r)&&a.push(o))}s=s.next}var _=r;return _.free(),_.next=pu.zpp_pool,pu.zpp_pool=_,a},shapesInAABB:function(e,t,n,i,r){this.sync_broadphase(),this.updateAABBShape(e);for(var a=this.aabbShape.zpp_inner.aabb,s=null==r?new R_:r,l=this.list;null!=l&&l.aabb.maxx<a.minx;)l=l.next;for(;null!=l&&l.aabb.minx<=a.maxx;){var o=l.shape;(null==i||o.filter.shouldCollide(i))&&(t?n?Dp.containTest(this.aabbShape.zpp_inner,o)&&s.push(o.outer):(a.contains(l.aabb)||l.aabb.intersect(a)&&Dp.testCollide_safe(o,this.aabbShape.zpp_inner))&&s.push(o.outer):(n?a.contains(l.aabb):l.aabb.intersect(a))&&s.push(o.outer)),l=l.next}return s},failed:null,bodiesInAABB:function(e,t,n,i,r){this.sync_broadphase(),this.updateAABBShape(e);var a=this.aabbShape.zpp_inner.aabb,s=null==r?new z_:r;null==this.failed&&(this.failed=new z_);for(var l=this.list;null!=l&&l.aabb.maxx<a.minx;)l=l.next;for(;null!=l&&l.aabb.minx<=a.maxx;){var o=l.shape,_=o.body.outer;if(l.aabb.intersect(a)&&(null==i||o.filter.shouldCollide(i)))if(t)if(n){if(!this.failed.has(_)){var p=Dp.containTest(this.aabbShape.zpp_inner,o);!s.has(_)&&p?s.push(_):p||(s.remove(_),this.failed.push(_))}}else!s.has(_)&&Dp.testCollide_safe(o,this.aabbShape.zpp_inner)&&s.push(_);else if(n){if(!this.failed.has(_)){var u=a.contains(o.aabb);!s.has(_)&&u?s.push(_):u||(s.remove(_),this.failed.push(_))}}else!s.has(_)&&a.contains(o.aabb)&&s.push(_);l=l.next}return this.failed.clear(),s},shapesInCircle:function(e,t,n,i,r,a){this.sync_broadphase(),this.updateCircShape(e,t,n);for(var s=this.circShape.zpp_inner.aabb,l=null==a?new R_:a,o=this.list;null!=o&&o.aabb.maxx<s.minx;)o=o.next;for(;null!=o&&o.aabb.minx<=s.maxx;){if(o.aabb.intersect(s)){var _=o.shape;(null==r||_.filter.shouldCollide(r))&&(i?Dp.containTest(this.circShape.zpp_inner,_)&&l.push(_.outer):Dp.testCollide_safe(_,this.circShape.zpp_inner)&&l.push(_.outer))}o=o.next}return l},bodiesInCircle:function(e,t,n,i,r,a){this.sync_broadphase(),this.updateCircShape(e,t,n);var s=this.circShape.zpp_inner.aabb,l=null==a?new z_:a;null==this.failed&&(this.failed=new z_);for(var o=this.list;null!=o&&o.aabb.maxx<s.minx;)o=o.next;for(;null!=o&&o.aabb.minx<=s.maxx;){if(o.aabb.intersect(s)){var _=o.shape,p=_.body.outer;if(null==r||_.filter.shouldCollide(r))if(i){if(!this.failed.has(p)){var u=Dp.containTest(this.circShape.zpp_inner,_);!l.has(p)&&u?l.push(p):u||(l.remove(p),this.failed.push(p))}}else!l.has(p)&&Dp.testCollide_safe(_,this.circShape.zpp_inner)&&l.push(p)}o=o.next}return this.failed.clear(),l},shapesInShape:function(e,t,n,i){this.sync_broadphase(),this.validateShape(e);for(var r=e.aabb,a=null==i?new R_:i,s=this.list;null!=s&&s.aabb.maxx<r.minx;)s=s.next;for(;null!=s&&s.aabb.minx<=r.maxx;){if(s.aabb.intersect(r)){var l=s.shape;(null==n||l.filter.shouldCollide(n))&&(t?Dp.containTest(e,l)&&a.push(l.outer):Dp.testCollide_safe(l,e)&&a.push(l.outer))}s=s.next}return a},bodiesInShape:function(e,t,n,i){this.sync_broadphase(),this.validateShape(e);var r=e.aabb,a=null==i?new z_:i;null==this.failed&&(this.failed=new z_);for(var s=this.list;null!=s&&s.aabb.maxx<r.minx;)s=s.next;for(;null!=s&&s.aabb.minx<=r.maxx;){if(s.aabb.intersect(r)){var l=s.shape,o=l.body.outer;if(null==n||l.filter.shouldCollide(n))if(t){if(!this.failed.has(o)){var _=Dp.containTest(e,l);!a.has(o)&&_?a.push(o):_||(a.remove(o),this.failed.push(o))}}else!a.has(o)&&Dp.testCollide_safe(e,l)&&a.push(o)}s=s.next}return this.failed.clear(),a},rayCast:function(e,t,n){this.sync_broadphase(),e.validate_dir();var i=e.rayAABB(),r=e.maxdist,a=null;if(0==e.dirx)for(var s=this.list;null!=s&&s.aabb.minx<=i.minx;){if(s.aabb.intersect(i)&&(null==n||s.shape.filter.shouldCollide(n))){var l=e.aabbsect(s.aabb);if(0<=l&&l<r){var o=s.shape.isCircle()?e.circlesect(s.shape.circle,t,r):e.polysect(s.shape.polygon,t,r);null!=o&&(r=o.get_distance(),null!=a&&a.dispose(),a=o)}}s=s.next}else if(e.dirx<0){for(var _=this.list,p=null;null!=_&&_.aabb.minx<=i.maxx;)_=(p=_).next;for(_=p;null!=_;){if(_.aabb.intersect(i)&&(null==n||_.shape.filter.shouldCollide(n))){var u=e.aabbsect(_.aabb);if(0<=u&&u<r){var h=_.shape.isCircle()?e.circlesect(_.shape.circle,t,r):e.polysect(_.shape.polygon,t,r);null!=h&&(r=h.get_distance(),null!=a&&a.dispose(),a=h)}}_=_.prev}}else for(var c=this.list;null!=c&&c.aabb.minx<=i.maxx&&c.aabb.minx<e.originx+e.dirx*r;){if(c.aabb.intersect(i)&&(null==n||c.shape.filter.shouldCollide(n))){var d=e.aabbsect(c.aabb);if(0<=d&&d<r){var m=c.shape.isCircle()?e.circlesect(c.shape.circle,t,r):e.polysect(c.shape.polygon,t,r);null!=m&&(r=m.get_distance(),null!=a&&a.dispose(),a=m)}}c=c.next}var f=i;return f.free(),f.next=Ap.zpp_pool,Ap.zpp_pool=f,a},rayMultiCast:function(e,t,n,i){this.sync_broadphase(),e.validate_dir();var r=e.rayAABB(),a=null==i?new c_:i;if(0==e.dirx)for(var s=this.list;null!=s&&s.aabb.minx<=r.minx;)s.aabb.intersect(r)&&(null==n||s.shape.filter.shouldCollide(n))&&0<=e.aabbsect(s.aabb)&&(s.shape.isCircle()?e.circlesect2(s.shape.circle,t,a):e.polysect2(s.shape.polygon,t,a)),s=s.next;else if(e.dirx<0){for(var l=this.list,o=null;null!=l&&l.aabb.minx<=r.maxx;)l=(o=l).next;for(l=o;null!=l;)l.aabb.intersect(r)&&(null==n||l.shape.filter.shouldCollide(n))&&0<=e.aabbsect(l.aabb)&&(l.shape.isCircle()?e.circlesect2(l.shape.circle,t,a):e.polysect2(l.shape.polygon,t,a)),l=l.prev}else for(var _=this.list;null!=_&&_.aabb.minx<=r.maxx;)_.aabb.intersect(r)&&(null==n||_.shape.filter.shouldCollide(n))&&0<=e.aabbsect(_.aabb)&&(_.shape.isCircle()?e.circlesect2(_.shape.circle,t,a):e.polysect2(_.shape.polygon,t,a)),_=_.next;var p=r;return p.free(),p.next=Ap.zpp_pool,Ap.zpp_pool=p,a},__class__:Tu});var Du=function(e,t){this.width=0,this.list=null,this.width=e,this.list=[]};(n["zpp_nape.util.ZNPArray2_Float"]=Du).__name__=["zpp_nape","util","ZNPArray2_Float"],Du.prototype={list:null,width:null,resize:function(e,t,n){for(var i=0,r=(this.width=e)*t;i<r;){var a=i++;this.list[a]=n}},get:function(e,t){return this.list[t*this.width+e]},set:function(e,t,n){return this.list[t*this.width+e]=n},__class__:Du};var Eu=function(e,t){this.width=0,this.list=null,this.width=e,this.list=[]};(n["zpp_nape.util.ZNPArray2_ZPP_GeomVert"]=Eu).__name__=["zpp_nape","util","ZNPArray2_ZPP_GeomVert"],Eu.prototype={list:null,width:null,resize:function(e,t,n){for(var i=0,r=(this.width=e)*t;i<r;){var a=i++;this.list[a]=n}},get:function(e,t){return this.list[t*this.width+e]},set:function(e,t,n){return this.list[t*this.width+e]=n},__class__:Eu};var Ou=function(e,t){this.width=0,this.list=null,this.width=e,this.list=[]};(n["zpp_nape.util.ZNPArray2_ZPP_MarchPair"]=Ou).__name__=["zpp_nape","util","ZNPArray2_ZPP_MarchPair"],Ou.prototype={list:null,width:null,resize:function(e,t,n){for(var i=0,r=(this.width=e)*t;i<r;){var a=i++;this.list[a]=n}},get:function(e,t){return this.list[t*this.width+e]},set:function(e,t,n){return this.list[t*this.width+e]=n},__class__:Ou};var Bu=function(){this.di=0,this.id=0,this.hnext=null,this.next=null,this.value=!1};(n["zpp_nape.util.Hashable2_Boolfalse"]=Bu).__name__=["zpp_nape","util","Hashable2_Boolfalse"],Bu.get=function(e,t,n){var i=Bu.getpersist(e,t);return i.value=n,i},Bu.getpersist=function(e,t){var n;return null==Bu.zpp_pool?n=new Bu:(n=Bu.zpp_pool,Bu.zpp_pool=n.next,n.next=null),n.alloc(),n.id=e,n.di=t,n},Bu.ordered_get=function(e,t,n){return e<=t?Bu.get(e,t,n):Bu.get(t,e,n)},Bu.ordered_get_persist=function(e,t){return e<=t?Bu.getpersist(e,t):Bu.getpersist(t,e)},Bu.prototype={value:null,next:null,hnext:null,id:null,di:null,free:function(){},alloc:function(){},__class__:Bu};var Lu=function(){this.cnt=0,this.table=null,this.cnt=0,this.table=[];for(var e=0;e<1048576;)e++,this.table.push(null)};(n["zpp_nape.util.FastHash2_Hashable2_Boolfalse"]=Lu).__name__=["zpp_nape","util","FastHash2_Hashable2_Boolfalse"],Lu.prototype={table:null,cnt:null,empty:function(){return 0==this.cnt},clear:function(){for(var e=0,t=this.table.length;e<t;){var n=e++,i=this.table[n];if(null!=i){for(;null!=i;){var r=i.hnext;i.hnext=null,i=r}this.table[n]=null}}},get:function(e,t){var n=this.table[this.hash(e,t)];if(null==n)return null;if(n.id==e&&n.di==t)return n;for(;null!=(n=n.hnext)&&(n.id!=e||n.di!=t););return n},ordered_get:function(e,t){if(t<e){var n=e;e=t,t=n}return this.get(e,t)},has:function(e,t){var n=this.table[this.hash(e,t)];if(null==n)return!1;if(n.id==e&&n.di==t)return!0;for(;null!=(n=n.hnext)&&(n.id!=e||n.di!=t););return null!=n},maybeAdd:function(e){var t=this.hash(e.id,e.di),n=this.table[t];null==n?(this.table[t]=e).hnext=null:(e.hnext=n.hnext,n.hnext=e),this.cnt++},add:function(e){var t=this.hash(e.id,e.di),n=this.table[t];null==n?(this.table[t]=e).hnext=null:(e.hnext=n.hnext,n.hnext=e),this.cnt++},remove:function(e){var t=this.hash(e.id,e.di),n=this.table[t];if(n==e)this.table[t]=n.hnext;else if(null!=n){for(var i;null!=(n=(i=n).hnext)&&n!=e;);i.hnext=n.hnext}e.hnext=null,this.cnt--},hash:function(e,t){return 106039*e+t&1048575},__class__:Lu};var ju=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CallbackSet"]=ju).__name__=["zpp_nape","util","ZNPList_ZPP_CallbackSet"],ju.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==hh.zpp_pool?t=new hh:(t=hh.zpp_pool,hh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==hh.zpp_pool?n=new hh:(n=hh.zpp_pool,hh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=hh.zpp_pool,hh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=hh.zpp_pool,hh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ju};var Fu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Shape"]=Fu).__name__=["zpp_nape","util","ZNPList_ZPP_Shape"],Fu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==ch.zpp_pool?t=new ch:(t=ch.zpp_pool,ch.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==ch.zpp_pool?n=new ch:(n=ch.zpp_pool,ch.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=ch.zpp_pool,ch.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=ch.zpp_pool,ch.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Fu};var Ru=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Body"]=Ru).__name__=["zpp_nape","util","ZNPList_ZPP_Body"],Ru.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==dh.zpp_pool?t=new dh:(t=dh.zpp_pool,dh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==dh.zpp_pool?n=new dh:(n=dh.zpp_pool,dh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=dh.zpp_pool,dh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=dh.zpp_pool,dh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Ru};var Gu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Compound"]=Gu).__name__=["zpp_nape","util","ZNPList_ZPP_Compound"],Gu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==fh.zpp_pool?t=new fh:(t=fh.zpp_pool,fh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==fh.zpp_pool?n=new fh:(n=fh.zpp_pool,fh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=fh.zpp_pool,fh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=fh.zpp_pool,fh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Gu};var Zu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Arbiter"]=Zu).__name__=["zpp_nape","util","ZNPList_ZPP_Arbiter"],Zu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==xh.zpp_pool?t=new xh:(t=xh.zpp_pool,xh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==xh.zpp_pool?n=new xh:(n=xh.zpp_pool,xh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=xh.zpp_pool,xh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=xh.zpp_pool,xh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Zu};var Uu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CbSetPair"]=Uu).__name__=["zpp_nape","util","ZNPList_ZPP_CbSetPair"],Uu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==wh.zpp_pool?t=new wh:(t=wh.zpp_pool,wh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==wh.zpp_pool?n=new wh:(n=wh.zpp_pool,wh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=wh.zpp_pool,wh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=wh.zpp_pool,wh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Uu};var Vu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CutInt"]=Vu).__name__=["zpp_nape","util","ZNPList_ZPP_CutInt"],Vu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==kh.zpp_pool?t=new kh:(t=kh.zpp_pool,kh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==kh.zpp_pool?n=new kh:(n=kh.zpp_pool,kh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=kh.zpp_pool,kh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=kh.zpp_pool,kh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Vu};var qu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_CutVert"]=qu).__name__=["zpp_nape","util","ZNPList_ZPP_CutVert"],qu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Sh.zpp_pool?t=new Sh:(t=Sh.zpp_pool,Sh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Sh.zpp_pool?n=new Sh:(n=Sh.zpp_pool,Sh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Sh.zpp_pool,Sh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Sh.zpp_pool,Sh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:qu};var Wu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_PartitionVertex"]=Wu).__name__=["zpp_nape","util","ZNPList_ZPP_PartitionVertex"],Wu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Ch.zpp_pool?t=new Ch:(t=Ch.zpp_pool,Ch.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Ch.zpp_pool?n=new Ch:(n=Ch.zpp_pool,Ch.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Ch.zpp_pool,Ch.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Ch.zpp_pool,Ch.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Wu};var Xu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_PartitionedPoly"]=Xu).__name__=["zpp_nape","util","ZNPList_ZPP_PartitionedPoly"],Xu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Nh.zpp_pool?t=new Nh:(t=Nh.zpp_pool,Nh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Nh.zpp_pool?n=new Nh:(n=Nh.zpp_pool,Nh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Nh.zpp_pool,Nh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Nh.zpp_pool,Nh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Xu};var Hu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_GeomVert"]=Hu).__name__=["zpp_nape","util","ZNPList_ZPP_GeomVert"],Hu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Ph.zpp_pool?t=new Ph:(t=Ph.zpp_pool,Ph.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Ph.zpp_pool?n=new Ph:(n=Ph.zpp_pool,Ph.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Ph.zpp_pool,Ph.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Ph.zpp_pool,Ph.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Hu};var Yu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_SimplifyP"]=Yu).__name__=["zpp_nape","util","ZNPList_ZPP_SimplifyP"],Yu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Mh.zpp_pool?t=new Mh:(t=Mh.zpp_pool,Mh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Mh.zpp_pool?n=new Mh:(n=Mh.zpp_pool,Mh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Mh.zpp_pool,Mh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Mh.zpp_pool,Mh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Yu};var Ju=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_SimpleVert"]=Ju).__name__=["zpp_nape","util","ZNPList_ZPP_SimpleVert"],Ju.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Ih.zpp_pool?t=new Ih:(t=Ih.zpp_pool,Ih.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Ih.zpp_pool?n=new Ih:(n=Ih.zpp_pool,Ih.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Ih.zpp_pool,Ih.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Ih.zpp_pool,Ih.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Ju};var Ku=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_SimpleEvent"]=Ku).__name__=["zpp_nape","util","ZNPList_ZPP_SimpleEvent"],Ku.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Ah.zpp_pool?t=new Ah:(t=Ah.zpp_pool,Ah.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Ah.zpp_pool?n=new Ah:(n=Ah.zpp_pool,Ah.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Ah.zpp_pool,Ah.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Ah.zpp_pool,Ah.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Ku};var Qu=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_AABBPair"]=Qu).__name__=["zpp_nape","util","ZNPList_ZPP_AABBPair"],Qu.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Th.zpp_pool?t=new Th:(t=Th.zpp_pool,Th.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Th.zpp_pool?n=new Th:(n=Th.zpp_pool,Th.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Th.zpp_pool,Th.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Th.zpp_pool,Th.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:Qu};var $u=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Edge"]=$u).__name__=["zpp_nape","util","ZNPList_ZPP_Edge"],$u.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Dh.zpp_pool?t=new Dh:(t=Dh.zpp_pool,Dh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Dh.zpp_pool?n=new Dh:(n=Dh.zpp_pool,Dh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Dh.zpp_pool,Dh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Dh.zpp_pool,Dh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:$u};var eh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Component"]=eh).__name__=["zpp_nape","util","ZNPList_ZPP_Component"],eh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Oh.zpp_pool?t=new Oh:(t=Oh.zpp_pool,Oh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Oh.zpp_pool?n=new Oh:(n=Oh.zpp_pool,Oh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Oh.zpp_pool,Oh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Oh.zpp_pool,Oh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:eh};var th=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_AABBNode"]=th).__name__=["zpp_nape","util","ZNPList_ZPP_AABBNode"],th.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Bh.zpp_pool?t=new Bh:(t=Bh.zpp_pool,Bh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Bh.zpp_pool?n=new Bh:(n=Bh.zpp_pool,Bh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Bh.zpp_pool,Bh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Bh.zpp_pool,Bh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:th};var nh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_InteractionGroup"]=nh).__name__=["zpp_nape","util","ZNPList_ZPP_InteractionGroup"],nh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Lh.zpp_pool?t=new Lh:(t=Lh.zpp_pool,Lh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Lh.zpp_pool?n=new Lh:(n=Lh.zpp_pool,Lh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Lh.zpp_pool,Lh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Lh.zpp_pool,Lh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:nh};var ih=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_FluidArbiter"]=ih).__name__=["zpp_nape","util","ZNPList_ZPP_FluidArbiter"],ih.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==jh.zpp_pool?t=new jh:(t=jh.zpp_pool,jh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==jh.zpp_pool?n=new jh:(n=jh.zpp_pool,jh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=jh.zpp_pool,jh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=jh.zpp_pool,jh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ih};var rh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_SensorArbiter"]=rh).__name__=["zpp_nape","util","ZNPList_ZPP_SensorArbiter"],rh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Fh.zpp_pool?t=new Fh:(t=Fh.zpp_pool,Fh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Fh.zpp_pool?n=new Fh:(n=Fh.zpp_pool,Fh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Fh.zpp_pool,Fh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Fh.zpp_pool,Fh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:rh};var ah=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_ColArbiter"]=ah).__name__=["zpp_nape","util","ZNPList_ZPP_ColArbiter"],ah.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Rh.zpp_pool?t=new Rh:(t=Rh.zpp_pool,Rh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Rh.zpp_pool?n=new Rh:(n=Rh.zpp_pool,Rh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Rh.zpp_pool,Rh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Rh.zpp_pool,Rh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ah};var sh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_Listener"]=sh).__name__=["zpp_nape","util","ZNPList_ZPP_Listener"],sh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Gh.zpp_pool?t=new Gh:(t=Gh.zpp_pool,Gh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Gh.zpp_pool?n=new Gh:(n=Gh.zpp_pool,Gh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Gh.zpp_pool,Gh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Gh.zpp_pool,Gh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:sh};var lh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_ToiEvent"]=lh).__name__=["zpp_nape","util","ZNPList_ZPP_ToiEvent"],lh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Zh.zpp_pool?t=new Zh:(t=Zh.zpp_pool,Zh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Zh.zpp_pool?n=new Zh:(n=Zh.zpp_pool,Zh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Zh.zpp_pool,Zh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Zh.zpp_pool,Zh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:lh};var oh=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ConvexResult"]=oh).__name__=["zpp_nape","util","ZNPList_ConvexResult"],oh.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Uh.zpp_pool?t=new Uh:(t=Uh.zpp_pool,Uh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Uh.zpp_pool?n=new Uh:(n=Uh.zpp_pool,Uh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Uh.zpp_pool,Uh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Uh.zpp_pool,Uh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:oh};var _h=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_ZPP_GeomPoly"]=_h).__name__=["zpp_nape","util","ZNPList_ZPP_GeomPoly"],_h.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==Vh.zpp_pool?t=new Vh:(t=Vh.zpp_pool,Vh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==Vh.zpp_pool?n=new Vh:(n=Vh.zpp_pool,Vh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=Vh.zpp_pool,Vh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=Vh.zpp_pool,Vh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:_h};var ph=function(){this.length=0,this.pushmod=!1,this.modified=!1,this.head=null};(n["zpp_nape.util.ZNPList_RayResult"]=ph).__name__=["zpp_nape","util","ZNPList_RayResult"],ph.prototype={head:null,begin:function(){return this.head},modified:null,pushmod:null,length:null,setbegin:function(e){this.head=e,this.modified=!0,this.pushmod=!0},add:function(e){return this.inlined_add(e)},inlined_add:function(e){var t;null==qh.zpp_pool?t=new qh:(t=qh.zpp_pool,qh.zpp_pool=t.next,t.next=null),t.alloc(),t.elt=e;var n=t;return n.next=this.begin(),this.head=n,this.modified=!0,this.length++,e},addAll:function(e){for(var t=e.begin();null!=t;){var n=t.elem();this.add(n),t=t.next}},insert:function(e,t){return this.inlined_insert(e,t)},inlined_insert:function(e,t){var n;null==qh.zpp_pool?n=new qh:(n=qh.zpp_pool,qh.zpp_pool=n.next,n.next=null),n.alloc(),n.elt=t;var i=n;return null==e?(i.next=this.begin(),this.head=i):(i.next=e.next,e.next=i),this.pushmod=this.modified=!0,this.length++,i},pop:function(){this.inlined_pop()},inlined_pop:function(){var e=this.begin();this.head=e.next;var t=e;t.free(),t.next=qh.zpp_pool,qh.zpp_pool=t,this.empty()&&(this.pushmod=!0),this.modified=!0,this.length--},pop_unsafe:function(){return this.inlined_pop_unsafe()},inlined_pop_unsafe:function(){var e=this.front();return this.pop(),e},remove:function(e){this.inlined_try_remove(e)},try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.erase(t),i=!0;break}n=(t=n).next}return i},inlined_remove:function(e){this.inlined_try_remove(e)},inlined_try_remove:function(e){for(var t=null,n=this.begin(),i=!1;null!=n;){if(n.elem()==e){this.inlined_erase(t),i=!0;break}n=(t=n).next}return i},erase:function(e){return this.inlined_erase(e)},inlined_erase:function(e){var t,n;null==e?(n=(t=this.begin()).next,this.head=n,this.empty()&&(this.pushmod=!0)):(n=(t=e.next).next,null==(e.next=n)&&(this.pushmod=!0));var i=t;return i.free(),i.next=qh.zpp_pool,qh.zpp_pool=i,this.modified=!0,this.length--,this.pushmod=!0,n},splice:function(e,t){for(;0<t--&&null!=e.next;)this.erase(e);return e.next},clear:function(){this.inlined_clear()},inlined_clear:function(){for(;!this.empty();)this.inlined_pop();this.pushmod=!0},reverse:function(){for(var e=this.begin(),t=null;null!=e;){var n=e.next;e.next=t,t=this.head=e,e=n}this.modified=!0,this.pushmod=!0},empty:function(){return null==this.begin()},size:function(){return this.length},has:function(e){return this.inlined_has(e)},inlined_has:function(e){var t;t=!1;for(var n=this.begin();null!=n;){if(n.elem()==e){t=!0;break}n=n.next}return t},front:function(){return this.begin().elem()},back:function(){for(var e=this.begin(),t=e;null!=t;)t=(e=t).next;return e.elem()},iterator_at:function(e){for(var t=this.begin();0<e--&&null!=t;)t=t.next;return t},at:function(e){var t=this.iterator_at(e);return null!=t?t.elem():null},__class__:ph};var uh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CbType"]=uh).__name__=["zpp_nape","util","ZNPNode_ZPP_CbType"],uh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:uh};var hh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CallbackSet"]=hh).__name__=["zpp_nape","util","ZNPNode_ZPP_CallbackSet"],hh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:hh};var ch=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Shape"]=ch).__name__=["zpp_nape","util","ZNPNode_ZPP_Shape"],ch.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:ch};var dh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Body"]=dh).__name__=["zpp_nape","util","ZNPNode_ZPP_Body"],dh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:dh};var mh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Constraint"]=mh).__name__=["zpp_nape","util","ZNPNode_ZPP_Constraint"],mh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:mh};var fh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Compound"]=fh).__name__=["zpp_nape","util","ZNPNode_ZPP_Compound"],fh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:fh};var gh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_InteractionListener"]=gh).__name__=["zpp_nape","util","ZNPNode_ZPP_InteractionListener"],gh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:gh};var vh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CbSet"]=vh).__name__=["zpp_nape","util","ZNPNode_ZPP_CbSet"],vh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:vh};var bh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Interactor"]=bh).__name__=["zpp_nape","util","ZNPNode_ZPP_Interactor"],bh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:bh};var yh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_BodyListener"]=yh).__name__=["zpp_nape","util","ZNPNode_ZPP_BodyListener"],yh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:yh};var xh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Arbiter"]=xh).__name__=["zpp_nape","util","ZNPNode_ZPP_Arbiter"],xh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:xh};var zh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_ConstraintListener"]=zh).__name__=["zpp_nape","util","ZNPNode_ZPP_ConstraintListener"],zh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:zh};var wh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CbSetPair"]=wh).__name__=["zpp_nape","util","ZNPNode_ZPP_CbSetPair"],wh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:wh};var kh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CutInt"]=kh).__name__=["zpp_nape","util","ZNPNode_ZPP_CutInt"],kh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:kh};var Sh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_CutVert"]=Sh).__name__=["zpp_nape","util","ZNPNode_ZPP_CutVert"],Sh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Sh};var Ch=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_PartitionVertex"]=Ch).__name__=["zpp_nape","util","ZNPNode_ZPP_PartitionVertex"],Ch.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Ch};var Nh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_PartitionedPoly"]=Nh).__name__=["zpp_nape","util","ZNPNode_ZPP_PartitionedPoly"],Nh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Nh};var Ph=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_GeomVert"]=Ph).__name__=["zpp_nape","util","ZNPNode_ZPP_GeomVert"],Ph.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Ph};var Mh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_SimplifyP"]=Mh).__name__=["zpp_nape","util","ZNPNode_ZPP_SimplifyP"],Mh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Mh};var Ih=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_SimpleVert"]=Ih).__name__=["zpp_nape","util","ZNPNode_ZPP_SimpleVert"],Ih.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Ih};var Ah=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_SimpleEvent"]=Ah).__name__=["zpp_nape","util","ZNPNode_ZPP_SimpleEvent"],Ah.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Ah};var Th=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_AABBPair"]=Th).__name__=["zpp_nape","util","ZNPNode_ZPP_AABBPair"],Th.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Th};var Dh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Edge"]=Dh).__name__=["zpp_nape","util","ZNPNode_ZPP_Edge"],Dh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Dh};var Eh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Vec2"]=Eh).__name__=["zpp_nape","util","ZNPNode_ZPP_Vec2"],Eh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Eh};var Oh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Component"]=Oh).__name__=["zpp_nape","util","ZNPNode_ZPP_Component"],Oh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Oh};var Bh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_AABBNode"]=Bh).__name__=["zpp_nape","util","ZNPNode_ZPP_AABBNode"],Bh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Bh};var Lh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_InteractionGroup"]=Lh).__name__=["zpp_nape","util","ZNPNode_ZPP_InteractionGroup"],Lh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Lh};var jh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_FluidArbiter"]=jh).__name__=["zpp_nape","util","ZNPNode_ZPP_FluidArbiter"],jh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:jh};var Fh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_SensorArbiter"]=Fh).__name__=["zpp_nape","util","ZNPNode_ZPP_SensorArbiter"],Fh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Fh};var Rh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_ColArbiter"]=Rh).__name__=["zpp_nape","util","ZNPNode_ZPP_ColArbiter"],Rh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Rh};var Gh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_Listener"]=Gh).__name__=["zpp_nape","util","ZNPNode_ZPP_Listener"],Gh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Gh};var Zh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_ToiEvent"]=Zh).__name__=["zpp_nape","util","ZNPNode_ZPP_ToiEvent"],Zh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Zh};var Uh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ConvexResult"]=Uh).__name__=["zpp_nape","util","ZNPNode_ConvexResult"],Uh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Uh};var Vh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_ZPP_GeomPoly"]=Vh).__name__=["zpp_nape","util","ZNPNode_ZPP_GeomPoly"],Vh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:Vh};var qh=function(){this.elt=null,this.next=null};(n["zpp_nape.util.ZNPNode_RayResult"]=qh).__name__=["zpp_nape","util","ZNPNode_RayResult"],qh.prototype={next:null,alloc:function(){},free:function(){this.elt=null},elt:null,elem:function(){return this.elt},__class__:qh};var Wh=function(){this.at_index=0,this.at_ite=null,this.zip_length=!1,this._length=0,this.inner=null,f_.call(this),this.at_ite=null,this.at_index=0,this.zip_length=!0,this._length=0};(n["zpp_nape.util.ZPP_MixVec2List"]=Wh).__name__=["zpp_nape","util","ZPP_MixVec2List"],Wh.get=function(e,t){null==t&&(t=!1);var n=new Wh;return n.inner=e,n.zpp_inner.immutable=t,n},Wh.__super__=f_,Wh.prototype=r(f_.prototype,{inner:null,_length:null,zip_length:null,at_ite:null,at_index:null,zpp_gl:function(){if(this.zpp_vm(),this.zip_length){this._length=0;for(var e=this.inner.begin();null!=e;)e.elem(),this._length++,e=e.next;this.zip_length=!1}return this._length},zpp_vm:function(){this.zpp_inner.validate(),this.inner.modified&&(this.zip_length=!0,this._length=0,this.at_ite=null)},at:function(e){if(this.zpp_vm(),this.zpp_inner.reverse_flag&&(e=this.get_length()-1-e),e<this.at_index||null==this.at_ite)for(this.at_index=0,this.at_ite=this.inner.begin();;){this.at_ite.elem();break}for(;this.at_index!=e;)for(this.at_index++,this.at_ite=this.at_ite.next;;){this.at_ite.elem();break}return this.at_ite.elem().wrapper()},push:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag)this.inner.add(e.zpp_inner);else{var n=this.inner.iterator_at(this.get_length()-1);this.inner.insert(n,e.zpp_inner)}this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},unshift:function(e){this.zpp_inner.modify_test(),this.zpp_vm();var t=null==this.zpp_inner.adder||this.zpp_inner.adder(e);if(t){if(this.zpp_inner.reverse_flag){var n=this.inner.iterator_at(this.get_length()-1);this.inner.insert(n,e.zpp_inner)}else this.inner.add(e.zpp_inner);this.zpp_inner.invalidate(),null!=this.zpp_inner.post_adder&&this.zpp_inner.post_adder(e)}return t},pop:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){var t=(e=this.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(t),this.zpp_inner.dontremove||this.inner.pop()}else{null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null);var n=1==this.get_length()?null:this.inner.iterator_at(this.get_length()-2),i=(e=null==n?this.inner.front():n.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.inner.erase(n)}return this.zpp_inner.invalidate(),e.wrapper()},shift:function(){this.zpp_inner.modify_test(),this.zpp_vm();var e=null;if(this.zpp_inner.reverse_flag){null!=this.at_ite&&null==this.at_ite.next&&(this.at_ite=null);var t=1==this.get_length()?null:this.inner.iterator_at(this.get_length()-2),n=(e=null==t?this.inner.front():t.next.elem()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(n),this.zpp_inner.dontremove||this.inner.erase(t)}else{var i=(e=this.inner.front()).wrapper();null!=this.zpp_inner.subber&&this.zpp_inner.subber(i),this.zpp_inner.dontremove||this.inner.pop()}return this.zpp_inner.invalidate(),e.wrapper()},remove:function(e){var t;this.zpp_inner.modify_test(),this.zpp_vm(),t=!1;for(var n=this.inner.begin();null!=n;){var i=n.elem();if(e.zpp_inner==i){t=!0;break}n=n.next}return t&&(null!=this.zpp_inner.subber&&this.zpp_inner.subber(e),this.zpp_inner.dontremove||this.inner.remove(e.zpp_inner),this.zpp_inner.invalidate()),t},clear:function(){if(this.zpp_inner.reverse_flag)for(;!this.empty();)this.pop();else for(;!this.empty();)this.shift()},__class__:Wh});var Xh=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new tp,this._invalidated=!0};(n["zpp_nape.util.ZPP_ConstraintList"]=Xh).__name__=["zpp_nape","util","ZPP_ConstraintList"],Xh.get=function(e,t){null==t&&(t=!1);var n=new To;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},Xh.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:Xh};var Hh=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Ru,this._invalidated=!0};(n["zpp_nape.util.ZPP_BodyList"]=Hh).__name__=["zpp_nape","util","ZPP_BodyList"],Hh.get=function(e,t){null==t&&(t=!1);var n=new z_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},Hh.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:Hh};var Yh=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new np,this._invalidated=!0};(n["zpp_nape.util.ZPP_InteractorList"]=Yh).__name__=["zpp_nape","util","ZPP_InteractorList"],Yh.get=function(e,t){null==t&&(t=!1);var n=new A_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},Yh.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:Yh};var Jh=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Gu,this._invalidated=!0};(n["zpp_nape.util.ZPP_CompoundList"]=Jh).__name__=["zpp_nape","util","ZPP_CompoundList"],Jh.get=function(e,t){null==t&&(t=!1);var n=new C_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},Jh.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:Jh};var Kh=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new sh,this._invalidated=!0};(n["zpp_nape.util.ZPP_ListenerList"]=Kh).__name__=["zpp_nape","util","ZPP_ListenerList"],Kh.get=function(e,t){null==t&&(t=!1);var n=new wo;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},Kh.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:Kh};var Qh=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new _p,this._invalidated=!0};(n["zpp_nape.util.ZPP_CbTypeList"]=Qh).__name__=["zpp_nape","util","ZPP_CbTypeList"],Qh.get=function(e,t){null==t&&(t=!1);var n=new fo;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},Qh.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:Qh};var $h=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Tp,this._invalidated=!0};(n["zpp_nape.util.ZPP_Vec2List"]=$h).__name__=["zpp_nape","util","ZPP_Vec2List"],$h.get=function(e,t){null==t&&(t=!1);var n=new f_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},$h.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:$h};var ec=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new _h,this._invalidated=!0};(n["zpp_nape.util.ZPP_GeomPolyList"]=ec).__name__=["zpp_nape","util","ZPP_GeomPolyList"],ec.get=function(e,t){null==t&&(t=!1);var n=new a_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},ec.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:ec};var tc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new ph,this._invalidated=!0};(n["zpp_nape.util.ZPP_RayResultList"]=tc).__name__=["zpp_nape","util","ZPP_RayResultList"],tc.get=function(e,t){null==t&&(t=!1);var n=new c_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},tc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:tc};var nc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new oh,this._invalidated=!0};(n["zpp_nape.util.ZPP_ConvexResultList"]=nc).__name__=["zpp_nape","util","ZPP_ConvexResultList"],nc.get=function(e,t){null==t&&(t=!1);var n=new t_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},nc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:nc};var ic=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new $u,this._invalidated=!0};(n["zpp_nape.util.ZPP_EdgeList"]=ic).__name__=["zpp_nape","util","ZPP_EdgeList"],ic.get=function(e,t){null==t&&(t=!1);var n=new L_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},ic.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:ic};var rc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Fu,this._invalidated=!0};(n["zpp_nape.util.ZPP_ShapeList"]=rc).__name__=["zpp_nape","util","ZPP_ShapeList"],rc.get=function(e,t){null==t&&(t=!1);var n=new R_;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},rc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:rc};var ac=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new nh,this._invalidated=!0};(n["zpp_nape.util.ZPP_InteractionGroupList"]=ac).__name__=["zpp_nape","util","ZPP_InteractionGroupList"],ac.get=function(e,t){null==t&&(t=!1);var n=new Ko;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},ac.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:ac};var sc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Zu,this._invalidated=!0};(n["zpp_nape.util.ZPP_ArbiterList"]=sc).__name__=["zpp_nape","util","ZPP_ArbiterList"],sc.get=function(e,t){null==t&&(t=!1);var n=new Zo;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},sc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:sc};var lc=function(){this.user_length=0,this.zip_length=!1,this.push_ite=null,this.at_ite=null,this.at_index=0,this.reverse_flag=!1,this.dontremove=!1,this.subber=null,this.post_adder=null,this.adder=null,this._modifiable=null,this._validate=null,this._invalidate=null,this._invalidated=!1,this.immutable=!1,this.inner=null,this.outer=null,this.inner=new Np,this._invalidated=!0};(n["zpp_nape.util.ZPP_ContactList"]=lc).__name__=["zpp_nape","util","ZPP_ContactList"],lc.get=function(e,t){null==t&&(t=!1);var n=new Xo;return n.zpp_inner.inner=e,t&&(n.zpp_inner.immutable=!0),n.zpp_inner.zip_length=!0,n},lc.prototype={outer:null,inner:null,immutable:null,_invalidated:null,_invalidate:null,_validate:null,_modifiable:null,adder:null,post_adder:null,subber:null,dontremove:null,reverse_flag:null,valmod:function(){this.validate(),this.inner.modified&&(this.inner.pushmod&&(this.push_ite=null),this.at_ite=null,this.inner.modified=!1,this.inner.pushmod=!1,this.zip_length=!0)},modified:function(){this.zip_length=!0,this.at_ite=null,this.push_ite=null},modify_test:function(){},validate:function(){this._invalidated&&(this._invalidated=!1,null!=this._validate&&this._validate())},invalidate:function(){this._invalidated=!0,null!=this._invalidate&&this._invalidate(this)},at_index:null,at_ite:null,push_ite:null,zip_length:null,user_length:null,__class__:lc};var oc=function(){};(n["zpp_nape.util.ZPP_Math"]=oc).__name__=["zpp_nape","util","ZPP_Math"],oc.sqrt=function(e){return Math.sqrt(e)},oc.invsqrt=function(e){return 1/oc.sqrt(e)},oc.sqr=function(e){return e*e},oc.clamp2=function(e,t){return oc.clamp(e,-t,t)},oc.clamp=function(e,t,n){return e<t?t:n<e?n:e};var _c=function(){};(n["zpp_nape.util.ZPP_PubPool"]=_c).__name__=["zpp_nape","util","ZPP_PubPool"];var pc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_Body"]=pc).__name__=["zpp_nape","util","ZPP_Set_ZPP_Body"],pc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=pc.zpp_pool,pc.zpp_pool=o},clear:function(){this.clear_with((function(e){}))},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=pc.zpp_pool,pc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==pc.zpp_pool?t=new pc:(t=pc.zpp_pool,pc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==pc.zpp_pool?t=new pc:(t=pc.zpp_pool,pc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==pc.zpp_pool?t=new pc:(t=pc.zpp_pool,pc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==pc.zpp_pool?t=new pc:(t=pc.zpp_pool,pc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==pc.zpp_pool?t=new pc:(t=pc.zpp_pool,pc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==pc.zpp_pool?t=new pc:(t=pc.zpp_pool,pc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==pc.zpp_pool?t=new pc:(t=pc.zpp_pool,pc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:pc};var uc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_CbSetPair"]=uc).__name__=["zpp_nape","util","ZPP_Set_ZPP_CbSetPair"],uc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=uc.zpp_pool,uc.zpp_pool=o},clear:function(){this.clear_with((function(e){}))},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=uc.zpp_pool,uc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==uc.zpp_pool?t=new uc:(t=uc.zpp_pool,uc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==uc.zpp_pool?t=new uc:(t=uc.zpp_pool,uc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==uc.zpp_pool?t=new uc:(t=uc.zpp_pool,uc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==uc.zpp_pool?t=new uc:(t=uc.zpp_pool,uc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==uc.zpp_pool?t=new uc:(t=uc.zpp_pool,uc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==uc.zpp_pool?t=new uc:(t=uc.zpp_pool,uc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==uc.zpp_pool?t=new uc:(t=uc.zpp_pool,uc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:uc};var hc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_PartitionVertex"]=hc).__name__=["zpp_nape","util","ZPP_Set_ZPP_PartitionVertex"],hc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=hc.zpp_pool,hc.zpp_pool=o},clear:function(){this.clear_with((function(e){}))},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=hc.zpp_pool,hc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==hc.zpp_pool?t=new hc:(t=hc.zpp_pool,hc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==hc.zpp_pool?t=new hc:(t=hc.zpp_pool,hc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==hc.zpp_pool?t=new hc:(t=hc.zpp_pool,hc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==hc.zpp_pool?t=new hc:(t=hc.zpp_pool,hc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==hc.zpp_pool?t=new hc:(t=hc.zpp_pool,hc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==hc.zpp_pool?t=new hc:(t=hc.zpp_pool,hc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==hc.zpp_pool?t=new hc:(t=hc.zpp_pool,hc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:hc};var cc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_PartitionPair"]=cc).__name__=["zpp_nape","util","ZPP_Set_ZPP_PartitionPair"],cc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=cc.zpp_pool,cc.zpp_pool=o},clear:function(){this.clear_with((function(e){}))},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=cc.zpp_pool,cc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==cc.zpp_pool?t=new cc:(t=cc.zpp_pool,cc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==cc.zpp_pool?t=new cc:(t=cc.zpp_pool,cc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==cc.zpp_pool?t=new cc:(t=cc.zpp_pool,cc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==cc.zpp_pool?t=new cc:(t=cc.zpp_pool,cc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==cc.zpp_pool?t=new cc:(t=cc.zpp_pool,cc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==cc.zpp_pool?t=new cc:(t=cc.zpp_pool,cc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==cc.zpp_pool?t=new cc:(t=cc.zpp_pool,cc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:cc};var dc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_SimpleVert"]=dc).__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleVert"],dc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=dc.zpp_pool,dc.zpp_pool=o},clear:function(){this.clear_with((function(e){}))},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=dc.zpp_pool,dc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==dc.zpp_pool?t=new dc:(t=dc.zpp_pool,dc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==dc.zpp_pool?t=new dc:(t=dc.zpp_pool,dc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==dc.zpp_pool?t=new dc:(t=dc.zpp_pool,dc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==dc.zpp_pool?t=new dc:(t=dc.zpp_pool,dc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==dc.zpp_pool?t=new dc:(t=dc.zpp_pool,dc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==dc.zpp_pool?t=new dc:(t=dc.zpp_pool,dc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==dc.zpp_pool?t=new dc:(t=dc.zpp_pool,dc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:dc};var mc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_SimpleSeg"]=mc).__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleSeg"],mc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=mc.zpp_pool,mc.zpp_pool=o},clear:function(){this.clear_with((function(e){}))},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=mc.zpp_pool,mc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==mc.zpp_pool?t=new mc:(t=mc.zpp_pool,mc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==mc.zpp_pool?t=new mc:(t=mc.zpp_pool,mc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==mc.zpp_pool?t=new mc:(t=mc.zpp_pool,mc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==mc.zpp_pool?t=new mc:(t=mc.zpp_pool,mc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==mc.zpp_pool?t=new mc:(t=mc.zpp_pool,mc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==mc.zpp_pool?t=new mc:(t=mc.zpp_pool,mc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==mc.zpp_pool?t=new mc:(t=mc.zpp_pool,mc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:mc};var fc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_SimpleEvent"]=fc).__name__=["zpp_nape","util","ZPP_Set_ZPP_SimpleEvent"],fc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=fc.zpp_pool,fc.zpp_pool=o},clear:function(){this.clear_with((function(e){}))},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=fc.zpp_pool,fc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==fc.zpp_pool?t=new fc:(t=fc.zpp_pool,fc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:fc};var gc=function(){this.colour=0,this.parent=null,this.next=null,this.prev=null,this.data=null,this.swapped=null,this.lt=null};(n["zpp_nape.util.ZPP_Set_ZPP_CbSet"]=gc).__name__=["zpp_nape","util","ZPP_Set_ZPP_CbSet"],gc.prototype={free:function(){this.data=null,this.lt=null,this.swapped=null},alloc:function(){},lt:null,swapped:null,data:null,prev:null,next:null,parent:null,colour:null,verify:function(){if(!this.empty()){for(var e=this.parent;null!=e.prev;)e=e.prev;for(;null!=e;){var t=e.data,n=!0;if(!this.empty()){for(var i=this.parent;null!=i.prev;)i=i.prev;for(;null!=i;){var r=i.data;if(n){if(t==r)n=!1;else if(!this.lt(r,t)&&this.lt(t,r))return!1}else if(!this.lt(t,r)&&this.lt(r,t))return!1;if(null!=i.next)for(i=i.next;null!=i.prev;)i=i.prev;else{for(;null!=i.parent&&i==i.parent.next;)i=i.parent;i=i.parent}}}if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{for(;null!=e.parent&&e==e.parent.next;)e=e.parent;e=e.parent}}}return!0},empty:function(){return null==this.parent},singular:function(){return null!=this.parent&&null==this.parent.prev&&null==this.parent.next},size:function(){var e=0;if(!this.empty()){for(var t=this.parent;null!=t.prev;)t=t.prev;for(;null!=t;)if(t.data,++e,null!=t.next)for(t=t.next;null!=t.prev;)t=t.prev;else{for(;null!=t.parent&&t==t.parent.next;)t=t.parent;t=t.parent}}return e},has:function(e){return null!=this.find(e)},find:function(e){for(var t=this.parent;null!=t&&t.data!=e;)t=this.lt(e,t.data)?t.prev:t.next;return t},has_weak:function(e){return null!=this.find_weak(e)},find_weak:function(e){for(var t=this.parent;null!=t;)if(this.lt(e,t.data))t=t.prev;else{if(!this.lt(t.data,e))break;t=t.next}return t},lower_bound:function(e){var t=null;if(!this.empty()){for(var n=this.parent;null!=n.prev;)n=n.prev;for(;null!=n;){var i=n.data;if(!this.lt(i,e)){t=i;break}if(null!=n.next)for(n=n.next;null!=n.prev;)n=n.prev;else{for(;null!=n.parent&&n==n.parent.next;)n=n.parent;n=n.parent}}}return t},first:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;return e.data},pop_front:function(){for(var e=this.parent;null!=e.prev;)e=e.prev;var t=e.data;return this.remove_node(e),t},remove:function(e){var t=this.find(e);this.remove_node(t)},successor_node:function(e){if(null!=e.next)for(e=e.next;null!=e.prev;)e=e.prev;else{var t=e;for(e=e.parent;null!=e&&e.prev!=t;)e=(t=e).parent}return e},predecessor_node:function(e){if(null!=e.prev)for(e=e.prev;null!=e.next;)e=e.next;else{var t=e;for(e=e.parent;null!=e&&e.next!=t;)e=(t=e).parent}return e},successor:function(e){var t=this.successor_node(this.find(e));return null==t?null:t.data},predecessor:function(e){var t=this.predecessor_node(this.find(e));return null==t?null:t.data},remove_node:function(e){if(null!=e.next&&null!=e.prev){for(var t=e.next;null!=t.prev;)t=t.prev;var n=e.data;e.data=t.data,t.data=n,null!=this.swapped&&this.swapped(e.data,t.data),e=t}var i=null==e.prev?e.next:e.prev;if(1==e.colour)if(null!=e.prev||null!=e.next)i.colour=1;else if(null!=e.parent)for(var r=e.parent;;){r.colour++,r.prev.colour--,r.next.colour--;var a=r.prev;if(-1==a.colour){this.__fix_neg_red(a);break}if(0==a.colour){if(null!=a.prev&&0==a.prev.colour){this.__fix_dbl_red(a.prev);break}if(null!=a.next&&0==a.next.colour){this.__fix_dbl_red(a.next);break}}var s=r.next;if(-1==s.colour){this.__fix_neg_red(s);break}if(0==s.colour){if(null!=s.prev&&0==s.prev.colour){this.__fix_dbl_red(s.prev);break}if(null!=s.next&&0==s.next.colour){this.__fix_dbl_red(s.next);break}}if(2==r.colour){if(null!=r.parent){r=r.parent;continue}r.colour=1}break}var l=e.parent;null==l?this.parent=i:l.prev==e?l.prev=i:l.next=i,null!=i&&(i.parent=l),e.parent=e.prev=e.next=null;var o=e;o.free(),o.next=gc.zpp_pool,gc.zpp_pool=o},clear:function(){this.clear_with((function(e){}))},clear_with:function(e){if(null!=this.parent){for(var t=this.parent;null!=t;)t=null!=t.prev?t.prev:null!=t.next?t.next:this.clear_node(t,e);this.parent=null}},clear_node:function(e,t){t(e.data);var n=e.parent;null!=n&&(e==n.prev?n.prev=null:n.next=null,e.parent=null);var i=e;return i.free(),i.next=gc.zpp_pool,gc.zpp_pool=i,n},__fix_neg_red:function(e){var t,n=e.parent;if(n.prev==e){var i=e.prev,r=e.next,a=r.prev,s=r.next;i.colour=0,e.colour=n.colour=1,null!=(e.next=a)&&(a.parent=e);var l=n.data;n.data=r.data,r.data=l,null!=this.swapped&&this.swapped(n.data,r.data),null!=(r.prev=s)&&(s.parent=r),r.next=n.next,null!=n.next&&(n.next.parent=r),null!=(n.next=r)&&(r.parent=n),t=i}else{var o=e.next,_=e.prev,p=_.next,u=_.prev;o.colour=0,e.colour=n.colour=1,null!=(e.prev=p)&&(p.parent=e);var h=n.data;n.data=_.data,_.data=h,null!=this.swapped&&this.swapped(n.data,_.data),null!=(_.next=u)&&(u.parent=_),_.prev=n.prev,null!=n.prev&&(n.prev.parent=_),null!=(n.prev=_)&&(_.parent=n),t=o}null!=t.prev&&0==t.prev.colour?this.__fix_dbl_red(t.prev):null!=t.next&&0==t.next.colour&&this.__fix_dbl_red(t.next)},__fix_dbl_red:function(e){for(;;){var t,n,i,r,a,s,l,o=e.parent,_=o.parent;if(null==_){o.colour=1;break}o==_.prev?(l=(i=_).next,s=e==o.prev?(n=o,r=(t=e).prev,a=e.next,o.next):(n=e,r=(t=o).prev,a=e.prev,e.next)):(r=(t=_).prev,l=e==o.prev?(i=o,a=(n=e).prev,s=e.next,o.next):(i=e,a=(n=o).prev,s=e.prev,e.next));var p=_.parent;if(null==p?this.parent=n:p.prev==_?p.prev=n:p.next=n,null!=n&&(n.parent=p),null!=(t.prev=r)&&(r.parent=t),null!=(t.next=a)&&(a.parent=t),null!=(n.prev=t)&&(t.parent=n),null!=(n.next=i)&&(i.parent=n),null!=(i.prev=s)&&(s.parent=i),null!=(i.next=l)&&(l.parent=i),n.colour=_.colour-1,t.colour=1,i.colour=1,n==this.parent)this.parent.colour=1;else if(0==n.colour&&0==n.parent.colour){e=n;continue}break}},try_insert_bool:function(e){var t=null,n=null;if(null==this.parent)null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null!=t&&(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),!0)},try_insert:function(e){var t=null,n=null;if(null==this.parent)null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,this.parent=t;else for(n=this.parent;;)if(this.lt(e,n.data)){if(null==n.prev){null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.prev=t).parent=n;break}n=n.prev}else{if(!this.lt(n.data,e))break;if(null==n.next){null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,(n.next=t).parent=n;break}n=n.next}return null==t?n:(null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t)},insert:function(e){var t;if(null==gc.zpp_pool?t=new gc:(t=gc.zpp_pool,gc.zpp_pool=t.next,t.next=null),t.alloc(),t.data=e,null==this.parent)this.parent=t;else for(var n=this.parent;;)if(this.lt(t.data,n.data)){if(null==n.prev){(n.prev=t).parent=n;break}n=n.prev}else{if(null==n.next){(n.next=t).parent=n;break}n=n.next}return null==t.parent?t.colour=1:(t.colour=0)==t.parent.colour&&this.__fix_dbl_red(t),t},__class__:gc};var vc,bc=0;function yc(e,t){return null==t?null:(null==t.__id__&&(t.__id__=bc++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&((n=function(){return n.method.apply(n.scope,arguments)}).scope=e,n.method=t,e.hx__closures__[t.__id__]=n),n);var n}n.Math=Math,String.prototype.__class__=n.String=String,String.__name__=["String"],n.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=n.Date=Date,Date.__name__=["Date"];var xc=n.Int={__name__:["Int"]},zc=n.Dynamic={__name__:["Dynamic"]},wc=n.Float=Number;wc.__name__=["Float"];var kc=n.Bool=Boolean;kc.__ename__=["Bool"];var Sc=n.Class={__name__:["Class"]},Cc={},Nc={},Pc=t.ArrayBuffer||io;null==Pc.prototype.slice&&(Pc.prototype.slice=io.sliceImpl);var Mc,Ic=t.DataView||ro,Ac=t.Float32Array||ao._new,Tc=t.Uint8Array||so._new;o.MEASUREMENT_INTERVAL=1e3,o.FONT_FAMILY="Helvetica,Arial",o.FPS_BG_CLR="#00FF00",o.FPS_WARN_BG_CLR="#FF8000",o.FPS_PROB_BG_CLR="#FF0000",o.MS_BG_CLR="#FFFF00",o.MEM_BG_CLR="#086A87",o.INFO_BG_CLR="#00FFFF",o.FPS_TXT_CLR="#000000",o.MS_TXT_CLR="#000000",o.MEM_TXT_CLR="#FFFFFF",o.INFO_TXT_CLR="#000000",o.TOP_LEFT="TL",o.TOP_RIGHT="TR",o.BOTTOM_LEFT="BL",o.BOTTOM_RIGHT="BR",o.DELAY_TIME=4e3,m.Element=0,m.PCData=1,m.CData=2,m.Comment=3,m.DocType=4,m.ProcessingInstruction=5,m.Document=6,O.LIGHT=16054256,O.LIGHT_MID=15199710,O.MID_LIGHT=13753277,O.MID=9546397,O.DARK_MID=4087919,O.DARK=1651777,O.RED=13772832,O.ORANGE=13792544,O.GREEN=3253280,O.BLUE=1935032,O.RED_LIGHT=15640467,O.ORANGE_LIGHT=15711890,O.GREEN_LIGHT=10546070,O.BLUE_LIGHT=9687278,W.guid_prefix="guid_not_initialized",W.guid_postfix=0,ie.destroyed_entity_list=[],le.pushClass=re.pushClass,le.pushBool=re.pushBool,le.pushInt=re.pushInt,le.pushDouble=re.pushDouble,le.pushString=re.pushString,le.pushEnum=re.pushEnum,le.pushArray=re.pushArray,le.pushInstance=re.pushInstance,le.pushIgnore=re.pushIgnore,le.pushPoint=re.pushPoint,le.pushTransform=re.pushTransform,oe.debug_draw_polygons_and_circles=!1,ve.dice_roll_add_min_frames=10,ve.dice_roll_add_max_frames=15,ve.dice_roll_available_abilities=[ge.Bomb,ge.Dynamite,ge.Armor,ge.Nitro],ze.magnet_distance=650,Ce.bomb_min_existance_time=30,Ce.total_explosion_time=21,Ce.bomb_explosion_radius=300,Ce.dynamite_explosion_radius=300,Ce.barrel_explosion_radius=300,Pe.shield_time=600,Pe.nitro_time=60,Pe.nitro_time_per_1_pick=30,Pe.magnet_time=120,Pe.transition_time=30,Pe.shuffle_time=30,Ie.adjusts=[],Ie.updates=[],Ee.balloon_time=3,Ee.anchor_time=3,qe.max_size=100,qe.count_per_row=10,qe.spacing=10,qe.offset_x=225,qe.offset_y=565,qe.max_width_offset=-40,qe.max_height=150,Ke.move_to_sides_speed=300,rt.min_average_velocity_threshold=35,rt.initial_rotation=.7853981633974351,rt.max_rotation=1.5707963267948701,at.rotate_until_angle_min=.5,at.rotate_until_angle_max=1,dt.time_frame=.2,It.additional_distance_to_timeout=50,Et.flip_count=16,Ot.arrow_animation_time=1,Ot.arrow_speed_y=-5,Bt.barrel_fall_time_array=[1.467,1.432,1.433,1.45,1.434,1.434,1.45,1.449,1.45,1.433],Bt.total_health=100,Bt.damage_coeff=50,Bt.text_offset=-180,jt.text_offset=-200,jt.max_time=30,jt.nitro_to_drive_coeff=1.5,Zt.text_in_time=1,Zt.challenge_show_time=2,Zt.text_out_time=1,Jt.car_ranking_count=10,Jt.car_ranking_current=0,Jt.restart_current_count=0,Jt.restart_max_count=20,Jt.restart_wait_frames=10,$t.smooth_steps=100,$t.scroll_coeff=30,$t.zoom_coeff=.005,$t.zoom_speed=.001,en.time=180,en.follow_time=0,en.deattach_coeff=.95,en.slow_down_delay=0,en.slow_down_duration=60,en.slow_down_smooth_in_duration=5,en.slow_down_smooth_out_duration=5,en.slow_down_time_coeff=.1,nn.background_time=.01,nn.title_pop_time=.15,nn.title_scale=.8,nn.title_scale_increase=.001,nn.title_scale_in_time=2,nn.title_alpha_out_time=.25,sn.level_number=1,sn.top_speed=0,sn.acceleration=0,sn.handling=0,sn.armor=0,hn.total_space_steps=0,hn.physics_update_time=0,cn.consolas_24="consolas_24",cn.toonish_36="toonish_36",cn.avantgarde_lt_medium_dark_26="avantgarde_lt_medium_dark_26",cn.avantgarde_lt_medium_light_26="avantgarde_lt_medium_light_26",cn.bell_gothic_std_black_dark_26="bell_gothic_std_black_dark_26",cn.bell_gothic_std_black_light_26="bell_gothic_std_black_light_26",cn.bell_gothic_std_black_very_light_26="bell_gothic_std_black_very_light_26",cn.bell_gothic_std_bold_dark_26="bell_gothic_std_bold_dark_26",cn.bell_gothic_std_bold_light_26="bell_gothic_std_bold_light_26",cn.tw_cen_mt_condensed_extra_bold_dark_29="tw_cen_mt_condensed_extra_bold_dark_29",gn.transition_time=15,xn.camera_time=60,xn.wait_for_finish_time=1,xn.finished_animation_time=15,xn.wait_for_level_stats_time=120,xn.finished_start_scale=2,xn.finished_end_scale=1,xn.camera_shake_amount=5,xn.camera_shake_time=5,wn.init_wait=30,wn.time_per_count=15,wn.time_per_wait=10,wn.max_countdown_state=5,wn.camera_additional_offset=-80,wn.camera_additional_offset_step=.82,kn.anim_time=.2,kn.anim_scale=1.5,kn.coin_display_debug_visibility=!0,Mn.distance_between_text=50,Mn.primary_text_font_size=42,Mn.secondary_text_font_size=32,Mn.stage_height_coeff=.33,Mn.phase_in_time=.2,Mn.phase_out_time=.5,Ln.phase_in_time=.1,Ln.phase_out_time=.75,Ln.white_circle_time=.5,Ln.wheel_anim_angle_start=-100,Ln.wheel_anim_angle_end=-180,Ln.wheel_anim_time=1.5,Rn.terrain_draw_count=20,Rn.pre_simulate_world_steps=60,Rn.pre_wait_steps=20,Rn.camera_smooth_steps=30,Rn.countdown_camera_smooth_steps=200,Rn.slow_step_stimulation_for_desktop=!1,Rn.texture_offset_add=0,Rn.race_zoom_min=1,Rn.race_zoom_max=.75,Rn.physics_dc_coeff=1.2,Rn.physics_velocity_iterations=10,Rn.physics_position_iterations=10,Vn.wait_in_menu_time=.5,Xn.max_column_count=4,Xn.distance_from_ground=120,Xn.x_distance=240,Xn.y_distance=200,Xn.scale=1,Xn.floating_time=1.5,Xn.floating_distance=15,Yn.wait_in_time=.05,Yn.anim_in_time=.35,Yn.anim_out_time=.2,Qn.locked_alpha=.25,Qn.white_circle_animation_time=1,Qn.white_circle_min_scale=1.5,Qn.white_circle_max_scale=2,ri.metric_width=390,ri.metric_height=30,ri.metric_green_or_red_alpha=1,ri.metric_offset=70,ri.metric_space=20,ui.scale_anim_time=1,ui.map_item_anim_time=1,ui.animate_in_wait_time=.1,ui.animate_in_time=.6,ui.animate_in_start_scale=2,vi.place_button_space=5,vi.camera_smooth_steps=10,vi.camera_smooth_steps_init=20,vi.camera_smooth_steps_init_time=1,vi.scroll_speed_coeff=1,vi.snap_distance=1e4,vi.max_scroll_to_sides=200,vi.start_drag_distance=20,vi.speed_coeff=.5,vi.speed_decrease_coeff=.5,vi.max_distance_for_speed=350,vi.max_speed=500,vi.speed_for_scroll_threshold=100,vi.close_button_anchor_x=.55,vi.close_button_anchor_y=.45,vi.main_button_deactivated_alpha=.3,vi.map_zoom_wait_time=.5,vi.finger_radius=30,vi.init_debug_scroll_location="",vi.place_treasure="treasure",vi.place_achievements="achievements",vi.place_upgrades="upgrades",vi.place_shop="shop",vi.place_map="map",zi.normal=zi.create([1,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1]),zi.ground=zi.create([0,0,0,0,0,0,0,1],[1,1,1,1,1,1,1,1]),zi.ray_to_ground=zi.create([0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,1]),zi.car_body=zi.create([0,1,0,0,0,0,0,0],[1,0,1,1,1,1,1,1]),zi.car_wheel=zi.create([0,1,0,0,0,0,0,0],[1,0,1,1,1,1,1,1]),zi.car_wolf_body=zi.create([0,0,1,0,0,0,0,0],[1,1,0,1,1,1,1,1]),zi.car_wolf_wheel=zi.create([0,0,1,0,0,0,0,0],[1,1,0,1,1,1,1,1]),zi.car_suspension=zi.create([0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]),zi.car_baggage=zi.create([0,0,1,0,0,0,0,0],[1,1,0,1,1,1,1,1]),zi.car_baggage_self=zi.create([0,0,1,0,0,0,0,0],[1,1,1,1,1,1,1,1]),zi.normal_except_cars=zi.create([1,0,0,0,0,0,0,0],[1,0,1,1,1,1,1,1]),zi.only_to_ground=zi.create([0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,1]),zi.no_interaction=zi.create([0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]),Si.shine_effect_total_pause_time=45,Si.transition_out_total_time=10,Si.transition_out_treasure_chest_total_time=30,Si.pickup_scale_time=6,Ai.place_coeff=.7,Ai.stunt_coeff=.3,Ai.bar_placement_y_coeff=.65,Ai.bar_scale=.9,Ai.chest_scale=.65,Ai.bar_offset_top_y=-50,Ai.bar_offset_middle_y=0,Ai.chest_offset_y=-200,Ai.buttons_offset_y=140,Ai.background_alpha=.95,Ai.menu_in_time=.3,Ai.menu_initial_scale=3.5,Ai.bar_time_in_seconds=2,Ai.pause_time_in_seconds=1,Ai.text_alpha_time=.1,Ai.indicator_anim_time=.2,Ai.indicator_anim_scale=2,Ai.chest_anim_scale=1.25,Ai.chest_default_scale=2,Ai.distance_between_buttons=400,Ai.button_anim_time=.5,Ai.button_scale_anim_time=.6,Ai.continue_button_inactive_alpha=.25,Ai.button_scale=.9,Ai.button_anim_scale=1,Ai.place_names=["0","1st","2nd","3rd","4th","5th","6th","7th","8th","9th","10th"],Ai.test_overwrite_place=-1,Ai.test_overwrite_stunts=-1,Fi.ratio_start=.6666666666666666,Fi.ratio_end=.6666666666666666,Fi.zoom_time=2,Fi.start_point=new ji(-1e4,-6e3,2e4),Fi.camera_tied=!0,Fi.button_time=.2,Fi.button_distance_y=125,Fi.button_position_x_width_coeff=.22,Fi.button_position_y_height_coeff=.6,Fi.yacht_speed=-1.5,Fi.cloud_speed=-30,Fi.credits_menu_x_coeff=.67,Fi.credits_menu_y_coeff=.59,Zi.pieces_destroy_distance=2e3,Hi.ramp_angle_in_degrees=45,Qi.WAKE=1,Qi.PROPS=2,Qi.ANGDRAG=4,Qi.ARBITERS=8,$i.car_body_default=new Ki(.2,.57,.7,.8,.001),$i.car_wheel_default=new Ki(.8,.5,1.2,.6,.005),$i.car_suspension_default=new Ki(0,1,2,.2,.001),$i.car_baggage_default=new Ki(.2,.57,.7,.1,.001),$i.box=new Ki(.5,.5,1.2,.4,.005),$i.balloons=new Ki(.8,.5,1,.2,.005),$i.balloons_line=new Ki(.8,.5,1,.1,.005),$i.anchor=new Ki(.2,.5,1,.4,.005),$i.anchor_line=new Ki(.2,.5,1,.2,.005),er.total_size=50,tr.keys_forward=[87,38],tr.keys_backward=[83,40],tr.keys_left=[65,37],tr.keys_right=[68,39],tr.keys_nitro=[81,16],tr.keys_power=[69,13],tr.keys_jump=[32],ir.radius=80,ar.radius=80,ar.transtion_in_time=15,ar.pickup_time=10,sr.max_angular_vel=65,sr.slow_volume_coeff=.5,sr.fast_volume_coeff=.6,or.car_rudolf="car_rudolf",or.car_bus="car_bus",or.car_farm_truck="car_farm_truck",or.car_semioval="car_semioval",or.car_tourcycle="car_tourcycle",or.car_ice_cream_truck="car_ice_cream_truck",or.car_bug="car_bug",or.car_coyote="car_coyote",or.car_cow="car_cow",or.car_rider="car_rider",or.car_taxi="car_taxi",or.all_cars=["car_rudolf","car_bus","car_farm_truck","car_semioval","car_tourcycle","car_ice_cream_truck","car_bug","car_coyote","car_cow","car_rider","car_taxi"],or.rank_1_cars=["car_rider","car_semioval","car_bug"],or.rank_2_cars=["car_rudolf","car_bus","car_taxi","car_farm_truck"],or.rank_3_cars=["car_cow","car_ice_cream_truck","car_coyote","car_tourcycle"],fr.RewardedAdNothing=0,fr.RewardedAdCoins=1,fr.RewardedAdChests=2,Ir.background_scale=.95,Ir.icon_y=-100,Ir.title_text_y=-310,Ir.name_text_y=45,Ir.description_text_max_width=330,Ir.description_text_y=150,Ir.name_text_font_size=36,Ir.description_text_font_size=26,Ar.card_scale=1,Ar.distance_between_cards=0,Or.text_size=22,Or.text_offset_x=-30,Or.offset_y=50,Or.spacing=50,Lr.phase_in_time=20,Lr.phase_in_scale=10,Lr.phase_in_camera_shake_amount=8,Lr.phase_in_camera_shake_time=4,Lr.phase_out_time=10,Lr.phase_out_scale=2,Lr.phase_use_time=20,Lr.phase_use_scale=2.5,Lr.item_size=39,Lr.item_distance=44,Fr.reward_prefix="reward_",Fr.ongoing_prefix="ongoing_",Fr.achievement_prefix="achievement_",Fr.armor_texture="armor",Fr.bomb_texture="bomb",Fr.dynamite_texture="dynamite",Fr.acceleration_texture="acceleration",Fr.boost_texture="boost",Fr.coin_texture="coin",Fr.balloons_texture="balloons",Fr.handling_texture="handling",Fr.first_texture="first",Fr.unlock_car_texture="unlock_car",Zr.stunt_front_wheelie=0,Zr.stunt_back_wheelie=1,Zr.stunt_front_flip=2,Zr.stunt_back_flip=3,Zr.stunt_wheelie_to_flip_combo=4,Zr.stunt_flip_to_wheelie_combo=5,Zr.stunt_wheelie_combo=6,Zr.stunt_flip_combo=7,Zr.stunt_perfect_landing=8,Zr.points_flip=1e3,Zr.points_wheelie=100,Zr.points_flip_combo=700,Zr.points_wheelie_combo=500,Zr.points_flip_to_wheelie_combo=800,Zr.points_wheelie_to_flip_combo=600,Zr.points_perfect_landing=500,Zr.combo_expiration_time=1.5,Zr.wheelie_start_min_time=.4,Zr.wheelie_point_per_time_step=.2,Zr.min_speed_coeff=.5,Zr.perfect_landing_time=1.2,Zr.perfect_landing_wheel_time=.034,Zr.score_name_min_display_time=.5,Zr.phase_out_time=.2,Zr.bar_offset=65,Zr.bar_offset_per_digit=13,Vr.debug_angle_difference=0,Vr.debug_grip=0,Vr.debug_swipe_steps=0,Vr.corner_distance_coeff=.3,Vr.grip_min_delta_angle=.01,Vr.grip_increase=.2,Vr.grip_decrease=.05,Vr.wheel_max_force_angle=.3,Vr.atan_smoothing_multiplier=50,Vr.max_friction=.8,Xr.PI=Math.PI,Xr.PI2=2*Math.PI,Xr.DEGREES_TO_RADIANS=.017453292519943,Xr.RADIANS_TO_DEGREES=57.29577951308232,Xr.INCHES_TO_CENTIMETERS=2.54,Xr.EPSILON=1e-8,Xr.GAMMA_LANCZOS_P=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],Hr.validate_reusable_objects=!1,Yr.destroyed_point_list=[],Qr.destroyed_bounds_list=[],$r.destroyed_quad_list=[],na.destroyed_matrix_list=[],ba.exists=!1,Ca.award_adventurer=new Sa("adventr_drivrs_vkas001",Tr.Finish2Levels),Ca.award_back_wheelie_pro=new Sa("adventr_drivrs_vkas002",Tr.Finish6Levels),Ca.award_spinner=new Sa("adventr_drivrs_vkas003",Tr.Stunt3xFrontFlip),Ca.award_combo_pro=new Sa("adventr_drivrs_vkas004",Tr.Stunt3xCombo),Ca.award_completionist=new Sa("adventr_drivrs_vkas005",Tr.Finish10LevelsWith100Score),Ca.award_back_flip_expert=new Sa("adventr_drivrs_vkas006",Tr.Stunt10BackFlipsInALevel),Ca.award_flip_master=new Sa("adventr_drivrs_vkas007",Tr.Stunt100Flips),Ca.award_number_one=new Sa("adventr_drivrs_vkas008",Tr.Finish20Levels1st),Ca.award_combo_expert=new Sa("adventr_drivrs_vkas009",Tr.Stunt10xCombo),Ca.award_100=new Sa("adventr_drivrs_vkas010",Tr.Finish30LevelsWith100Score),Ca.all_awards=[Ca.award_adventurer,Ca.award_back_wheelie_pro,Ca.award_spinner,Ca.award_combo_pro,Ca.award_completionist,Ca.award_back_flip_expert,Ca.award_flip_master,Ca.award_number_one,Ca.award_combo_expert,Ca.award_100],Pa.destroyed_description_list=[],Da.debug_on=!1,Da.debug_tree_update_ms=0,Da.debug_total_objects=0,Da.debug_add_checks=0,Da.debug_index_checks=0,Da.debug_dynamic_checks=0,Ea.destroyed_partition_objects=[],Wa.CLICK_EVENT_DISTANCE=3,Ya.show_adblock_warning=!1,Ja.ORDER_LEFT=0,Ja.ORDER_RIGHT=1,Ja.ORDER_TOP=2,Ja.ORDER_BOTTOM=3,$a.ID_TOPEDGE=3,$a.ID_RIGHTEDGE=0,$a.ID_BOTTOMEDGE=2,$a.ID_LEFTEDGE=1,us.destroyed_sprite_list=[],hs.destroyed_group_list=[],cs.NAME="BEF_v3",cs.BOOL_FLAG=0,cs.BOOL_TRUE_FLAG=1,cs.BOOL_FALSE_FLAG=2,cs.INT_FLAG=3,cs.DOUBLE_FLAG=4,cs.STRING_FLAG=5,cs.NULL_FLAG=6,cs.ENUM_FLAG=7,cs.ENUM_INDEX_INDEX_FLAG=8,cs.ENUM_STRING_INDEX_FLAG=9,cs.ENUM_STRING_STRING_FLAG=10,cs.ARRAY_FLAG=11,cs.INSTANCE_FLAG=12,cs.INSTANCE_POINT_FLAG=128,cs.INSTANCE_TRANSFORM_FLAG=129,Ms.debug_print_stats=!1,Ms.debug_print_time_and_texture_size=!0,Ms.debug_add_base_texture_to_stage=!1,Ms.bleeding_fix=2,Ms.destroyed_terrain_rect_list=[],Ms.destroyed_sprite_object_list=[],Is.None=0,Is.BikasNet=1,Is.LaggedCom=2,Is.PokiCom=3,Ds.Development=0,Ds.Release=1,Os.working_library="",Os.working_stage="",Os.background_objects_source="",Os.level_data_saves=[],Os.all_sound_loops=[],Os.all_music_loops=[],Os.all_sounds=[],Gs.transition_out_time=15,Ws.UNKNOWN=0,Ws.WEBGL=1,Ws.CANVAS=2,Xs.paused=!1,Xs.right_mouse_button_down=!1,Xs.top_listeners=[],Ys.TYPE_DIRECT="direct",Ys.TYPE_ORGANIC="organic",Ys.TYPE_REFERRAL="referral",Js.ERROR_SEVERITY_SILENCE=0,Js.ERROR_SEVERITY_TRACE=1,Js.ERROR_SEVERITY_EXCEPTIONS=2,Ks.SCOPE_VISITOR=1,Ks.SCOPE_SESSION=2,Ks.SCOPE_PAGE=3,tl.REFERRER_INTERNAL="0",rl.paused=!1,sl.VERSION="5.2.5",ol.parts=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],hl.OBJECT_KEY_NUM=1,hl.TYPE_KEY_NUM=2,hl.LABEL_KEY_NUM=3,hl.VALUE_VALUE_NUM=1,cl.TYPE_EVENT="event",cl.TYPE_TRANSACTION="tran",cl.TYPE_ITEM="item",cl.TYPE_SOCIAL="social",cl.TYPE_CUSTOMVARIABLE="var",cl.X10_CUSTOMVAR_NAME_PROJECT_ID="8",cl.X10_CUSTOMVAR_VALUE_PROJECT_ID="9",cl.X10_CUSTOMVAR_SCOPE_PROJECT_ID="11",cl.CAMPAIGN_DELIMITER="|",dl.X10_EVENT_PROJECT_ID="5",Sl.CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Sl.BYTES=kl.ofString(Sl.CHARS),Ml.count=0,Ll.i64tmp=new yl(0,0),Fl.escapes=((Mc=new Al).set("lt","<"),Mc.set("gt",">"),Mc.set("amp","&"),Mc.set("quot",'"'),Mc.set("apos","'"),Mc),Vl.LEN_EXTRA_BITS_TBL=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,-1,-1],Vl.LEN_BASE_VAL_TBL=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Vl.DIST_EXTRA_BITS_TBL=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,-1,-1],Vl.DIST_BASE_VAL_TBL=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Vl.CODE_LENGTHS_POS=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Yl.INFINITY=new Yl,Kl.EMPTY=Kl._new(NaN,NaN),Ql.point=Kl._new(),Ql.zero=Kl._new(0,0),Ql.EPSILON=1e-8,eo.__toStr={}.toString,ao.BYTES_PER_ELEMENT=4,so.BYTES_PER_ELEMENT=1,lo.epsilon=1e-8,lo.fluidAngularDragFriction=2.5,lo.fluidAngularDrag=100,lo.fluidVacuumDrag=.5,lo.fluidLinearDrag=.5,lo.collisionSlop=.2,lo.collisionSlopCCD=.5,lo.distanceThresholdCCD=.05,lo.staticCCDLinearThreshold=.05,lo.staticCCDAngularThreshold=.005,lo.bulletCCDLinearThreshold=.125,lo.bulletCCDAngularThreshold=.0125,lo.dynamicSweepLinearThreshold=17,lo.dynamicSweepAngularThreshold=.6,lo.angularCCDSlipScale=.75,lo.arbiterExpirationDelay=6,lo.staticFrictionThreshold=2,lo.elasticThreshold=20,lo.sleepDelay=60,lo.linearSleepThreshold=.2,lo.angularSleepThreshold=.4,lo.contactBiasCoef=.3,lo.contactStaticBiasCoef=.6,lo.contactContinuousBiasCoef=.4,lo.contactContinuousStaticBiasCoef=.5,lo.constraintLinearSlop=.1,lo.constraintAngularSlop=.001,lo.illConditionedThreshold=2e8,X_.FMAX=1e100,H_._Constraint=0,H_._Interactor=0,H_._CbType=0,H_._CbSet=0,H_._Listener=0,H_._ZPP_SimpleVert=0,H_._ZPP_SimpleSeg=0,H_._Space=0,H_._InteractionGroup=0,rp.ANY_SHAPE=new co,rp.ANY_BODY=new co,rp.ANY_COMPOUND=new co,rp.ANY_CONSTRAINT=new co,ap.internal=!1,ap.id_ImmState_ACCEPT=1,ap.id_ImmState_IGNORE=2,ap.id_ImmState_ALWAYS=4,ap.id_GravMassMode_DEFAULT=0,ap.id_GravMassMode_FIXED=1,ap.id_GravMassMode_SCALED=2,ap.id_InertiaMode_DEFAULT=0,ap.id_InertiaMode_FIXED=1,ap.id_MassMode_DEFAULT=0,ap.id_MassMode_FIXED=1,ap.id_BodyType_STATIC=1,ap.id_BodyType_DYNAMIC=2,ap.id_BodyType_KINEMATIC=3,ap.id_ListenerType_BODY=0,ap.id_ListenerType_CONSTRAINT=1,ap.id_PreFlag_ACCEPT=1,ap.id_ListenerType_INTERACTION=2,ap.id_PreFlag_IGNORE=2,ap.id_ListenerType_PRE=3,ap.id_PreFlag_ACCEPT_ONCE=3,ap.id_PreFlag_IGNORE_ONCE=4,ap.id_CbEvent_BEGIN=0,ap.id_CbEvent_ONGOING=6,ap.id_InteractionType_COLLISION=1,ap.id_CbEvent_END=1,ap.id_InteractionType_SENSOR=2,ap.id_CbEvent_WAKE=2,ap.id_InteractionType_FLUID=4,ap.id_CbEvent_SLEEP=3,ap.id_InteractionType_ANY=7,ap.id_CbEvent_BREAK=4,ap.id_CbEvent_PRE=5,ap.id_Winding_UNDEFINED=0,ap.id_Winding_CLOCKWISE=1,ap.id_Winding_ANTICLOCKWISE=2,ap.id_ValidationResult_VALID=0,ap.id_ValidationResult_DEGENERATE=1,ap.id_ValidationResult_CONCAVE=2,ap.id_ValidationResult_SELF_INTERSECTING=3,ap.id_ShapeType_CIRCLE=0,ap.id_ShapeType_POLYGON=1,ap.id_Broadphase_DYNAMIC_AABB_TREE=0,ap.id_Broadphase_SWEEP_AND_PRUNE=1,ap.id_ArbiterType_COLLISION=1,ap.id_ArbiterType_SENSOR=2,ap.id_ArbiterType_FLUID=4,sp.types=[ko.get_BODY(),ko.get_CONSTRAINT(),ko.get_INTERACTION(),ko.get_PRE()],sp.events=[ho.get_BEGIN(),ho.get_END(),ho.get_WAKE(),ho.get_SLEEP(),ho.get_BREAK(),ho.get_PRE(),ho.get_ONGOING()],pp.UCbSet=new ip,pp.VCbSet=new ip,pp.WCbSet=new ip,pp.UCbType=new _p,pp.VCbType=new _p,pp.WCbType=new _p,wp.internal=!1,wp.COL=1,wp.FLUID=4,wp.SENSOR=2,wp.types=[null,Uo.get_COLLISION(),Uo.get_SENSOR(),null,Uo.get_FLUID()],Cp.FACE1=0,Cp.FACE2=1,Cp.CIRCLE=2,Np.internal=!1,Mp.SHAPE=1,Mp.BODY=2,Dp.flowpoly=new Tp,Dp.flowsegs=new Tp,Op.internal=!1,qp.me=new qp,qp.look_march=[-1,224,56,216,14,-1,54,214,131,99,-1,91,141,109,181,85],Yp.nextId=0,du.types=[null,w_.get_STATIC(),w_.get_DYNAMIC(),w_.get_KINEMATIC()],du.cur_graph_depth=0,gu.types=[G_.get_CIRCLE(),G_.get_POLYGON()],bu.internal=!1,ku.tmpaabb=new Ap,Su.FATTEN=3,Su.VEL_STEPS=2,Xh.internal=!1,Hh.internal=!1,Yh.internal=!1,Jh.internal=!1,Kh.internal=!1,Qh.internal=!1,$h.internal=!1,ec.internal=!1,tc.internal=!1,nc.internal=!1,ic.internal=!1,rc.internal=!1,ac.internal=!1,sc.internal=!1,lc.internal=!1,l.main()}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);